{"version":3,"file":"token-action-hud-core.min.mjs","sources":["../module/core/constants.mjs","../module/core/utils.mjs","../module/handlers/data-handler.mjs","../module/managers/migration-manager.mjs","../module/handlers/character-handler.mjs","../module/handlers/layout-handler.mjs","../module/handlers/tooltip-handler.mjs","../module/handlers/group-handler.mjs","../module/managers/hud-manager.mjs","../node_modules/@yaireo/dragsort/dist/dragsort.js","../node_modules/@yaireo/tagify/dist/tagify.esm.js","../module/applications/tagify-app.mjs","../module/applications/tagify-app-helper.mjs","../module/handlers/group-resizer.mjs","../module/applications/token-action-hud.mjs","../module/core/sockets.mjs","../module/handlers/action-handlers/generic-action-handler.mjs","../module/handlers/action-handlers/compendium-action-handler.mjs","../module/handlers/action-handlers/macro-action-handler.mjs","../module/handlers/action-handlers/action-handler.mjs","../module/handlers/action-handlers/action-handler-extender.mjs","../module/handlers/roll-handlers/roll-handler.mjs","../module/handlers/roll-handlers/pre-roll-handler.mjs","../module/handlers/roll-handlers/roll-handler-extender.mjs","../module/applications/custom-style-form.mjs","../module/dialogs/reset-layout.mjs","../module/dialogs/reset-all-layouts.mjs","../module/applications/settings-form.mjs","../module/core/settings.mjs","../module/handlers/action-handlers/item-macro-extender.mjs","../module/managers/system-manager.mjs","../module/core/api.mjs","../module/main.mjs"],"sourcesContent":["/**\n * Module-based constants\n */\nexport const MODULE = {\n  ID: \"token-action-hud-core\",\n  NAME: \"Token Action HUD\"\n};\n\n\n/* -------------------------------------------- */\n\n/**\n * Template directory\n */\nconst TEMPLATE_DIR = `modules/${MODULE.ID}/templates`;\n\n/* -------------------------------------------- */\n\n/**\n * Templates\n */\nexport const TEMPLATE = {\n  action: `${TEMPLATE_DIR}/action.hbs`,\n  customStyleForm: `${TEMPLATE_DIR}/custom-style-form.hbs`,\n  group: `${TEMPLATE_DIR}/group.hbs`,\n  hud: `${TEMPLATE_DIR}/hud.hbs`,\n  listSubgroup: `${TEMPLATE_DIR}/list-subgroup.hbs`,\n  settings: `${TEMPLATE_DIR}/settings.hbs`,\n  tabSubgroup: `${TEMPLATE_DIR}/tab-subgroup.hbs`,\n  tagifyAppHud: `${TEMPLATE_DIR}/tag-dialog-hud.hbs`,\n  tagifyAppGroup: `${TEMPLATE_DIR}/tag-dialog-group.hbs`,\n  tagifyAppSubgroup: `${TEMPLATE_DIR}/tag-dialog-subgroup.hbs`\n};\n\n/* -------------------------------------------- */\n\n/**\n * Delimiter character\n */\nexport const DELIMITER = \"|\";\n\n/* -------------------------------------------- */\n\n/**\n * Action types\n */\nexport const ACTION_TYPE = {\n  compendiumEntry: \"tokenActionHud.compendiumEntry\",\n  compendiumMacro: \"tokenActionHud.compendiumMacro\",\n  compendiumPlaylist: \"tokenActionHud.compendiumPlaylist\",\n  macro: \"tokenActionHud.macro\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * Compendium action types\n */\nexport const COMPENDIUM_ACTION_TYPES = [\"compendiumEntry\", \"compendiumMacro\", \"compendiumPlaylist\", \"macro\"];\n\n/* -------------------------------------------- */\n\n/**\n * Compendium pack types\n */\nexport const COMPENDIUM_PACK_TYPES = [\"JournalEntry\", \"Macro\", \"RollTable\"];\n\n/* -------------------------------------------- */\n\n/**\n * CSS styles\n */\nexport const CSS_STYLE = {\n  foundryVTT: {\n    class: \"tah-style-foundry-vtt-dark\",\n    file: \"tah-foundry-vtt-dark\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  compact: {\n    class: \"tah-style-foundry-vtt-dark-compact\",\n    file: \"tah-foundry-vtt-dark-compact\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark Compact\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  dockedLeft: {\n    class: \"tah-style-docked-left\",\n    file: \"tah-docked-left\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark Docked Left\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    isDocked: true,\n    dockPosition: \"left\"\n  },\n  dockedCenterRight: {\n    class: \"tah-style-docked-right\",\n    file: \"tah-docked-right\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark Docked Center-Right\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    collapseIcon: \"fa-caret-right\",\n    expandIcon: \"fa-caret-left\",\n    isDocked: true,\n    dockPosition: \"center-right\"\n  },\n  dockedRight: {\n    class: \"tah-style-docked-right\",\n    file: \"tah-docked-right\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Dark Docked Right\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\",\n    collapseIcon: \"fa-caret-right\",\n    expandIcon: \"fa-caret-left\",\n    isDocked: true,\n    dockPosition: \"right\"\n  },\n  foundryVttLight: {\n    class: \"tah-style-foundry-vtt-light\",\n    file: \"tah-foundry-vtt-light\",\n    moduleId: MODULE.ID,\n    name: \"Foundry VTT Light\",\n    primaryColor: \"#dddddd\",\n    secondaryColor: \"#dddddd80\",\n    tertiaryColor: \"#ff6400\"\n  },\n  pathfinder: {\n    class: \"tah-style-pathfinder\",\n    file: \"tah-pathfinder\",\n    moduleId: MODULE.ID,\n    name: \"Pathfinder\"\n  },\n  highContrast: {\n    class: \"tah-style-high-contrast\",\n    file: \"tah-high-contrast\",\n    moduleId: MODULE.ID,\n    name: \"High Contrast\",\n    primaryColor: \"#ffff00\",\n    secondaryColor: \"#ffff00\",\n    tertiaryColor: \"#0C7BDC\"\n  },\n  custom: {\n    class: \"tah-style-custom\",\n    file: \"tah-custom\",\n    moduleId: MODULE.ID,\n    name: \"Custom\"\n  }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Custom styles\n */\nexport const CUSTOM_STYLE = {\n  backgroundColor: { cssProperty: \"--tah-background-color\", type: String, default: \"#00000000\" },\n  buttonHeight: { cssProperty: \"--tah-button-height-editable\", type: Number, default: 32 },\n  buttonBackgroundColor: { cssProperty: \"--tah-button-background-color-editable\", type: String, default: \"#000000b3\" },\n  buttonBorderPrimaryColor: { cssProperty: \"--tah-button-border-primary-color-editable\", type: String, default: \"#0C0C0CFF\" },\n  buttonBorderSecondaryColor: { cssProperty: \"--tah-button-border-secondary-color-editable\", type: String, default: \"#060606FF\" },\n  buttonTextColor: { cssProperty: \"--tah-button-text-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  buttonHoverBorderPrimaryColor: { cssProperty: \"--tah-button-hover-border-primary-color-editable\", type: String, default: \"#FF6400FF\" },\n  buttonHoverBorderSecondaryColor: { cssProperty: \"--tah-button-hover-border-secondary-color-editable\", type: String, default: \"#FF0000FF\" },\n  buttonHoverBackgroundColor: { cssProperty: \"--tah-button-hover-background-color-editable\", type: String, default: \"#000000B3\" },\n  buttonHoverTextColor: { cssProperty: \"--tah-button-hover-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  buttonToggleActiveBackgroundColor: { cssProperty: \"--tah-button-toggle-active-background-color-editable\", type: String, default: \"#3C0078BF\" },\n  buttonToggleActiveBorderPrimaryColor: { cssProperty: \"--tah-button-toggle-active-border-primary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleActiveBorderSecondaryColor: { cssProperty: \"--tah-button-toggle-active-border-secondary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleActiveTextColor: { cssProperty: \"--tah-button-toggle-active-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  buttonToggleHoverBackgroundColor: { cssProperty: \"--tah-button-toggle-hover-background-color-editable\", type: String, default: \"#3C0078BF\" },\n  buttonToggleHoverBorderPrimaryColor: { cssProperty: \"--tah-button-toggle-hover-border-primary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleHoverBorderSecondaryColor: { cssProperty: \"--tah-button-toggle-hover-secondary-color-editable\", type: String, default: \"#9B8DFFFF\" },\n  buttonToggleHoverTextColor: { cssProperty: \"--tah-button-toggle-hover-text-color-editable\", type: String, default: \"#FFFFFFFF\" },\n  textPrimaryColor: { cssProperty: \"--tah-text-primary-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  textSecondaryColor: { cssProperty: \"--tah-text-secondary-color-editable\", type: String, default: \"#DDDDDD80\" },\n  textTertiaryColor: { cssProperty: \"--tah-text-tertiary-color-editable\", type: String, default: \"#FF6400FF\" },\n  textHoverPrimaryColor: { cssProperty: \"--tah-text-hover-primary-color-editable\", type: String, default: \"#DDDDDDFF\" },\n  textHoverSecondaryColor: { cssProperty: \"--tah-text-hover-secondary-color-editable\", type: String, default: \"#DDDDDD80\" },\n  textHoverTertiaryColor: { cssProperty: \"--tah-text-tertiary-color-editable\", type: String, default: \"#FF6400FF\" }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Group types\n */\nexport const GROUP_TYPE = {\n  COMPENDIUM: \"compendium\",\n  CUSTOM: \"custom\",\n  SYSTEM: \"system\",\n  SYSTEM_DERIVED: \"system-derived\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * HUD\n */\nexport const HUD = {\n  DEFAULT_HEIGHT: 200,\n  DEFAULT_WIDTH: 20,\n  DEFAULT_LEFT_POS: 150,\n  DEFAULT_TOP_POS: 80,\n  DEFAULT_SCALE: 1,\n  DEFAULT_ZINDEX: 100\n};\n\n/* -------------------------------------------- */\n\n/**\n * Item Macro icon\n */\nexport const ITEM_MACRO_ICON = {\n  ICON: \"fas fa-sd-card\",\n  TOOLTIP: \"Item Macro\"\n};\n\n/* -------------------------------------------- */\n\n/**\n * Layout settings\n */\nexport const LAYOUT_SETTING = {\n  customLayout: {\n    hint: \"tokenActionHud.settings.customLayout.hint\",\n    name: \"tokenActionHud.settings.customLayout.name\",\n    inputType: \"filePicker\",\n    filePickerType: \"json\",\n    dtype: \"String\",\n    scope: \"world\"\n  },\n  userCustomLayout: {\n    hint: \"tokenActionHud.settings.userCustomLayout.hint\",\n    name: \"tokenActionHud.settings.userCustomLayout.name\",\n    inputType: \"filePicker\",\n    filePickerType: \"json\",\n    dtype: \"String\",\n    scope: \"user\"\n  },\n  exportLayout: {\n    hint: \"tokenActionHud.settings.exportLayout.hint\",\n    label: \"tokenActionHud.settings.exportLayout.label\",\n    name: \"tokenActionHud.settings.exportLayout.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-file-export\",\n    action: \"exportLayout\"\n  },\n  resetLayout: {\n    hint: \"tokenActionHud.settings.resetLayout.hint\",\n    label: \"tokenActionHud.settings.resetLayout.label\",\n    name: \"tokenActionHud.settings.resetLayout.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-arrow-rotate-left\",\n    action: \"resetLayout\",\n    scope: \"client\"\n  },\n  resetAllLayouts: {\n    hint: \"tokenActionHud.settings.resetAllLayouts.hint\",\n    label: \"tokenActionHud.settings.resetAllLayouts.label\",\n    name: \"tokenActionHud.settings.resetAllLayouts.name\",\n    inputType: \"button\",\n    icon: \"fa-solid fa-bomb\",\n    action: \"resetAllLayouts\",\n    scope: \"world\"\n  }\n};\n\n/* -------------------------------------------- */\n\n/**\n * Settings\n */\nexport const SETTING = {\n  activeCssAsText: { classes: [\"TokenActionHud\"], cache: true },\n  allow: { classes: [\"TokenActionHud\"], cache: true },\n  alwaysShowHud: { classes: [\"TokenActionHud\"], cache: true },\n  backgroundColor: {},\n  buttonBackgroundColor: {},\n  buttonBorderPrimaryColor: {},\n  buttonBorderSecondaryColor: {},\n  buttonHeight: {},\n  buttonHoverBorderPrimaryColor: {},\n  buttonHoverBorderSecondaryColor: {},\n  buttonHoverBackgroundColor: {},\n  buttonHoverTextColor: {},\n  buttonTextColor: {},\n  buttonToggleActiveBackgroundColor: {},\n  buttonToggleActiveBorderPrimaryColor: {},\n  buttonToggleActiveBorderSecondaryColor: {},\n  buttonToggleActiveTextColor: {},\n  buttonToggleHoverBackgroundColor: {},\n  buttonToggleHoverBorderPrimaryColor: {},\n  buttonToggleHoverBorderSecondaryColor: {},\n  buttonToggleHoverTextColor: {},\n  clickOpenCategory: { classes: [\"TokenActionHud\"], cache: true },\n  customLayout: { classes: [\"ActionHandler\"], cache: true },\n  customStyle: {},\n  debug: { classes: [\"TokenActionHud\"], cache: true },\n  direction: { classes: [\"TokenActionHud\"], cache: true },\n  displayCharacterName: { classes: [\"TokenActionHud\"], cache: true },\n  displayIcons: { classes: [\"TokenActionHud\"], cache: true },\n  drag: { classes: [\"TokenActionHud\"], cache: true },\n  enable: { classes: [\"TokenActionHud\"], cache: true },\n  enableCustomization: { classes: [\"ActionHandler\", \"TokenActionHud\"], cache: true },\n  grid: { classes: [\"TokenActionHud\"], cache: true },\n  itemMacro: {},\n  migrationVersion: {},\n  reset: {},\n  renderItemOnRightClick: {},\n  rollHandler: { default: \"core\" },\n  scale: { classes: [\"TokenActionHud\"], cache: true },\n  sortActions: { classes: [\"ActionHandler\"], cache: true },\n  startup: {},\n  style: { classes: [\"TokenActionHud\"], cache: true },\n  tooltips: { classes: [\"ActionHandler\"], cache: true },\n  textPrimaryColor: {},\n  textSecondaryColor: {},\n  textTertiaryColor: {},\n  textHoverPrimaryColor: {},\n  textHoverSecondaryColor: {},\n  textHoverTertiaryColor: {},\n  userCustomLayout: { classes: [\"ActionHandler\"], cache: true }\n};\n","import { CSS_STYLE, CUSTOM_STYLE, MODULE } from \"./constants.mjs\";\n\n/**\n * A class responsible for logging messages to the console.\n */\nexport class Logger {\n  /**\n   * Log an info message to the console. If 'notify' is true, also send a notification\n   * @param {string} message The message\n   * @param {boolean} notify Whether to send a notification\n   */\n  static info(message, notify = false) {\n    if (notify) ui.notifications.info(`Token Action HUD | ${message}`);\n    else console.log(`Token Action HUD Info | ${message}`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Log an error message to the console. If 'notify' is true, also send a notification\n   * @param {string} message The message\n   * @param {boolean} notify Whether to send a notification\n   */\n  static error(message, notify = false) {\n    if (notify) ui.notifications.error(`Token Action HUD | ${message}`, { permanent: true });\n    else console.error(`Token Action HUD Error | ${message}`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Log a debug message and, optionally, data to the console\n   * @param {string} message   The message\n   * @param {object|null} data The data\n   */\n  static debug(message, data = null) {\n    const isDebug = game.tokenActionHud?.setting?.debug ?? Utils.getSetting(\"debug\");\n    if (isDebug) {\n      if (!data) {\n        console.log(`Token Action HUD Debug | ${message}`);\n        return;\n      }\n      const dataClone = Utils.deepClone(data);\n      console.log(`Token Action HUD Debug | ${message}`, dataClone);\n    }\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * A class responsible for setting and aborting timers.\n */\nexport class Timer {\n  constructor(milliseconds) {\n    this.milliseconds = milliseconds;\n    this.timer = null;\n  }\n\n  async start() {\n    if (this.timer) this.abort();\n    return new Promise(resolve => {\n      this.timer = setTimeout(() => { resolve(); }, this.milliseconds ?? 100);\n    });\n  }\n\n  async abort() {\n    clearTimeout(this.timer);\n    this.timer = null;\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * A class of helper functions.\n */\nexport class Utils {\n  /**\n   * Whether the user is allowed to use the HUD\n   * @public\n   * @param {number} userRole     The user's role\n   * @param {number} allowSetting The 'allow' setting value\n   * @returns {boolean} Whether the user is allowed to use the HUD\n   */\n  static checkAllow(userRole, allowSetting) {\n    return userRole >= allowSetting;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Capitalize the first letter of every word\n   * @param {string} value The string\n   * @returns {string}     The capitalized string\n   */\n  static capitalize(value) {\n    return value.replace(\n      /\\w\\S*/g,\n      text => text.charAt(0).toUpperCase() + text.substring(1).toLowerCase()\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Foundry VTT's deepClone function wrapped here to avoid code error highlighting due to missing definition\n   * @public\n   * @param {object} original The original object\n   * @param {object} options  The options\n   * @returns {object}        The cloned object\n   */\n  static deepClone(original, options) {\n    // eslint-disable-next-line no-undef\n    return foundry.utils.deepClone(original, options);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor from the token or actor\n   * @public\n   * @param {string} actorId The actor id\n   * @param {string} tokenId The token id\n   * @returns {object}       The actor\n   */\n  static getActor(actorId, tokenId) {\n    let token = null;\n    if (tokenId) token = canvas.tokens.placeables.find(token => token.id === tokenId);\n    if (token) return token.actor;\n    return game.actors.get(actorId);\n  }\n\n  /**\n   * Get closest group to the event target\n   * @param {object} event The event\n   * @returns {object}     The closest group element\n   */\n  static getClosestGroupElement(event) {\n    if (!event) return null;\n    return event.target.closest(\"[data-part=\\\"subgroup\\\"]\") || event.target.closest(\"[data-part=\\\"group\\\"]\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors of controlled tokens\n   * @public\n   * @returns {Array} The actors\n   */\n  static getControlledActors() {\n    const tokens = game.canvas.tokens?.controlled ?? [];\n    return tokens.map(token => token.actor);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get status effect from actor based on the status ID\n   * @param {object} actor    The actor\n   * @param {string} statusId The status ID\n   * @returns {object}        The status effect\n   */\n  static getStatusEffect(actor, statusId) {\n    return actor.effects.find(effect => effect.statuses.every(status => status === statusId));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get image from the entity\n   * @public\n   * @param {object} entity       The entity, e.g., actor, item\n   * @param {Array} defaultImages Any default images to exclude\n   * @returns {string}            The image URL\n   */\n  static getImage(entity, defaultImages = []) {\n    defaultImages.push(\"icons/svg/mystery-man.svg\");\n    let result = \"\";\n    if (game.tokenActionHud?.setting?.displayIcons) {\n      result = (typeof entity === \"string\")\n        ? entity\n        : entity?.img ?? entity?.icon ?? \"\";\n    }\n    return !defaultImages.includes(result) ? result : \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get item from the actor\n   * @public\n   * @param {object} actor  The actor\n   * @param {string} itemId The item id\n   * @returns {object}      The item\n   */\n  static getItem(actor, itemId) {\n    return actor.items.get(itemId);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @public\n   * @param {string} tokenId The token id\n   * @returns {object}       The token\n   */\n  static getToken(tokenId) {\n    return canvas.tokens.placeables.find(token => token.id === tokenId);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get controlled tokens\n   * @public\n   * @returns {Array} The controlled tokens\n   */\n  static getControlledTokens() {\n    return game.canvas.tokens?.controlled ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get first controlled tokens\n   * @public\n   * @returns {object|null} The first controlled token\n   */\n  static getFirstControlledToken() {\n    const controlledToken = game.canvas.tokens.controlled[0];\n    if (controlledToken) {\n      return controlledToken;\n    }\n\n    const character = game.user?.character;\n    if (character) {\n      return canvas.tokens.placeables.find(token => token.actor?.id === character.id);\n    }\n\n    return null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get setting value\n   * @public\n   * @param {string} key               The setting key\n   * @param {string=null} defaultValue The setting default value\n   * @returns {*}                      The setting value\n   */\n  static getSetting(key, defaultValue = null) {\n    let value = defaultValue ?? null;\n    try {\n      value = game.settings.get(MODULE.ID, key);\n    } catch{\n      Logger.debug(`Setting '${key}' not found`);\n    }\n    return value;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set setting value\n   * @public\n   * @param {string} key   The setting key\n   * @param {string} value The setting value\n   */\n  static async setSetting(key, value) {\n    if (game.settings.settings.get(`${MODULE.ID}.${key}`)) {\n      await game.settings.set(MODULE.ID, key, value);\n      Logger.debug(`Setting '${key}' set to '${value}'`);\n    } else if (key !== \"debug\") {\n      Logger.debug(`Setting '${key}' not found`);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get module actor flag\n   * @public\n   * @param {string} key The flag key\n   * @returns {*}        The flag value\n   */\n  static getActorFlag(key) {\n    return game.tokenActionHud.actor.getFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set module actor flag\n   * @public\n   * @param {string} key The flag key\n   * @param {*} value    The flag value\n   */\n  static async setActorFlag(key, value) {\n    await game.tokenActionHud.actor.setFlag(MODULE.ID, key, value);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset module actor flag\n   * @public\n   * @param {string} key The flag key\n   */\n  static async unsetActorFlag(key) {\n    await game.tokenActionHud.actor.unsetFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get module user flag\n   * @public\n   * @param {string} key The flag key\n   * @returns {*}        The flag value\n   */\n  static getUserFlag(key) {\n    return game.user.getFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set module user flag\n   * @public\n   * @param {string} key The flag key\n   * @param {*} value    The flag value\n   */\n  static async setUserFlag(key, value) {\n    await game.user.setFlag(MODULE.ID, key, value);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset module user flag\n   * @public\n   * @param {string} key The flag key\n   */\n  static async unsetUserFlag(key) {\n    await game.user.unsetFlag(MODULE.ID, key);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Language translation\n   * @public\n   * @param {string} toTranslate The value to translate\n   * @returns {string}           The translated value\n   */\n  static i18n(toTranslate) {\n    return game.i18n.localize(toTranslate);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether a GM is active\n   * @public\n   * @returns {boolean} Whether a GM is active\n   */\n  static isGmActive() {\n    return game.users.some(user => user.isGM && user.active);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the given module is active\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {boolean}       Whether the given module is active\n   */\n  static isModuleActive(moduleId) {\n    const module = game.modules.get(moduleId);\n    return module && module.active;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the given module's title\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {string}        The module title\n   */\n  static getModuleTitle(moduleId) {\n    return game.modules.get(moduleId)?.title ?? \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the given module's version\n   * @public\n   * @param {string} moduleId The module id\n   * @returns {string}        The module version\n   */\n  static getModuleVersion(moduleId) {\n    return game.modules.get(moduleId)?.version ?? \"\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Humanize keybinding\n   * @param {object} key The keybinding key\n   * @returns {string}   The humanized keybinding\n   */\n  static humanizeBinding(key) {\n    const keyboardManager = foundry?.helpers?.interaction?.KeyboardManager ?? KeyboardManager;\n    const binding = game.keybindings.get(MODULE.ID, key);\n    if (!binding) return \"\";\n    const stringParts = binding[0].modifiers.reduce((parts, part) => {\n      if (keyboardManager.MODIFIER_CODES[part]?.includes(binding[0].key)) return parts;\n      parts.unshift(keyboardManager.getKeycodeDisplayString(part));\n      return parts;\n    }, [keyboardManager.getKeycodeDisplayString(binding[0].key)]);\n    return stringParts.join(\" + \");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the median\n   * @public\n   * @param {Array} numbers The array of numbers\n   * @returns {number}      The median\n   */\n  static median(numbers) {\n    const mid = Math.floor(numbers.length / 2);\n    const nums = [...numbers].sort((a, b) => a - b);\n    return numbers.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get upper quartile average\n   * @param {Array} numbers The numbers\n   * @returns {number}      The upper quartile average\n   */\n  static getUpperQuartileAverage(numbers) {\n    const sortedNumbers = numbers.slice().sort((a, b) => a - b);\n    const length = sortedNumbers.length;\n    const startIndex = Math.ceil(length * 0.75);\n    const endIndex = length - 1;\n\n    let sum = 0;\n    let count = 0;\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      sum += sortedNumbers[i];\n      count++;\n    }\n\n    const upperQuartileAverage = sum / count;\n\n    return upperQuartileAverage;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get modifier (e.g., +5) from number\n   * @param {number} num The number\n   * @returns {string}   The modifier\n   */\n  static getModifier(num) {\n    if (!num && num !== 0) return \"\";\n    const sign = (num >= 0) ? \"+\" : \"\";\n    return `${sign}${num}`;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Sort items\n   * @public\n   * @param {object} items The items\n   * @returns {object}     The sorted items\n   */\n  static sortItems(items) {\n    return new Map([...items.entries()].sort((a, b) => a[1].sort.localeCompare(b[1].sort)));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Sort items by name\n   * @public\n   * @param {object} items The items\n   * @returns {object}     The sorted items\n   */\n  static sortItemsByName(items) {\n    return new Map([...items.entries()].sort((a, b) => a[1].name.localeCompare(b[1].name)));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Enable stylesheet based on setting and disable all other stylesheets\n   * @public\n   * @param {string} style The 'style' setting value\n   */\n  static switchCSS(style) {\n    const tahElement = document.querySelector(\"#token-action-hud-app\");\n    if (tahElement) {\n      const styleClass = foundry.utils.isNewerVersion(game.version, \"12.999\") && [\"dockedLeft\", \"dockedCenterRight\", \"dockedRight\"].includes(style)\n        ? `${CSS_STYLE[style].class}-v13`\n        : CSS_STYLE[style].class;\n\n      if (tahElement.classList.contains(styleClass)) return;\n      const classesToRemove = [...tahElement.classList].filter(c => c !== \"tah-expanded\");\n      if (classesToRemove.length) tahElement.classList.remove(classesToRemove);\n      tahElement.classList.add(styleClass);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register Handlebar helpers\n   * @public\n   */\n  static registerHandlebars() {\n    // Capitalise first character\n    Handlebars.registerHelper(\"tokenActionHudCoreCap\", function(string) {\n      if (!string || string.length < 1) return \"\";\n      return string[0].toUpperCase() + string.slice(1);\n    });\n    const reduceOp = function(args, reducer) {\n      args = Array.from(args);\n      args.pop(); // => options\n      const first = args.shift();\n      return args.reduce(reducer, first);\n    };\n\n    // Support operators\n    Handlebars.registerHelper({\n      tokenActionHudCoreTrue: function() { return reduceOp(arguments, a => a); }\n    });\n\n    // Add asterisk to toggleable actions\n    Handlebars.registerHelper(\"tokenActionHudCoreActiveText\", function(block) {\n      if (game.tokenActionHud?.setting?.activeCssAsText) {\n        return block.fn(this);\n      }\n      return block.inverse(this);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the major, minor and patch parts of the module version\n   * @public\n   * @param {string} moduleVersion The module version\n   * @returns {object|null}        The module version parts\n   */\n  static getModuleVersionParts(moduleVersion) {\n    if (!moduleVersion) {\n      Logger.debug(\"Module version not retrieved\", { trigger: \"getModuleVersionParts\" });\n      return null;\n    }\n    const moduleVersionParts = moduleVersion.split(\".\");\n    return {\n      major: moduleVersionParts[0],\n      minor: moduleVersionParts[1],\n      patch: moduleVersionParts[2]\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the system module is compatible with the core module version\n   * @public\n   * @param {string} requiredCoreModuleVersion The required core module version\n   * @returns {boolean}                        Whether the system module is compatible with the core module version\n   */\n  static isSystemModuleCompatible(requiredCoreModuleVersion) {\n    if (!requiredCoreModuleVersion) return true;\n\n    // Get core module version in parts\n    const requiredCoreModuleVersionParts = this.getModuleVersionParts(requiredCoreModuleVersion);\n    const coreModuleVersionParts = this.getModuleVersionParts(game.modules.get(MODULE.ID).version);\n\n    if (coreModuleVersionParts.major !== requiredCoreModuleVersionParts.major\n      || coreModuleVersionParts.minor !== requiredCoreModuleVersionParts.minor\n      || (requiredCoreModuleVersionParts.patch && coreModuleVersionParts.patch !== requiredCoreModuleVersionParts.patch)\n    ) {\n      const requiredVersion = `${requiredCoreModuleVersionParts.major}.${requiredCoreModuleVersionParts.minor}.${requiredCoreModuleVersionParts.patch ?? \"X\"}`;\n      const installedVersion = game.modules.get(MODULE.ID).version;\n      ui.notifications.error(\n        `The installed Token Action HUD system module requires Token Action HUD Core module version ${requiredVersion}, but version ${installedVersion} is installed. Install Token Action HUD Core module version ${requiredVersion} to continue using Token Action HUD. Earlier versions of Token Action HUD Core are available on the module's package page on the Foundry VTT site.`,\n        { permanent: true }\n      );\n      return false;\n    }\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get nested groups by criteria\n   * @public\n   * @param {object} groups The groups\n   * @param {object} data   The search data\n   * @returns {object|null} The nested groups\n   */\n  static getNestedGroups(groups, data = {}) {\n    let order = 0;\n    if (!groups) return null;\n    const groupId = data?.id;\n    const groupType = data?.type;\n    groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n    const foundGroups = {};\n    for (const group of groups) {\n      if ((!groupId || group.id === groupId) && (!groupType || group.type === groupType)) {\n        order++;\n        const level = group.nestId.split(\"_\").length;\n        foundGroups[group.nestId] = { ...group, order, level };\n      }\n      if (group.groups?.length > 0) {\n        const groups = this.getNestedGroups(group.groups, data);\n        if (groups) Object.assign(foundGroups, groups);\n      }\n    }\n    return (Object.keys(foundGroups).length > 0) ? foundGroups : null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group by nest ID\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   * @returns {object|null} The group\n   */\n  static async getGroupByNestId(groups, data = {}) {\n    const nestId = (typeof data === \"string\" ? data : data?.nestId);\n    const groupType = data?.type;\n    if (!nestId) return null;\n\n    const parts = nestId.split(\"_\");\n    return await findGroup(groups, parts);\n\n    /* -------------------------------------------- */\n\n    /**\n     * Find group\n     * @param {object} groups The groups\n     * @param {Array} parts   The nestId parts\n     * @returns {object}      The group\n     */\n    async function findGroup(groups, parts) {\n      if (!groups) return null;\n      groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n      for (const group of groups) {\n        if (group.id === parts[0]) {\n          if (parts.length === 1) {\n            if (!group.type || !groupType || group.type === groupType) return group;\n            return;\n          }\n          parts.shift();\n          if (!group.groups) continue;\n          for (const groupStyle of Object.values(group.groups)) {\n            if (groupStyle.length === 0) continue;\n            const foundGroup = await findGroup(groupStyle, parts);\n            if (foundGroup) return foundGroup;\n          }\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Delete group by nest id\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   */\n  static async deleteGroupByNestId(groups, data = {}) {\n    const nestId = (typeof data === \"string\" ? data : data?.nestId);\n    if (!nestId) return;\n\n    const parts = nestId.split(\"_\");\n    await findAndDeleteGroup(groups, parts);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Find and delete a group\n   * @param {object} groups The groups\n   * @param {Array} parts   The nestId parts\n   */\n  static async findAndDeleteGroup(groups, parts) {\n    groups = (Array.isArray(groups)) ? groups : Object.values(groups);\n    for (const [index, group] of groups.entries()) {\n      if (group.id === parts[0]) {\n        if (parts.length === 1) {\n          groups.splice(index, 1);\n          return;\n        }\n        if (group.groups.length === 0) return;\n        parts.shift();\n        const foundGroup = await findAndDeleteGroup(group.groups, parts);\n        if (foundGroup) return;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Delete groups by id\n   * @public\n   * @param {object} groups The groups\n   * @param {string} data   The search data\n   */\n  static async deleteGroupsById(groups, data = {}) {\n    const id = (typeof data === \"string\" ? data : data?.id);\n    if (!id) return;\n\n    for (let i = groups.length - 1; i >= 0; i--) {\n      if (groups[i].id === id) {\n        groups.splice(i, 1);\n      } else if (groups[i].groups?.length > 0) {\n        deleteGroupsById(groups[i].groups, data);\n      }\n    }\n  }\n}\n","import { MODULE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\n/* -------------------------------------------- */\n\nconst filePicker = foundry?.applications?.apps?.FilePicker?.implementation ?? FilePicker;\n\n/**\n * A class responsible for handling data-related activities.\n */\nexport class DataHandler {\n  constructor(socket) {\n    this.socket = socket;\n  }\n\n  /**\n   * Initialise the data handler\n   */\n  async init() {\n    await this.#createDirectories();\n    await Promise.all([\n      this.private = await this.isPrivate(),\n      this.fileMap = await this.getFilePathsAsGm()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether persistent storage can be used\n   * @returns {boolean} Whether persistent storage can be used\n   */\n  get isPersistentStorage() {\n    return (foundry.utils.isNewerVersion(game.version, \"11.305\") && typeof ForgeVTT === \"undefined\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create directories for storage of files\n   * @private\n   */\n  async #createDirectories() {\n    if (!game.user.isGM || !Utils.getSetting(\"enableCustomization\")) return;\n\n    const DATA_FOLDER = \"data\";\n    const moduleDirectory = (this.isPersistentStorage)\n      ? `modules/${MODULE.ID}/storage`\n      : MODULE.ID;\n\n    const directoriesToCreate = [\n      moduleDirectory,\n      `${moduleDirectory}/${game.world.id}`,\n      `${moduleDirectory}/${game.world.id}/actor`,\n      `${moduleDirectory}/${game.world.id}/user`\n    ];\n\n    for (const directory of directoriesToCreate) {\n      await filePicker.browse(DATA_FOLDER, directory).catch(async _ => {\n        if (!(await filePicker.createDirectory(DATA_FOLDER, directory, {}))) {\n          Logger.debug(`Failed to create directory: ${directory}`);\n        }\n      });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get base path to the layout files\n   * @returns {string} The path\n   */\n  get path() {\n    return (this.isPersistentStorage)\n      ? `modules/${MODULE.ID}/storage/${game.world.id}/`\n      : `${MODULE.ID}/${game.world.id}/`;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file parts\n   * @param {string} file The file\n   * @returns {object}    The file parts\n   */\n  getFileParts(file) {\n    const parts = file.split(\"/\");\n    const filename = parts.pop();\n    const folder = parts.join(\"/\");\n    const id = filename.split(\".\")[0];\n    return { folder, filename, id };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the module directory is set to private\n   * @returns {boolean} Whether the module directory is set to private\n   */\n  async isPrivate() {\n    if (game.user.isGM) return false;\n\n    if (game.user.hasPermission(\"FILES_BROWSE\")) {\n      try {\n        await filePicker.browse(\"data\", this.path);\n        return false;\n      } catch{\n        return true;\n      }\n    }\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file paths as GM\n   * @returns {object} The file paths\n   */\n  async getFilePathsAsGm() {\n    if ((!game.user.hasPermission(\"FILES_BROWSE\") || this.private) && !Utils.isGmActive()) {\n      Logger.info(\"Cannot get file paths without a GM present\", false);\n      return new Map(); // Return an empty map if no permissions and no GM\n    }\n\n    const files = game.user.hasPermission(\"FILES_BROWSE\") && !this.private\n      ? await this.getFilePaths()\n      : await this.socket.executeAsGM(\"getFilePaths\");\n\n    return new Map(files.map(file => {\n      const { id } = this.getFileParts(file);\n      return [id, file];\n    }));\n  }\n\n  /**\n   * Get file paths using socket\n   * @returns {Array} The file paths\n   */\n  static async getFilePathsWithSocket() {\n    return await game.tokenActionHud?.dataHandler?.getFilePaths() ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get file paths\n   * @returns {Array} The file paths\n   */\n  async getFilePaths() {\n    const [actorFiles, userFiles] = await Promise.all([\n      filePicker.browse(\"data\", `${this.path}actor/`),\n      filePicker.browse(\"data\", `${this.path}user/`)\n    ]);\n\n    return [...(actorFiles?.files ?? []), ...(userFiles?.files ?? [])];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the user can save data\n   * @returns {boolean} Whether the user can save data\n   */\n  get canSaveData() {\n    return ((game.user.hasPermission(\"FILES_UPLOAD\") && !this.private) || Utils.isGmActive());\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save data the GM\n   * @public\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @param {object} data The data\n   */\n  async saveDataAsGm(type, id, data) {\n    if (game.user.hasPermission(\"FILES_UPLOAD\") && !this.private) {\n      await this.saveData(type, id, data);\n    }\n\n    if (!Utils.isGmActive()) {\n      Logger.info(\"Cannot save data without a GM present\", false);\n      return;\n    }\n\n    await this.socket.executeAsGM(\"saveData\", type, id, data);\n  }\n\n  /* -------------------------------------------- */\n\n  static async saveDataWithSocket(type, id, data) {\n    return await game.tokenActionHud.dataHandler.saveData(type, id, data);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save data\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @param {object} data The data\n   */\n  async saveData(type, id, data) {\n    try {\n      // Get the folder path\n      const folder = `${this.path}${type}`;\n\n      // Generate the system-safe filename\n      const fileName = encodeURI(`${id}.json`);\n\n      // Create the file and contents\n      const file = new File([JSON.stringify(data, null, \"\")], fileName, { type: \"application/json\" });\n\n      // Upload the file\n      const response = await filePicker.upload(\"data\", folder, file, {}, { notify: false });\n\n      if (response.path) {\n        if (!this.fileMap.has(id)) {\n          this.fileMap.set(id, response.path);\n        }\n      } else {\n        Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response.error || \"Unknown error\"}`);\n      }\n    } catch(error) {\n      Logger.error(`An error occurred while saving data for ${id}.json: ${error.message}`);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the user can get data\n   * @returns {boolean} Whether the user can get data\n   */\n  get canGetData() {\n    return ((game.user.hasPermission(\"FILES_BROWSE\") && !this.private) || Utils.isGmActive());\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data as GM\n   * @public\n   * @param {object} options The options: file, type, id\n   * @returns {object}       The data\n   */\n  async getDataAsGm(options) {\n    try {\n      if ((!game.user.hasPermission(\"FILES_BROWSE\") || this.private) && !Utils.isGmActive()) {\n        Logger.info(\"Cannot get data without a GM present\", false);\n        return;\n      }\n\n      const data = (game.user.hasPermission(\"FILES_BROWSE\"))\n        ? await this.getData(options)\n        : await this.socket.executeAsGM(\"getData\", options);\n\n      return data;\n    } catch(error) {\n      Logger.error(`An error occurred while getting data: ${error.message}`);\n      return null;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  static async getDataWithSocket(options) {\n    return await game.tokenActionHud.dataHandler.getData(options);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data\n   * @param {string} options The options: file, type, id\n   * @returns {object}       The data\n   */\n  async getData(options) {\n    const { id, file } = options;\n\n    // Check if the file is available in the fileMap\n    let foundFile = this.fileMap.get(id) ?? null;\n\n    // If not found, try to browse, otherwise return null\n    if (!foundFile) {\n      if (!file) return null;\n      const { folder, filename } = this.getFileParts(file);\n      const foundFolder = await filePicker.browse(\"data\", folder);\n      foundFile = foundFolder.files.find(file => file.endsWith(filename));\n      if (!foundFile) return null;\n    }\n\n    try {\n      const ms = Date.now();\n      const response = await fetch(`${foundFile}?ms=${ms}`);\n\n      // Check if the fetch was successful\n      if (response.ok) {\n        const data = await response.json();\n        return data;\n      } else {\n        return null;\n      }\n    } catch(error) {\n      console.error(error);\n      return null;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get data\n   * @param {string} type The type: actor or user\n   * @param {string} id   The actor or user id\n   * @returns {object}    The data\n   */\n  async getDataMigrate(type, id) {\n    const folderPath = `${MODULE.ID}/${game.world.id}/${type}`;\n    const fileName = encodeURI(`${id}.json`);\n    try {\n      const foundFolderPath = await filePicker.browse(\"data\", folderPath);\n      const foundFilePath = foundFolderPath.files.find(file => file.endsWith(fileName));\n      if (foundFilePath) {\n        const ms = Date.now();\n        return await fetch(`${foundFilePath}?ms=${ms}`)\n          .then(response => {\n            if (response.ok) {\n              return response.json();\n            } else {\n              return null;\n            }\n          })\n          .catch(error => {\n            console.error(error);\n          });\n      } else {\n        return null;\n      }\n    } catch{\n      return null;\n    }\n  }\n}\n","import { MODULE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Manages migrations between module versions\n */\nexport class MigrationManager {\n  constructor(dataHandler, socket) {\n    this.dataHandler = dataHandler;\n    this.socket = socket;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise migrations\n   * @public\n   */\n  async init() {\n    if (!game.user.isGM) return;\n\n    const moduleVersion = game.modules.get(MODULE.ID).version;\n    const migrationVersion = Utils.getSetting(\"migrationVersion\");\n    if (moduleVersion === migrationVersion) return;\n\n    let isSuccess = true;\n    isSuccess = (!migrationVersion || foundry.utils.isNewerVersion(\"1.4.10\", migrationVersion))\n      ? await this.#unsetOldFlags()\n      : true;\n    isSuccess = (this.dataHandler.isPersistentStorage && (!migrationVersion || foundry.utils.isNewerVersion(\"1.4.11\", migrationVersion)))\n      ? await this.#migrateFiles()\n      : true;\n\n    if (isSuccess) {\n      Utils.setSetting(\"migrationVersion\", moduleVersion);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Unset old flags\n   * @private\n   * @returns {boolean} Whether the old flags were unset\n   */\n  async #unsetOldFlags() {\n    try {\n      const users = game.users.filter(user => user.getFlag(MODULE.ID, \"categories\"));\n      for (const user of users) {\n        user.unsetFlag(MODULE.ID, \"categories\");\n        user.unsetFlag(MODULE.ID, \"defaults\");\n      }\n\n      const actors = game.actors.filter(actor => actor.getFlag(MODULE.ID, \"categories\"));\n      for (const actor of actors) {\n        actor.unsetFlag(MODULE.ID, \"categories\");\n      }\n\n      const tokens = game.canvas.tokens.objects.children.filter(token => token.actor?.getFlag(MODULE.ID, \"categories\"));\n      for (const token of tokens) {\n        token.actor?.unsetFlag(MODULE.ID, \"categories\");\n      }\n\n      for (const scene of game.scenes) {\n        const tokens = scene.tokens.filter(token => token.actor?.getFlag(MODULE.ID, \"categories\"));\n        for (const token of tokens) {\n          token.actor?.unsetFlag(MODULE.ID, \"categories\");\n        }\n      }\n\n      return true;\n    } catch(err) {\n      Logger.debug(err.message, err);\n\n      return false;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Migrate files to storage\n   * @returns {boolean} Whether the files were migrated to storage\n   */\n  async #migrateFiles() {\n    try {\n      Logger.info(\"Migrating files to persistent storage...\", true);\n      for (const user of game.users) {\n        const data = await this.dataHandler.getDataMigrate(\"user\", user.id);\n        if (data) {\n          await this.dataHandler.saveData(\"user\", user.id, data);\n        }\n      }\n\n      for (const actor of game.actors) {\n        const data = await this.dataHandler.getDataMigrate(\"actor\", actor.id);\n        if (data) {\n          await this.dataHandler.saveData(\"actor\", actor.id, data);\n        }\n      }\n      Logger.info(\"Successfully migrated files to persistent storage\", true);\n      return true;\n    } catch{\n      Logger.info(\"Failed to migrate files to persistent storage\", true);\n      return false;\n    }\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\nexport class CharacterHandler {\n  constructor(hudManager) {\n    this.hudManager = hudManager;\n    this.groupHandler = hudManager.groupHandler;\n    this.actionHandler = hudManager.actionHandler;\n    this.rollHandler = hudManager.rollHandler;\n  }\n\n  /**\n   * Initialise Character Handler\n   */\n  init() {\n    this.previousActorId = this.actor?.id;\n    this.setCharacter();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether there is a character\n   * @returns {boolean} Whether there is a character\n   */\n  get isCharacter() {\n    return this.actor || this.isMultipleTokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether there is multiple tokens\n   * @returns {boolean} Whether there is multiple tokens\n   */\n  get isMultipleTokens() {\n    const controlledTokens = Utils.getControlledTokens();\n    return controlledTokens.length > 1 && !this.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the current actor is the same actor\n   * @returns {boolean} Whether the current actor is the same actor\n   */\n  get isSameActor() {\n    return this.previousActorId !== this.actor?.id;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set character based on controlled tokens\n   * @private\n   */\n  setCharacter() {\n    this.resetCharacter();\n    const controlledTokens = Utils.getControlledTokens();\n    if (controlledTokens.length > 1) {\n      this.#handleMultipleTokens(controlledTokens);\n    } else {\n      this.#handleSingleToken(controlledTokens);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset actor and token properties\n   */\n  resetCharacter() {\n    this.token = null;\n    this.actor = null;\n    this.tokens = [];\n    this.actors = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle multiple controlled tokens\n   * @param {*} controlledTokens\n   */\n  #handleMultipleTokens(controlledTokens) {\n    this.characterName = game.i18n.localize(\"tokenActionHud.multiple\");\n\n    // Empty singulars\n    this.token = null;\n    this.actor = null;\n\n    // Set multiples\n    this.tokens = controlledTokens;\n    this.actors = Utils.getControlledActors();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle a single controlled token\n   * @private\n   * @param {Array} controlledTokens The controlled tokens\n   */\n  #handleSingleToken(controlledTokens) {\n    const character = { token: null, actor: null };\n\n    if (controlledTokens.length === 1 && this.#isValidCharacter(controlledTokens[0])) {\n      character.token = controlledTokens[0];\n      character.actor = character.token?.actor;\n    } else if (controlledTokens.length === 0 && game.user.character && Utils.getSetting(\"alwaysShowHud\")) {\n      character.actor = game.user.character;\n      character.token = canvas.tokens?.placeables.find(t => t.actor?.id === character.actor.id) ?? null;\n    }\n\n    if (!character.actor) return;\n\n    this.characterName = character.token?.name ?? character.actor.name;\n\n    // Set in this class\n    this.token = character.token;\n    this.actor = character.actor;\n    this.tokens = [character.token];\n    this.actors = [character.actor];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the character is a valid selection for the current user\n   * @private\n   * @param {object} [token = {}] The token\n   * @returns {boolean}           Whether the character is a valid selection for the current user\n   */\n  #isValidCharacter(token = {}) {\n    return game.user.isGM || token.actor?.testUserPermission(game.user, \"OWNER\");\n  }\n\n}\n","import { Utils } from \"../core/utils.mjs\";\n\n/**\n * Handler for the HUD layout.\n */\nexport class LayoutHandler {\n  constructor(systemManager, dataHandler) {\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.defaultLayout = null;\n    this.customLayout = null;\n  }\n\n  /**\n   * Initialise the HUD layout\n   */\n  async init() {\n    await Promise.all([\n      this.#setDefaultLayout(),\n      this.#setCustomLayout()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.defaultLayout = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   */\n  hardReset() {\n    this.softReset();\n    this.customLayout = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the default layout\n   * @private\n   */\n  async #setDefaultLayout() {\n    if (this.defaultLayout) return;\n    const defaultLayout = this.systemManager.defaults?.layout;\n    if (!defaultLayout) { this.defaultLayout = null; return; }\n    this.defaultLayout = await Utils.getNestedGroups(defaultLayout);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set custom layout\n   * @private\n   */\n  async #setCustomLayout() {\n    if (this.customLayout) return;\n    const file = Utils.getUserFlag(\"userCustomLayout\") || Utils.getSetting(\"customLayout\") || null;\n    this.customLayout = (file) ? await this.dataHandler.getDataAsGm({ file }) : null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Export layout to file\n   * @public\n   */\n  async exportLayout() {\n    const data = await this.dataHandler.getDataAsGm({ type: \"user\", id: game.userId }) ?? this.customLayout ?? this.defaultLayout;\n    if (data) {\n      saveDataToFile(JSON.stringify(data, null, 2), \"text/json\", \"token-action-hud-layout.json\");\n    }\n  }\n\n  /**\n   * Get the layout\n   * @returns {object} The layout\n   */\n  get layout() {\n    return this.customLayout ?? this.defaultLayout;\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\n\n/**\n * Get tooltip based on module setting\n * @param {object|string} tooltip The tooltip\n * @param {string} name           The name\n * @returns {object}              The tooltip\n */\nexport function getTooltip(tooltip, name) {\n  const setting = game.tokenActionHud?.setting?.tooltips ?? Utils.getSetting(\"tooltips\");\n\n  if (setting === \"none\") return null;\n  if (setting === \"nameOnly\" || !tooltip) return name;\n\n  if (typeof tooltip !== \"object\") {\n    tooltip = { content: tooltip };\n  }\n\n  if (!tooltip.content.includes(\"tah-tooltip-wrapper\")) {\n    tooltip.content = `<div class=\"tah-tooltip-wrapper\">${tooltip.content}</div>`;\n  }\n\n  let direction = \"RIGHT\";\n  if (tooltip.direction) {\n    direction = tooltip.direction;\n  } else {\n    const style = game.tokenActionHud.systemManager.styles[game.tokenActionHud.setting.style];\n\n    if ([\"center-right\", \"right\"].includes(style.dockPosition)) {\n      direction = \"LEFT\";\n    }\n  }\n\n  tooltip.direction = direction;\n\n  return tooltip;\n}\n","import { COMPENDIUM_PACK_TYPES, GROUP_TYPE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\nimport { getTooltip } from \"../handlers/tooltip-handler.mjs\";\n\n/**\n * Handler for the HUD groups.\n */\nexport class GroupHandler {\n  constructor(hudManager, systemManager, dataHandler, layoutHandler) {\n    this.hudManager = hudManager;\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.layoutHandler = layoutHandler;\n    this.defaultGroups = {};\n    this.groups = {};\n    this.actorGroups = {};\n    this.userGroups = {};\n  }\n\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /**\n   * Initialise the groups\n   */\n  async init() {\n    this.#setDefaultGroups();\n    await Promise.all([\n      this.#setSavedActorGroups(),\n      this.#setSavedUserGroups()\n    ]);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.defaultGroups = {};\n    this.groups = null;\n    this.groups = {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   */\n  hardReset() {\n    this.softReset();\n    this.actorGroups = {};\n    this.userGroups = {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the default groups\n   * @private\n   */\n  #setDefaultGroups() {\n    const defaultGroups = this.systemManager.defaults?.groups;\n    if (!defaultGroups) return;\n    for (const defaultGroup of defaultGroups) {\n      this.defaultGroups[defaultGroup.id] = defaultGroup;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the saved groups from the actor flag\n   * @private\n   */\n  async #setSavedActorGroups() {\n    if (!this.actor) return;\n\n    if (!Utils.getSetting(\"enableCustomization\")) {\n      this.actorGroups = {};\n      return;\n    }\n\n    if (this.isSameActor && Object.entries(this.actorGroups).length) return;\n\n    if (!this.dataHandler.canGetData) {\n      this.actorGroups = {};\n      return;\n    }\n\n    Logger.debug(\"Retrieving groups from actor...\", { actor: this.actor });\n    this.actorGroups = {};\n    const actorGroups = await this.dataHandler.getDataAsGm({ type: \"actor\", id: this.actor.id }) ?? null;\n    if (!actorGroups) return;\n    for (const group of Object.entries(actorGroups)) {\n      group[1].nestId = group[0];\n    }\n    this.actorGroups = actorGroups;\n    Logger.debug(\"Groups from actor retrieved\", { actorGroups: this.actorGroups, actor: this.actor });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the saved groups from the user flag\n   * @private\n   */\n  async #setSavedUserGroups() {\n    const user = game.user;\n    const layout = this.layoutHandler.layout;\n\n    const getUserGroups = data => {\n      const userGroups = Object.keys(data).length ? data : layout;\n      for (const group of Object.entries(userGroups)) {\n        group[1].nestId = group[0];\n      }\n      return userGroups;\n    };\n\n    if (!Utils.getSetting(\"enableCustomization\")) {\n      this.userGroups = getUserGroups(layout);\n      return;\n    }\n\n    if (Object.entries(this.userGroups).length) return;\n\n    if (!this.dataHandler.canGetData) {\n      this.userGroups = getUserGroups(layout);\n      return;\n    }\n\n    Logger.debug(\"Retrieving groups from user...\", { user });\n    this.userGroups = {};\n    const savedUserData = await this.dataHandler.getDataAsGm({ type: \"user\", id: user.id }) ?? {};\n    this.userGroups = getUserGroups(savedUserData);\n    Logger.debug(\"Groups retrieved from user\", { userGroups: this.userGroups, user });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare groups in the HUD.\n   * @param {object} hud The HUD\n   * @returns {object}   The prepared groups\n   */\n  async prepareGroups(hud) {\n    if (Object.keys(this.userGroups).length) {\n      const userGroups = this.getUserGroups();\n      for (const userGroup of userGroups) {\n        if (userGroup.level === 1) {\n          const group = this.createGroup(userGroup);\n          hud.groups.push(group);\n          this.groups[group.nestId] = group;\n        } else {\n          const parentNestId = userGroup.nestId.split(\"_\", userGroup.level - 1).join(\"_\");\n          const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId });\n          if (parentGroup) {\n            const group = this.createGroup(userGroup);\n            if (group.settings.style === \"tab\") {\n              parentGroup.groups.tabs.push(group);\n            } else {\n              parentGroup.groups.lists.push(group);\n            }\n            this.groups[group.nestId] = group;\n          }\n        }\n      }\n    }\n\n    if (Object.keys(this.actorGroups).length) {\n      const actorGroups = this.getActorGroups();\n\n      for (const actorGroup of actorGroups) {\n        const parentNestId = actorGroup.nestId.split(\"_\", actorGroup.level - 1).join(\"_\");\n        const existingGroup = await Utils.getGroupByNestId(hud.groups, { nestId: actorGroup.nestId });\n        if (existingGroup) {\n          if (actorGroup.actions?.length) {\n            existingGroup.actions = actorGroup.actions;\n          }\n        } else {\n          const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId });\n\n          if (parentGroup && actorGroup.type === \"system-derived\") {\n            if (!parentGroup.groups) parentGroup.groups = { lists: [], tabs: [] };\n\n            const group = this.createGroup(actorGroup, true);\n\n            if (actorGroup.actions?.length) {\n              group.actions = actorGroup.actions;\n            }\n\n            if (group.settings.style === \"tab\") {\n              parentGroup.groups.tabs.push(group);\n            } else {\n              parentGroup.groups.lists.push(group);\n            }\n\n            this.groups[group.nestId] = group;\n          }\n        }\n      }\n    }\n\n    return this.groups;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get first matching group\n   * @public\n   * @param {object} [data = {}]   The group data\n   * @param {string} [data.nestId] The nested group ID\n   * @param {string} [data.id]     The group ID\n   * @param {number} [data.level]  The group level\n   * @param {string} [data.type]   The group type\n   * @returns {Array}              The group\n   */\n  getGroup({ nestId, id, level, type } = {}) {\n    if (nestId) return this.groups[nestId];\n\n    return Object.values(this.groups).find(group =>\n      (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching groups\n   * @public\n   * @param {object}  [data = {}]     The group data\n   * @param {string}  [data.nestId]   The nested group ID\n   * @param {string}  [data.id]       The group ID\n   * @param {number}  [data.level]    The group level\n   * @param {string}  [data.type]     The group type\n   * @param {boolean} [data.selected] Whether the group is selected\n   * @returns {Array}                 The matching groups\n   */\n  getGroups({ nestId, id, level, type, selected } = {}) {\n    return Object.values(this.groups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n      && (!selected || group.selected === selected)\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching actor-related groups\n   * @public\n   * @param {object}  [data = {}]   The group data\n   * @param {string}  [data.nestId] The nested group ID\n   * @param {string}  [data.id]     The group ID\n   * @param {number}  [data.level]  The group level\n   * @param {string}  [data.type]   The group type\n   * @returns {Array}               The groups\n   */\n  getActorGroups({ nestId, id, level, type } = {}) {\n    return Object.values(this.actorGroups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    ).sort((a, b) => (a.level - b.level || a.order - b.order));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get matching user-related groups\n   * @public\n   * @param {object}  [data = {}]   The group data\n   * @param {string}  [data.nestId] The nested group ID\n   * @param {string}  [data.id]     The group ID\n   * @param {number}  [data.level]  The group level\n   * @param {string}  [data.type]   The group type\n   * @returns {Array}               The groups\n   */\n  getUserGroups({ nestId, id, level, type } = {}) {\n    return Object.values(this.userGroups).filter(group =>\n      (!nestId || group.nestId.startsWith(nestId))\n      && (!id || group.id === id)\n      && (!level || group.level === level)\n      && (!type || group.type === type)\n    ).sort((a, b) => (a.level - b.level || a.order - b.order));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group IDs\n   * @returns {Array} The group IDs\n   */\n  getGroupIds() {\n    return Object.values(this.groups).map(group => group.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get group settings\n   * @public\n   * @param {object} [groupData={}] The group data\n   * @returns {object|null}         The group settings\n   */\n  getGroupSettings(groupData = {}) {\n    return this.getGroup(groupData)?.settings ?? null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create group\n   * @public\n   * @param {object} groupData The group data\n   * @param {boolean} keepData Whether to keep the data\n   * @returns {object}         The group\n   */\n  createGroup(groupData, keepData = false) {\n    const groupDataClone = Utils.deepClone(groupData);\n    const nestIdParts = groupData.nestId.split(\"_\");\n    const level = nestIdParts.length ?? 1;\n\n    const tooltip = getTooltip(groupData?.tooltip, groupDataClone?.name);\n\n    if (!keepData) {\n      groupDataClone.actions = [];\n      groupDataClone.groups = { lists: [], tabs: [] };\n    }\n\n    const defaultSettings = {\n      showTitle: true,\n      style: (level === 1) ? \"tab\" : \"list\"\n    };\n\n    const groupSettings = groupDataClone.settings || {};\n    groupSettings.showTitle ??= defaultSettings.showTitle;\n    groupSettings.style ??= defaultSettings.style;\n\n    groupDataClone.subtitleClass = (groupSettings.showTitle) ? \"\" : \"tah-hidden\";\n\n    const groupSystem = groupDataClone.system || {};\n\n    const commonProps = {\n      actions: groupDataClone.actions,\n      class: groupDataClone.class || groupDataClone.cssClass || \"\",\n      groups: groupDataClone.groups,\n      id: groupDataClone.id,\n      info1: groupDataClone.info1 || \"\",\n      info2: groupDataClone.info2 || \"\",\n      info3: groupDataClone.info3 || \"\",\n      level: groupDataClone.level || level || 1,\n      listName: groupDataClone.listName || groupDataClone.name,\n      name: groupDataClone.name,\n      nestId: groupDataClone.nestId || groupDataClone.id,\n      order: groupDataClone.order,\n      selected: groupDataClone.selected ?? groupDataClone.isSelected ?? groupDataClone.defaultSelected ?? true,\n      settings: groupSettings,\n      system: groupSystem,\n      tooltip,\n      type: groupDataClone.type || GROUP_TYPE.CUSTOM\n    };\n\n    if (level > 1) {\n      commonProps.subtitleClass = groupDataClone.subtitleClass || \"\";\n    }\n\n    return commonProps;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update groups\n   * @public\n   * @param {Array | object} groupsData         The groups data\n   * @param {object} [parentGroupData = null] The parent group data\n   */\n  updateGroups(groupsData, parentGroupData) {\n    if (!Array.isArray(groupsData)) groupsData = [groupsData];\n\n    const level = (parentGroupData?.level ?? 0) + 1;\n    const childGroupData = { level };\n    if (parentGroupData?.nestId) childGroupData.nestId = parentGroupData.nestId;\n\n    const existingGroups = this.getGroups(childGroupData);\n\n    // Remove any groups that are no longer present\n    for (const existingGroup of existingGroups) {\n      if (existingGroup.type === \"system-derived\") {\n        existingGroup.selected = false;\n        existingGroup.order = 999;\n      } else if (!groupsData.find(groupData => groupData.id === existingGroup.id)) {\n        delete this.groups[existingGroup.nestId];\n      }\n    }\n\n    // Add or update groups\n    let order = 0;\n    for (const groupData of groupsData) {\n      groupData.nestId = (parentGroupData?.nestId)\n        ? `${parentGroupData.nestId}_${groupData.id}`\n        : groupData.id;\n      groupData.selected = groupData.selected ?? true;\n      groupData.order = order;\n\n      const existingGroup = this.getGroup(groupData);\n\n      if (existingGroup) {\n        Object.assign(existingGroup, groupData);\n      } else {\n        const group = this.createGroup(groupData);\n        this.groups[groupData.nestId] = group;\n      }\n      order++;\n    }\n\n    // Update parent group settings\n    if (parentGroupData?.settings) {\n      const existingParentGroup = this.getGroup(parentGroupData);\n      if (existingParentGroup) {\n        existingParentGroup.settings = parentGroupData.settings;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save group settings\n   * @public\n   * @param {object} groupData The group data\n   */\n  saveGroupSettings(groupData) {\n    const group = this.getGroup(groupData);\n    group.settings = { ...group.settings, ...groupData.settings };\n    this.saveGroups({ saveActor: true, saveUser: true });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save groups\n   * @public\n   * @param {object} options The options\n   */\n  async saveGroups(options = { saveActor: false, saveUser: false }) {\n    if (!Utils.getSetting(\"enableCustomization\")) return;\n\n    Logger.debug(\"Saving groups...\");\n\n    if (options?.saveActor) await this.saveActorGroups();\n    if (options?.saveUser) await this.saveUserGroups();\n\n    Logger.debug(\"Groups saved\", { groups: this.groups });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save actor groups to file\n   * @public\n   */\n  async saveActorGroups() {\n    if (!this.actor || !Object.keys(this.groups).length) return;\n\n    Logger.debug(\"Saving actor groups...\");\n\n    const actorGroups = {};\n    this.actorGroups = {};\n\n    for (const group of Object.values(this.groups)) {\n      this.actorGroups[group.nestId] = group;\n      actorGroups[group.nestId] = this.#getReducedGroupData(group, true);\n    }\n\n    if (this.dataHandler.canSaveData) {\n      await this.dataHandler.saveDataAsGm(\"actor\", this.actor.id, actorGroups);\n\n      Logger.debug(\"Actor groups saved\", { actorGroups });\n    } else {\n      Logger.debug(\"Actor groups not saved as no GM present\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Save user groups to file\n   * @public\n   */\n  async saveUserGroups() {\n    if (!Object.keys(this.groups).length) return;\n\n    Logger.debug(\"Saving user groups...\");\n\n    const userGroups = {};\n    this.userGroups = {};\n\n    for (const group of Object.values(this.groups)) {\n      if (group.type !== \"system-derived\") {\n        this.userGroups[group.nestId] = group;\n        userGroups[group.nestId] = this.#getReducedGroupData(group, false);\n      }\n    }\n\n    if (this.dataHandler.canSaveData) {\n      await this.dataHandler.saveDataAsGm(\"user\", game.userId, userGroups);\n      Logger.debug(\"User groups saved\", { userGroups });\n    } else {\n      Logger.debug(\"User groups not saved as no GM present\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get reduced groups data for saving to flags\n   * @private\n   * @param {object}  data          The group data\n   * @param {string}  data.id       The group ID\n   * @param {string}  data.name     The group name\n   * @param {string}  data.listName The list name for the group\n   * @param {number}  data.level    The group level\n   * @param {number}  data.order    The order of the group\n   * @param {boolean} data.selected Whether the group is selected\n   * @param {object}  data.settings The group settings\n   * @param {string}  data.type     The group type\n   * @param {Array}   data.actions  The list of actions for the group (if `keepActions` is true)\n   * @param {boolean} keepActions   Whether to keep action data\n   * @returns {object}              The reduced group data\n   */\n  #getReducedGroupData({ id, name, listName, level, order, selected, settings, type, actions }, keepActions = false) {\n    const data = { id, name, listName, level, order, selected, settings, type };\n\n    if (keepActions) {\n      data.actions = actions.map(({ id, isPreset, userSelected }) => { return { id, isPreset, userSelected }; });\n    }\n\n    return data;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get selected groups as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {object}         The selected groups\n   */\n  getSelectedGroupsAsTags(groupData = {}) {\n    groupData.selected = true;\n    groupData.level = (groupData.level || 0) + 1;\n    const groups = this.getGroups(groupData);\n    return groups?.map(group => this.#toTagify(group)) ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available groups as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {object}         The groups\n   */\n  async getAvailableGroupAsTags(groupData) {\n    const derivedGroups = await this.#getDerivedGroupsAsTags(groupData);\n    const systemGroups = await this.#getSystemGroupsAsTags();\n    const compendiumGroups = await this.#getCompendiumGroupsAsTags();\n    const macroGroups = await this.#getMacroGroupsAsTags();\n    return [...derivedGroups, ...systemGroups, ...compendiumGroups, ...macroGroups];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get derived groups as Tagify entries\n   * @private\n   * @param {object} data        The group data\n   * @param {object} data.nestId The group nest ID\n   * @returns {object}           The derived groups\n   */\n  #getDerivedGroupsAsTags({ nestId }) {\n    const derivedGroups = this.getGroups({ nestId, type: GROUP_TYPE.SYSTEM_DERIVED });\n    return derivedGroups?.map(group => this.#toTagify(group)) ?? [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get system groups as Tagify entries\n   * @private\n   * @returns {object} The system groups\n   */\n  #getSystemGroupsAsTags() {\n    return Object.values(this.defaultGroups).map(group => this.#toTagify(group));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get compendium groups as Tagify entries\n   * @private\n   * @returns {object} The compendium groups\n   */\n  #getCompendiumGroupsAsTags() {\n    const packs = game.packs.filter(pack =>\n      COMPENDIUM_PACK_TYPES.includes(pack.documentName)\n            && (foundry.utils.isNewerVersion(game.version, \"10\") ? pack.visible : (!pack.private || game.user.isGM))\n    );\n    const groups = packs.map(pack => {\n      return {\n        id: pack.metadata.id.replace(\".\", \"-\"),\n        listName: `${game.i18n.localize(\"tokenActionHud.group\")}: ${pack.metadata.label}`,\n        name: pack.metadata.label,\n        type: \"core\"\n      };\n    });\n    return groups.map(group => this.#toTagify(group));\n  }\n\n  /**\n   * Get macro groups as Tagify entries\n   * @private\n   * @returns {object} The macro groups\n   */\n  #getMacroGroupsAsTags() {\n    return [this.#toTagify({\n      id: \"macros\",\n      listName: `${game.i18n.localize(\"tokenActionHud.group\")}: ${game.i18n.localize(\"tokenActionHud.macros\")}`,\n      name: game.i18n.localize(\"tokenActionHud.macros\"),\n      type: \"core\"\n    })];\n  }\n\n  /**\n   * Add group to the HUD\n   * @public\n   * @param {object} groupData         The group data\n   * @param {object} parentGroupData   The parent group data\n   * @param {boolean} [update = false] Whether to update an existing group\n   */\n  addGroup(groupData, parentGroupData, update = false) {\n    groupData.type = groupData?.type ?? \"system-derived\";\n    groupData.style = groupData?.style ?? \"list\";\n\n    if (!parentGroupData?.id && !parentGroupData?.nestId) return;\n\n    const parentGroups = this.getGroups(parentGroupData);\n    if (!parentGroups?.length) return;\n\n    for (const parentGroup of parentGroups) {\n      const nestId = `${parentGroup.nestId}_${groupData.id}`;\n      const existingGroups = this.getGroups({ ...groupData, nestId });\n\n      if (existingGroups.length) {\n        if (update) {\n          for (const existingGroup of existingGroups) {\n            // Temporary fix until info1-3 properties are grouped into info object\n            if (groupData.info) {\n              Object.assign(groupData, { ...groupData.info });\n              delete groupData.info;\n            }\n\n            Object.assign(existingGroup, this.createGroup({ ...existingGroup, ...groupData }, true));\n          }\n        } else {\n          for (const existingGroup of existingGroups) {\n            const tooltip = getTooltip(groupData.tooltip, existingGroup.name);\n            Object.assign(existingGroup, { tooltip });\n          }\n        }\n      } else {\n        const group = this.createGroup({ ...groupData, nestId });\n\n        if (!parentGroup.groups) parentGroup.groups = { lists: [], tabs: [] };\n\n        if (group.settings.style === \"tab\") {\n          parentGroup.groups.tabs.push(group);\n        } else {\n          parentGroup.groups.lists.push(group);\n        }\n        this.groups[group.nestId] = group;\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update group in the HUD\n   * @public\n   * @param {object} groupData                The group data\n   * @param {object} [parentGroupData = null] The parent group data\n   */\n  updateGroup(groupData, parentGroupData = null) {\n    groupData.type = groupData?.type ?? \"system-derived\";\n\n    const updateExistingGroups = existingGroups => {\n      for (const existingGroup of existingGroups) {\n        // Temporary fix until info1-3 properties are grouped into info object\n        if (groupData.info) {\n          Object.assign(groupData, { ...groupData.info });\n          delete groupData.info;\n        }\n\n        Object.assign(existingGroup, this.createGroup({ ...existingGroup, ...groupData }, true));\n      }\n    };\n\n    if (parentGroupData) {\n      const parentGroups = this.getGroups(parentGroupData);\n      for (const parentGroup of parentGroups) {\n        const nestId = `${parentGroup.nestId}_${groupData.id}`;\n        const existingGroups = this.getGroups({ ...groupData, nestId });\n\n        updateExistingGroups(existingGroups);\n      }\n    } else {\n      const existingGroups = this.getGroups(groupData);\n\n      updateExistingGroups(existingGroups);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Remove group from HUD\n   * @public\n   * @param {object} groupData The group data\n   */\n  removeGroup(groupData) {\n    if (!groupData?.nestId && groupData?.id) {\n      Utils.deleteGroupsById(this.hud.groups, groupData.id);\n    }\n\n    const groups = this.getGroups(groupData);\n    if (!groups?.length) return;\n\n    for (const group of groups) {\n      delete this.groups[group.nestId];\n      if (groupData?.nestId) {\n        Utils.deleteGroupByNestId(this.hud.groups, group.nestId);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add info to group in the HUD\n   * @public\n   * @param {string} groupData The group data\n   */\n  addGroupInfo(groupData) {\n    const groupId = groupData?.id;\n    const groupInfo = groupData?.info;\n\n    if (!groupId || !groupInfo) return;\n\n    const groups = this.getGroups(groupData);\n\n    groups.forEach(group => {\n      group.info1 = groupInfo.info1;\n      group.info2 = groupInfo.info2;\n      group.info3 = groupInfo.info3;\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set property to indicate whether a group has actions within it\n   * @public\n   */\n  setHasActions() {\n    Object.values(this.groups).forEach(group => {\n      if (group.actions.some(action => action.selected)) {\n        group.hasActions = true;\n      } else {\n        group.hasActions = false;\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Convert a group into a Tagify entry\n   * @private\n   * @param {object} groupData The group data\n   * @returns {object}         The Tagify entry\n   */\n  #toTagify(groupData) {\n    const { id, name, type, listName } = groupData;\n    return { id, name, type, value: listName ?? name };\n  }\n}\n","\nimport { CharacterHandler } from \"../handlers/character-handler.mjs\";\nimport { LayoutHandler } from \"../handlers/layout-handler.mjs\";\nimport { GroupHandler } from \"../handlers/group-handler.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\nexport class HudManager {\n  constructor(tokenActionHud, systemManager, dataHandler, socket) {\n    this.tokenActionHud = tokenActionHud;\n    this.dataHandler = dataHandler;\n    this.socket = socket;\n    this.layoutHandler = new LayoutHandler(systemManager, dataHandler);\n    this.groupHandler = new GroupHandler(this, systemManager, dataHandler, this.layoutHandler);\n    this.actionHandler = systemManager.getActionHandlerCore(this, this.dataHandler, this.groupHandler);\n    this.rollHandler = systemManager.getRollHandlerCore(this);\n    this.characterHandler = new CharacterHandler(this);\n  }\n\n  /**\n   * Initialise the HUD\n   * @param {string} trigger The update trigger\n   * @returns {boolean} Whether the HUD was initialised\n   */\n  async init(trigger) {\n    this.characterHandler.init();\n\n    if ( !this.characterHandler.isCharacter || !this.isHudEnabled) return false;\n\n    const options = (trigger === \"controlToken\" && this.characterHandler.isSameActor) ? { saveActor: true } : {};\n\n    await this.#buildHud(options);\n\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   * @public\n   */\n  softResetHud() {\n    this.hud = null;\n    this.hud = [];\n    this.groupHandler.softReset();\n    this.layoutHandler.softReset();\n    this.actionHandler.softReset();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Hard reset variables\n   * @public\n   */\n  hardResetHud() {\n    this.softResetHud();\n    this.groupHandler.hardReset();\n    this.layoutHandler.hardReset();\n  }\n\n  /**\n   * Build the HUD\n   * @private\n   * @param {object} options The options\n   * @returns {object}       The HUD\n   */\n  async #buildHud(options) {\n    Logger.debug(\"Building HUD...\", { actor: this.actor, token: this.token });\n\n    if (this.previousActor?.id === this.actor?.id) {\n      this.isSameActor = true;\n    } else {\n      this.previousActor = this.actor;\n      this.isSameActor = false;\n    }\n\n    this.softResetHud();\n\n    await this.layoutHandler.init();\n    await this.groupHandler.init();\n\n    if (!this.dataHandler.canGetData && !this.isGmInactiveUserNotified) {\n      Logger.info(\"Cannot retrieve HUD layout without GM present\", true);\n      this.isGmInactiveUserNotified = true;\n    }\n\n    this.hud = await this.#prepareHud();\n\n    await this.actionHandler.buildActionsCore();\n    this.groupHandler.setHasActions();\n    await this.groupHandler.saveGroups(options);\n\n    Logger.debug(\"HUD built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare the HUD\n   * @private\n   * @returns {object} The HUD\n   */\n  async #prepareHud() {\n    Logger.debug(\"Preparing HUD...\", { actor: this.actor, token: this.token });\n\n    const name = (Utils.getSetting(\"displayCharacterName\"))\n      ? this.characterHandler.characterName ?? game.i18n.localize(\"tokenActionHud.multiple\")\n      : \"\";\n    const actorId = this.actor?.id ?? \"multi\";\n    const tokenId = this.token?.id ?? \"multi\";\n    const hud = { name, tokenId, actorId, groups: [] };\n\n    const groups = await this.groupHandler.prepareGroups(hud);\n    this.actionHandler.prepareActions(groups);\n\n    Logger.debug(\"HUD prepared\", { hud, actor: this.actor, token: this.token });\n    return hud;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle HUD event\n   * @param {string} eventType The event type\n   * @param {object} event     The event\n   */\n  handleHudEvent(eventType, event) {\n    const group = ([\"groupClick\"].includes(eventType)) ? this.getGroup(event) : null;\n    const action = ([\"clickAction\", \"hoverAction\"].includes(eventType)) ? this.getAction(event) : null;\n\n    this.#registerKeyPresses(event);\n    this.#setIsHover(event);\n\n    try {\n      switch (eventType) {\n        case \"groupClick\":\n          this.rollHandler.handleGroupClickCore(event, group);\n          break;\n        case \"clickAction\":\n          this.rollHandler.handleActionClickCore(event, action, this.actionHandler);\n          break;\n        case \"hoverAction\":\n          this.rollHandler.handleActionHoverCore(event, action);\n      }\n    } catch(error) {\n      Logger.error(event);\n    }\n  }\n\n  /**\n   * Registers key presses\n   * @private\n   * @param {object} event The events\n   */\n  #registerKeyPresses(event) {\n    this.#setIsRightClick(event);\n    this.#setIsAlt(event);\n    this.#setIsCtrl(event);\n    this.#setIsShift(event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the button was right-clicked\n   * @public\n   * @param {object} event The event\n   */\n  #setIsRightClick(event) {\n    const button = event?.originalEvent?.button || event.button;\n    this.isRightClick = button === 2;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isAlt based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsAlt(event) {\n    const keyboardManager = foundry?.helpers?.interaction?.KeyboardManager ?? KeyboardManager;\n    const isModiferActive = game.keyboard.isModifierActive(keyboardManager.MODIFIER_KEYS.ALT);\n    if (event.altKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT ALT key press\");\n      keyboardManager.emulateKeypress(false, \"AltLeft\", { altKey: true, force: true });\n      game.keyboard.downKeys.add(\"AltLeft\");\n      this.isAlt = true;\n    } else {\n      this.isAlt = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isCtrl based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsCtrl(event) {\n    const keyboardManager = foundry?.helpers?.interaction?.KeyboardManager ?? KeyboardManager;\n    const isModiferActive = game.keyboard.isModifierActive(keyboardManager.MODIFIER_KEYS.CONTROL);\n    if (event.ctrlKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT CTRL key press\");\n      keyboardManager.emulateKeypress(false, \"ControlLeft\", { ctrlKey: true, force: true });\n      game.keyboard.downKeys.add(\"ControlLeft\");\n      this.isCtrl = true;\n    } else {\n      this.isCtrl = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isShift based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsShift(event) {\n    const keyboardManager = foundry?.helpers?.interaction?.KeyboardManager ?? KeyboardManager;\n    const isModiferActive = game.keyboard.isModifierActive(keyboardManager.MODIFIER_KEYS.SHIFT);\n    if (event.shiftKey && !isModiferActive) {\n      Logger.debug(\"Emulating LEFT SHIFT key press\");\n      keyboardManager.emulateKeypress(false, \"ShiftLeft\", { shiftKey: true, force: true });\n      game.keyboard.downKeys.add(\"ShiftLeft\");\n      this.isShift = true;\n    } else {\n      this.isShift = isModiferActive;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set isHover based on event\n   * @private\n   * @param {object} event The event\n   */\n  #setIsHover(event) {\n    this.isHover = [\"mouseenter\", \"mouseover\", \"pointerenter\"].includes(event.type);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the group from the nest ID\n   * @param {object} event The event\n   * @returns {object}     The group\n   */\n  getGroup(event) {\n    const groupElement = Utils.getClosestGroupElement(event);\n    const nestId = groupElement?.dataset?.nestId;\n    return this.groupHandler.getGroup({ nestId }) ?? null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the action from the action ID on the button\n   * @param {object} event  The event\n   * @returns {object}      The action\n   */\n  getAction(event) {\n    if (!event) return {};\n    const actionButtonElement = event.target.closest('[data-part=\"actionButton\"]')\n      ?? event.target.querySelector('[data-part=\"actionButton\"]');\n    const actionId = actionButtonElement?.dataset?.actionId;\n    if (!actionId) return {};\n    return this.actionHandler.availableActions.get(actionId) || {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the hud is enabled for the current user\n   * @private\n   * @returns {boolean} Whether the hud is enabled for the current user\n   */\n  get isHudEnabled() {\n    if (!Utils.getSetting(\"enable\")) return false;\n    if (game.user.isGM) return true;\n    return Utils.checkAllow(game.user.role, Utils.getSetting(\"allow\"));\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to CharacterHandler properties     */\n  /* -------------------------------------------- */\n\n  get characterName() {\n    return this.characterHandler?.characterName;\n  }\n\n  get actor() {\n    return this.characterHandler?.actor;\n  }\n\n  set actor(actor) {\n    this.characterHandler.actor = actor;\n  }\n\n  get actors() {\n    return this.characterHandler?.actors;\n  }\n\n  set actors(actors) {\n    this.characterHandler.actors = actors;\n  }\n\n  get token() {\n    return this.characterHandler?.token;\n  }\n\n  set token(token) {\n    this.characterHandler.token = token;\n  }\n\n  get tokens() {\n    return this.characterHandler?.tokens;\n  }\n\n  set tokens(tokens) {\n    this.characterHandler.tokens = tokens;\n  }\n}\n","!function(t,e){var i=i||{};\"function\"==typeof i&&i.amd?i([],e):\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"object\"==typeof exports?exports.DragSort=e():t.DragSort=e()}(this,(function(){var t,e=0,i={},s={},r=(t=window.MutationObserver||window.WebKitMutationObserver,function(e,i){e&&1===e.nodeType&&(t?new t((function(t,e){i(t)})).observe(e,{childList:!0,subtree:!1}):window.addEventListener&&e.addEventListener(\"DOMNodeInserted\",i,!1))});function a(t,e){if(!t)return this;e=e||{},this.parentElm=t,this.uid=e.uid,this.settings={selector:\"*\",callbacks:{}},Object.assign(this.settings,e),this.setup(),r(this.parentElm,this.setup.bind(this)),this.bindEvents()}return a.prototype={namespace:\"dragsort\",setup(){[...this.parentElm.childNodes].forEach((t=>{if(1!=t.nodeType)return t.parentNode.removeChild(t);t.matches(this.settings.selector)&&(t.draggable=!0)})),this.gap=this.getItemsGap(this.parentElm.firstElementChild)},throttle(t,e){var i=!1,s=this;return function(r){i||(t.call(s,r),i=!0,setTimeout((()=>i=!1),e))}},getDraggableElm(t){if(!t.closest)return null;var e=t.closest('[draggable=\"true\"]');return this.uid==i.uid?e:null},dragstart(t,e){i=this;var s,r=this.getDraggableElm(e);r?(this.saveInitialStyles(),this.source=this.getInitialState(),this.target=this.getInitialState(),s=r.getBoundingClientRect(),this.source.elm=r,this.source.idx=this.getNodeIndex(r),this.source.size.width=s.width,this.source.size.height=s.height,t.dataTransfer.effectAllowed=\"move\",this.settings.callbacks.dragStart&&this.settings.callbacks.dragStart(this.source.elm,t),setTimeout(this.afterDragStart.bind(this))):i={}},afterDragStart(){var t=\"vertical\"==this.settings.mode?\"height\":\"width\";this.parentElm.classList.add(`${this.namespace}--dragStart`),this.source.elm.style[t]=this.source.size[t]+\"px\",this.source.elm.classList.add(`${this.namespace}--dragElem`)},dragover(t){t.preventDefault(),t.stopPropagation();var e=t.target;if((e=this.getDraggableElm(e))&&this.target){var i=this.target.elm,s=this.target.hoverDirection;t.dataTransfer.dropEffect=\"move\",this.target.hoverDirection=this.getTargetDirection(t),i==e&&s==this.target.hoverDirection||this.directionAwareDragEnter(t,e)}},dragenter(t,e){(e=this.getDraggableElm(e))&&this.target&&this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(this.target.bounding=e.getBoundingClientRect())},directionAwareDragEnter(t,e){var i;t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=\"none\",this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(t.dataTransfer.dropEffect=\"move\",this.cleanupLastTarget(),this.target.elm=e,this.target.idx=this.getNodeIndex(e),e.classList.add(\"over\"),i=Math.abs(this.target.idx-this.source.idx),this.source.elm.classList.toggle(`${this.namespace}--hide`,i>0),\"vertical\"==this.settings.mode?this.target.elm.style[this.target.hoverDirection?\"marginBottom\":\"marginTop\"]=this.source.size.height+this.gap+\"px\":this.target.elm.style[this.target.hoverDirection?\"marginRight\":\"marginLeft\"]=this.source.size.width+this.gap+\"px\")},dragend(t){if(clearTimeout(this.dragoverTimeout),this.dragoverTimeout=null,this.parentElm.classList.remove(`${this.namespace}--dragStart`),!this.isValidElm(this.target.elm))return this.cleanup();var e=this.target.hoverDirection?this.target.elm.nextElementSibling:this.target.elm;return this.source.elm!=this.target.elm&&this.target.elm&&(this.target.elm.classList.add(`${this.namespace}--noAnim`),this.cleanup(),this.parentElm.insertBefore(this.source.elm,e)),this.source.elm&&this.source.elm.classList.remove(`${this.namespace}--dragElem`,`${this.namespace}--hide`),this.settings.callbacks.dragEnd&&this.settings.callbacks.dragEnd(this.source.elm),this},isTargetLastChild(){return this.parentElm.lastElementChild==this.target.elm},getTargetDirection(t){if(this.target.bounding)return\"vertical\"==this.settings.mode?t.pageY>this.target.bounding.top+this.target.bounding.height/2?1:0:t.pageX>this.target.bounding.left+this.target.bounding.width/2?1:0},getNodeIndex(t){for(var e=0;t=t.previousSibling;)3==t.nodeType&&/^\\s*$/.test(t.data)||e++;return e},isValidElm(t){return t&&t.nodeType&&t.parentNode==this.parentElm},saveInitialStyles(){[...this.parentElm.children].forEach((t=>{t.setAttribute(\"dragsort-initial-style\",t.getAttribute(\"style\"))}))},cleanup(){i={},[...this.parentElm.children].forEach((t=>{t.style=t.getAttribute(\"dragsort-initial-style\"),t.removeAttribute(\"dragsort-initial-style\"),setTimeout((()=>{t.classList.remove(`${this.namespace}--over`,`${this.namespace}--noAnim`,`${this.namespace}--dragElem`)}),50)}))},cleanupLastTarget(){const{elm:t}=this.target;t&&(t.classList.remove(`${this.namespace}--hide`,`${this.namespace}--over`),t.style=t.getAttribute(\"dragsort-initial-style\"))},getInitialState:()=>({elm:null,size:{}}),getItemsGap(t){var e=getComputedStyle(t),i=getComputedStyle(t.parentNode),s=\"vertical\"==this.settings.mode,r=parseInt(i.gap)||0;return parseInt(e[\"margin\"+(s?\"Top\":\"Left\")])+parseInt(e[\"margin\"+(s?\"Bottom\":\"Right\")])+r},bindEvents(t){for(var e in this.listeners=this.listeners||{dragstart:t=>this.dragstart(t,t.target),dragenter:t=>this.dragenter(t,t.target),dragend:t=>this.dragend(t,t.target),dragover:this.throttle(this.dragover,350)},this.listeners)this.parentElm[t?\"removeEventListener\":\"addEventListener\"](e,this.listeners[e])},destroy(){this.cleanup(),this.bindEvents(!0),delete s[this.uid]}},function(t,i){return s[++e]=t.DragSort?s[t.DragSort]:new a(t,{...i,uid:e}),t.DragSort=e,s[e]}}));","/*\nTagify v4.31.3 - tags input component\nBy: Yair Even-Or <vsync.design@gmail.com>\nhttps://github.com/yairEO/tagify\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\nThis Software may not be rebranded and sold as a library under any other name\r\nother than \"Tagify\" (by owner) or as part of another library.\n*/\n\nvar t=\"&#8203;\";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,i){if(!t)return;if(\"string\"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(n);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var n={isEnabled:function(){var t;return null===(t=window.TAGIFY_DEBUG)||void 0===t||t},log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).log.apply(s,[\"[Tagify]:\"].concat(i(e)))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).warn.apply(s,[\"[Tagify]:\"].concat(i(e)))}},s=function(t,e,i,n){return t=\"\"+t,e=\"\"+e,n&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()},a=function(t,e){return t&&Array.isArray(t)&&t.map((function(t){return o(t,e)}))};function o(t,e){var i,n={};for(i in t)e.indexOf(i)<0&&(n[i]=t[i]);return n}function r(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function l(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function d(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function c(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function u(t,e,i){var n,s;function a(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(c(e[i])){c(t[i])?a(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return n=t,(null!=(s=Object)&&\"undefined\"!=typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](n):n instanceof s)||(t={}),a(t,e),i&&a(t,i),t}function g(){var t=[],e={},i=!0,n=!1,s=void 0;try{for(var a,o=arguments[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var r=a.value,l=!0,d=!1,u=void 0;try{for(var g,h=r[Symbol.iterator]();!(l=(g=h.next()).done);l=!0){var p=g.value;c(p)?e[p.value]||(t.push(p),e[p.value]=1):t.includes(p)||t.push(p)}}catch(t){d=!0,u=t}finally{try{l||null==h.return||h.return()}finally{if(d)throw u}}}}catch(t){n=!0,s=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return t}function h(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var p=function(){return/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent)};function f(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}function m(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function v(t){return t&&t.closest(this.settings.classNames.tagSelector)}function b(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function w(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:u({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(n.warn(\"tag element doesn't exist\",{tagElm:t,data:e}),e)}function y(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),n=i.getRangeAt(0);i.rangeCount&&(n.setStartAfter(e),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}}function T(t,e){t.forEach((function(t){if(w(t.previousSibling)||!t.previousSibling){var i=document.createTextNode(\"​\");t.before(i),e&&y(i)}}))}var O={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:[\"blur\",\"tab\",\"enter\"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,focusable:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:function(){},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\" \"},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownItemSelected:\"tagify__dropdown__item--selected\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:function(){return Promise.resolve()},beforePaste:function(){return Promise.resolve()},suggestionClick:function(){return Promise.resolve()},beforeKeyDown:function(){return Promise.resolve()}}};function x(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function D(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){x(t,e,i[e])}))}return t}function I(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function E(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function M(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function N(){for(var t in this.dropdown={},this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs(),this.DOM.dropdown.__tagify=this}var _,A,C=(_=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){E(t,e,i[e])}))}return t}({},{events:{binding:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},n=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[n](\"scroll\",i.position,!0),window[n](\"resize\",i.position),window[n](\"keydown\",i.onKeyDown)),this.DOM.dropdown[n](\"mouseover\",i.onMouseOver),this.DOM.dropdown[n](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[n](\"mousedown\",i.onClick),this.DOM.dropdown.content[n](\"scroll\",i.onScroll)},callbacks:{onKeyDown:function(t){var e=this;if(this.state.hasFocus&&!this.state.composing){var i=this.settings,s=this.DOM.dropdown.querySelector(i.classNames.dropdownItemActiveSelector),a=this.dropdown.getSuggestionDataByNode(s),o=\"mix\"==i.mode,r=\"select\"==i.mode;i.hooks.beforeKeyDown(t,{tagify:this}).then((function(l){switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var d=e.dropdown.getAllSuggestionsRefs(),c=\"ArrowUp\"==t.key||\"Up\"==t.key;s&&(s=e.dropdown.getNextOrPrevOption(s,!c)),s&&s.matches(i.classNames.dropdownItemSelector)||(s=d[c?d.length-1:0]),e.dropdown.highlightOption(s,!0);break;case\"Escape\":case\"Esc\":e.dropdown.hide();break;case\"ArrowRight\":if(e.state.actions.ArrowLeft||i.autoComplete.rightKey)return;case\"Tab\":var u=!i.autoComplete.rightKey||!i.autoComplete.tabKey;if(!o&&!r&&s&&u&&!e.state.editing&&a){t.preventDefault();var g=e.dropdown.getMappedValue(a);return e.input.autocomplete.set.call(e,g),!1}return!0;case\"Enter\":t.preventDefault(),i.hooks.suggestionClick(t,{tagify:e,tagData:a,suggestionElm:s}).then((function(){if(s)return e.dropdown.selectOption(s),s=e.dropdown.getNextOrPrevOption(s,!c),void e.dropdown.highlightOption(s);e.dropdown.hide(),o||e.addTags(e.state.inputText.trim(),!0)})).catch((function(t){return n.warn(t)}));break;case\"Backspace\":if(o||e.state.editing.scope)return;var h=e.input.raw.call(e);\"\"!=h&&8203!=h.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0))}}))}},onMouseOver:function(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(e)},onMouseLeave:function(t){this.dropdown.highlightOption()},onClick:function(t){var e=this;if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var i=t.target.closest(this.settings.classNames.dropdownItemSelector),s=this.dropdown.getSuggestionDataByNode(i);this.state.actions.selectOption=!0,setTimeout((function(){return e.state.actions.selectOption=!1}),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:s,suggestionElm:i}).then((function(){i?e.dropdown.selectOption(i,t):e.dropdown.hide()})).catch((function(t){return n.warn(t)}))}},onScroll:function(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},refilter:function(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},getSuggestionDataByNode:function(t){for(var e,i=t&&t.getAttribute(\"value\"),n=this.suggestedListItems.length;n--;){if(c(e=this.suggestedListItems[n])&&e.value==i)return e;if(e==i)return{value:e}}},getNextOrPrevOption:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.dropdown.getAllSuggestionsRefs(),n=i.findIndex((function(e){return e===t}));return e?i[n+1]:i[n-1]},highlightOption:function(t,e){var i,n=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(n),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(n),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption:function(t,e){var i=this,n=this.settings,s=n.dropdown,a=s.clearOnSelect,o=s.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(o&&this.dropdown.hide());e=e||{};var r=t.getAttribute(\"value\"),l=\"noMatch\"==r,d=\"mix\"==n.mode,c=this.suggestedListItems.find((function(t){var e;return(null!==(e=t.value)&&void 0!==e?e:t)==r}));if(this.trigger(\"dropdown:select\",{data:c,elm:t,event:e}),c||l){if(this.state.editing){var g=this.normalizeTags([c])[0];c=n.transformTag.call(this,g)||g,this.onEditTagDone(null,u({__isValid:!0},c))}else this[d?\"addMixTags\":\"addTags\"]([c||this.input.raw.call(this)],a);(d||this.DOM.input.parentNode)&&(setTimeout((function(){i.DOM.input.focus(),i.toggleFocusClass(!0)})),o&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(function(){i.dropdown.fillHeaderFooter(),setTimeout((function(){t.remove(),i.dropdown.refilter()}),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))}else o&&setTimeout(this.dropdown.hide.bind(this))},selectAll:function(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems:function(t,e){var i,n,s,a,o,r,l=function(){var t,l,d=void 0,u=void 0;t=m[y],n=(null!=(l=Object)&&\"undefined\"!=typeof Symbol&&l[Symbol.hasInstance]?l[Symbol.hasInstance](t):t instanceof l)?m[y]:{value:m[y]};var v,b=!Object.keys(n).some((function(t){return w.includes(t)}))?[\"value\"]:w;g.fuzzySearch&&!e.exact?(a=b.reduce((function(t,e){return t+\" \"+(n[e]||\"\")}),\"\").toLowerCase().trim(),g.accentedSearch&&(a=h(a),r=h(r)),d=0==a.indexOf(r),u=a===r,v=a,s=r.toLowerCase().split(\" \").every((function(t){return v.includes(t.toLowerCase())}))):(d=!0,s=b.some((function(t){var i=\"\"+(n[t]||\"\");return g.accentedSearch&&(i=h(i),r=h(r)),g.caseSensitive||(i=i.toLowerCase()),u=i===r,e.exact?i===r:0==i.indexOf(r)}))),o=!g.includeSelectedTags&&i.isTagDuplicate(c(n)?n.value:n),s&&!o&&(u&&d?f.push(n):\"startsWith\"==g.sortby&&d?p.unshift(n):p.push(n))},d=this,u=this.settings,g=u.dropdown,p=(e=e||{},[]),f=[],m=u.whitelist,v=g.maxItems>=0?g.maxItems:1/0,b=g.includeSelectedTags||\"select\"==u.mode,w=g.searchKeys,y=0;if(!(t=\"select\"==u.mode&&this.value.length&&this.value[0][u.tagTextProp]==t?\"\":t)||!w.length)return p=b?m:m.filter((function(t){return!d.isTagDuplicate(c(t)?t.value:t)})),this.state.dropdown.suggestions=p,p.slice(0,v);for(r=g.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();y<m.length;y++)i=this,l();return this.state.dropdown.suggestions=f.concat(p),\"function\"==typeof g.sortby?g.sortby(f.concat(p),r):f.concat(p).slice(0,v)},getMappedValue:function(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML:function(t){var e=this;return u([],t).map((function(t,i){\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var n=e.dropdown.getMappedValue(t);return n=\"string\"==typeof n&&e.settings.dropdown.escapeHTML?d(n):n,e.settings.templates.dropdownItem.apply(e,[I(D({},t),{mappedValue:n}),e])})).join(\"\")}}),A=null!=(A={refs:function(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs:function(){return M(this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector))},show:function(t){var e,i,n,a=this,o=this.settings,r=\"mix\"==o.mode&&!o.enforceWhitelist,l=!o.whitelist||!o.whitelist.length,d=\"manual\"==o.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(l&&!r&&!o.templates.dropdownItemNoMatch||!1===o.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),o.templates.dropdownItemNoMatch&&(n=o.templates.dropdownItemNoMatch.call(this,{value:t}))),!n){if(this.suggestedListItems.length)t&&r&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!r||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(c(e=this.suggestedListItems[0])?e.value:e),o.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(n),o.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(o.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),d||setTimeout((function(){a.dropdown.position(),a.dropdown.render()})),setTimeout((function(){a.trigger(\"dropdown:show\",a.DOM.dropdown)}))}},hide:function(t){var e=this,i=this.DOM,n=i.scope,s=i.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),n.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((function(){e.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle:function(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},getAppendTarget:function(){var t=this.settings.dropdown;return\"function\"==typeof t.appendTarget?t.appendTarget():t.appendTarget},render:function(){var t,e,i,n=this,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings,o=this.dropdown.getAppendTarget();return!1===a.dropdown.enabled||(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),o.appendChild(this.DOM.dropdown),setTimeout((function(){return n.DOM.dropdown.classList.remove(a.classNames.dropdownInital)})))),this},fill:function(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").split(/>\\s+</).join(\"><\").trim():\"\"},fillHeaderFooter:function(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),n=this.dropdown.getHeaderRef(),s=this.dropdown.getFooterRef();e&&(null==n||n.parentNode.replaceChild(e,n)),i&&(null==s||s.parentNode.replaceChild(i,s))},position:function(t){var e=this.settings.dropdown,i=this.dropdown.getAppendTarget();if(\"manual\"!=e.position&&i){var n,s,a,o,r,l,d,c,u,g=this.DOM.dropdown,h=e.RTL,p=i===document.body,f=i===this.DOM.scope,m=p?window.pageYOffset:i.scrollTop,v=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,b=v.clientHeight,w=Math.max(v.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",y=this.DOM[\"input\"==w?\"input\":\"scope\"];if(t=t||g.clientHeight,this.state.dropdown.visible){if(\"text\"==w?(a=(n=function(){var t=document.getSelection();if(t.rangeCount){var e,i,n=t.getRangeAt(0),s=n.startContainer,a=n.startOffset;if(a>0)return(i=document.createRange()).setStart(s,a-1),i.setEnd(s,a),{left:(e=i.getBoundingClientRect()).right,top:e.top,bottom:e.bottom};if(s.getBoundingClientRect)return s.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=n.top,o=n.left,r=\"auto\"):(l=function(t){var e=0,i=0;for(t=t.parentNode;t&&t!=v;)e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.parentNode;return{top:e,left:i}}(i),n=y.getBoundingClientRect(),s=f?-1:n.top-l.top,a=(f?n.height:n.bottom-l.top)-1,o=f?-1:n.left-l.left,r=n.width+\"px\"),!p){var T=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=T,a+=T}var O;s=Math.floor(s),a=Math.ceil(a),c=((d=null!==(O=e.placeAbove)&&void 0!==O?O:b-n.bottom<t)?s:a)+m,u=\"left: \".concat(o+(h&&n.width||0)+window.pageXOffset,\"px;\"),g.style.cssText=\"\".concat(u,\"; top: \").concat(c,\"px; min-width: \").concat(r,\"; max-width: \").concat(r),g.setAttribute(\"placement\",d?\"top\":\"bottom\"),g.setAttribute(\"position\",w)}}}})?A:{},Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(A)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(A)).forEach((function(t){Object.defineProperty(_,t,Object.getOwnPropertyDescriptor(A,t))})),_),k=\"@yaireo/tagify/\",L={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},j={wrapper:function(e,i){return'<tags class=\"'.concat(i.classNames.namespace,\" \").concat(i.mode?\"\".concat(i.classNames[i.mode+\"Mode\"]):\"\",\" \").concat(e.className,'\"\\n                    ').concat(i.readonly?\"readonly\":\"\",\"\\n                    \").concat(i.disabled?\"disabled\":\"\",\"\\n                    \").concat(i.required?\"required\":\"\",\"\\n                    \").concat(\"select\"===i.mode?\"spellcheck='false'\":\"\",'\\n                    tabIndex=\"-1\">\\n                    ').concat(this.settings.templates.input.call(this),\"\\n                \").concat(t,\"\\n        </tags>\")},input:function(){var e=this.settings,i=e.placeholder||t;return\"<span \".concat(!e.readonly&&e.userInput?\"contenteditable\":\"\",' tabIndex=\"0\" data-placeholder=\"').concat(i,'\" aria-placeholder=\"').concat(e.placeholder||\"\",'\"\\n                    class=\"').concat(e.classNames.input,'\"\\n                    role=\"textbox\"\\n                    autocapitalize=\"false\"\\n                    autocorrect=\"off\"\\n                    spellcheck=\"false\"\\n                    aria-autocomplete=\"both\"\\n                    aria-multiline=\"').concat(\"mix\"==e.mode,'\"></span>')},tag:function(t,e){var i=e.settings;return'<tag title=\"'.concat(t.title||t.value,\"\\\"\\n                    contenteditable='false'\\n                    tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\"\\n                    class=\"').concat(i.classNames.tag,\" \").concat(t.class||\"\",'\"\\n                    ').concat(this.getAttributes(t),\">\\n            <x title='' tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\" class=\"').concat(i.classNames.tagX,\"\\\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span \").concat(\"select\"===i.mode&&i.userInput?\"contenteditable='true'\":\"\",' autocapitalize=\"false\" autocorrect=\"off\" spellcheck=\\'false\\' class=\"').concat(i.classNames.tagText,'\">').concat(t[i.tagTextProp]||t.value,\"</span>\\n            </div>\\n        </tag>\")},dropdown:function(t){var e=t.dropdown,i=\"manual\"==e.position;return'<div class=\"'.concat(i?\"\":t.classNames.dropdown,\" \").concat(e.classname,'\" role=\"listbox\" aria-labelledby=\"dropdown\" dir=\"').concat(e.RTL?\"rtl\":\"\",\"\\\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\\\"\").concat(t.classNames.dropdownWrapper,'\"></div>\\n                </div>')},dropdownContent:function(t){var e=this.settings.templates,i=this.state.dropdown.suggestions;return\"\\n            \".concat(e.dropdownHeader.call(this,i),\"\\n            \").concat(t,\"\\n            \").concat(e.dropdownFooter.call(this,i),\"\\n        \")},dropdownItem:function(t){return\"<div \".concat(this.getAttributes(t),\"\\n                    class='\").concat(this.settings.classNames.dropdownItem,\" \").concat(this.isTagDuplicate(t.value)?this.settings.classNames.dropdownItemSelected:\"\",\" \").concat(t.class||\"\",'\\'\\n                    tabindex=\"0\"\\n                    role=\"option\">').concat(t.mappedValue||t.value,\"</div>\")},dropdownHeader:function(t){return\"<header data-selector='tagify-suggestions-header' class=\\\"\".concat(this.settings.classNames.dropdownHeader,'\"></header>')},dropdownFooter:function(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?\"<footer data-selector='tagify-suggestions-footer' class=\\\"\".concat(this.settings.classNames.dropdownFooter,'\">\\n                ').concat(e,\" more items. Refine your search.\\n            </footer>\"):\"\"},dropdownItemNoMatch:null};function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function V(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=i){var n,s,a=[],o=!0,r=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){r=!0,s=t}finally{try{o||null==i.return||i.return()}finally{if(r)throw s}}return a}}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return P(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return P(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function H(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function B(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function W(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}function K(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return R(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var U={customBinding:function(){var t=this;this.customEventsList.forEach((function(e){t.on(e,t.settings.callbacks[e])}))},binding:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.settings,n=this.events.callbacks,s=e?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!e){for(var a in this.state.mainEvents=e,e&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),t=this.listeners.main=this.listeners.main||{keydown:[\"input\",n.onKeydown.bind(this)],click:[\"scope\",n.onClickScope.bind(this)],dblclick:\"select\"!=i.mode&&[\"scope\",n.onDoubleClickScope.bind(this)],paste:[\"input\",n.onPaste.bind(this)],drop:[\"input\",n.onDrop.bind(this)],compositionstart:[\"input\",n.onCompositionStart.bind(this)],compositionend:[\"input\",n.onCompositionEnd.bind(this)]})t[a]&&this.DOM[t[a][0]][s](a,t[a][1]);var o=this.listeners.main.inputMutationObserver||new MutationObserver(n.onInputDOMChange.bind(this));o.disconnect(),\"mix\"==i.mode&&o.observe(this.DOM.input,{childList:!0}),this.events.bindOriginaInputListener.call(this)}},bindOriginaInputListener:function(t){var e=(t||0)+500;this.listeners.main&&(clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(this.events.callbacks.observeOriginalInputValue.bind(this),e))},bindGlobal:function(t){var e,i=this.events.callbacks,n=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global)){this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"focusin\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"focusout\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this),useCapture:!0}];var s=!0,a=!1,o=void 0;try{for(var r,l=this.listeners.global[Symbol.iterator]();!(s=(r=l.next()).done);s=!0)(e=r.value).target[n](e.type,e.cb,!!e.useCapture)}catch(t){a=!0,o=t}finally{try{s||null==l.return||l.return()}finally{if(a)throw o}}}},unbindGlobal:function(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur:function(t){var e,i,n=this.settings,s=v.call(this,t.target),a=m.call(this,t.target),o=t.target.classList.contains(n.classNames.tagX),r=\"focusin\"==t.type,l=\"focusout\"==t.type;s&&r&&!a&&!o&&this.toggleFocusClass(this.state.hasFocus=+new Date);var d=t.target?this.trim(this.DOM.input.textContent):\"\",c=null===(i=this.value)||void 0===i||null===(e=i[0])||void 0===e?void 0:e[n.tagTextProp],u=n.dropdown.enabled>=0,g={relatedTarget:t.relatedTarget},h=this.state.actions.selectOption&&(u||!n.dropdown.closeOnSelect),p=this.state.actions.addNew&&u;if(l){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),n.onChangeAfterBlur&&this.triggerChangeEvent()}if(!(h||p||o))if(r||s?(this.state.hasFocus=+new Date,this.toggleFocusClass(this.state.hasFocus)):this.state.hasFocus=!1,\"mix\"!=n.mode){if(r){if(!n.focusable)return;var f=0===n.dropdown.enabled&&!this.state.dropdown.visible,b=!a||\"select\"===n.mode;return this.toggleFocusClass(!0),this.trigger(\"focus\",g),void(f&&b&&this.dropdown.show(this.value.length?\"\":void 0))}if(l){if(this.trigger(\"blur\",g),this.loading(!1),\"select\"==n.mode){if(this.value.length){var w=this.getTagElms()[0];d=this.trim(w.textContent)}c===d&&(d=\"\")}d&&!this.state.actions.selectOption&&n.addTagOnBlur&&n.addTagOn.includes(\"blur\")&&this.addTags(d,!0)}s||(this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide())}else r?this.trigger(\"focus\",g):l&&(this.trigger(\"blur\",g),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart:function(t){this.state.composing=!0},onCompositionEnd:function(t){this.state.composing=!1},onWindowKeyDown:function(t){var e,i=this.settings,n=document.activeElement,s=v.call(this,n)&&this.DOM.scope.contains(document.activeElement),a=s&&n.hasAttribute(\"readonly\");if(this.state.hasFocus||s&&!a){e=n.nextElementSibling;var o=t.target.classList.contains(i.classNames.tagX);switch(t.key){case\"Backspace\":i.readonly||this.state.editing||(this.removeTags(n),(e||this.DOM.input).focus());break;case\"Enter\":if(o)return void this.removeTags(t.target.parentNode);i.a11y.focusableTags&&m.call(this,n)&&setTimeout(this.editTag.bind(this),0,n);break;case\"ArrowDown\":this.state.dropdown.visible||\"mix\"==i.mode||this.dropdown.show()}}},onKeydown:function(t){var e=this,i=this.settings;if(!this.state.composing&&i.userInput){\"select\"==i.mode&&i.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var n=this.trim(t.target.textContent);this.trigger(\"keydown\",{event:t}),i.hooks.beforeKeyDown(t,{tagify:this}).then((function(s){if(\"mix\"==i.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":e.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(e.state.editing)return;var a=document.getSelection(),o=\"Delete\"==t.key&&a.anchorOffset==(a.anchorNode.length||0),r=a.anchorNode.previousSibling,d=1==a.anchorNode.nodeType||!a.anchorOffset&&r&&1==r.nodeType&&a.anchorNode.previousSibling;!function(t){var e=document.createElement(\"div\");t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}(e.DOM.input.innerHTML);var c,u,g,h=e.getTagElms(),f=1===a.anchorNode.length&&a.anchorNode.nodeValue==String.fromCharCode(8203);if(\"edit\"==i.backspace&&d)return c=1==a.anchorNode.nodeType?null:a.anchorNode.previousElementSibling,setTimeout(e.editTag.bind(e),0,c),void t.preventDefault();if(p()&&B(d,Element))return g=l(d),d.hasAttribute(\"readonly\")||d.remove(),e.DOM.input.focus(),void setTimeout((function(){y(g),e.DOM.input.click()}));if(\"BR\"==a.anchorNode.nodeName)return;if((o||d)&&1==a.anchorNode.nodeType?u=0==a.anchorOffset?o?h[0]:null:h[Math.min(h.length,a.anchorOffset)-1]:o?u=a.anchorNode.nextElementSibling:B(d,Element)&&(u=d),3==a.anchorNode.nodeType&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&t.preventDefault(),(d||o)&&!i.backspace)return void t.preventDefault();if(\"Range\"!=a.type&&!a.anchorOffset&&a.anchorNode==e.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=a.type&&u&&u.hasAttribute(\"readonly\"))return void y(l(u));\"Delete\"==t.key&&f&&w(a.anchorNode.nextSibling)&&e.removeTags(a.anchorNode.nextSibling)}return!0}var m=\"manual\"==i.dropdown.position;switch(t.key){case\"Backspace\":\"select\"==i.mode&&i.enforceWhitelist&&e.value.length?e.removeTags():e.state.dropdown.visible&&\"manual\"!=i.dropdown.position||\"\"!=t.target.textContent&&8203!=n.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0));break;case\"Esc\":case\"Escape\":if(e.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":e.state.dropdown.visible||e.dropdown.show();break;case\"ArrowRight\":var v=e.state.inputSuggestion||e.state.ddItemData;if(v&&i.autoComplete.rightKey)return void e.addTags([v],!0);break;case\"Tab\":var b=\"select\"==i.mode;if(!n||b)return!0;t.preventDefault();case\"Enter\":if(e.state.dropdown.visible&&!m)return;t.preventDefault(),setTimeout((function(){e.state.dropdown.visible&&!m||e.state.actions.selectOption||!i.addTagOn.includes(t.key.toLowerCase())||e.addTags(n,!0)}))}})).catch((function(t){return t}))}},onInput:function(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this,void 0,{trim:!1}),n=i.length>=e.dropdown.enabled,s={value:i,inputElm:this.DOM.input},a=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(a),s.isValid=a,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[n?\"show\":\"hide\"](i),this.trigger(\"input\",s))},onMixTagsInput:function(t){var e,i,n,s,a,o,r,l,d=this,c=this.settings,g=this.value.length,h=this.getTagElms(),f=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(h,(function(t){return w(t).value}));if(\"deleteContentBackward\"==t.inputType&&p()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),T(this.getTagElms()),this.value.slice().forEach((function(t){t.readonly&&!v.includes(t.value)&&f.appendChild(d.createTagElem(t))})),f.childNodes.length&&(m.insertNode(f),this.setRangeAtStartEnd(!1,f.lastChild)),h.length!=g)return this.value=[].map.call(this.getTagElms(),(function(t){return w(t)})),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),n=(e=m.toString().slice(0,m.endOffset)).split(c.pattern).length-1,(i=e.match(c.pattern))&&(s=e.slice(e.lastIndexOf(i[i.length-1]))),s){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:s.match(c.pattern)[0],value:s.replace(c.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(c.delimiters))return this.state.tag.value=this.state.tag.value.replace(c.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,c.dropdown.clearOnSelect),void this.dropdown.hide();a=this.state.tag.value.length>=c.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||n<this.state.mixMode.matchedPatternCount)&&(a=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=n}setTimeout((function(){d.update({withoutChangeEvent:!0}),d.trigger(\"input\",u({},d.state.tag,{textContent:d.DOM.input.textContent})),d.state.tag&&d.dropdown[a?\"show\":\"hide\"](d.state.tag.value)}),10)},onInputIE:function(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue:function(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere:function(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1,t.target.closest(\".tagify__dropdown\")&&t.target.closest(\".tagify__dropdown\").__tagify!=this&&this.dropdown.hide())},onClickScope:function(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),n=t.target===this.DOM.scope,s=+new Date-this.state.hasFocus;if(n&&\"select\"!=e.mode)this.DOM.input.focus();else{if(!t.target.classList.contains(e.classNames.tagX))return i&&!this.state.editing?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:w(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks&&\"select\"!=e.mode||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500||!e.focusable)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,W(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){H(t,e,i[e])}))}return t}({},t),{target:this.getTagElms()[0]})),!e.userInput&&this.dropdown.show()));this.removeTags(t.target.parentNode)}},onPaste:function(t){var e=this;t.preventDefault();var i,n,s,a=this.settings;if(\"select\"==a.mode&&a.enforceWhitelist||!a.userInput)return!1;a.readonly||(n=t.clipboardData||window.clipboardData,s=n.getData(\"Text\"),a.hooks.beforePaste(t,{tagify:this,pastedText:s,clipboardData:n}).then((function(a){void 0===a&&(a=s),a&&(e.injectAtCaret(a,window.getSelection().getRangeAt(0)),\"mix\"==e.settings.mode?e.events.callbacks.onMixTagsInput.call(e,t):e.settings.pasteAsTags?i=e.addTags(e.state.inputText+a,!0):(e.state.inputText=a,e.dropdown.show(a))),e.trigger(\"paste\",{event:t,pastedText:s,clipboardData:n,tagsElems:i})})).catch((function(t){return t})))},onDrop:function(t){t.preventDefault()},onEditTagInput:function(t,e){var i,n=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(n),a=w(n),o=this.input.normalize.call(this,t),r=(H(i={},this.settings.tagTextProp,o),H(i,\"__tagId\",a.__tagId),i),l=this.validateTag(r);this.editTagChangeDetected(u(a,r))||!0!==t.originalIsValid||(l=!0),n.classList.toggle(this.settings.classNames.tagInvalid,!0!==l),a.__isValid=l,n.title=!0===l?a.title||a.value:l,o.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=o),this.dropdown.show(o)),this.trigger(\"edit:input\",{tag:n,index:s,data:u({},this.value[s],{newValue:o}),event:e})},onEditTagPaste:function(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var n=b(i);this.setRangeAtStartEnd(!1,n)},onEditTagClick:function(t,e){this.events.callbacks.onClickScope.call(this,e)},onEditTagFocus:function(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur:function(t,e){var i=m.call(this,e.relatedTarget);if(\"select\"==this.settings.mode&&i&&e.relatedTarget.contains(e.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t))){var n,s,a,o=this.settings,r=t.closest(\".\"+o.classNames.tag),l=w(r),d=this.input.normalize.call(this,t),c=(H(n={},o.tagTextProp,d),H(n,\"__tagId\",l.__tagId),n),g=l.__originalData,h=this.editTagChangeDetected(u(l,c)),p=this.validateTag(c);if(d)if(h){var f;if(s=this.hasMaxTags(),a=u({},g,(H(f={},o.tagTextProp,this.trim(d)),H(f,\"__isValid\",p),f)),o.transformTag.call(this,a,g),!0!==(p=(!s||!0===g.__isValid)&&this.validateTag(a))){if(this.trigger(\"invalid\",{data:a,tag:r,message:p}),o.editTags.keepInvalid)return;o.keepInvalidTags?a.__isValid=p:a=g}else o.keepInvalidTags&&(delete a.title,delete a[\"aria-invalid\"],delete a.class);this.onEditTagDone(r,a)}else this.onEditTagDone(r,g);else this.onEditTagDone(r)}},onEditTagkeydown:function(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":this.state.editing=!1,!!e.__tagifyTagData.__originalData.value?e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e):e.remove();break;case\"Enter\":case\"Tab\":t.preventDefault();setTimeout((function(){return t.target.blur()}),0)}},onDoubleClickScope:function(t){var e,i,n=t.target.closest(\".\"+this.settings.classNames.tag),s=w(n),a=this.settings;n&&!1!==s.editable&&(e=n.classList.contains(this.settings.classNames.tagEditing),i=n.hasAttribute(\"readonly\"),a.readonly||e||i||!this.settings.editTags||!a.userInput||(this.events.callbacks.onEditTagFocus.call(this,n),this.editTag(n)),this.toggleFocusClass(!0),\"select\"!=a.mode&&this.trigger(\"dblclick\",{tag:n,index:this.getNodeIndex(n),data:w(n)}))},onInputDOMChange:function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(e.settings.classNames.tagSelector)){var i,n=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(n=document.createTextNode(\"\\n\")),(i=t).replaceWith.apply(i,K([n].concat(K(K(t.childNodes).slice(0,-1))))),y(n)}else if(m.call(e,t)){var s;if(3!=(null===(s=t.previousSibling)||void 0===s?void 0:s.nodeType)||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName){t.previousSibling.replaceWith(\"\\n​\");for(var a=t.nextSibling,o=\"\";a;)o+=a.textContent,a=a.nextSibling;o.trim()&&y(t.previousSibling)}else t.previousSibling&&!w(t.previousSibling)||t.before(\"​\")}})),t.removedNodes.forEach((function(t){t&&\"BR\"==t.nodeName&&m.call(e,i)&&(e.removeTags(i),e.fixFirefoxLastTagNoCaret())}))}));var i=this.DOM.input.lastChild;i&&\"\"==i.nodeValue&&i.remove(),i&&\"BR\"==i.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function X(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function J(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){z(t,e,i[e])}))}return t}function G(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return q(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return q(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function $(t,e){if(!t){n.warn(\"input element not found\",t);var i=new Proxy(this,{get:function(){return function(){return i}}});return i}if(t.__tagify)return n.warn(\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var s;u(this,function(t){var e=document.createTextNode(\"\"),i={};function s(t,i,n){n&&i.split(/\\s+/g).forEach((function(i){return e[t+\"EventListener\"].call(e,i,n)}))}return{removeAllCustomListeners:function(){Object.entries(i).forEach((function(t){var e=F(t,2),i=e[0];e[1].forEach((function(t){return s(\"remove\",i,t)}))})),i={}},off:function(t,e){return t&&(e?s(\"remove\",t,e):t.split(/\\s+/g).forEach((function(t){var e;null===(e=i[t])||void 0===e||e.forEach((function(e){return s(\"remove\",t,e)})),delete i[t]}))),this},on:function(t,e){return e&&\"function\"==typeof e&&(t.split(/\\s+/g).forEach((function(t){Array.isArray(i[t])?i[t].push(e):i[t]=[e]})),s(\"add\",t,e)),this},trigger:function(i,s,a){var o;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var r=\"object\"==typeof s?s:{value:s};if((r=a.cloneData?u({},r):r).tagify=this,s.event&&(r.event=this.cloneEvent(s.event)),V(s,Object))for(var l in s)V(s[l],HTMLElement)&&(r[l]=s[l]);o=new CustomEvent(i,{detail:r})}catch(t){n.warn(t)}e.dispatchEvent(o)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(s=e.id,function(t){var e,i=\"/\"+t;if(1==localStorage.getItem(k+s+\"/v\",1))try{e=JSON.parse(localStorage[k+s+i])}catch(t){}return e}),this.setPersistedData=function(t){return t?(localStorage.setItem(k+t+\"/v\",1),function(e,i){var n=\"/\"+i,s=JSON.stringify(e);e&&i&&(localStorage.setItem(k+t+n,s),dispatchEvent(new Event(\"storage\")))}):function(){}}(e.id),this.clearPersistedData=function(t){return function(e){var i=k+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(var n in localStorage)n.includes(i)&&localStorage.removeItem(n)}}(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),N.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}$.prototype={_dropdown:C,placeCaretAfterNode:y,getSetTagData:w,helpers:{sameStr:s,removeCollectionProp:a,omit:o,isObject:c,parseHTML:r,escapeHTML:d,extend:u,concatWithoutDups:g,getUID:f,isNodeTag:m},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"paste\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim:function(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:r,templates:j,parseTemplate:function(t,e){return r((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){var e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},set userInput(t){this.settings.userInput=!!t,this.setContentEditable(!!t)},get userInput(){return this.settings.userInput},generateClassSelectors:function(t){var e=function(e){var i=e;Object.defineProperty(t,i+\"Selector\",{get:function(){return\".\"+this[i].split(\" \")[0]}})};for(var i in t)e(i)},applySettings:function(t,e){var i,n;O.templates=this.templates;var s=u({},O,\"mix\"==e.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=u({},s,e);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=d(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((function(e){var i=t.getAttribute(\"data-\"+e);i&&X(i=i.split(a.delimiters),Array)&&(a[e]=i)})),\"autoComplete\"in e&&!c(e.autoComplete)&&(a.autoComplete=O.autoComplete,a.autoComplete.enabled=e.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=e.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=J({},L,a.texts||{}),(\"select\"!=a.mode||(null===(i=e.dropdown)||void 0===i?void 0:i.enabled))&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=(null===(n=e.dropdown)||void 0===n?void 0:n.appendTarget)||document.body;var o=this.getPersistedData(\"whitelist\");Array.isArray(o)&&(this.whitelist=Array.isArray(a.whitelist)?g(a.whitelist,o):o)},getAttributes:function(t){var e,i=this.getCustomAttributes(t),n=\"\";for(e in i)n+=\" \"+e+(void 0!==t[e]?'=\"'.concat(i[e],'\"'):\"\");return n},getCustomAttributes:function(t){if(!c(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=d(t[e]));return i},setStateSelection:function(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars:function(){var t,e,i,n=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(t=function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((function(t){return t})).pop().trim();return{value:+t.split(e).filter((function(t){return t}))[0].trim(),unit:e}}((i=\"tag-hide-transition\",n.getPropertyValue(\"--\"+i))),e=t.value,\"s\"==t.unit?1e3*e:e)}},build:function(t){var e=this.DOM,i=t.closest(\"label\");this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1),i&&i.setAttribute(\"for\",\"\")},destroy:function(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),this.removeAllCustomListeners(),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues:function(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){var n=this.getPersistedData(\"value\");t=n&&!this.DOM.originalInput.value?n:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{X(JSON.parse(t),Array)&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((function(t){return t&&t.classList.add(i.classNames.tagNoAnimation)}))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent:function(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading:function(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading:function(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass:function(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation:function(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass:function(t){this.toggleClass(this.settings.classNames.focus,!!t)},setPlaceholder:function(t){var e=this;[\"data\",\"aria\"].forEach((function(i){return e.DOM.input.setAttribute(\"\".concat(i,\"-placeholder\"),t)}))},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:U,fixFirefoxLastTagNoCaret:function(){},setRangeAtStartEnd:function(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if(X(i.focusNode,Element)&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((function(n){return i.getRangeAt(0)[\"set\"+n](e,t||e.length)}))}catch(t){console.warn(t)}}},insertAfterTag:function(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected:function(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode:function(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode:function(t,e){this.getTagTextNode(t).innerHTML=d(e)},editTag:function(t,e){var i=this;t=t||this.getLastTag(),e=e||{};var s=this.settings,a=this.getTagTextNode(t),o=this.getNodeIndex(t),r=w(t),l=this.events.callbacks,d=!0,c=\"select\"==s.mode;if(!c&&this.dropdown.hide(),a){if(!X(r,Object)||!(\"editable\"in r)||r.editable)return r=w(t,{__originalData:u({},r),__originalHTML:t.cloneNode(!0)}),w(r.__originalHTML,r.__originalData),a.setAttribute(\"contenteditable\",!0),t.classList.add(s.classNames.tagEditing),this.events.callbacks.onEditTagFocus.call(this,t),a.addEventListener(\"click\",l.onEditTagClick.bind(this,t)),a.addEventListener(\"blur\",l.onEditTagBlur.bind(this,this.getTagTextNode(t))),a.addEventListener(\"input\",l.onEditTagInput.bind(this,a)),a.addEventListener(\"paste\",l.onEditTagPaste.bind(this,a)),a.addEventListener(\"keydown\",(function(e){return l.onEditTagkeydown.call(i,e,t)})),a.addEventListener(\"compositionstart\",l.onCompositionStart.bind(this)),a.addEventListener(\"compositionend\",l.onCompositionEnd.bind(this)),e.skipValidation||(d=this.editTagToggleValidity(t)),a.originalIsValid=d,this.trigger(\"edit:start\",{tag:t,index:o,data:r,isValid:d}),a.focus(),!c&&this.setRangeAtStartEnd(!1,a),0===s.dropdown.enabled&&!c&&this.dropdown.show(),this.state.hasFocus=!0,this}else n.warn(\"Cannot find element in Tag template: .\",s.classNames.tagTextSelector)},editTagToggleValidity:function(t,e){var i;if(e=e||w(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid=i,e.__isValid;n.warn(\"tag has no data: \",t,e)},onEditTagDone:function(t,e){t=t||this.state.editing.scope,e=e||{};var i,n,s={tag:t,index:this.getNodeIndex(t),previousData:w(t),data:e},a=this.settings;this.trigger(\"edit:beforeUpdate\",s,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&(void 0!==(n=e[a.tagTextProp])?null===(i=(n+=\"\").trim)||void 0===i?void 0:i.call(n):a.tagTextProp in e?void 0:e.value)?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),a.a11y.focusableTags?t.focus():\"select\"!=a.mode&&y(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",s),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag:function(t,e){e&&\"\"!==e.value&&void 0!==e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&u(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags:function(){var t=this;this.value.length=0;var e=this.settings.classNames,i=[e.tagNotAllowed.split(\" \")[0],e.tagHide];[].forEach.call(this.getTagElms(),(function(e){G(e.classList).some((function(t){return i.includes(t)}))||t.value.push(w(e))})),this.update()},injectAtCaret:function(t,e){var i;if(e=e||(null===(i=this.state.selection)||void 0===i?void 0:i.range),\"string\"==typeof t&&(t=document.createTextNode(t)),!e&&t)return this.appendMixTags(t),this;var n=b(t,e);return this.setRangeAtStartEnd(!1,n),this.updateValueByDOMTags(),this.update(),this},input:{set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.settings,n=i.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=d(\"\"+t),t&&this.toggleClass(i.classNames.empty,!this.DOM.input.innerHTML)),!t&&n&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw:function(){return this.DOM.input.textContent},validate:function(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize:function(t,e){var i=t||this.DOM.input,n=[];i.childNodes.forEach((function(t){return 3==t.nodeType&&n.push(t.nodeValue)})),n=n.join(\"\\n\");try{n=n.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return n=n.replace(/\\s/g,\" \"),(null==e?void 0:e.trim)?this.trim(n):n},autocomplete:{suggest:function(t){if(this.settings.autoComplete.enabled){\"object\"!=typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=this.state.inputText.toLowerCase(),n=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&n==i?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set:function(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx:function(t){return this.value.findIndex((function(e){return e.__tagId==(t||{}).__tagId}))},getNodeIndex:function(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=\".\"+G(this.settings.classNames.tag.split(\" \")).concat(G(e)).join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(n))},getLastTag:function(){var t=this.settings.classNames,e=this.DOM.scope.querySelectorAll(\"\".concat(t.tagSelector,\":not(.\").concat(t.tagHide,\"):not([readonly])\"));return e[e.length-1]},isTagDuplicate:function(t,e,i){var n=0,a=!0,o=!1,r=void 0;try{for(var l,d=this.value[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var c=l.value;s(this.trim(\"\"+t),c.value,e)&&i!=c.__tagId&&n++}}catch(t){o=!0,r=t}finally{try{a||null==d.return||d.return()}finally{if(o)throw r}}return n},getTagIndexByValue:function(t){var e=this,i=[],n=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach((function(a,o){a.__tagifyTagData&&s(e.trim(a.__tagifyTagData.value),t,n)&&i.push(o)})),i},getTagElmByValue:function(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag:function(t){var e=this;t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((function(){t.classList.remove(e.settings.classNames.tagFlash)}),100))},isTagBlacklisted:function(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((function(e){return(\"\"+e).toLowerCase()==t})).length},isTagWhitelisted:function(t){return!!this.getWhitelistItem(t)},getWhitelistItem:function(t,e,i){e=e||\"value\";var n,a=this.settings;return(i=i||a.whitelist).some((function(i){var o=\"object\"==typeof i?i[e]||i.value:i;if(s(o,t,a.dropdown.caseSensitive,a.trim))return n=\"object\"==typeof i?i:{value:i},!0})),n||\"value\"!=e||\"value\"==a.tagTextProp||(n=this.getWhitelistItem(t,a.tagTextProp,i)),n},validateTag:function(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,n=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?\"mix\"!=e.mode&&e.pattern&&X(e.pattern,RegExp)&&!e.pattern.test(n)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(n,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(n)||e.enforceWhitelist&&!this.isTagWhitelisted(n)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs:function(t,e){return{\"aria-invalid\":!0,class:\"\".concat(t.class||\"\",\" \").concat(this.settings.classNames.tagNotAllowed).trim(),title:e}},hasMaxTags:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly:function(t,e){var i=this.settings;this.DOM.scope.contains(document.activeElement)&&document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.settings.userInput=!0,this.setContentEditable(!t)},setContentEditable:function(t){this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1},setDisabled:function(t){this.setReadonly(t,\"disabled\")},normalizeTags:function(t){var e=this,i=this.settings,n=i.whitelist,s=i.delimiters,a=i.mode,o=i.tagTextProp,r=[],l=!!n&&X(n[0],Object),d=Array.isArray(t),g=d&&t[0].value,h=function(t){return(t+\"\").split(s).reduce((function(t,i){var n,s=e.trim(i);return s&&t.push((z(n={},o,s),z(n,\"value\",s),n)),t}),[])};if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=h(t)}else d&&(t=t.reduce((function(t,i){if(c(i)){var n=u({},i);o in n||(o=\"value\"),n[o]=e.trim(n[o]),(n[o]||0===n[o])&&t.push(n)}else if(i){var s;(s=t).push.apply(s,G(h(i)))}return t}),[]));return l&&!g&&(t.forEach((function(t){var i=r.map((function(t){return t.value})),n=e.dropdown.filterListItems.call(e,t[o],{exact:!0});e.settings.duplicates||(n=n.filter((function(t){return!i.includes(t.value)})));var s=n.length>1?e.getWhitelistItem(t[o],o,n):n[0];s&&X(s,Object)?r.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[o]),r.push(t))})),r.length&&(t=r)),t},parseMixTags:function(t){var e=this,i=this.settings,n=i.mixTagsInterpolator,s=i.duplicates,a=i.transformTag,o=i.enforceWhitelist,r=i.maxTags,l=i.tagTextProp,d=[];t=t.split(n[0]).map((function(t,i){var c,u,g,h=t.split(n[1]),p=h[0],f=d.length==r;try{if(p==+p)throw Error;u=JSON.parse(p)}catch(t){u=e.normalizeTags(p)[0]||{value:p}}if(a.call(e,u),f||!(h.length>1)||o&&!e.isTagWhitelisted(u.value)||!s&&e.isTagDuplicate(u.value)){if(t)return i?n[0]+t:t}else u[c=u[l]?l:\"value\"]=e.trim(u[c]),g=e.createTagElem(u),d.push(u),g.classList.add(e.settings.classNames.tagNoAnimation),h[0]=g.outerHTML,e.value.push(u);return h.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize();var c=this.getTagElms();return c.forEach((function(t,e){return w(t,d[e])})),this.update({withoutChangeEvent:!0}),T(c,this.state.hasFocus),t},replaceTextWithNode:function(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,n,s=this.state.selection||window.getSelection(),a=s.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return a.splitText(s.anchorOffset-o),-1==(i=a.nodeValue.lastIndexOf(e))?!0:(n=a.splitText(i),t&&a.parentNode.replaceChild(t,n),!0)}},prepareNewTagNode:function(t,e){e=e||{};var i=this.settings,n=[],s={},a=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},a),i.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(e.skipInvalid)return;if(u(s,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:a}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!i.createInvalidTags)return void n.push(t.value)}return\"readonly\"in t&&(t.readonly?s[\"aria-readonly\"]=!0:delete t.readonly),{tagElm:this.createTagElem(t,s),tagData:t,aggregatedInvalidInput:n}},postProcessNewTagNode:function(t,e){var i=this,n=this.settings,s=e.__isValid;s&&!0===s?this.value.push(e):(this.trigger(\"invalid\",{data:e,index:this.value.length,tag:t,message:s}),n.keepInvalidTags||setTimeout((function(){return i.removeTags(t,!0)}),1e3)),this.dropdown.position()},selectTag:function(t,e){var i=this;if(!this.settings.enforceWhitelist||this.isTagWhitelisted(e.value)){this.state.actions.selectOption&&setTimeout((function(){return i.setRangeAtStartEnd(!1,i.DOM.input)}));var n=this.getLastTag();return n?this.replaceTag(n,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag:function(t){var e=u({value:\"\"},t||{}),i=this.createTagElem(e);w(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags:function(t,e,i){var n=this,s=[],a=this.settings,o=[],r=document.createDocumentFragment(),l=[];if(!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((function(t){var e=n.prepareNewTagNode(t,{skipInvalid:i||a.skipInvalid});if(e){var d=e.tagElm;if(t=e.tagData,o=e.aggregatedInvalidInput,s.push(d),\"select\"==a.mode)return n.selectTag(d,t);r.appendChild(d),n.postProcessNewTagNode(d,t),l.push({tagElm:d,tagData:t})}})),this.appendTag(r),l.forEach((function(t){var e=t.tagElm,i=t.tagData;return n.trigger(\"add\",{tag:e,index:n.getTagIdx(i),data:i})})),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":o.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),this.dropdown.refilter(),s},addMixTags:function(t){var e=this;if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var i=document.createDocumentFragment();return t.forEach((function(t){var n=e.prepareNewTagNode(t);i.appendChild(n.tagElm),e.insertAfterTag(n.tagElm),e.postProcessNewTagNode(n.tagElm,n.tagData)})),this.appendMixTags(i),i.children},appendMixTags:function(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag:function(t){var e,i,n,s=this,a=this.settings,o=null===(e=this.state.tag)||void 0===e?void 0:e.delimiters;if(t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(a.pattern.source||a.pattern)[0],n=this.prepareNewTagNode(t),i=n.tagElm,this.replaceTextWithNode(i)||this.DOM.input.appendChild(i),setTimeout((function(){return i.classList.add(s.settings.classNames.tagNoAnimation)}),300),this.update(),!o){var r=this.insertAfterTag(i)||i;setTimeout(y,0,r)}return this.state.tag=null,this.postProcessNewTagNode(i,n.tagData),i},appendTag:function(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem:function(t,e){t.__tagId=f();var i,n=u({},t,J({value:d(t.value+\"\")},e));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(i=this.parseTemplate(\"tag\",[n,this])),w(i,t),i},reCheckInvalidTags:function(){var t=this,e=this.settings;this.getTagElms(e.classNames.tagNotAllowed).forEach((function(i,n){var s=w(i),a=t.hasMaxTags(),o=t.validateTag(s),r=!0===o&&!a;if(\"select\"==e.mode&&t.toggleScopeValidation(o),r)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},t.replaceTag(i,s);i.title=a||o}))},removeTags:function(t,e,i){var n,s=this,a=this.settings;if(t=t&&X(t,HTMLElement)?[t]:X(t,Array)?t:t?[t]:[this.getLastTag()].filter((function(t){return t})),n=t.reduce((function(t,e){e&&\"string\"==typeof e&&(e=s.getTagElmByValue(e));var i=w(e);return e&&i&&!i.readonly&&t.push({node:e,idx:s.getTagIdx(i),data:w(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==n.length&&\"select\"!=a.mode&&n[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),n.length)return a.hooks.beforeRemoveTag(n,{tagify:this}).then((function(){var t=function(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))};i&&i>10&&1==n.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(s,n[0]):n.forEach(t.bind(s)),e||(s.removeTagsFromValue(n.map((function(t){return t.node}))),s.update(),\"select\"==a.mode&&a.userInput&&s.setContentEditable(!0))})).catch((function(t){}))},removeTagsFromDOM:function(){this.getTagElms().forEach((function(t){return t.remove()}))},removeTagsFromValue:function(t){var e=this;(t=Array.isArray(t)?t:[t]).forEach((function(t){var i=w(t),n=e.getTagIdx(i);n>-1&&e.value.splice(n,1)}))},removeAllTags:function(t){var e=this;t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((function(){e.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.settings.userInput&&this.setContentEditable(!0)),this.update(t)},postUpdate:function(){this.state.blockChangeEvent=!1;var t,e,i=this.settings,n=i.classNames,s=\"mix\"==i.mode?i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;(this.toggleClass(n.hasMaxTags,this.value.length>=i.maxTags),this.toggleClass(n.hasNoTags,!this.value.length),this.toggleClass(n.empty,!s),\"select\"==i.mode)&&this.toggleScopeValidation(null===(e=this.value)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.__isValid)},setOriginalInputValue:function(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update:function(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100),this.events.bindOriginaInputListener.call(this,100)},getInputValue:function(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue:function(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString:function(){var t=\"\",e=this,i=this.settings,n=i.originalInputValueFormat||JSON.stringify,s=i.mixTagsInterpolator;return function i(a){a.childNodes.forEach((function(a){if(1==a.nodeType){var r=w(a);if(\"BR\"==a.tagName&&(t+=\"\\r\\n\"),r&&m.call(e,a)){if(r.__removed)return;t+=s[0]+n(o(r,e.dataProps))+s[1]}else a.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(a.tagName)?t+=a.textContent:\"DIV\"!=a.tagName&&\"P\"!=a.tagName||(t+=\"\\r\\n\",i(a))}else t+=a.textContent}))}(this.DOM.input),t}},$.prototype.removeTag=$.prototype.removeTags;export{$ as default};\n//# sourceMappingURL=tagify.esm.js.map\r\n","import { MODULE, TEMPLATE } from \"../core/constants.mjs\";\nimport { Logger } from \"../core/utils.mjs\";\nimport DragSort from \"@yaireo/dragsort\";\nimport Tagify from \"@yaireo/tagify\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Tagify-based application\n */\nexport class TagifyApp extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(data) {\n    super(data);\n    this.tagify = null;\n    this.dragSort = null;\n    this.content = data.content;\n    this.submit = data.submit;\n    this.categoryId = null;\n    this.subcategoryId = null;\n    this.options.window.title = data.title;\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      resetActions: TagifyApp.resetActions,\n      unselectAllTags: TagifyApp.unselectAllTags\n    },\n    classes: [`${MODULE.ID}-app`, \"tah-dialog\", \"sheet\"],\n    id: \"token-action-hud-dialog\",\n    form: {\n      closeOnSubmit: true,\n      handler: TagifyApp.submit\n    },\n    position: {\n      width: 600,\n      height: 800\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    return this.content;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show dialog\n   * @public\n   * @param {string} dialogType      The dialog type\n   * @param {string} nestId          The nest id\n   * @param {object} tags            The available and selected tags\n   * @param {object} dialogData      The dialog data\n   * @param {function*} dialogSubmit The dialog submit function\n   */\n  static open(dialogType, nestId, tags, dialogData, dialogSubmit) {\n    this.nestId = nestId;\n    TagifyApp.#prepareHook(tags);\n\n    const data = {\n      title: dialogData.title,\n      content: dialogData.content,\n      submit: dialogSubmit\n    };\n\n    let dialog;\n    switch (dialogType) {\n      case \"hud\":\n        dialog = new TagifyAppHud(data);\n        break;\n      case \"topLevelGroup\":\n        dialog = new TagifyAppGroup(data);\n        break;\n      case \"group\":\n        dialog = new TagifyAppSubgroup(data);\n        break;\n    }\n\n    dialog.render(true);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare dialog hook\n   * @private\n   * @param {object} tags The tags\n   */\n  static #prepareHook(tags) {\n    Hooks.once(\"renderTagifyApp\", (app, html, options) => {\n      const tagInput = html.querySelector('input[class=\"tah-dialog-tagify\"]');\n\n      if (tagInput) {\n        const options = {\n          delimiters: \";\",\n          maxTags: \"Infinity\",\n          dropdown: {\n            position: \"manual\",\n            maxItems: Infinity, // <- maximum allowed rendered suggestions\n            classname: \"tah-dialog-tags-dropdown\", // <- custom classname for this dropdown, so it could be targeted\n            enabled: 0 // <- show suggestions on focus\n          },\n          templates: {\n            dropdownItemNoMatch() {\n              return \"<div class='empty'>Nothing Found</div>\";\n            }\n          }\n        };\n\n        if (tags.available) options.whitelist = tags.available;\n\n        TagifyApp.tagify = new Tagify(tagInput, options);\n\n        if (tags.selected) TagifyApp.tagify.addTags(tags.selected);\n\n        TagifyApp.dragSort = new DragSort(TagifyApp.tagify.DOM.scope, {\n          selector: `.${TagifyApp.tagify.settings.classNames.tag}`,\n          callbacks: { dragEnd: onDragEnd }\n        });\n\n        /**\n         * On drag end\n         */\n        function onDragEnd() {\n          TagifyApp.tagify.updateValueByDOMTags();\n        }\n\n        const tagifyInput = html.querySelector(\".tagify__input\");\n        if (tagifyInput) {\n          tagifyInput.addEventListener(\"keydown\", event => {\n            if (event.key === \"Enter\") {\n              event.preventDefault();\n              TagifyApp.tagify.addTags(TagifyApp.tagify.state.inputText, !0);\n            }\n          });\n        }\n\n        if (app.constructor.name === \"TagifyAppHud\") return;\n\n        TagifyApp.tagify.dropdown.show();\n        const dropdownLabelElement = document.createElement(\"div\");\n        dropdownLabelElement.classList.add(\"tah-dialog-label\");\n        dropdownLabelElement.innerHTML = game.i18n.localize(\"tokenActionHud.form.hud.availableItems\");\n        TagifyApp.tagify.DOM.scope.parentNode.appendChild(dropdownLabelElement);\n        TagifyApp.tagify.DOM.scope.parentNode.appendChild(TagifyApp.tagify.DOM.dropdown);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Reset Actions within Groups' button is clicked, reset the actor's HUD data.\n   * Only used in the HUD dialog.\n   * @private\n   */\n  static async resetActions() {\n    await foundry.applications.api.DialogV2.confirm({\n      window: {\n        title: game.i18n.localize(\"tokenActionHud.dialog.resetActions.title\")\n      },\n      content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetActions.content\")}</p>`,\n      modal: true,\n      yes: {\n        label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n        callback: async () => {\n          await game.tokenActionHud.resetActorData();\n          Logger.info(\"Actions reset\", true);\n        }\n      },\n      no: {\n        label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Unselect All' button is clicked, unselect all tags\n   */\n  static unselectAllTags() {\n    TagifyApp.tagify.removeAllTags();\n  }\n\n  /* -------------------------------------------- */\n\n  /** @override */\n  _onKeyDown(event) {\n    // Close dialog\n    if (event.key === \"Escape\" && !event.target.className.includes(\"tagify\")) {\n      event.preventDefault();\n      event.stopPropagation();\n      return this.close();\n    }\n\n    // Confirm default choice\n    if (\n      event.key === \"Enter\"\n            && this.data.default\n            && !event.target.className.includes(\"tagify\")\n    ) {\n      event.preventDefault();\n      event.stopPropagation();\n      const defaultChoice = this.data.buttons[this.data.default];\n      return this.submit(defaultChoice);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle form submission\n   * @param {object} event    The event\n   * @param {object} form     The form\n   * @param {object} formData The form data\n   */\n  static async submit(event, form, formData) {\n    const selection = TagifyApp.tagify.value.map(c => {\n      c.id = c.id ?? c.value.slugify({ replacement: \"-\", strict: true });\n      return {\n        id: c.id,\n        listName: c.value,\n        name: c.name ?? c.value,\n        type: c.type\n      };\n    });\n    await this.submit(selection, formData.object);\n  }\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppHud extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppHud\n    }\n  };\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppGroup extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppGroup\n    }\n  };\n}\n\n/* -------------------------------------------- */\n\nexport class TagifyAppSubgroup extends TagifyApp {\n  static PARTS = {\n    form: {\n      template: TEMPLATE.tagifyAppSubgroup\n    }\n  };\n}\n","import { TagifyApp } from \"./tagify-app.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\n/**\n * Generates data for the Tagify application.\n */\nexport class TagifyAppHelper {\n  /**\n   * Show the HUD dialog\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   */\n  static async openEditHudApp(groupHandler) {\n    // Set available and selected tags\n    const tags = {};\n    tags.available = [];\n    tags.selected = await groupHandler.getSelectedGroupsAsTags();\n    const grid = await Utils.getSetting(\"grid\");\n\n    // Set dialog data\n    const dialogData = {\n      title: game.i18n.localize(\"tokenActionHud.form.hud.hudTitle\"),\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.hudDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: { grid }\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      const grid = formData?.grid;\n      await groupHandler.updateGroups(choices, { level: 0 });\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n      await Utils.setSetting(\"grid\", grid);\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    // Show dialog\n    TagifyApp.open(\"hud\", null, tags, dialogData, dialogSubmit);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show group dialog\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   * @param {object} groupData   The group data\n   */\n  static async openEditGroupApp(groupHandler, groupData) {\n    const { nestId, name, level } = groupData;\n\n    // Set available and selected tags\n    const tags = {};\n\n    // Get available subcategories\n    tags.available = await groupHandler.getAvailableGroupAsTags({ nestId, level });\n\n    // Get selected subcategories\n    tags.selected = await groupHandler.getSelectedGroupsAsTags({ nestId, level });\n\n    // Set dialog data\n    const dialogData = {\n      title: `${game.i18n.localize(\"tokenActionHud.form.hud.groupTitle\")}: ${name}`,\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.groupDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: await groupHandler.getGroupSettings(groupData)\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      choices = choices.map(choice => {\n        choice.id =\n                choice.id\n                ?? choice.name.slugify({\n                  replacement: \"-\",\n                  strict: true\n                });\n        choice.type = choice.type ?? \"custom\";\n        return {\n          id: choice.id,\n          listName: choice.listName,\n          name: choice.name,\n          type: choice.type\n        };\n      });\n\n      const characterCount = formData?.characterCount;\n      const customWidth = formData?.customWidth;\n      const grid = formData?.grid;\n      const image = formData?.image;\n      const showTitle = formData?.showTitle;\n      const sort = formData?.sort;\n      groupData.settings = { characterCount, customWidth, grid, image, showTitle, sort };\n\n      // Save selected subcategories to user action list\n      await groupHandler.updateGroups(choices, groupData);\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    TagifyApp.open(\n      \"topLevelGroup\",\n      nestId,\n      tags,\n      dialogData,\n      dialogSubmit\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Show action dialog\n   * @public\n   * @param {class} groupHandler  The GroupHandler instance\n   * @param {class} actionHandler The ActionHandler instance\n   * @param {object} groupData    The group data\n   */\n  static async openEditSubgroupApp(groupHandler, actionHandler, groupData) {\n    const { nestId, name, level } = groupData;\n\n    // Set available and selected tags\n    const tags = {};\n\n    // Get available groups and actions\n    const availableActions = await actionHandler.getAvailableActionsAsTags(groupData);\n    const availableGroups = await groupHandler.getAvailableGroupAsTags({ nestId, level });\n    tags.available = [...availableActions, ...availableGroups];\n\n    // Get selected actions and subcategories\n    const selectedActions = await actionHandler.getSelectedActionsAsTags(groupData);\n    const selectedGroups = await groupHandler.getSelectedGroupsAsTags({ nestId, level });\n    tags.selected = [...selectedActions, ...selectedGroups];\n\n    // Set dialog data\n    const dialogData = {\n      title: `${game.i18n.localize(\"tokenActionHud.form.hud.groupTitle\")}: ${name} `,\n      content: {\n        topLabel: game.i18n.localize(\"tokenActionHud.form.hud.groupDetail\"),\n        placeholder: game.i18n.localize(\"tokenActionHud.form.hud.tagPlaceholder\"),\n        settings: await groupHandler.getGroupSettings(groupData)\n      }\n    };\n\n    // Set function on submit\n    const dialogSubmit = async (choices, formData) => {\n      const selectedGroups = [];\n      const selectedActions = [];\n      for (const choice of choices) {\n        if (choice.type === \"action\") {\n          selectedActions.push(choice);\n        } else {\n          selectedGroups.push(choice);\n        }\n      }\n\n      // Get advanced category options\n      const characterCount = formData?.characterCount;\n      const collapse = formData?.collapse;\n      const customWidth = formData?.customWidth;\n      const grid = formData?.grid;\n      const image = formData?.image;\n      const showTitle = formData?.showTitle;\n      const sort = formData?.sort;\n      const style = formData?._style;\n      groupData.settings = { characterCount, collapse, customWidth, grid, image, showTitle, sort, style };\n\n      // Save subcategories to user action list\n      await groupHandler.updateGroups(selectedGroups, groupData);\n      await actionHandler.updateActions(selectedActions, groupData);\n      await groupHandler.saveGroups({ saveActor: true, saveUser: true });\n\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    };\n\n    TagifyApp.open(\n      \"group\",\n      nestId,\n      tags,\n      dialogData,\n      dialogSubmit\n    );\n  }\n}\n","import { Utils } from \"../core/utils.mjs\";\n\nexport class GroupResizer {\n  constructor(tokenActionHud, hudManager) {\n    this.tokenActionHud = tokenActionHud;\n    this.hudManager = hudManager;\n    this.groupHandler = hudManager.groupHandler;\n    this.minCols = 3;\n    this.isCustomWidth = false;\n    this.settings = null;\n    this.spacing = 10;\n  }\n\n  /**\n   * Resize the groups element\n   * @param {object} groupElement The group element\n   */\n  async resizeGroup(groupElement) {\n    if (!groupElement) return;\n\n    await this.#setVariables(groupElement);\n\n    if (!this.subgroupsElement) return;\n\n    if (!this.tokenActionHud.isDocked) {\n      await this.#setWidth();\n    }\n\n    await this.#setHeight();\n\n    this.#resetVariables();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set variables\n   * @private\n   * @param {object} groupElement The group element\n   */\n  async #setVariables(groupElement) {\n    this.#resetVariables();\n\n    this.groupElement = groupElement;\n\n    // Get groups element\n    await this.#setSubgroupsElement();\n    if (!this.subgroupsElement) return;\n\n    // Reset groups elements\n    this.#resetGroupsElements();\n\n    // Get groups\n    this.#setSubgroupElementArr();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset variables\n   * @private\n   */\n  #resetVariables() {\n    this.actionsElements = null;\n    this.availableHeight = null;\n    this.availableWidth = null;\n    this.gridWidth = null;\n    this.groupElement = null;\n    this.subgroupElementArr = null;\n    this.subgroupsElement = null;\n    this.subgroupsElementPadding = null;\n    this.subgroupsElementRect = null;\n    this.isCustomWidth = false;\n    this.minCols = 3;\n    this.settings = null;\n    this.spacing = 10;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset groups elements\n   */\n  #resetGroupsElements() {\n    const level1GroupElement = this.groupElement.closest('[data-part=\"group\"]');\n    const groupsElements = level1GroupElement.querySelectorAll(\".tah-subgroups\");\n    const style = { maxHeight: \"\", overflowY: \"\" };\n    this.#resetCSS(groupsElements, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the grid width\n   * @private\n   */\n  async #getGridWidth() {\n    // Reset action elements\n    const emptyStyle = { display: \"\", gridTemplateColumns: \"\", width: \"\" };\n    await this.#resetCSS(this.actionsElements, emptyStyle);\n\n    const actionWidths = [];\n    const actionWidthsForMedian = [];\n    for (const actionsElement of this.actionsElements) {\n      const actionElements = actionsElement.querySelectorAll(\".tah-action:not(.shrink)\");\n      for (const actionElement of actionElements) {\n        const actionRect = actionElement.getBoundingClientRect();\n        const actionWidth = Math.round(parseFloat(actionRect.width) + 1 || 0);\n        const actionButtonText = actionElement.querySelector(\".tah-action-button-text\");\n        const actionButtonTextRect = actionButtonText?.getBoundingClientRect();\n        const actionButtonTextWidth = Math.round(parseFloat(actionButtonTextRect?.width) || 0);\n        actionWidthsForMedian.push(actionWidth);\n        actionWidths.push({ actionWidth, actionButtonTextWidth });\n      }\n    }\n\n    let upperQuartileAverage = Math.ceil(Utils.getUpperQuartileAverage(actionWidthsForMedian));\n    const minActionButtonTextWidth = 30;\n\n    for (const actionWidth of actionWidths) {\n      const availableactionButtonTextWidth = upperQuartileAverage\n        - (actionWidth.actionWidth - actionWidth.actionButtonTextWidth);\n      if (availableactionButtonTextWidth < minActionButtonTextWidth) {\n        upperQuartileAverage = (upperQuartileAverage - availableactionButtonTextWidth) + minActionButtonTextWidth;\n      }\n    }\n\n    this.gridWidth = upperQuartileAverage;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Resize the actions element into the grid format\n   * @private\n   * @param {object} actionsElement   The actions element\n   * @param {number} groupCustomWidth The group custom width\n   */\n  async #resizeGrid(actionsElement, groupCustomWidth) {\n    if (!actionsElement) return;\n    const emptyStyle = { display: \"\", gridTemplateColumns: \"\", width: \"\" };\n    await this.#assignCSS(actionsElement, emptyStyle);\n\n    const actions = actionsElement.querySelectorAll(\".tah-action\");\n    const squaredCols = Math.ceil(Math.sqrt(actions.length));\n    const availableGroupWidth = groupCustomWidth ?? this.availableWidth;\n    const availableCols = Math.floor(availableGroupWidth / this.gridWidth);\n    const cols = (squaredCols > availableCols || groupCustomWidth)\n      ? availableCols\n      : (actions.length <= this.minCols) ? actions.length : squaredCols;\n    // Apply maxHeight and width styles to content\n    const style = { display: \"grid\", gridTemplateColumns: `repeat(${cols}, ${this.gridWidth}px)` };\n    await this.#assignCSS(actionsElement, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Resize the actions element\n   * @private\n   * @param {object} actionsElement   The actions element\n   * @param {number} groupCustomWidth The group custom width\n   */\n  async #resize(actionsElement, groupCustomWidth) {\n    if (!actionsElement) return;\n\n    let width = 500;\n\n    if (this.isCustomWidth) {\n      width = this.availableWidth;\n    } else if (groupCustomWidth) {\n      width = groupCustomWidth;\n    } else {\n      const actions = actionsElement.querySelectorAll(\".tah-action\");\n      if (!actions.length) return;\n      const sqrtActions = Math.ceil(Math.sqrt(actions.length)); // 4\n\n      // Initialize variables\n      let currentRow = 1;\n      let maxRowWidth = 0;\n      let rowWidth = 0;\n      // Iterate through action groups, calculating dimensions and counts\n      if (actions.length > 0) {\n        actions.forEach((action, index) => {\n          if ((index + 1) / sqrtActions > currentRow) {\n            rowWidth = rowWidth - 5;\n            maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth;\n            rowWidth = 0;\n            currentRow++;\n          }\n          const actionRect = action.getBoundingClientRect();\n          const actionWidth = Math.ceil(parseFloat(actionRect.width) + 1 || 0);\n          rowWidth += actionWidth;\n          if (index + 1 === actions.length) {\n            rowWidth = rowWidth - 5;\n            maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth;\n          }\n        });\n      }\n\n      // Add padding to maxAvgGroupWidth and maxGroupWidth\n      maxRowWidth += this.subgroupsElementPadding;\n\n      // Determine width of content\n      width = (maxRowWidth < this.availableWidth && actions.length > 3) ? maxRowWidth : this.availableWidth;\n      if (width < 200) width = 200;\n    }\n\n    const style = { maxWidth: `${width}px` };\n    await this.#assignCSS(actionsElement, style);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available content width\n   * @private\n   * @returns {number} The available content width\n   */\n  #getAvailableWidth() {\n    const customWidth = this.settings?.customWidth;\n\n    if (customWidth) {\n      this.isCustomWidth = true;\n      return customWidth;\n    }\n\n    const windowWidth = canvas.screenDimensions[0] || window.innerWidth;\n    const contentLeft = this.subgroupsElementRect.left;\n    const uiRight = document.querySelector(\"#ui-right\");\n    const uiRightClientWidth = uiRight.clientWidth;\n    return Math.floor((\n      uiRightClientWidth > 0\n        ? windowWidth - uiRightClientWidth\n        : windowWidth\n    ) - this.spacing - contentLeft);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get subgroups element\n   * @private\n   */\n  async #setSubgroupsElement() {\n    this.subgroupsElement = this.groupElement.querySelector('[data-part=\"subgroups\"]');\n    if (!this.subgroupsElement) return;\n    this.subgroupsElementRect = this.subgroupsElement.getBoundingClientRect();\n    this.subgroupsElementComputed = getComputedStyle(this.subgroupsElement);\n    this.subgroupsElementPadding =\n      Math.ceil(parseFloat(this.subgroupsElementComputed.paddingLeft) || 0)\n      + Math.ceil(parseFloat(this.subgroupsElementComputed.paddingRight) || 0);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get subgroup elements\n   * @private\n   */\n  #setSubgroupElementArr() {\n    this.subgroupElementArr = this.groupElement.querySelectorAll('[data-part=\"subgroup\"]');\n    if (this.subgroupElementArr.length === 0) this.subgroupElementArr = [this.groupElement];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the width\n   */\n  async #setWidth() {\n    this.actionsElements = this.groupElement.querySelectorAll('[data-part=\"actions\"]');\n\n    // Exit early if no action elements exist\n    if (this.actionsElements.length === 0) return;\n\n    // Get group settings\n    const nestId = this.groupElement.dataset.nestId;\n    this.settings = await this.groupHandler.getGroupSettings({ nestId, level: 1 });\n\n    // Get available width\n    this.availableWidth = this.#getAvailableWidth();\n\n    // Loop groups\n    let hasGrid = false;\n    for (const subgroupElement of this.subgroupElementArr) {\n      const actionsElement = subgroupElement.querySelector('[data-part=\"actions\"]');\n      if (!actionsElement) continue;\n      const nestId = subgroupElement.dataset.nestId;\n      const groupSettings = await this.groupHandler.getGroupSettings({ nestId });\n      const groupCustomWidth = groupSettings.customWidth;\n      const grid = Utils.getSetting(\"grid\") || this.settings?.grid || groupSettings?.grid || actionsElement.style.display;\n      if (grid) {\n        if (!hasGrid) {\n          await this.#getGridWidth();\n          hasGrid = true;\n        }\n        await this.#resizeGrid(actionsElement, groupCustomWidth);\n      } else {\n        await this.#resize(actionsElement, groupCustomWidth);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the height\n   * @private\n   */\n  async #setHeight() {\n    await new Promise(resolve => {\n      requestAnimationFrame(() => {\n        this.availableHeight = this.#getAvailableHeight();\n        const style = { maxHeight: `${this.availableHeight}px`, overflowY: \"auto\" };\n        Object.assign(this.subgroupsElement.style, style);\n        resolve();\n      });\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available height\n   * @private\n   * @returns {number} The available height\n   */\n  #getAvailableHeight() {\n    const windowHeight = canvas.screenDimensions[1] || window.innerHeight;\n    const contentBottom = this.subgroupsElementRect.bottom;\n    const contentTop = this.subgroupsElementRect.top;\n\n    let uiTopBottom = null;\n    if (this.tokenActionHud.isDocked) {\n      let siblingsHeight = 0;\n      let sibling = this.groupElement.nextElementSibling;\n\n      if (sibling) {\n        const siblings = [sibling];\n        while (sibling) {\n          sibling = sibling.nextElementSibling;\n          if (sibling) siblings.push(sibling);\n        }\n        for (const sibling of siblings) {\n          const siblingHeight = sibling.getBoundingClientRect().height;\n          siblingsHeight += siblingHeight ?? 0;\n        }\n      }\n\n      return Math.max(windowHeight - contentTop - siblingsHeight - this.spacing, 100);\n    } else if (this.tokenActionHud.direction === \"down\") {\n      if (foundry.utils.isNewerVersion(game.version, \"12.999\")) {\n        uiTopBottom = document.querySelector(\"#hotbar\");\n      } else {\n        uiTopBottom = document.querySelector(\"#ui-bottom\");\n      }\n    } else if (foundry.utils.isNewerVersion(game.version, \"12.999\")) {\n      uiTopBottom = document.querySelector(\"scene-navigation-active\");\n    } else {\n      uiTopBottom = document.querySelector(\"#ui-top\");\n    }\n    const uiTopBottomOffsetHeight = uiTopBottom?.offsetHeight ?? 0;\n    const availableHeight = (this.tokenActionHud.direction === \"down\")\n      ? windowHeight - contentTop - uiTopBottomOffsetHeight - this.spacing\n      : contentBottom - uiTopBottomOffsetHeight - this.spacing;\n    return Math.max(availableHeight, 100);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Assign CSS\n   * @private\n   * @param {object} element The DOM element\n   * @param {object} style   The style\n   */\n  async #assignCSS(element, style) {\n    if (!element) return;\n    requestAnimationFrame(() => {\n      Object.assign(element.style, style);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset CSS\n   * @private\n   * @param {Array} elements The DOM elements\n   * @param {object} style   The style\n   */\n  async #resetCSS(elements, style) {\n    for (const element of elements) {\n      Object.assign(element.style, style);\n    }\n  }\n}\n","import { HudManager } from \"../managers/hud-manager.mjs\";\nimport { TagifyAppHelper } from \"./tagify-app-helper.mjs\";\nimport { GroupResizer } from \"../handlers/group-resizer.mjs\";\nimport { HUD, MODULE, SETTING, TEMPLATE } from \"../core/constants.mjs\";\nimport { Logger, Timer, Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\n/**\n * Token Action HUD application\n */\nexport class TokenActionHud extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(systemManager, dataHandler, socket) {\n    super();\n    this.systemManager = systemManager;\n    this.dataHandler = dataHandler;\n    this.hudManager = new HudManager(this, systemManager, dataHandler, socket);\n    this.socket = socket;\n    this.openGroups = new Set();\n    this.updatePendingTimer = new Timer(10);\n    this.updateTimer = new Timer(10);\n    this.closeTimer = null;\n    this.renderTimer = null;\n    this.setting = {};\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Merge Token Action Hud's default options with ApplicationV2\n   * @override\n   */\n  static DEFAULT_OPTIONS = {\n    actions: {\n      clickGroup: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickGroup\n      },\n      clickSubgroup: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickSubgroup\n      },\n      clickAction: {\n        buttons: [0, 2],\n        handler: TokenActionHud.clickAction\n      },\n      collapseHud: TokenActionHud.collapseHud,\n      expandHud: TokenActionHud.expandHud,\n      lockHud: TokenActionHud.lockHud,\n      unlockHud: TokenActionHud.unlockHud,\n      editHud: TokenActionHud.editHud\n    },\n    background: \"none\",\n    id: \"token-action-hud-app\",\n    position: {\n      width: HUD.DEFAULT_WIDTH,\n      height: HUD.DEFAULT_HEIGHT,\n      left: HUD.DEFAULT_LEFT_POS,\n      top: HUD.DEFAULT_TOP_POS,\n      scale: HUD.DEFAULT_SCALE,\n      zIndex: HUD.DEFAULT_ZINDEX\n    },\n    window: {\n      frame: false,\n      title: \"token-action-hud\"\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  /**\n   * Define template parts\n   */\n  static PARTS = {\n    form: {\n      template: TEMPLATE.hud\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare context\n   * @override\n   */\n  async _prepareContext() {\n    const styleData = this.systemManager.styles[this.setting.style];\n    const styleClass = foundry.utils.isNewerVersion(game.version, \"12.999\") && [\"dockedLeft\", \"dockedCenterRight\", \"dockedRight\"].includes(this.setting.style)\n      ? `${styleData.class}-v13`\n      : styleData.class;\n    const context = {\n      hud: this.hudManager.hud,\n      id: \"token-action-hud\",\n      style: styleClass ?? \"\",\n      scale: this.scale,\n      background: \"#00000000\",\n      collapseIcon: styleData.collapseIcon ?? \"fa-caret-left\",\n      expandIcon: styleData.expandIcon ?? \"fa-caret-right\",\n      collapsibleSubgroups: Utils.getSetting(\"collapsibleSubgroups\")\n    };\n\n    Logger.debug(\"Application context\", { context });\n    return context;\n  }\n\n  /* -------------------------------------------- */\n  /* SETTINGS                                     */\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the HUD\n   * @public\n   */\n  async init() {\n    this.#cacheSettings();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Cache settings for slightly faster retrieval\n   */\n  #cacheSettings() {\n    Object.entries(SETTING).forEach(([key, value]) => {\n      if (value.cache) {\n        this.setting[key] = Utils.getSetting(key);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update cached settings following changes\n   * @param {string} key The setting key\n   * @param {*|null} value      The setting value\n   * @public\n   */\n  async updateCachedSettings(key, value = null) {\n    if (!this.updateSettingsPending) {\n      this.updateSettingsPending = true;\n      Logger.debug(\"Updating settings...\");\n    }\n\n    if (!SETTING[key]) return;\n    if (!SETTING[key].cache) return;\n\n    this.setting[key] = value;\n\n    switch (key) {\n      case \"customLayout\":\n      case \"userCustomLayout\":\n        this.hudManager.layoutHandler.customLayout = null;\n        break;\n      case \"rollHandler\":\n        this.hudManager.rollHandler = this.systemManager.getRollHandlerCore(this.hudManager.actionHandler);\n        break;\n      case \"style\":\n        this.setPosition();\n    }\n  }\n\n  /* -------------------------------------------- */\n  /* RENDER                                       */\n  /* -------------------------------------------- */\n\n  /**\n   * On render\n   * @param {options} context The context\n   * @param {options} options The options\n   */\n  _onRender(context, options) {\n    super._onRender(context, options);\n    this.element.classList.remove(\"tah-closed\");\n    Utils.switchCSS(this.setting.style);\n    clearTimeout(this.closeTimer);\n    clearTimeout(this.renderTimer);\n    this.#cacheElements();\n    this.#setInitialHudState();\n    this.#addHoverEvents(this.elements);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Cache HUD elements\n   */\n  #cacheElements() {\n    this.elements = {\n      characterName: this.element.querySelector(\"[data-part=\\\"characterName\\\"]\"),\n      actionArr: this.element.querySelectorAll(\"[data-part=\\\"action\\\"]\"),\n      buttons: this.element.querySelector(\"[data-part=\\\"buttons\\\"]\"),\n      tabSubgroupArr: this.element.querySelectorAll(\"[data-group-type=\\\"tab\\\"]\"),\n      groups: this.element.querySelector(\"[data-part=\\\"groups\\\"]\"),\n      editHudButton: this.element.querySelector(\"[data-part=\\\"editHudButton\\\"]\"),\n      listSubgroupsArr: this.element.querySelectorAll(\"[data-part=\\\"listSubgroups\\\"]\"),\n      subgroupsContainerArr: this.element.querySelectorAll(\"[data-part=\\\"subgroupsContainer\\\"]\"),\n      subgroupArr: this.element.querySelectorAll(\"[data-part=\\\"subgroup\\\"]\"),\n      listSubgroupTitleArr: this.element.querySelectorAll(\"[data-part=\\\"listSubgroupTitle\\\"]\"),\n      groupButtonArr: this.element.querySelectorAll(\"[data-part=\\\"groupButton\\\"]\"),\n      collapseExpandContainer: this.element.querySelector(\"[data-part=\\\"collapseExpandContainer\\\"]\"),\n      collapseHudButton: this.element.querySelector(\"[data-part=\\\"collapseHudButton\\\"]\"),\n      expandHudButton: this.element.querySelector(\"[data-part=\\\"expandHudButton\\\"]\"),\n      unlockButton: this.element.querySelector(\"[data-part=\\\"unlockHudButton\\\"]\"),\n      lockButton: this.element.querySelector(\"[data-part=\\\"lockHudButton\\\"]\")\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the initial state of the HUD (collapsed or expanded, locked or unlocked)\n   * @private\n   */\n  #setInitialHudState() {\n    if (this.isCollapsed) { TokenActionHud.collapseHud.call(this); }\n\n    if (Utils.getSetting(\"enableCustomization\")) {\n      if (this.isUnlocked) {\n        TokenActionHud.unlockHud.call(this);\n      } else {\n        TokenActionHud.lockHud.call(this);\n      }\n    } else {\n      TokenActionHud.lockHud.call(this);\n      this.elements.unlockButton.classList.add(\"tah-hidden\");\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add hover events\n   * @param {object} elements The elements\n   */\n  #addHoverEvents(elements) {\n    if (!Utils.getSetting(\"clickOpenCategory\")) {\n      // When a category button is hovered over...\n      elements.tabSubgroupArr.forEach(element => {\n        element.addEventListener(\"touchstart\", this.toggleGroup.bind(this), { passive: true });\n        element.addEventListener(\"pointerenter\", this.toggleGroup.bind(this));\n        element.addEventListener(\"pointerleave\", this.toggleGroup.bind(this));\n      });\n    }\n\n    // When a category button is clicked and held...\n    if (!this.isDocked) {\n      elements.groupButtonArr.forEach(element => {\n        element.addEventListener(\"mousedown\", this.#dragEvent.bind(this));\n        element.addEventListener(\"touchstart\", this.#dragEvent.bind(this), { passive: true });\n      });\n    }\n\n    // When an action is hovered...\n    elements.actionArr.forEach(element => {\n      element.addEventListener(\"pointerenter\", this.handleActionHover.bind(this));\n      element.addEventListener(\"pointerleave\", this.handleActionHover.bind(this));\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* POST-RENDER                                  */\n  /* -------------------------------------------- */\n\n  /**\n   * Functions to execute after the application is rendered\n   */\n  postRender() {\n    this.rendering = false;\n    this.#applyDirection();\n    this.#reopenGroups();\n    if (!this.isCollapsed) {\n      this.renderTimer = setTimeout(() => {\n        requestAnimationFrame(() => {\n          this.element?.classList?.add(\"tah-expanded\");\n        });\n      }, 25);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Apply classes for HUD direction\n   * @private\n   */\n  #applyDirection() {\n    if (this.isDocked) return;\n\n    const { characterName, subgroupsContainerArr } = this.elements;\n\n    if (this.direction === \"up\") {\n      characterName?.classList?.add(\"tah-hidden\");\n\n      subgroupsContainerArr.forEach(element => {\n        element.classList.remove(\"expand-down\");\n        element.classList.add(\"expand-up\");\n      });\n    } else {\n      if (!this.isCollapsed) {\n        characterName?.classList?.remove(\"tah-hidden\");\n      }\n\n      subgroupsContainerArr.forEach(element => {\n        element.classList.add(\"expand-down\");\n        element.classList.remove(\"expand-up\");\n      });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reopen groups following a re-render of the HUD\n   * @private\n   */\n  #reopenGroups() {\n    if (!this.openGroups.size) return;\n\n    this.openGroups.forEach(groupId => {\n      const group = this.element.querySelector(`#${groupId}`);\n      if (group) {\n        this.toggleGroup(null, group);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* INTERACTIVITY                                */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Edit HUD' button is clicked, open the Edit HUD app\n   */\n  static editHud() {\n    TagifyAppHelper.openEditHudApp(this.hudManager.groupHandler);\n  }\n\n  /* -------------------------------------------- */\n  /* ENABLE/DISABLE HUD                           */\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the HUD enabled state\n   */\n  async toggleHudEnable() {\n    const binding = Utils.humanizeBinding(\"enableDisableHud\");\n    const state = (this.isEnabled) ? \"disabled\" : \"enabled\";\n    if (this.isEnabled) {\n      this.#close();\n    } else {\n      Hooks.callAll(\"forceUpdateTokenActionHud\");\n    }\n    await Utils.setSetting(\"enable\", !this.isEnabled);\n    Logger.info(game.i18n.format(`tokenActionHud.keybinding.toggleHud.${state}`, { binding }), true);\n  }\n\n  /* -------------------------------------------- */\n  /* COLLAPSE/EXPAND HUD                          */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Collapse HUD' button is clicked, collapse the HUD\n   */\n  static collapseHud() {\n    this.toggleHudCollapse(\"collapse\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Expand HUD' button is clicked, expand the HUD\n   */\n  static expandHud() {\n    this.toggleHudCollapse(\"expand\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the HUD between collapse and expand states\n   * @param {string} state The state (\"collapse\" or \"expand\")\n   */\n  toggleHudCollapse(state) {\n    state = state ?? ((this.isCollapsed) ? \"expand\" : \"collapse\");\n    const isCollapsing = state === \"collapse\";\n    const { characterName, collapseHudButton, expandHudButton, groups, buttons } = this.elements;\n\n    collapseHudButton.classList.toggle(\"tah-hidden\", isCollapsing);\n    expandHudButton.classList.toggle(\"tah-hidden\", !isCollapsing);\n\n    if (this.isDocked) {\n      this.element.classList.toggle(\"tah-expanded\", !isCollapsing);\n    } else {\n      if (this.direction === \"down\") { characterName.classList.toggle(\"tah-hidden\", isCollapsing); }\n      groups.classList.toggle(\"tah-hidden\", isCollapsing);\n      buttons.classList.toggle(\"tah-hidden\", isCollapsing);\n    }\n\n    this.isCollapsed = isCollapsing;\n  }\n\n  /* -------------------------------------------- */\n  /* LOCK/UNLOCK HUD                              */\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Unlock HUD' button is clicked, unlock the HUD\n   * @param {object|null} event The event\n   */\n  static async unlockHud(event = null) {\n    this.toggleHudLock(\"unlock\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When the 'Lock HUD' button is clicked, lock the HUD\n   * @param {object|null} event The event\n   */\n  static async lockHud(event = null) {\n    this.toggleHudLock(\"lock\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle HUD lock state\n   * @param {string} state      The state (\"lock\" or \"unlock\")\n   * @param {object|null} event The event\n   */\n  toggleHudLock(state, event = null) {\n    if (event) event.preventDefault();\n\n    const isUnlocking = state === \"unlock\";\n    const { unlockButton, lockButton, editHudButton, subgroupArr, groupButtonArr,\n      groups, listSubgroupsArr, tabSubgroupArr, listSubgroupTitleArr } = this.elements;\n\n    // Toggle button visibiltiy\n    unlockButton.classList.toggle(\"tah-hidden\", isUnlocking);\n    lockButton.classList.toggle(\"tah-hidden\", !isUnlocking);\n    editHudButton.classList.toggle(\"tah-hidden\", !isUnlocking);\n\n    // Toggle class for styling when unlocked/locked\n    groups.classList.toggle(\"tah-unlocked\", isUnlocking);\n\n    // Helper function to toggle classes\n    const toggleElements = (elements, className, toggle) => {\n      elements.forEach(element => element.classList.toggle(className, toggle));\n    };\n\n    toggleElements(groupButtonArr, \"disable-edit\", !isUnlocking);\n    toggleElements(listSubgroupTitleArr, \"disable-edit\", !isUnlocking);\n\n    if (isUnlocking) {\n      // When the HUD is unlocked, unhide elements\n      toggleElements(subgroupArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(listSubgroupsArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(tabSubgroupArr, \"tah-hidden\", !isUnlocking);\n      toggleElements(listSubgroupTitleArr, \"tah-hidden\", !isUnlocking);\n    } else {\n      // When the HUD is locked, hide elements that have no underlying actions\n      const hideIfEmpty = elements => {\n        elements.forEach(element => {\n          const hasActions = element.querySelectorAll(\".tah-action\").length > 0;\n          if (!hasActions) element.classList.add(\"tah-hidden\");\n        });\n      };\n\n      hideIfEmpty(tabSubgroupArr);\n      hideIfEmpty(subgroupArr);\n      hideIfEmpty(listSubgroupsArr);\n\n      listSubgroupTitleArr.forEach(element => {\n        const groupElement = element.closest(\".tah-subgroup\");\n        if (groupElement.dataset?.showTitle === \"false\") {\n          element.classList.add(\"tah-hidden\");\n        }\n      });\n    }\n\n    this.isUnlocked = isUnlocking;\n  }\n\n  /* -------------------------------------------- */\n  /* GROUP EVENTS                                 */\n  /* -------------------------------------------- */\n\n  /**\n   * When a group is clicked\n   * @param {object} event The event\n   */\n  static clickGroup(event) {\n    this.bringToFront();\n\n    // Remove focus to allow core ESC interactions\n    event.currentTarget.blur();\n\n    if (event.type === \"contextmenu\") {\n      if (this.isUnlocked) {\n        this.openEditGroupApp(event);\n      } else {\n        this.handleGroupClick(event);\n      }\n    } else if (Utils.getSetting(\"clickOpenCategory\")) {\n      this.toggleGroup(event);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * When a subgroup is clicked\n   * @param {object} event The event\n   */\n  static clickSubgroup(event) {\n    if (event.type === \"contextmenu\") {\n      if (this.isUnlocked) {\n        this.openEditGroupApp(event);\n      } else {\n        this.handleGroupClick(event);\n      }\n    } else {\n      const group = Utils.getClosestGroupElement(event);\n      if (group.dataset?.groupType === \"tab\") {\n        this.toggleGroup(event, group);\n      } else {\n        this.collapseExpandSubgroup(event);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle the visibility of the group\n   * @param {object} event The event\n   * @param {object} group The group element\n   */\n  toggleGroup(event = null, group = null) {\n    group = group || Utils.getClosestGroupElement(event);\n    const isOpen = group.classList.contains(\"hover\");\n    const shouldOpen = !isOpen;\n    if ((isOpen && event?.type === \"pointerenter\") || (!isOpen && event?.type === \"pointerleave\")) return;\n    group.classList.toggle(\"hover\", shouldOpen);\n    if (shouldOpen) {\n      this.#toggleOtherGroups(group);\n      const groupResizer = new GroupResizer(this, this.hudManager);\n      groupResizer.resizeGroup(group);\n\n      this.openGroups.add(group.id);\n    } else {\n      this.openGroups.delete(group.id);\n    }\n    // Remove focus to allow core ESC interactions\n    if (event) event.currentTarget.blur();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Toggle visibility of other groups\n   * @private\n   * @param {string} groupToIgnore The group to ignore\n   */\n  #toggleOtherGroups(groupToIgnore) {\n    if (!this.openGroups.size) return;\n\n    this.openGroups.forEach(groupId => {\n      if (groupId === groupToIgnore.id) return;\n      const group = this.element.querySelector(`#${groupId}`);\n      // If group no longer exists on the HUD, delete it\n      if (!group) {\n        this.openGroups.delete(groupId);\n      }\n      const isParentToIgnore = group.querySelector(`#${groupToIgnore.id}`);\n      if (group && !isParentToIgnore) {\n        this.toggleGroup(null, group);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Collapse/expand a subgroup\n   * @param {object} event                       The event\n   */\n  collapseExpandSubgroup(event) {\n    if (!Utils.getSetting(\"collapsibleSubgroups\")) return;\n\n    const target = event.target.closest('[data-part=\"listSubgroupTitle\"]');\n\n    const groupElement = Utils.getClosestGroupElement(event);\n    const nestId = groupElement?.dataset?.nestId;\n    const tabSubgroup = target.closest(\".tah-tab-subgroup.hover\");\n    const groupsElement = groupElement?.querySelector(\"[data-part=\\\"subgroups\\\"]\");\n    const collapseIcon = target.querySelector(\".tah-collapse-icon\");\n    const expandIcon = target.querySelector(\".tah-expand-icon\");\n    const imageElement = groupElement.querySelector(\".tah-list-image\");\n\n    const toggleGroupVisibility = () => {\n      groupsElement?.classList.toggle(\"tah-hidden\");\n      collapseIcon?.classList.toggle(\"tah-hidden\");\n      expandIcon?.classList.toggle(\"tah-hidden\");\n      imageElement?.classList.toggle(\"tah-hidden\");\n    };\n\n    const saveGroupSettings = collapse => {\n      if (Utils.getSetting(\"enableCustomization\")) {\n        this.hudManager.groupHandler.saveGroupSettings({ nestId, settings: { collapse } });\n      }\n    };\n\n    if (groupsElement?.classList.contains(\"tah-hidden\")) {\n      toggleGroupVisibility();\n      saveGroupSettings(false);\n      const groupResizer = new GroupResizer(this, this.hudManager);\n      groupResizer.resizeGroup(tabSubgroup);\n    } else {\n      toggleGroupVisibility();\n      saveGroupSettings(true);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle when a group is clicked\n   * @param {object} event The event\n   */\n  handleGroupClick(event) {\n    this.hudManager.handleHudEvent(\"groupClick\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Open the 'Edit Group' or 'Edit Subgroup' app\n   * @param {object} event\n   */\n  openEditGroupApp(event) {\n    const group = Utils.getClosestGroupElement(event);\n    const { nestId, level, type } = group.dataset;\n    if (!nestId) return;\n    const name = this.hudManager.groupHandler.groups[nestId].name;\n    const parsedLevel = parseInt(level, 10) || null;\n\n    if (parsedLevel === 1) {\n      TagifyAppHelper.openEditGroupApp(\n        this.hudManager.groupHandler,\n        { nestId, name, level: parsedLevel, type }\n      );\n    } else {\n      TagifyAppHelper.openEditSubgroupApp(\n        this.hudManager.groupHandler,\n        this.hudManager.actionHandler,\n        { nestId, name, level: parsedLevel, type }\n      );\n    }\n\n  }\n\n  /* -------------------------------------------- */\n  /* ACTION EVENTS                                */\n  /* -------------------------------------------- */\n\n  /**\n   * When an action is clicked\n   * @param {object} event The event\n   */\n  static clickAction(event) {\n    event.preventDefault();\n    this.hudManager.handleHudEvent(\"clickAction\", event);\n    event.currentTarget.blur();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle when an action is hovered\n   * @param {object} event The event\n   */\n  handleActionHover(event) {\n    this.hudManager.handleHudEvent(\"hoverAction\", event);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Drag event handler\n   * @private\n   * @param {object} event The event\n   */\n  #dragEvent(event) {\n    if (!this.isDraggable) return;\n\n    // Get the main element\n    const element = this.element;\n\n    const clientX = event.clientX ?? event.changedTouches[0].clientX;\n    const clientY = event.clientY ?? event.changedTouches[0].clientY;\n\n    // Initialise positions and starting positions\n    let pos1 = 0;\n    let pos2 = 0;\n    let pos3 = clientX;\n    let pos4 = clientY;\n    const originalElementTop = element.offsetTop;\n    const originalElementLeft = element.offsetLeft;\n    let newElementTop = originalElementTop;\n    let newElementLeft = originalElementLeft;\n\n    /**\n     * Mouse movement event handler\n     * @param {object} event The event\n     */\n    const mouseMoveEvent = event => {\n      const clientX = event.clientX ?? event.changedTouches[0].clientX;\n      const clientY = event.clientY ?? event.changedTouches[0].clientY;\n      pos1 = pos3 - clientX;\n      pos2 = pos4 - clientY;\n      pos3 = clientX;\n      pos4 = clientY;\n\n      // If the mouse has not moved, do not update\n      if (pos1 === pos3 && pos2 === pos4) return;\n\n      newElementTop = newElementTop - pos2;\n      newElementLeft = newElementLeft - pos1;\n\n      this.topPos = newElementTop;\n\n      // Apply styles\n      requestAnimationFrame(() => {\n        Object.assign(element.style, { left: `${newElementLeft}px`, top: `${newElementTop}px` });\n      });\n    };\n\n    /* -------------------------------------------- */\n\n    /**\n     * Mouse up event handler\n     */\n    const mouseUpEvent = () => {\n      // Remove the mouse move and touch move events\n      document.onmousemove = null;\n      element.ontouchmove = null;\n\n      // Remove the mouse up and touch end events\n      document.onmouseup = null;\n      element.ontouchend = null;\n\n      // If position has not changed, do not update\n      if (newElementTop === originalElementTop && newElementLeft === originalElementLeft) return;\n\n      this.topPos = newElementTop;\n\n      this.#applyDirection();\n\n      // Save the new position to the user's flags\n      this.hudPosition = { top: newElementTop, left: newElementLeft };\n    };\n\n    // Bind mouse move and touch move events\n    document.onmousemove = mouseMoveEvent;\n    element.ontouchmove = mouseMoveEvent;\n\n    // Bind mouse up and touch end events\n    document.onmouseup = mouseUpEvent;\n    element.ontouchend = mouseUpEvent;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set position of the HUD\n   * @public\n   */\n  setPosition() {\n    if (!this.hudManager.hud) return;\n    if (this.isDocked) {\n      this.#setDockedPosition();\n    } else {\n      this.#setUndockedPosition();\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set docked position\n   */\n  #setDockedPosition() {\n    this.element.style.top = 0;\n    this.element.style.left = 0;\n\n    const interfaceElement = document.querySelector(\"#interface\");\n    const dockPosition = this.systemManager.styles[this.setting.style]?.dockPosition;\n    const isV13 = foundry.utils.isNewerVersion(game.version, \"12.999\");\n\n    switch (dockPosition) {\n      case \"right\":\n        if (isV13) {\n          const sidebarElement = document.querySelector(\"#sidebar\");\n          sidebarElement.prepend(this.element);\n        } else {\n          interfaceElement.appendChild(this.element);\n        }\n        break;\n      case \"center-right\":\n        const rightUiElement = interfaceElement.querySelector(\"#ui-right\");\n        if (isV13) {\n          rightUiElement.prepend(this.element);\n        } else {\n          interfaceElement.insertBefore(this.element, rightUiElement);\n        }\n        break;\n      case \"left\":\n        const leftUiElement = interfaceElement.querySelector(\"#ui-left\");\n        if (isV13) {\n          leftUiElement.prepend(this.element);\n        } else {\n          interfaceElement.insertBefore(this.element, leftUiElement);\n        }\n        break;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set undocked position\n   */\n  #setUndockedPosition() {\n    document.body.appendChild(this.element);\n    this.#setPositionFromFlag();\n    this.#applyDirection();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set the position of the HUD based on user flag\n   * @private\n   */\n  #setPositionFromFlag() {\n    if (!this.hudPosition) {\n      this.element.style.top = `${HUD.DEFAULT_TOP_POS}px`;\n      this.element.style.left = `${HUD.DEFAULT_LEFT_POS}px`;\n      return;\n    }\n\n    return new Promise(resolve => {\n      const check = () => {\n        if (this.element) {\n          this.element.style.bottom = null;\n          this.topPos = this.hudPosition.top < 5 || this.hudPosition.top > window.innerHeight + 5\n            ? HUD.DEFAULT_TOP_POS\n            : this.hudPosition.top ?? HUD.DEFAULT_TOP_POS;\n          this.leftPos = this.hudPosition.left < 5 || this.hudPosition.left > window.innerWidth + 5\n            ? HUD.DEFAULT_LEFT_POS\n            : this.hudPosition.left ?? HUD.DEFAULT_LEFT_POS;\n          this.element.style.top = `${this.topPos}px`;\n          this.element.style.left = `${this.leftPos}px`;\n          resolve();\n        } else {\n          setTimeout(check, 10);\n        }\n      };\n\n      check();\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The direction the HUD will expand\n   * @private\n   * @returns {string} The direction\n   */\n  get direction() {\n    const direction = Utils.getSetting(\"direction\");\n    if (direction === \"up\" || (direction === \"auto\" && this.topPos > window.innerHeight / 2)) return \"up\";\n    return \"down\";\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The HUD position\n   * @returns {object} The HUD position\n   */\n  get hudPosition() {\n    return Utils.getUserFlag(\"position\");\n  }\n\n  set hudPosition(obj) {\n    Utils.setUserFlag(\"position\", obj);\n    Logger.debug(`Position set to x: ${obj.top}px, y: ${obj.left}px`);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is enabled\n   * @returns {boolean} Whether the HUD is enabled\n   */\n  get isEnabled() {\n    return Utils.getSetting(\"enable\");\n  }\n\n  set isEnabled(bool) {\n    Utils.setSetting(\"enable\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is collapsed\n   * @returns {boolean} Whether the HUD is collapsed\n   */\n  get isCollapsed() {\n    return Utils.getUserFlag(\"isCollapsed\");\n  }\n\n  set isCollapsed(bool) {\n    Utils.setUserFlag(\"isCollapsed\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is docked\n   * @returns {boolean} Whether the HUD is docked\n   */\n  get isDocked() {\n    const style = this.systemManager.styles[this.setting.style];\n    return style.isDocked || style.dockPosition;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is unlocked\n   * @returns {boolean} Whether the HUD is unlocked\n   */\n  get isUnlocked() {\n    return Utils.getUserFlag(\"isUnlocked\");\n  }\n\n  set isUnlocked(bool) {\n    Utils.setUserFlag(\"isUnlocked\", bool);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the HUD is draggable\n   * @returns {boolean} Whether the HUD is draggable\n   */\n  get isDraggable() {\n    const drag = Utils.getSetting(\"drag\");\n    return ((drag === \"always\") || (drag === \"whenUnlocked\" && this.isUnlocked));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * The HUD scale\n   * @private\n   * @returns {number} The scale\n   */\n  get scale() {\n    if (this.isDocked) return 1;\n    const scale = parseFloat(Utils.getSetting(\"scale\")) || 1;\n    return Math.min(Math.max(scale, 0.5), 2);\n  }\n\n  /**\n   * Reset the position of the HUD\n   * @public\n   */\n  async resetPosition() {\n    Logger.debug(\"Resetting position...\");\n    this.hudPosition = { top: HUD.DEFAULT_TOP_POS, left: HUD.DEFAULT_LEFT_POS };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Copy user's data to others users\n   * @public\n   * @param {string} fromUserId        The user id to copy from\n   * @param {string | Array} toUserIds The user ids to copy to\n   */\n  async copy(fromUserId, toUserIds) {\n    await this.#copyUserData(fromUserId, toUserIds);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Copy user's data to others users\n   * @private\n   * @param {string} fromUserId        The user id to copy from\n   * @param {string | Array} toUserIds The user ids to copy to\n   */\n  async #copyUserData(fromUserId, toUserIds) {\n    if (!game.user.isGM) {\n      Logger.info(\"Copy failed: User is not a GM\", true);\n      return;\n    }\n    // Exit if parameters are missing\n    if (!fromUserId || !toUserIds.length) {\n      Logger.info(\"Copy failed: Parameters missing\", true);\n      return;\n    }\n\n    Logger.debug(\"Copying user data to users...\");\n\n    const fromGroup = await this.dataHandler.getDataAsGm({ type: \"user\", id: fromUserId });\n\n    if (typeof toUserIds === \"string\") {\n      await this.dataHandler.saveDataAsGm(\"user\", toUserIds, fromGroup);\n    } else if (Array.isArray(toUserIds)) {\n      for (const userId of toUserIds) {\n        await this.dataHandler.saveDataAsGm(\"user\", userId, fromGroup);\n      }\n    }\n\n    Logger.debug(\"User data copied to users\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset the HUD layout with the socket\n   */\n  static async resetLayoutWithSocket() {\n    game?.tokenActionHud?.resetLayout();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset the HUD layout\n   */\n  async resetLayout() {\n    Logger.debug(\"Resetting layout...\");\n    await this.resetUserAndActorData();\n    this.resetPosition();\n    Logger.debug(\"Layout reset\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset current actor's HUD data\n   */\n  async resetActorData() {\n    Logger.debug(\"Resetting actor data...\");\n\n    await this.dataHandler.saveDataAsGm(\"actor\", this.hudManager.actor.id, {});\n\n    Logger.debug(\"Actor data reset\");\n\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset every actor's HUD data\n   * @public\n   */\n  async resetAllActorData() {\n    Logger.debug(\"Resetting all actor data...\");\n\n    for (const actor of game.actors) {\n      Logger.debug(`Resetting flags for actor [${actor.id}]`, { actor });\n      await this.dataHandler.saveDataAsGm(\"actor\", actor.id, {});\n    }\n\n    Logger.debug(\"All actor data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetAllActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset user's HUD data\n   * @public\n   */\n  async resetUserData() {\n    Logger.debug(\"Resetting user data...\");\n    await this.dataHandler.saveDataAsGm(\"user\", game.userId, {});\n    Logger.debug(\"User data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetUserData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset every user's HUD data\n   * @public\n   */\n  async resetAllUserData() {\n    Logger.debug(\"Resetting all user data...\");\n    for (const user of game.users) {\n      await this.dataHandler.saveDataAsGm(\"user\", user.id, {});\n    }\n    Logger.debug(\"All user data reset\");\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetAllUserData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Reset user and actor's HUD data\n   */\n  async resetUserAndActorData() {\n    Logger.debug(\"Resetting user data...\");\n    await this.dataHandler.saveDataAsGm(\"user\", game.userId, {});\n    Logger.debug(\"User data reset\");\n\n    Logger.debug(\"Resetting actor data...\");\n    await this.dataHandler.saveDataAsGm(\"actor\", this.hudManager.actor.id, {});\n    Logger.debug(\"Actor data reset\");\n\n    this.hudManager.hardResetHud();\n    const trigger = { trigger: { type: \"method\", name: \"TokenActionHud#resetUserAndActorData\" } };\n    this.update(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update the HUD\n   * @public\n   * @param {object} trigger The trigger for the update\n   */\n  async update(trigger = null) {\n    // Stops settings updates from triggering the HUD update multiple times\n    // Instead an update is triggered when settings are updated and the settings config window is closed\n    if (trigger?.name === \"closeSettingsConfig\") {\n      if (!this.updateSettingsPending) return;\n      this.updateSettingsPending = false;\n      Logger.debug(\"Settings updated\");\n    }\n\n    await this.#handleUpdate();\n    await this.#performUpdate(trigger);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handles HUD updates to avoid overlapping updates\n   */\n  async #handleUpdate() {\n    // Start a timer and reset it each time an update call is received before the timer has elapsed\n    if (this.isUpdatePending) this.updatePendingTimer.abort();\n\n    this.isUpdatePending = true;\n    await this.updatePendingTimer.start();\n    this.isUpdatePending = false;\n\n    // Wait for the current update to complete before progressing a pending update\n    // Stop waiting if the current update takes longer than 5 seconds\n    const waitForUpdateCompletion = async () => {\n      const maxWaitTime = 5000;\n      const interval = 10;\n      const iterations = maxWaitTime / interval;\n\n      let i = 0;\n      while (i < iterations && this.isUpdating) {\n        await this.updateTimer.start();\n        i++;\n      }\n\n      return !this.isUpdating;\n    };\n\n    if (this.isUpdating) {\n      const hasCompleted = await waitForUpdateCompletion();\n      if (!hasCompleted) {\n        Logger.debug(\"Update took too long. Aborting...\");\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Perform the HUD update following handling\n   * @param {object} trigger The trigger for the update\n   */\n  async #performUpdate(trigger) {\n    this.isUpdating = true;\n    Logger.debug(\"Updating HUD...\", trigger);\n\n    // Await does have an effect\n    const initialised = await this.hudManager.init(trigger);\n    if (!initialised) {\n      this.#abortUpdate();\n      return;\n    }\n\n    this.rendering = true;\n    this.render({ force: true, position: {} });\n\n    if (!ui.windows[MODULE.ID]) {\n      ui.windows[MODULE.ID] = this;\n    }\n\n    this.isUpdating = false;\n\n    Hooks.callAll(\"tokenActionHudCoreHudUpdated\", MODULE);\n    Logger.debug(\"HUD updated\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Abort the HUD update with a debug message\n   * @private\n   */\n  #abortUpdate() {\n    this.#close();\n    Logger.debug(\"HUD update aborted as no character(s) found or HUD is disabled\");\n    this.isUpdating = false;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Close the HUD\n   * @public\n   */\n  closeHud() {\n    this.#close();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Close the HUD\n   * @private\n   */\n  #close() {\n    requestAnimationFrame(() => {\n      this.element?.classList?.remove(\"tah-expanded\");\n      this.element?.classList?.add(\"tah-closed\");\n    });\n\n    this.openGroups = new Set();\n    this.closeTimer = setTimeout(() => {\n      this.close({ animate: false });\n    }, 500);\n\n    delete ui.windows[MODULE.ID];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the token change is valid for a HUD update\n   * @public\n   * @param {object} token The token\n   * @param {object} data  The data\n   * @returns {boolean}    Whether the token change is valid for a HUD update\n   */\n  isValidTokenChange(token, data = null) {\n    if (data.flags) return false;\n    return this.#isRelevantToken(token) || (Utils.getSetting(\"alwaysShowHud\") && token.actorId === game.user.character?.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the token is controlled or on the canvas\n   * @private\n   * @param {object} token The token\n   * @returns {boolean} Whether the token is controlled or on the canvas\n   */\n  #isRelevantToken(token) {\n    const controlledTokens = Utils.getControlledTokens();\n    return (\n      controlledTokens?.some(controlledToken => controlledToken.id === token.id)\n        || (!controlledTokens?.length\n          && canvas?.tokens?.placeables?.some(token => token.id === this.hudManager.token?.id))\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the given actor is the selected actor\n   * @param {object} actor The actor\n   * @returns {boolean}    Whether the given actor is the selected actor\n   */\n  isControlledActor(actor) {\n    return actor?.id === this.hudManager.actor?.id;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the actor or item update is valid for a HUD update\n   * @param {object} actor The actor\n   * @param {object} data  The data\n   * @returns {boolean}    Whether the actor or item update is valid for a HUD update\n   */\n  isValidActorOrItemUpdate(actor, data) {\n    if (!actor) {\n      Logger.debug(\"No actor; updating HUD\", { data });\n      return true;\n    }\n\n    if (this.isControlledActor(actor)) {\n      Logger.debug(\"Same actor; updating HUD\", { actor, data });\n      return true;\n    } else {\n      Logger.debug(\"Different actor; skipping HUD update\", { actor, data });\n      return false;\n    }\n  }\n}\n","import { MODULE } from \"./constants.mjs\";\nimport { DataHandler } from \"../handlers/data-handler.mjs\";\nimport { TokenActionHud } from \"../applications/token-action-hud.mjs\";\n\nlet socket;\n\n/**\n * Register socket with socketlib module\n */\nexport function registerSocket() {\n  socket = socketlib.registerModule(MODULE.ID);\n  socket.register(\"getFilePaths\", DataHandler.getFilePathsWithSocket);\n  socket.register(\"getData\", DataHandler.getDataWithSocket);\n  socket.register(\"saveData\", DataHandler.saveDataWithSocket);\n  socket.register(\"reset\", TokenActionHud.resetLayoutWithSocket);\n}\n\n/**\n * Whether the socketlib module is active\n * @returns {boolean} Whether the socketlib module is active\n */\nexport function isSocketlibActive() {\n  if (game.modules.get(\"socketlib\")?.active) return true;\n\n  Logger.error(\"This module requires the 'socketlib' module to be installed and enabled.\", true);\n  return false;\n}\n\n\n/**\n * Get the socket\n * @returns {object} The socket\n */\nexport function getSocket() {\n  return socket;\n}\n","import { GROUP_TYPE } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's generic actions.\n */\nexport class GenericActionHandler {\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n    this.actor = actionHandler.actor;\n    this.token = actionHandler.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build generic actions\n   * @public\n   */\n  buildActions() {\n    this.#buildUtilities();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities\n   * @private\n   */\n  #buildUtilities() {\n    if (this.actor) {\n      this.#buildSingleTokenUtilities();\n    } else {\n      this.#buildMultipleTokenUtilities();\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities for a single token\n   * @private\n   */\n  #buildSingleTokenUtilities() {\n    if (!this.token) return;\n    const actionsData = [];\n\n    // Build Toggle Combat action\n    const toggleCombatId = \"toggleCombat\";\n    const toggleCombatName = this.token?.inCombat\n      ? game.i18n.localize(\"tokenActionHud.removeFromCombat\")\n      : game.i18n.localize(\"tokenActionHud.addToCombat\");\n    const toggleCombatAction = {\n      id: toggleCombatId,\n      name: toggleCombatName,\n      onClick: async () => {\n        const token = Utils.getFirstControlledToken();\n        token.document.toggleCombatant();\n\n      }\n    };\n    actionsData.push(toggleCombatAction);\n\n    // Build Toggle Visibility action\n    if (game.user.isGM) {\n      const toggleVisibilityId = \"toggleVisibility\";\n      const toggleVisibilityName = this.token?.document?.hidden\n        ? game.i18n.localize(\"tokenActionHud.makeVisible\")\n        : game.i18n.localize(\"tokenActionHud.makeInvisible\");\n      const toggleVisibilityAction = {\n        id: toggleVisibilityId,\n        name: toggleVisibilityName,\n        onClick: async () => {\n          const token = Utils.getFirstControlledToken();\n          const isHidden = token.document.hidden;\n          await token.document.update({ hidden: !isHidden });\n        }\n      };\n      actionsData.push(toggleVisibilityAction);\n    }\n\n    const groupData = { id: \"token\", type: GROUP_TYPE.SYSTEM };\n\n    // Add actions to HUD\n    this.actionHandler.addActions(actionsData, groupData);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build utilities for multiple tokens\n   * @private\n   */\n  #buildMultipleTokenUtilities() {\n    const tokens = Utils.getControlledTokens();\n    const actionsData = [];\n\n    // Toggle Combat\n    const toggleCombatId = \"toggleCombat\";\n    const toggleCombatName = tokens.every(token => token.inCombat)\n      ? game.i18n.localize(\"tokenActionHud.removeFromCombat\")\n      : game.i18n.localize(\"tokenActionHud.addToCombat\");\n    const toggleCombatAction = {\n      id: toggleCombatId,\n      name: toggleCombatName,\n      onClick: async () => {\n        const controlledTokens = Utils.getControlledTokens();\n        for (const token of controlledTokens) {\n          await token.document.toggleCombatant();\n        }\n      }\n    };\n    actionsData.push(toggleCombatAction);\n\n    // Toggle Visibility\n    if (game.user.isGM) {\n      const toggleVisibilityId = \"toggleVisibility\";\n      const toggleVisibilityname = tokens.every(token => token.document?.hidden)\n        ? game.i18n.localize(\"tokenActionHud.makeVisible\")\n        : game.i18n.localize(\"tokenActionHud.makeInvisible\");\n      const toggleVisibilityAction = {\n        id: toggleVisibilityId,\n        name: toggleVisibilityname,\n        onClick: async () => {\n          const controlledTokens = Utils.getControlledTokens();\n          for (const token of controlledTokens) {\n            const isHidden = token.document.hidden;\n            await token.document.update({ hidden: !isHidden });\n          }\n        }\n      };\n      actionsData.push(toggleVisibilityAction);\n    }\n\n    const groupData = { id: \"token\", type: GROUP_TYPE.SYSTEM };\n\n    // Add actions to HUD\n    this.actionHandler.addActions(actionsData, groupData);\n  }\n}\n","import { ACTION_TYPE, COMPENDIUM_PACK_TYPES } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's compendium actions.\n */\nexport class CompendiumActionHandler {\n  actionHandler;\n\n  compendiumActions;\n\n  packIds;\n\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n    this.compendiumActions = new Map();\n    this.packIds = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build compendium actions\n   */\n  async buildActions() {\n    if (!Utils.getSetting(\"enableCompendiumActions\")) return;\n\n    if (this.compendiumActions.size === 0) {\n      this.packIds = game.packs\n        .filter(\n          pack =>\n            COMPENDIUM_PACK_TYPES.includes(pack.documentName)\n              && (foundry.utils.isNewerVersion(game.version, \"10\") ? pack.visible : !pack.private || game.user.isGM)\n        )\n        .map(pack => pack.metadata.id);\n\n      if (this.packIds.length === 0) return;\n\n      await Promise.all(this.packIds.map(packId => this.#setActions(packId)));\n    }\n\n    for (const pack of this.compendiumActions.values()) {\n      this.actionHandler.addActions(pack.actions, pack.groupData);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set compendium actions into the compendiumActions map\n   * @param {string} packId The pack id\n   */\n  async #setActions(packId) {\n    const pack = game.packs.get(packId);\n    const entries = pack ? pack.index.size > 0 ? pack.index : await pack.getIndex() : null;\n    if (!entries) return;\n    const actionType = this.#getCompendiumActionType(pack?.documentName);\n    if (!actionType) return;\n    const actions = entries.map(entry => (\n      this.actionHandler.createAction(\n        {\n          id: entry._id,\n          name: entry.name,\n          listName: `${game.i18n.localize(ACTION_TYPE[actionType])}: ${entry.name}`,\n          img: Utils.getImage(entry),\n          onClick: this.#getOnClick(actionType, pack, entry._id)\n        })\n    ));\n    const groupData = { id: this.#getGroupId(packId), type: \"core\" };\n    this.compendiumActions.set(packId, { actions, groupData });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get compendium action type based on document name\n   * @param {string} documentName The pack document name\n   * @returns {string}            The compendium action type\n   */\n  #getCompendiumActionType(documentName) {\n    switch (documentName) {\n      case \"Macro\":\n        return \"compendiumMacro\";\n      default:\n        return \"compendiumEntry\";\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function\n   * @param {string} actionType The action type\n   * @param {object} pack       The compendium pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClick(actionType, pack, documentId) {\n    switch (actionType) {\n      case \"compendiumMacro\":\n        return this.#getOnClickFunction(pack, documentId);\n      default:\n        return this.#getOnClickEntry(pack, documentId);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function for compendium journal entry\n   * @param {object} pack       The pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClickEntry(pack, documentId) {\n    return async () => {\n      const journalEntry = await pack.getDocument(documentId);\n      journalEntry.sheet.render(true); };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get on click function for compendium macro\n   * @param {object} pack       The pack\n   * @param {string} documentId The document ID\n   * @returns {Function}        The function\n   */\n  #getOnClickFunction(pack, documentId) {\n    return async () => {\n      await pack.getDocument(documentId).then(macro => macro.execute());\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the group ID from the pack ID\n   * @param {string} packId The pack id\n   * @returns {string}      The group id\n   */\n  #getGroupId(packId) {\n    return packId.replace(\".\", \"-\");\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the compendium is linked\n   * @public\n   * @param {string} packId The pack id\n   * @returns {boolean}     Whether the compendium is linked\n   */\n  isLinkedCompendium(packId) {\n    return (this.packIds.length)\n      ? this.packIds?.includes(packId)\n      : false;\n  }\n}\n","import { ACTION_TYPE } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building the HUD's macro actions.\n */\nexport class MacroActionHandler {\n  constructor(actionHandler) {\n    this.actionHandler = actionHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Clear cached macro actions.\n   */\n  clearCache() {\n    this.macroActions = null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build macro actions\n   * @override\n   */\n  async buildActions() {\n    if (!Utils.getSetting(\"enableMacroActions\")) return;\n\n    if (!this.macroActions) {\n      this.macroActions = {\n        actions: await this.#getActions(),\n        groupData: { id: \"macros\", type: \"core\" }\n      };\n    }\n\n    this.actionHandler.addActions(this.macroActions.actions, this.macroActions.groupData);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actions\n   * @private\n   * @returns {object} The actions\n   */\n  async #getActions() {\n    const actionType = \"macro\";\n    const macros = game.macros.filter(macro => this.#hasPermission(macro));\n\n    return macros.map(macro =>\n      this.actionHandler.createAction({\n        id: macro.id,\n        name: macro.name,\n        listName: this.#getListName(actionType, macro.name),\n        img: Utils.getImage(macro),\n        onClick: () => {\n          game.macros.get(macro.id).execute();\n        }\n      })\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Check if the user has permission for the macro\n   * @private\n   * @param {object} macro The macro\n   * @returns {boolean}    Whether the user has permission\n   */\n  #hasPermission(macro) {\n    const { ownership } = macro;\n    return ownership[game.userId] ? ownership[game.userId] > 0 : ownership.default > 0;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get list name\n   * @param {string} actionType The action type\n   * @param {string} name       The action name\n   * @returns {string}          The list name\n   */\n  #getListName(actionType, name) {\n    const actionTypeName = `${game.i18n.localize(ACTION_TYPE[actionType])}: ` ?? \"\";\n    return `${actionTypeName}${name}`;\n  }\n}\n","import { DELIMITER } from \"../../core/constants.mjs\";\nimport { GenericActionHandler } from \"./generic-action-handler.mjs\";\nimport { CompendiumActionHandler } from \"./compendium-action-handler.mjs\";\nimport { MacroActionHandler } from \"./macro-action-handler.mjs\";\nimport { getTooltip } from \"../tooltip-handler.mjs\";\nimport { Logger, Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for the HUD actions.\n */\nexport class ActionHandler {\n  constructor() {\n    this.hudManager = {};\n    this.groupHandler = {};\n    this.genericActionHandler = new GenericActionHandler(this);\n    this.compendiumActionHandler = new CompendiumActionHandler(this);\n    this.macroActionHandler = new MacroActionHandler(this);\n    this.actions = [];\n    this.availableActions = new Map();\n    this.delimiter = DELIMITER;\n    this.actionHandlerExtenders = [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Soft reset variables\n   */\n  softReset() {\n    this.genericActionHandler = new GenericActionHandler(this);\n    this.actions = [];\n    this.availableActions = new Map();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare actions\n   * @param {object} groups The HUD groups\n   */\n  prepareActions(groups) {\n    for (const group of Object.values(groups)) {\n      if (group.actions?.length) {\n        this.actions.push(...group.actions);\n        for (const action of group.actions) {\n          action.selected = false;\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build actions\n   */\n  async buildActionsCore() {\n    await Promise.all([\n      this.#buildSystemActionsCore(),\n      this.#buildGenericActionsCore(),\n      this.#buildCompendiumActionsCore(),\n      this.#buildMacroActionsCore()\n    ]);\n    await this.#buildExtendedActionsCore();\n    this.#updateNonPresetActions();\n    this.#setCharacterLimit();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build system-specific actions\n   * @private\n   */\n  async #buildSystemActionsCore() {\n    Logger.debug(\"Building system actions...\", { actor: this.actor, token: this.token });\n    const groupIds = this.groupHandler.getGroupIds();\n    await this.buildSystemActions(groupIds);\n    Logger.debug(\"System actions built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Placeholder function for the system module\n   * @override\n   * @param {Array} groupIds The group IDs\n   */\n  async buildSystemActions(groupIds) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build compendium-specific actions\n   * @private\n   */\n  async #buildCompendiumActionsCore() {\n    Logger.debug(\"Building compendium actions...\");\n    await this.compendiumActionHandler.buildActions();\n    Logger.debug(\"Compendium actions built\", { hud: this.hud });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build generic actions\n   * @private\n   */\n  #buildGenericActionsCore() {\n    Logger.debug(\"Building generic actions...\", { actor: this.actor, token: this.token });\n    this.genericActionHandler.buildActions();\n    Logger.debug(\"Generic actions built\", { hud: this.hud, actor: this.actor, token: this.token });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build macro-specific actions\n   * @private\n   */\n  async #buildMacroActionsCore() {\n    Logger.debug(\"Building macro actions...\");\n    await this.macroActionHandler.buildActions();\n    Logger.debug(\"Macro actions built\", { hud: this.hud });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Build extended actions\n   * @private\n   */\n  async #buildExtendedActionsCore() {\n    await Promise.all(this.actionHandlerExtenders.map(\n      async extender => await extender.extendActionHandler()\n    ));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update non-preset actions\n   * @private\n   */\n  #updateNonPresetActions() {\n    const nonPresetActions = this.actions.filter(action => !action?.isPreset);\n\n    for (const nonPresetAction of nonPresetActions) {\n      const availableAction = this.availableActions.get(nonPresetAction.id);\n\n      if (availableAction) {\n        const systemSelected = availableAction.systemSelected ?? nonPresetAction.systemSelected;\n        const userSelected = nonPresetAction.userSelected ?? availableAction.userSelected;\n        Object.assign(nonPresetAction, this.createAction({ ...availableAction, systemSelected, userSelected }));\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set character limit for action names based on the 'Character per Word' setting\n   * @private\n   */\n  #setCharacterLimit() {\n    const groups = this.groupHandler.getGroups({ level: 1 });\n\n    for (const group of groups) {\n      const groupCharacterCount = group?.settings?.characterCount;\n\n      const subgroups = this.groupHandler.getGroups({ nestId: group.nestId });\n\n      for (const subgroup of subgroups) {\n        const actions = subgroup.actions;\n        if (!actions?.length) continue;\n\n        const subgroupCharacterCount = subgroup?.settings?.characterCount;\n        const characterCount = (subgroupCharacterCount >= 0)\n          ? groupCharacterCount\n          : subgroupCharacterCount;\n\n        // Exit if character limit is not defined\n        if ((!characterCount && characterCount !== 0) || characterCount < 0) continue;\n\n        for (const action of actions) {\n          if (action.name.length <= characterCount) continue;\n          if (characterCount === 0) {\n            action.name = \"\";\n            continue;\n          }\n          // Set each word to the character limit\n          action.name = action.name\n            .split(\" \")\n            .map(word => word.slice(0, characterCount))\n            .join(\" \");\n        }\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actions by ID\n   * @public\n   * @param {object} actionData The action data\n   * @returns {Array}           The actions\n   */\n  getActions(actionData) {\n    return this.actions.filter(action => action.id === actionData.id);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create action\n   * @public\n   * @param {object} actionData The action data\n   * @returns {object}          The action\n   */\n  createAction(actionData) {\n    const fullName = actionData.fullName ?? actionData.name;\n    const tooltip = getTooltip(actionData.tooltip, fullName);\n\n    const infoProps = info => {\n      if (!info) return {};\n      return {\n        ...(info.class && { class: info.class }),\n        ...(info.icon && { icon: info.icon }),\n        ...(info.text && { text: info.text }),\n        ...(info.title && { title: info.title })\n      };\n    };\n\n    return {\n      id: actionData.id,\n      name: actionData.name,\n      fullName,\n      listName: actionData.listName || actionData.name,\n      ...(actionData.onClick && { onClick: actionData.onClick }),\n      ...(actionData.onHover && { onClick: actionData.onHover }),\n      ...(actionData.encodedValue && { encodedValue: actionData.encodedValue }),\n      ...(actionData.cssClass && { cssClass: actionData.cssClass }),\n      icons: actionData.icons || {},\n      ...(actionData.icon1 && { icon1: actionData.icon1 }),\n      ...(actionData.icon2 && { icon2: actionData.icon2 }),\n      ...(actionData.icon3 && { icon3: actionData.icon3 }),\n      ...(actionData.img && { img: actionData.img }),\n      info1: infoProps(actionData.info1),\n      info2: infoProps(actionData.info2),\n      info3: infoProps(actionData.info3),\n      system: actionData.system || {},\n      isAction: true,\n      ...(actionData.isItem && { isItem: actionData.isItem }),\n      ...(actionData.isPreset && { isPreset: actionData.isPreset }),\n      userSelected: actionData.userSelected ?? true,\n      systemSelected: actionData.systemSelected ?? true,\n      selected: actionData.systemSelected\n        ? actionData.userSelected ?? actionData.systemSelected ?? true\n        : false,\n      tooltip,\n      ...(actionData.useRawHtmlName && { useRawHtmlName: actionData.useRawHtmlName })\n    };\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add actions to the HUD\n   * @public\n   * @param {object} actionsData The actions data\n   * @param {object} groupData   The group data\n   */\n  addActions(actionsData, groupData) {\n    if (!actionsData.length) return;\n\n    // Create actions\n    const actions = new Map(actionsData.map(actionData => [\n      actionData.id,\n      (actionData.isAction) ? actionData : this.createAction(actionData)]\n    ));\n    this.#addToAvailableActions(actions);\n\n    if (!groupData?.id) return;\n\n    if (!groupData?.type) { groupData.type = \"system\"; }\n\n    const groups = this.groupHandler.getGroups(groupData);\n\n    if (!groups.length) return;\n\n    for (const group of groups) {\n      // Get existing actions\n      const existingActions = new Map(group.actions.map(action => [action.id, action]));\n\n      const reorderedActions = [];\n\n      // Loop the previously saved actions in the group\n      existingActions.forEach((existingAction, existingActionId) => {\n        const action = actions.get(existingActionId);\n        if (action) {\n          const systemSelected = action.systemSelected ?? existingAction.systemSelected;\n          const userSelected = existingAction.userSelected ?? action.userSelected;\n          const selected = (!systemSelected)\n            ? false\n            : userSelected ?? systemSelected ?? true;\n          Object.assign(existingAction, { ...action, isPreset: true, selected, systemSelected, userSelected });\n        } else if (!existingAction.selected && existingAction.isPreset) {\n          const systemSelected = false;\n          Object.assign(existingAction, this.createAction({ ...existingAction, systemSelected }));\n        }\n      });\n\n      // Loop the generated actions and add any not previously saved\n      actions.forEach((action, actionId) => {\n        const existingAction = existingActions.get(actionId);\n        if (!existingAction) reorderedActions.push(this.createAction({ ...action, isPreset: true }));\n      });\n\n      // Sort actions alphabetically\n      if (\n        groupData?.settings?.sort\n        || (typeof groupData?.settings?.sort === \"undefined\" && Utils.getSetting(\"sortActions\"))\n      ) {\n        reorderedActions.sort((a, b) => a.name.localeCompare(b.name));\n      }\n\n      // Add actions to group\n      group.actions.push(...reorderedActions);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Update actions\n   * @public\n   * @param {Array} actionsData The actions data\n   * @param {object} groupData  The group data\n   */\n  updateActions(actionsData, groupData) {\n    const group = this.groupHandler.getGroup(groupData);\n    const actions = group.actions;\n\n    const reorderedActions = [];\n\n    // Set 'selected' to true for selected actions\n    // Reorder actions based on order in dialog\n    for (const actionData of actionsData) {\n      if (actionData.id.includes(\"itemMacro\")) continue;\n      const existingAction = group.actions.find(action => action.id === actionData.id);\n      if (existingAction) {\n        const actionClone = { ...existingAction, userSelected: true };\n        reorderedActions.push(actionClone);\n      } else {\n        const availableAction = this.availableActions.get(actionData.id);\n        if (availableAction) {\n          const actionClone = { ...availableAction, userSelected: true };\n          reorderedActions.push(actionClone);\n        }\n      }\n    }\n    // Set 'selected' to false for unselected actions\n    for (const action of actions) {\n      if (!action.id || action?.id.includes(\"itemMacro\")) continue;\n\n      const actionData = actionsData.find(actionData => actionData.id === action.id);\n      if (!actionData && action.isPreset) {\n        const actionClone = { ...action, userSelected: false };\n        reorderedActions.push(actionClone);\n      }\n    }\n\n    // Sort actions alphabetically\n    if (groupData?.settings?.sort\n      || (typeof groupData?.settings?.sort === \"undefined\" && Utils.getSetting(\"sortActions\"))) {\n      reorderedActions.sort((a, b) => a.name.localeCompare(b.name));\n    }\n\n    // Replace group actions\n    group.actions = reorderedActions;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add to available actions\n   * @private\n   * @param {Array} actions The actions\n   */\n  #addToAvailableActions(actions) {\n    for (const [actionId, action] of actions) {\n      if (!this.availableActions.has(actionId)) {\n        this.availableActions.set(actionId, action);\n      }\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get available actions as Tagify entries\n   * @public\n   * @returns {Array} The available actions as Tagify entries\n   */\n  getAvailableActionsAsTags() {\n    return [...this.availableActions.values()]\n      .map(action => this.#toTagify(action))\n      .sort((a, b) => a.value.localeCompare(b.value));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get selected actions as Tagify entries\n   * @public\n   * @param {object} groupData The group data\n   * @returns {Array}          The selected actions as Tagify entries\n   */\n  getSelectedActionsAsTags(groupData) {\n    const group = this.groupHandler.getGroup(groupData);\n    if (!group) return [];\n    return group.actions\n      .filter(action => action.selected === true)\n      .map(action => this.#toTagify(action));\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add action handler extender\n   * @public\n   * @param {object} actionHandlerExtender The action handler extender\n   */\n  addActionHandlerExtender(actionHandlerExtender) {\n    Logger.debug(\"Adding action handler extender...\", { actionHandlerExtender });\n    actionHandlerExtender.hudManager = this.hudManager;\n    actionHandlerExtender.groupHandler = this.groupHandler;\n    actionHandlerExtender.actionHandler = this;\n    this.actionHandlerExtenders.push(actionHandlerExtender);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Convert an action into a Tagify entry\n   * @private\n   * @param {object} actionData The action data\n   * @returns {object}          The Tagify entry\n   */\n  #toTagify(actionData) {\n    const { id, name, listName } = actionData;\n    return { id, name, type: \"action\", value: listName ?? name };\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to the HudManager properties       */\n  /* -------------------------------------------- */\n\n  /**\n   * Get character name\n   * @returns {string} The character name\n   */\n  get characterName() {\n    return this.hudManager?.characterName;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor\n   * @returns {object} The actor\n   */\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set actor\n   */\n  set actor(actor) {\n    this.hudManager.actor = actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors\n   * @returns {Array} The actors\n   */\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set actors\n   * @param {Array} actors The actors\n   */\n  set actors(actors) {\n    this.hudManager.actors = actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @returns {object} The token\n   */\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set token\n   */\n  set token(token) {\n    this.hudManager.token = token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get tokens\n   * @returns {Array} The tokens\n   */\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Set tokens\n   * @param {Array} tokens The tokens\n   */\n  set tokens(tokens) {\n    this.hudManager.tokens = tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the right mouse button was clicked\n   * @returns {boolean} Whether the right mouse button was clicked\n   */\n  get isRightClick() {\n    return this.hudManager?.isRightClick;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the ALT key was pressed\n   * @returns {boolean} Whether the ALT key was pressed\n   */\n  get isAlt() {\n    return this.hudManager?.isAlt;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the CTRL key was pressed\n   * @returns {boolean} Whether the CTRL key was pressed\n   */\n  get isCtrl() {\n    return this.hudManager?.isCtrl;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the SHIFT key was pressed\n   * @returns {boolean} Whether the SHIFT key was pressed\n   */\n  get isShift() {\n    return this.hudManager?.isShift;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the element was hovered\n   * @returns {boolean} Whether the element was hovered\n   */\n  get isHover() {\n    return this.hudManager?.isHover;\n  }\n}\n","import { ActionHandler } from \"./action-handler.mjs\";\n\n/**\n * An extension of the base ActionHandler which extends the HUD via core or system modules.\n */\nexport class ActionHandlerExtender extends ActionHandler {\n  constructor() {\n    super();\n  }\n\n  /**\n   * Extend action handler\n   * @override\n   */\n  extendActionHandler() {}\n}\n","import { DELIMITER } from \"../../core/constants.mjs\";\nimport { Logger, Utils } from \"../../core/utils.mjs\";\n\n/**\n * Resolves core actions triggered from the HUD\n */\nexport class RollHandler {\n  constructor() {\n    this.hudManager = null;\n    this.delimiter = DELIMITER;\n    this.preRollHandlers = [];\n    this.rollHandlerExtenders = [];\n  }\n\n  /**\n   * Throw error\n   * @public\n   * @param {*} err The error\n   */\n  throwInvalidValueErr(err) {\n    throw new Error(\n      `Error handling button click: ${err}`\n    );\n  }\n\n  /**\n   * Add roll handler extender\n   * @public\n   * @param {object} rollHandlerExtender The RollHandlerExtender instance\n   */\n  addRollHandlerExtender(rollHandlerExtender) {\n    Logger.debug(\"Adding roll handler extender...\", { rollHandlerExtender });\n    this.rollHandlerExtenders.push(rollHandlerExtender);\n  }\n\n  /**\n   * Handle action events\n   * @public\n   * @param {object} event The event\n   * @param {object} action The action\n   * @param {class} actionHandler The ActionHandler instance\n   */\n  async handleActionClickCore(event, action, actionHandler) {\n    try {\n      Logger.debug(\"Handling action click event\", { event });\n\n      // Update variables with current action context\n      this.action = action;\n\n      // If the action has an onClick function, call it and trigger a HUD update\n      if (typeof action?.onClick === \"function\") {\n        action.onClick();\n        Hooks.callAll(\"forceUpdateTokenActionHud\");\n        return;\n      }\n\n      // Get the value of the associated button\n      const buttonValue = this.#getButtonValue(event);\n\n      // Check pre-handlers in extenders\n      for (let handler of this.rollHandlerExtenders) {\n        handler.action = this.action;\n        if (handler.prehandleActionEvent(event, buttonValue, actionHandler)) {\n          return;\n        }\n      }\n\n      // Check pre-handlers\n      for (let handler of this.preRollHandlers) {\n        handler.action = this.action;\n        if (handler.prehandleActionEvent(event, buttonValue, actionHandler)) {\n          return;\n        }\n      }\n\n      // Check handlers in extenders\n      for (let handler of this.rollHandlerExtenders) {\n        handler.action = this.action;\n        if (handler.handleActionClick(event, buttonValue, actionHandler)) {\n          return;\n        }\n      }\n\n      // If the action was not yet handled, call the default method\n      this.handleActionClick(event, buttonValue);\n    } catch(error) {\n      Logger.error(\"Error handling action click event\", { error, event, action });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event       The event\n   * @param {string} buttonValue The button value\n   */\n  handleActionClick(event, buttonValue) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle action hover events\n   * @param {object} event  The event\n   * @param {object} action The action\n   */\n  async handleActionHoverCore(event, action) {\n    Logger.debug(\"Handling action hover event\", { event });\n\n    // Update variables with current action context\n    this.action = action;\n\n    // If the action has an onHover function, call it\n    if (typeof action?.onHover === \"function\") {\n      action.onHover();\n      return;\n    }\n\n    // Get the value of the associated button\n    const buttonValue = this.#getButtonValue(event);\n\n    this.handleActionHover(event, buttonValue);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event       The event\n   * @param {string} buttonValue The button value\n   */\n  handleActionHover(event, buttonValue) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle group click events\n   * @param {object} event The event\n   * @param {group} group  The nest ID\n   */\n  async handleGroupClickCore(event, group) {\n    Logger.debug(`Handling click event for group [${group.name}]`, { event });\n\n    this.handleGroupClick(event, group);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Overide for the TAH system module\n   * @override\n   * @param {object} event The event\n   * @param {object} group The group\n   */\n  handleGroupClick(event, group) {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add a pre-roll handler\n   * @public\n   * @param {object} handler The roll handler\n   */\n  addPreRollHandler(handler) {\n    Logger.debug(`Adding pre-roll handler ${handler.constructor.name}`);\n    this.preRollHandlers.push(handler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get button value\n   * @private\n   * @param {object} event  The event\n   * @returns {string}      The button value\n   */\n  #getButtonValue(event) {\n    if (!event) return null;\n    const buttonElement = event.target.querySelector(\".tah-action-button\") ?? event.target.closest(\".tah-action-button\");\n    return buttonElement?.value || null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Renders the item sheet\n   * @public\n   * @param {object} actor  The actor\n   * @param {string} itemId The item id\n   * @returns {boolean}     Whether the item was rendered\n   */\n  renderItem(actor, itemId) {\n    // If actor is not specified, use the RollHandler's actor\n    if (!actor) {\n      actor = this.actor;\n    }\n\n    // Get the item\n    const item = Utils.getItem(actor, itemId);\n\n    // If the item is not found, return false\n    if (!item) return false;\n\n    // Render the item and return true\n    item.sheet.render(true);\n    return true;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the item sheet should be rendered\n   * @public\n   * @returns {boolean}\n   */\n  isRenderItem() {\n    return (this.isRightClick && !(this.isAlt || this.isCtrl || this.isShift));\n  }\n\n  /* -------------------------------------------- */\n  /* Shortcuts to the HudManager properties       */\n  /* -------------------------------------------- */\n\n  /**\n   * Get actor\n   * @returns {object} The actor\n   */\n  get actor() {\n    return this.hudManager?.actor;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get actors\n   * @returns {Array} The actors\n   */\n  get actors() {\n    return this.hudManager?.actors;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get token\n   * @returns {object} The token\n   */\n  get token() {\n    return this.hudManager?.token;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get tokens\n   * @returns {Array} The tokens\n   */\n  get tokens() {\n    return this.hudManager?.tokens;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the right mouse button was clicked\n   * @returns {boolean} Whether the right mouse button was clicked\n   */\n  get isRightClick() {\n    return this.hudManager.isRightClick;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the ALT key was pressed\n   * @returns {boolean} Whether the ALT key was pressed\n   */\n  get isAlt() {\n    return this.hudManager.isAlt;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the CTRL key was pressed\n   * @returns {boolean} Whether the CTRL key was pressed\n   */\n  get isCtrl() {\n    return this.hudManager.isCtrl;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the SHIFT key was pressed\n   * @returns {boolean} Whether the SHIFT key was pressed\n   */\n  get isShift() {\n    return this.hudManager.isShift;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Whether the element was hovered over\n   * @returns {boolean} Whether the element was hovered over\n   */\n  get isHover() {\n    return this.hudManager?.isHover;\n  }\n}\n","import { RollHandler } from \"./roll-handler.mjs\";\n\n/*\n * Used for adding support for actions not part of the core functions.\n * Returns true from prehandleActionEvent() if it can perform an action and stops\n * further actions being performed.\n */\nexport class PreRollHandler extends RollHandler {\n  /**\n   * Pre-handle action event\n   * @param {object} event        The event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  prehandleActionEvent(event, buttonValue, actionHandler) {\n    return false;\n  }\n}\n","import { RollHandler } from \"./roll-handler.mjs\";\n\n/**\n * An extension of the base RollHandler which extends the actions that can be handled\n */\nexport class RollHandlerExtender extends RollHandler {\n  constructor() {\n    super();\n  }\n\n  /**\n   * Pre-handle action event\n   * @param {object} event        The event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  prehandleActionEvent(event, buttonValue, actionHandler) {\n    return false;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle action click\n   * @override\n   * @param {object} event        The click event\n   * @param {string} buttonValue  The button value\n   * @param {class} actionHandler The ActionHandler instance\n   * @returns {boolean}\n   */\n  handleActionClick(event, buttonValue, actionHandler) {\n    return false;\n  }\n}\n","import { CUSTOM_STYLE, MODULE, TEMPLATE } from \"../core/constants.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class CustomStyleForm extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(...args) {\n    super(args);\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      reset: CustomStyleForm.reset\n    },\n    classes: [`${MODULE.ID}-app`, \"sheet\"],\n    id: \"token-action-hud-core-settings\",\n    form: {\n      closeOnSubmit: true,\n      handler: CustomStyleForm.submit\n    },\n    position: {\n      width: 600,\n      height: 680\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true,\n      title: \"tokenActionHud.settings.customStyle.form.title\"\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  static PARTS = {\n    form: {\n      template: TEMPLATE.customStyleForm\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    this.context = {\n      backgroundColor: Utils.getSetting(\"backgroundColor\", CUSTOM_STYLE.backgroundColor.default),\n      buttonHeight: Utils.getSetting(\"buttonHeight\", CUSTOM_STYLE.buttonHeight.default),\n      buttonBackgroundColor: Utils.getSetting(\"buttonBackgroundColor\", CUSTOM_STYLE.buttonBackgroundColor.default),\n      buttonHoverBackgroundColor: Utils.getSetting(\"buttonHoverBackgroundColor\", CUSTOM_STYLE.buttonHoverBackgroundColor.default),\n      buttonToggleActiveBackgroundColor: Utils.getSetting(\"buttonToggleActiveBackgroundColor\", CUSTOM_STYLE.buttonToggleActiveBackgroundColor.default),\n      buttonToggleHoverBackgroundColor: Utils.getSetting(\"buttonToggleHoverBackgroundColor\", CUSTOM_STYLE.buttonToggleHoverBackgroundColor.default),\n      buttonTextColor: Utils.getSetting(\"buttonTextColor\", CUSTOM_STYLE.buttonTextColor.default),\n      buttonHoverTextColor: Utils.getSetting(\"buttonHoverTextColor\", CUSTOM_STYLE.buttonHoverTextColor.default),\n      buttonToggleActiveTextColor: Utils.getSetting(\"buttonToggleActiveTextColor\", CUSTOM_STYLE.buttonToggleActiveTextColor.default),\n      buttonToggleHoverTextColor: Utils.getSetting(\"buttonToggleHoverTextColor\", CUSTOM_STYLE.buttonToggleHoverTextColor.default),\n      buttonBorderPrimaryColor: Utils.getSetting(\"buttonBorderPrimaryColor\", CUSTOM_STYLE.buttonBorderPrimaryColor.default),\n      buttonBorderSecondaryColor: Utils.getSetting(\"buttonBorderSecondaryColor\", CUSTOM_STYLE.buttonBorderSecondaryColor.default),\n      buttonHoverBorderPrimaryColor: Utils.getSetting(\"buttonHoverBorderPrimaryColor\", CUSTOM_STYLE.buttonHoverBorderPrimaryColor.default),\n      buttonHoverBorderSecondaryColor: Utils.getSetting(\"buttonHoverBorderSecondaryColor\", CUSTOM_STYLE.buttonHoverBorderSecondaryColor.default),\n      buttonToggleActiveBorderPrimaryColor: Utils.getSetting(\"buttonToggleActiveBorderPrimaryColor\", CUSTOM_STYLE.buttonToggleActiveBorderPrimaryColor.default),\n      buttonToggleActiveBorderSecondaryColor: Utils.getSetting(\"buttonToggleActiveBorderSecondaryColor\", CUSTOM_STYLE.buttonToggleActiveBorderSecondaryColor.default),\n      buttonToggleHoverBorderPrimaryColor: Utils.getSetting(\"buttonToggleHoverBorderPrimaryColor\", CUSTOM_STYLE.buttonToggleHoverBorderPrimaryColor.default),\n      buttonToggleHoverBorderSecondaryColor: Utils.getSetting(\"buttonToggleHoverBorderSecondaryColor\", CUSTOM_STYLE.buttonToggleHoverBorderSecondaryColor.default),\n      textPrimaryColor: Utils.getSetting(\"textPrimaryColor\", CUSTOM_STYLE.textPrimaryColor.default),\n      textSecondaryColor: Utils.getSetting(\"textSecondaryColor\", CUSTOM_STYLE.textSecondaryColor.default),\n      textTertiaryColor: Utils.getSetting(\"textTertiaryColor\", CUSTOM_STYLE.textTertiaryColor.default),\n      textHoverPrimaryColor: Utils.getSetting(\"textHoverPrimaryColor\", CUSTOM_STYLE.textHoverPrimaryColor.default),\n      textHoverSecondaryColor: Utils.getSetting(\"textHoverSecondaryColor\", CUSTOM_STYLE.textHoverSecondaryColor.default),\n      textHoverTertiaryColor: Utils.getSetting(\"textHoverTertiaryColor\", CUSTOM_STYLE.textHoverTertiaryColor.default)\n    };\n    return this.context;\n  }\n\n  /* -------------------------------------------- */\n\n  _onRender(context, options) {\n    super._onRender(context, options);\n    if (typeof ColorPicker !== \"undefined\") { ColorPicker.install(); }\n  }\n\n  /* -------------------------------------------- */\n\n  static async reset() {\n    for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n      Utils.setSetting(key, value.default);\n      document.querySelector(\":root\").style.setProperty(value.cssProperty, value.default);\n    }\n    this.render(true);\n  }\n\n  /* -------------------------------------------- */\n\n  static async submit(event, form, formData) {\n    const isCustom = Utils.getSetting(\"style\") === \"custom\";\n    for (const [key, value] of Object.entries(formData.object)) {\n      const customStyle = CUSTOM_STYLE[key];\n      if (value !== this.context[key]) {\n        Utils.setSetting(key, value);\n        if (isCustom) {\n          document.querySelector(\":root\").style.setProperty(customStyle.cssProperty, value);\n        }\n      }\n    }\n  }\n}\n","import { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Reset layout confirmation dialog\n * @public\n */\nexport async function resetLayoutDialog() {\n  await foundry.applications.api.DialogV2.confirm({\n    window: {\n      title: game.i18n.localize(\"tokenActionHud.dialog.resetLayout.title\")\n    },\n    content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetLayout.content\")}</p>`,\n    modal: true,\n    yes: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n      callback: async () => resetLayout()\n    },\n    no: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n    }\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Reset user layout\n */\nasync function resetLayout() {\n  if (!game?.tokenActionHud) return;\n\n  const customLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=customLayout]\");\n  if (customLayoutElement) {\n    await game.tokenActionHud.updateCachedSettings(\"customLayout\", customLayoutElement?.value ?? \"\");\n    await Utils.setSetting(\"customLayout\", customLayoutElement?.value ?? \"\");\n  }\n\n  const userCustomLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=userCustomLayout]\");\n  if (userCustomLayoutElement) {\n    await game.tokenActionHud.updateCachedSettings(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n    await Utils.setUserFlag(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n  }\n\n  await game.tokenActionHud.resetLayout();\n  Logger.info(\"Layout reset\", true);\n}\n","import { Logger, Utils } from \"../core/utils.mjs\";\n\n/**\n * Reset all layouts confirmation dialog\n * @public\n */\nexport async function resetAllLayoutsDialog() {\n  await foundry.applications.api.DialogV2.confirm({\n    window: {\n      title: game.i18n.localize(\"tokenActionHud.dialog.resetAllLayouts.title\")\n    },\n    content: `<p>${game.i18n.localize(\"tokenActionHud.dialog.resetAllLayouts.content\")}</p>`,\n    modal: true,\n    yes: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.yes\"),\n      callback: async () => resetAllLayouts()\n    },\n    no: {\n      label: game.i18n.localize(\"tokenActionHud.dialog.button.no\")\n    }\n  });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Reset HUD layouts for everyone\n * @public\n */\nasync function resetAllLayouts() {\n  if (!game.tokenActionHud) return;\n\n  const customLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=customLayout]\");\n  if (customLayoutElement) {\n    await Utils.setSetting(\"customLayout\", customLayoutElement?.value ?? \"\");\n  }\n\n  const userCustomLayoutElement = document.querySelector(\"#token-action-hud-core-settings input[name=userCustomLayout]\");\n  if (userCustomLayoutElement) {\n    await Utils.setUserFlag(\"userCustomLayout\", userCustomLayoutElement?.value ?? \"\");\n  }\n\n  await game.tokenActionHud.socket.executeForEveryone(\"reset\");\n  Logger.info(\"All layouts reset\", true);\n}\n","import { MODULE, LAYOUT_SETTING, TEMPLATE } from \"../core/constants.mjs\";\nimport { resetLayoutDialog } from \"../dialogs/reset-layout.mjs\";\nimport { resetAllLayoutsDialog } from \"../dialogs/reset-all-layouts.mjs\";\nimport { Utils } from \"../core/utils.mjs\";\n\nconst { ApplicationV2, HandlebarsApplicationMixin } = foundry.applications.api;\n\nexport class TahSettingsForm extends HandlebarsApplicationMixin(ApplicationV2) {\n  constructor(...args) {\n    super(args);\n\n    this.settings = {};\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    actions: {\n      exportLayout: TahSettingsForm.exportLayout,\n      resetLayout: resetLayoutDialog,\n      resetAllLayouts: resetAllLayoutsDialog,\n      reset: TahSettingsForm.reset\n    },\n    classes: [`${MODULE.ID}-app`, \"sheet\"],\n    id: \"token-action-hud-core-settings\",\n    form: {\n      closeOnSubmit: true,\n      handler: TahSettingsForm.submit\n    },\n    position: {\n      width: 600,\n      height: 800\n    },\n    tag: \"form\",\n    window: {\n      minimizable: true,\n      resizable: true\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  static PARTS = {\n    form: {\n      template: TEMPLATE.settings\n    }\n  };\n\n  /* -------------------------------------------- */\n\n  async _prepareContext() {\n    const settings = [];\n    const context = { settings };\n\n    for (const [key, setting] of Object.entries(this.settings)) {\n      const { scope, hint, icon, label, name, type, inputType, range, choices, action } = setting;\n\n      if (scope === \"world\" && !game.user.isGM) continue;\n\n      const value = (setting?.scope)\n        ? (scope === \"user\")\n          ? await Utils.getUserFlag(key)\n          : await Utils.getSetting(key)\n        : \"\";\n      const settingType = type instanceof Function ? type.name : \"String\";\n      const isButton = inputType === \"button\";\n      const isCheckbox = inputType === \"checkbox\";\n      const isFilePicker = inputType === \"filePicker\";\n      const filePickerType = (inputType === \"filePicker\") ? settingType ?? \"any\" : \"\";\n      const isNumber = inputType === \"number\";\n      const isRange = (inputType === \"range\") && range;\n      const isSelect = choices !== undefined;\n      settings.push({\n        id: key,\n        hint: game.i18n.localize(hint),\n        icon,\n        label: game.i18n.localize(label),\n        name: game.i18n.localize(name),\n        value,\n        type,\n        isButton,\n        action,\n        isCheckbox,\n        isFilePicker,\n        filePickerType,\n        isNumber,\n        isRange,\n        isSelect\n      });\n    }\n    return context;\n  }\n\n  /* -------------------------------------------- */\n\n  static exportLayout() {\n    if (!game.tokenActionHud) return;\n    game.tokenActionHud.hudManager.layoutHandler.exportLayout();\n  }\n\n  static async submit(event, form, formData) {\n    for (const [key, value] of Object.entries(formData.object)) {\n      switch (this.settings[key].scope) {\n        case \"client\":\n        case \"world\":\n          await Utils.setSetting(key, value); break;\n        case \"user\":\n          await Utils.setUserFlag(key, value); break;\n      }\n\n      await game.tokenActionHud.updateCachedSettings(key, value);\n    }\n\n    game.tokenActionHud.update();\n  }\n}\n\n/* -------------------------------------------- */\n\nexport class TahSettingsFormLayout extends TahSettingsForm {\n  constructor() {\n    super();\n    this.settings = LAYOUT_SETTING;\n  }\n\n  /* -------------------------------------------- */\n\n  static DEFAULT_OPTIONS = {\n    window: {\n      title: \"tokenActionHud.settings.layout.form.title\"\n    }\n  };\n}\n","import { CustomStyleForm } from \"../applications/custom-style-form.mjs\";\nimport { TahSettingsFormLayout } from \"../applications/settings-form.mjs\";\nimport { CUSTOM_STYLE, MODULE } from \"./constants.mjs\";\nimport { Logger, Utils } from \"./utils.mjs\";\n\n/**\n * When a module setting is changed, update the HUD settings\n * @param {string} key The setting key\n * @param {*} value    The setting value\n */\nfunction onChangeFunction(key, value) {\n  if (game.tokenActionHud) game.tokenActionHud.updateCachedSettings(key, value);\n}\n\n/* -------------------------------------------- */\n\n// Register key bindings\nHooks.on(\"init\", async () => {\n  game.keybindings.register(MODULE.ID, \"enableDisableHud\", {\n    name: game.i18n.localize(\"tokenActionHud.enableDisableHud\"),\n    editable: [],\n    onDown: () => { if (game.tokenActionHud) game.tokenActionHud.toggleHudEnable(); }\n  });\n\n  game.keybindings.register(MODULE.ID, \"collapseExpandHud\", {\n    name: game.i18n.localize(\"tokenActionHud.collapseExpandHud\"),\n    editable: [],\n    onDown: () => { if (game.tokenActionHud) game.tokenActionHud.toggleHudCollapse(); }\n  });\n});\n\n/* -------------------------------------------- */\n\n/**\n * Register module settings\n * @param {class} systemManager The system manager\n * @param {Array} rollHandlers  The available roll handlers\n * @param {object} styles       The styles\n */\nexport const registerSettingsCore = function(systemManager, rollHandlers, styles) {\n  game.settings.registerMenu(MODULE.ID, \"customStyle\", {\n    hint: game.i18n.localize(\"tokenActionHud.settings.customStyle.hint\"),\n    label: game.i18n.localize(\"tokenActionHud.settings.customStyle.label\"),\n    name: game.i18n.localize(\"tokenActionHud.settings.customStyle.name\"),\n    icon: \"fas fa-palette\",\n    type: CustomStyleForm,\n    restricted: false,\n    scope: \"client\"\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.registerMenu(MODULE.ID, \"layout\", {\n    hint: game.i18n.localize(\"tokenActionHud.settings.layout.hint\"),\n    label: game.i18n.localize(\"tokenActionHud.settings.layout.label\"),\n    name: game.i18n.localize(\"tokenActionHud.settings.layout.name\"),\n    icon: \"fas fa-table-layout\",\n    type: TahSettingsFormLayout,\n    restricted: false,\n    scope: \"client\"\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"startup\", {\n    name: \"One-Time Startup Prompt\",\n    scope: \"world\",\n    config: false,\n    type: Boolean,\n    default: false\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"migrationVersion\", {\n    name: \"Migration Version\",\n    scope: \"world\",\n    config: false,\n    type: String,\n    default: \"0.0\"\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enable\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enable.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enable.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enable\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"rollHandler\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.rollHandler.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.rollHandler.hint\"),\n    scope: \"world\",\n    config: true,\n    type: String,\n    choices: rollHandlers,\n    default: \"core\",\n    onChange: value => {\n      onChangeFunction(\"rollHandler\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  const styleChoices = Object.fromEntries(Object.entries(styles).map(([key, value]) => [key, value.name]));\n\n  game.settings.register(MODULE.ID, \"style\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.style.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.style.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"foundryVTT\",\n    choices: styleChoices,\n    onChange: value => {\n      Utils.switchCSS(value);\n      onChangeFunction(\"style\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"customLayout\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.customLayout.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.customLayout.hint\"),\n    scope: \"world\",\n    config: false,\n    type: String\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"userCustomLayout\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.userCustomLayout.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.userCustomLayout.hint\"),\n    scope: \"client\",\n    config: false,\n    type: String\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"allow\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.allow.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.allow.hint\"),\n    scope: \"world\",\n    config: true,\n    type: String,\n    choices: {\n      4: game.i18n.localize(\"tokenActionHud.settings.allow.choice.4\"),\n      3: game.i18n.localize(\"tokenActionHud.settings.allow.choice.3\"),\n      2: game.i18n.localize(\"tokenActionHud.settings.allow.choice.2\"),\n      1: game.i18n.localize(\"tokenActionHud.settings.allow.choice.1\")\n    },\n    default: 1,\n    requiresReload: true\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enableCustomization\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enableCustomization.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enableCustomization.hint\"),\n    scope: \"world\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enableCustomization\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enableCompendiumActions\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enableCompendiumActions.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enableCompendiumActions.hint\"),\n    scope: \"world\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enableCompendiumActions\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"enableMacroActions\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.enableMacroActions.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.enableMacroActions.hint\"),\n    scope: \"world\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"enableMacroActions\", value);\n    }\n  });\n\n   /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"direction\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.direction.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.direction.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"auto\",\n    choices: {\n      auto: game.i18n.localize(\"tokenActionHud.settings.direction.choice.auto\"),\n      up: game.i18n.localize(\"tokenActionHud.settings.direction.choice.up\"),\n      down: game.i18n.localize(\"tokenActionHud.settings.direction.choice.down\")\n    },\n    onChange: value => {\n      onChangeFunction(\"direction\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"grid\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.grid.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.grid.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"grid\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"scale\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.scale.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.scale.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Number,\n    range: {\n      min: 0.5,\n      max: 2,\n      step: 0.05\n    },\n    default: 1,\n    onChange: value => {\n      onChangeFunction(\"scale\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"drag\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.drag.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.drag.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"whenUnlocked\",\n    choices: {\n      always: game.i18n.localize(\"tokenActionHud.settings.drag.choices.always\"),\n      whenUnlocked: game.i18n.localize(\"tokenActionHud.settings.drag.choices.whenUnlocked\"),\n      never: game.i18n.localize(\"tokenActionHud.settings.drag.choices.never\")\n    },\n    onChange: value => {\n      onChangeFunction(\"drag\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"alwaysShowHud\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.alwaysShowHud.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.alwaysShowHud.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"alwaysShowHud\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"clickOpenCategory\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.clickOpenCategory.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.clickOpenCategory.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"clickOpenCategory\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"collapsibleSubgroups\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.collapsibleSubgroups.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.collapsibleSubgroups.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"collapsibleSubgroups\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"displayCharacterName\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.displayCharacterName.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.displayCharacterName.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"displayCharacterName\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"sortActions\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.sortActions.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.sortActions.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"sortActions\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"displayIcons\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.displayIcons.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.displayIcons.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: true,\n    onChange: value => {\n      onChangeFunction(\"displayIcons\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"tooltips\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.tooltips.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.tooltips.hint\"),\n    scope: \"client\",\n    config: true,\n    type: String,\n    default: \"full\",\n    choices: {\n      full: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.full\"),\n      nameOnly: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.nameOnly\"),\n      none: game.i18n.localize(\"tokenActionHud.settings.tooltips.choices.none\")\n    },\n    onChange: value => {\n      onChangeFunction(\"tooltips\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"tooltipDelay\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.tooltipDelay.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.tooltipDelay.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Number,\n    default: 1500,\n    onChange: value => {\n      setTooltipDelay(value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  const tooltipDelay = Utils.getSetting(\"tooltipDelay\") || 1500;\n  setTooltipDelay(tooltipDelay);\n\n  /**\n   * Set the tooltip delay\n   * @param {number} ms Delay amount in milliseconds\n   */\n  function setTooltipDelay(ms) {\n    const root = document.querySelector(\":root\");\n    root.style.setProperty(\"--tah-tooltip-delay\", `${ms}ms`);\n  }\n\n  /* -------------------------------------------- */\n\n  if (Utils.isModuleActive(\"itemacro\") && !Utils.isModuleActive(\"midi-qol\")) {\n    game.settings.register(MODULE.ID, \"itemMacro\", {\n      name: game.i18n.localize(\"tokenActionHud.settings.itemMacro.name\"),\n      hint: game.i18n.localize(\"tokenActionHud.settings.itemMacro.hint\"),\n      scope: \"client\",\n      config: true,\n      type: String,\n      choices: {\n        both: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.both\"),\n        itemMacro: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.itemMacro\"),\n        original: game.i18n.localize(\"tokenActionHud.settings.itemMacro.choices.original\")\n      },\n      default: \"both\",\n      onChange: value => {\n        onChangeFunction(\"itemMacro\", value);\n      }\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"activeCssAsText\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.activeCssAsText.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.activeCssAsText.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"activeCssAsText\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  game.settings.register(MODULE.ID, \"debug\", {\n    name: game.i18n.localize(\"tokenActionHud.settings.debug.name\"),\n    hint: game.i18n.localize(\"tokenActionHud.settings.debug.hint\"),\n    scope: \"client\",\n    config: true,\n    type: Boolean,\n    default: false,\n    onChange: value => {\n      onChangeFunction(\"debug\", value);\n    }\n  });\n\n  /* -------------------------------------------- */\n\n  registerCustomStyleSettings();\n\n  systemManager.registerSettings(onChangeFunction);\n\n  Logger.debug(\"Available roll handlers\", { rollHandlers });\n};\n\n/* -------------------------------------------- */\n\n/**\n * Register color settings\n */\nfunction registerCustomStyleSettings() {\n  for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n    game.settings.register(MODULE.ID, key, {\n      scope: \"client\",\n      config: false,\n      type: value.type,\n      default: value.default\n    });\n  }\n}\n","import { ActionHandlerExtender } from \"./action-handler-extender.mjs\";\nimport { DELIMITER, ITEM_MACRO_ICON } from \"../../core/constants.mjs\";\nimport { Utils } from \"../../core/utils.mjs\";\n\n/**\n * Handler for building actions related to the Item Macro module.\n */\nexport class ItemMacroActionHandlerExtender extends ActionHandlerExtender {\n  constructor() {\n    super();\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Extend the action list\n   * @override\n   */\n  extendActionHandler() {\n    if (!this.actor) return;\n\n    const items = this.actor.items.filter(item => item.flags?.itemacro?.macro?.command);\n    if (!items?.length) return;\n\n    const itemMacroSetting = Utils.getSetting(\"itemMacro\");\n    if (itemMacroSetting === \"original\") return;\n\n    const replaceExisting = itemMacroSetting === \"itemMacro\";\n\n    Object.values(this.groupHandler.groups).forEach(group => {\n      this.#addGroupActions(items, group, replaceExisting);\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add group actions\n   * @private\n   * @param {Array} items     The items\n   * @param {object} group    The group\n   * @param {boolean} replace Whether to replace the action or not\n   */\n  #addGroupActions(items, group, replace) {\n    // Exit if no actions exist\n    if (!group?.actions?.length) return;\n\n    const actions = [];\n    for (const existingAction of group.actions) {\n      const item = items.find(item => item.id === existingAction.id);\n      if (!item) continue;\n\n      const existingItemMacroAction = group.actions.find(action => action.id === `itemMacro+${existingAction.id}`);\n      const actionToReplace = existingItemMacroAction ?? existingAction;\n\n      if (existingItemMacroAction) replace = true;\n\n      const macroAction = this.#createItemMacroAction(item, existingAction, actionToReplace, replace);\n\n      if (!replace) {\n        actions.push(macroAction);\n      }\n\n      if (!this.actionHandler.availableActions.has(macroAction.id)) {\n        this.actionHandler.availableActions.set(macroAction.id, macroAction);\n      }\n    }\n\n    this.#addActions(actions, group);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Create item macro action\n   * @private\n   * @param {object} item            The item\n   * @param {object} existingAction  The existing action\n   * @param {object} actionToReplace The action to replace\n   * @param {boolean} replace        Whether to replace the action or not\n   * @returns {object}               The item macro action\n   */\n  #createItemMacroAction(item, existingAction, actionToReplace, replace) {\n    const action = (replace) ? actionToReplace : Utils.deepClone(existingAction);\n    action.encodedValue = `itemMacro${existingAction.encodedValue?.substr(existingAction.encodedValue.indexOf(DELIMITER))}`;\n    action.id = `itemMacro+${existingAction.id}`;\n    action.fullName = existingAction.fullName;\n    action.listName = `Item Macro: ${existingAction.fullName}`;\n    action.name = existingAction.name;\n    action.img = existingAction.img;\n    action.itemMacroIcon = `<i class=\"${ITEM_MACRO_ICON.ICON}\" data-tooltip=\"${ITEM_MACRO_ICON.TOOLTIP}\"></i>`;\n    action.selected = existingAction.userSelected ?? existingAction.systemSelected;\n\n    action.onClick = () => {\n      try {\n        item.executeMacro();\n      } catch(err) {\n        Logger.debug(\"ItemMacro Error\", err);\n        return false;\n      }\n    };\n\n    return action;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add actions to the group\n   * @private\n   * @param {object} actions The actions\n   * @param {object} group   The group\n   */\n  #addActions(actions, group) {\n    actions.forEach(macroAction => {\n      const index = group.actions.findIndex(action => action.id === macroAction.id) + 1;\n      group.actions.splice(index, 0, macroAction);\n    });\n  }\n}\n","import { registerSettingsCore } from \"../core/settings.mjs\";\nimport { ItemMacroActionHandlerExtender } from \"../handlers/action-handlers/item-macro-extender.mjs\";\nimport { RollHandler } from \"../handlers/roll-handlers/roll-handler.mjs\";\nimport { MODULE, CSS_STYLE } from \"../core/constants.mjs\";\nimport { Logger, Utils } from \"../core/utils.mjs\";\n\nexport class SystemManager {\n  constructor() {\n    this.coreModuleId = MODULE.ID;\n    this.defaults = [];\n    this.styles = null;\n  }\n\n  /* -------------------------------------------- */\n  /*  Methods for system modules to override      */\n  /* -------------------------------------------- */\n\n  getActionHandler() {}\n\n  getRollHandler(rollHandlerId) {\n    return false;\n  }\n\n  getAvailableRollHandlers() {}\n\n  registerSettings(onChangeFunction) {}\n\n  async registerDefaults() {}\n\n  registerStyles() {}\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the system manager\n   */\n  async init() {\n    await this.#registerDefaultsCore();\n    this.#registerStylesCore();\n    this.#registerSettingsCore();\n  }\n\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register defaults\n   * @private\n   * @returns {Array} The defaults\n   */\n  async #registerDefaultsCore() {\n    const defaults = await this.registerDefaults() ?? [];\n\n    Hooks.callAll(\"tokenActionHudCoreRegisterDefaults\", defaults);\n\n    if (defaults) {\n      this.defaults = defaults;\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register styles\n   * @private\n   */\n  #registerStylesCore() {\n    const systemStyles = this.registerStyles() ?? {};\n    this.styles = foundry.utils.mergeObject(CSS_STYLE, systemStyles);\n\n    Hooks.callAll(\"tokenActionHudCoreRegisterStyles\", this.styles);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Register module settings\n   * @private\n   */\n  #registerSettingsCore() {\n    const rollHandlers = this.getAvailableRollHandlers();\n    registerSettingsCore(this, rollHandlers, this.styles);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Initialise the action handler\n   * @public\n   * @param {class} hudManager The HudManager instance\n   * @returns {class}          The ActionHandler instance\n   */\n  getActionHandlerCore(hudManager) {\n    const actionHandler = this.getActionHandler();\n    actionHandler.systemManager = this;\n\n    const { dataHandler, groupHandler } = hudManager;\n    actionHandler.hudManager = hudManager;\n    actionHandler.dataHandler = dataHandler;\n    actionHandler.groupHandler = groupHandler;\n    actionHandler.addGroup = groupHandler.addGroup.bind(groupHandler);\n    actionHandler.addGroupInfo = groupHandler.addGroupInfo.bind(groupHandler);\n    this.#addActionHandlerExtenders(groupHandler, actionHandler);\n\n    Hooks.callAll(\"tokenActionHudCoreAddActionHandler\", actionHandler);\n\n    return actionHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add action handler extensions\n   * @public\n   * @param {class} groupHandler The GroupHandler instance\n   * @param {class} actionHandler The ActionHandler instance\n   */\n  #addActionHandlerExtenders(groupHandler, actionHandler) {\n    if (Utils.isModuleActive(\"itemacro\") && !Utils.isModuleActive(\"midi-qol\")) {\n      actionHandler.addActionHandlerExtender(new ItemMacroActionHandlerExtender(groupHandler, actionHandler));\n    }\n\n    Hooks.callAll(\"tokenActionHudCoreAddActionHandlerExtenders\", actionHandler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the roll handler\n   * @public\n   * @param {class} hudManager The HudManager instance\n   * @returns {class}          The RollHandler instance\n   */\n  getRollHandlerCore(hudManager) {\n    let rollHandlerId = Utils.getSetting(\"rollHandler\");\n\n    if (!(rollHandlerId === \"core\" || Utils.isModuleActive(rollHandlerId))) {\n      Logger.error(rollHandlerId, game.i18n.localize(\"tokenActionHud.handlerNotFound\"));\n      rollHandlerId = \"core\";\n      Utils.setSetting(\"rollHandler\", rollHandlerId);\n    }\n\n    // If no system RollHandler is returned, use core RollHandler\n    const rollHandler = this.getRollHandler(rollHandlerId) ?? new RollHandler();\n    rollHandler.hudManager = hudManager;\n\n    this.#addRollHandlerExtenders(rollHandler);\n\n    Hooks.callAll(\"tokenActionHudCoreAddRollHandler\", rollHandler);\n\n    return rollHandler;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add roll handler extensions\n   * @public\n   * @param {class} rollHandler The roll handler\n   */\n  #addRollHandlerExtenders(rollHandler) {\n    Hooks.callAll(\"tokenActionHudCoreAddRollHandlerExtenders\", rollHandler);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Add handler\n   * @param {Array} choices The choices\n   * @param {string} id     The module id\n   */\n  static addHandler(choices, id) {\n    if (Utils.isModuleActive(id)) {\n      const title = Utils.getModuleTitle(id);\n      foundry.utils.mergeObject(choices, { [id]: title });\n    }\n  }\n}\n","import { MODULE } from \"./constants.mjs\";\nimport { ActionHandler } from \"../handlers/action-handlers/action-handler.mjs\";\nimport { ActionHandlerExtender } from \"../handlers/action-handlers/action-handler-extender.mjs\";\nimport { DataHandler } from \"../handlers/data-handler.mjs\";\nimport { PreRollHandler } from \"../handlers/roll-handlers/pre-roll-handler.mjs\";\nimport { RollHandler } from \"../handlers/roll-handlers/roll-handler.mjs\";\nimport { RollHandlerExtender } from \"../handlers/roll-handlers/roll-handler-extender.mjs\";\nimport { SystemManager } from \"../managers/system-manager.mjs\";\nimport { Logger, Timer, Utils } from \"./utils.mjs\";\n\n/**\n * Register the API\n */\nexport function registerApi() {\n  const module = game.modules.get(MODULE.ID);\n  module.api = {\n    ActionHandlerExtender,\n    ActionHandler,\n    DataHandler,\n    Logger,\n    PreRollHandler,\n    RollHandler,\n    RollHandlerExtender,\n    SystemManager,\n    Timer,\n    Utils\n  };\n\n  Hooks.callAll(\"tokenActionHudCoreApiReady\", module);\n}\n","import { MODULE, TEMPLATE } from \"./core/constants.mjs\";\nimport { DataHandler } from \"./handlers/data-handler.mjs\";\nimport { MigrationManager } from \"./managers/migration-manager.mjs\";\nimport { TokenActionHud } from \"./applications/token-action-hud.mjs\";\nimport { Logger, Utils } from \"./core/utils.mjs\";\nimport { registerSocket, getSocket, isSocketlibActive } from \"./core/sockets.mjs\";\nimport { registerApi } from \"./core/api.mjs\";\n\nlet systemManager;\n\n/**\n * Register hooks\n */\nHooks.once(\"socketlib.ready\", registerSocket);\nHooks.on(\"ready\", registerApi);\nHooks.on(\"tokenActionHudSystemReady\", registerCoreModule);\nHooks.on(\"tokenActionHudCoreReady\", registerHud);\nHooks.on(\"renderHotbar\", (_, html) => addContextMenuListener(html, foundry.utils.isNewerVersion(game.version, \"12.999\") ? \"li.slot\" : \"li.macro\"));\nHooks.on(\"renderSceneNavigation\", (_, html) => addContextMenuListener(html, foundry.utils.isNewerVersion(game.version, \"12.999\") ? \"li.ui-control\" : \"li.scene.nav-item\"));\n\n/* -------------------------------------------- */\n\n/**\n * Register the core module\n * @param {object} systemModule The system module\n */\nasync function registerCoreModule(systemModule) {\n  // Exit if core module version is not compatible with the system module\n  if (!Utils.isSystemModuleCompatible(systemModule.api?.requiredCoreModuleVersion)) return;\n\n  // Exit if socketlit module is not installed or enabled\n  if (!isSocketlibActive()) return;\n\n  // Create new SystemManager and register core and system module settings\n  systemManager = new systemModule.api.SystemManager(MODULE.ID);\n  await systemManager.init();\n\n  // Register Handlebar helpers\n  Utils.registerHandlebars();\n\n  // Load templates\n  if (foundry.utils.isNewerVersion(game.version, \"12.9999\")) {\n    foundry.applications.handlebars.loadTemplates(Object.values(TEMPLATE));\n  } else {\n    loadTemplates(Object.values(TEMPLATE));\n  }\n\n  Hooks.callAll(\"tokenActionHudCoreReady\");\n}\n\n/* -------------------------------------------- */\n\n/**\n * Register the TokenActionHud application\n */\nasync function registerHud() {\n  // Get socket\n  const socket = getSocket();\n\n  // Initialise DataHandler\n  const dataHandler = new DataHandler(socket);\n  await dataHandler.init();\n\n  // Initialise MigrationManager\n  const migrationManager = new MigrationManager(dataHandler, socket);\n  await migrationManager.init();\n\n  checkColorPicker();\n  registerHudHooks();\n\n  game.tokenActionHud = new TokenActionHud(systemManager, dataHandler, socket);\n  await game.tokenActionHud.init();\n\n  Hooks.callAll(\"tokenActionHudReady\");\n\n  game.tokenActionHud.update({ type: \"hook\", name: \"tokenActionHudCoreReady\" });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Notify GM if the Color Picker is not active\n */\nfunction checkColorPicker() {\n  if (game.user.isGM && !game.modules.get(\"color-picker\")?.active && Utils.getSetting(\"startup\") === false) {\n    Logger.info(\"To enable color pickers, install the 'Color Picker' module.\", true);\n    Utils.setSetting(\"startup\", true);\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * Register HUD-related hooks\n */\nfunction registerHudHooks() {\n  Hooks.on(\"renderTokenActionHud\", () => game.tokenActionHud.postRender());\n  const hooks = [\n    \"deleteActor\", \"updateActor\", \"createActiveEffect\", \"deleteActiveEffect\",\n    \"createCombat\", \"deleteCombat\", \"updateCombat\", \"updateCombatant\",\n    \"deleteCompendium\", \"updateCompendium\", \"createItem\", \"deleteItem\",\n    \"updateItem\", \"createMacro\", \"deleteMacro\", \"updateMacro\", \"controlToken\",\n    \"deleteToken\", \"updateToken\", \"closeSettingsConfig\", \"forceUpdateTokenActionHud\"\n  ];\n\n  hooks.forEach(hook => Hooks.on(hook, (...args) => handleHookEvent({ ...args }, hook)));\n}\n\n/* -------------------------------------------- */\n\n/**\n * Handle hook events\n * @param {object} hookData The hook data\n * @param {string} hookName The hook name\n */\nfunction handleHookEvent(hookData, hookName) {\n  if (!validateHookData(hookData, hookName)) return;\n  game.tokenActionHud.update({ type: \"hook\", name: hookName, data: hookData });\n}\n\n/* -------------------------------------------- */\n\n/**\n * Validate hook data\n * @param {object} hookData The hook data\n * @param {string} hookName The hook name\n * @returns {boolean}\n */\nfunction validateHookData(hookData, hookName) {\n  if (!game.tokenActionHud) return false;\n  switch (hookName) {\n    case \"deleteActor\":\n    case \"updateActor\":\n      return game.tokenActionHud.isValidActorOrItemUpdate(hookData[0], hookData[1]);\n    case \"createActiveEffect\":\n    case \"deleteActiveEffect\":\n      return game.tokenActionHud.isControlledActor(hookData[0]?.parent);\n    case \"createCombatant\":\n    case \"updateCombatant\":\n      return game.tokenActionHud.isControlledActor(hookData[0]?.actor);\n    case \"deleteCompendium\":\n    case \"updateCompendium\":\n      return validateCompendium(hookData.source?.metadata?.id);\n    case \"createItem\":\n    case \"deleteItem\":\n    case \"updateItem\":\n      return game.tokenActionHud.isValidActorOrItemUpdate(hookData[0]?.actor);\n    case \"createMacro\":\n    case \"deleteMacro\":\n    case \"updateMacro\":\n      game.tokenActionHud.hudManager.actionHandler.macroActionHandler.clearCache();\n      return true;\n    case \"updateToken\":\n      return Object.hasOwn(hookData[1], \"hidden\") && game.tokenActionHud.isValidTokenChange(hookData[0], hookData[1]);\n    default:\n      return true;\n  }\n}\n\n/* -------------------------------------------- */\n\n/**\n * Validate compendium hook\n * @param {string} id The compendium ID\n * @returns {boolean} Whether the compendium hook is valid\n */\nfunction validateCompendium(id) {\n  const compendiumHandler = game.tokenActionHud.hudManager.actionHandler.compendiumActionHandler;\n  if (!compendiumHandler.isLinkedCompendium(id)) return false;\n  compendiumHandler.compendiumActions = new Map();\n  return true;\n}\n\n/* -------------------------------------------- */\n\n/**\n * Add context menu listeners\n * @param {object} html     The HTML\n * @param {string} selector The selector for the HTML element\n */\nfunction addContextMenuListener(html, selector) {\n  // Supports both v12 and v13\n  const htmlElement = html[0] ?? html;\n  const element = htmlElement.querySelector(selector);\n  if (element) element.addEventListener(\"contextmenu\", sendHudToBottom);\n}\n\n/* -------------------------------------------- */\n\n/**\n * Send HUD to bottom\n */\nfunction sendHudToBottom() {\n  if (game.tokenActionHud?.element) {\n    game.tokenActionHud.element.style.zIndex = 20;\n  }\n}\n"],"names":["MODULE","ID","NAME","TEMPLATE_DIR","TEMPLATE","action","customStyleForm","group","hud","listSubgroup","settings","tabSubgroup","tagifyAppHud","tagifyAppGroup","tagifyAppSubgroup","DELIMITER","ACTION_TYPE","compendiumEntry","compendiumMacro","compendiumPlaylist","macro","COMPENDIUM_PACK_TYPES","CSS_STYLE","foundryVTT","class","file","moduleId","name","primaryColor","secondaryColor","tertiaryColor","compact","dockedLeft","isDocked","dockPosition","dockedCenterRight","collapseIcon","expandIcon","dockedRight","foundryVttLight","pathfinder","highContrast","custom","CUSTOM_STYLE","backgroundColor","cssProperty","type","String","default","buttonHeight","Number","buttonBackgroundColor","buttonBorderPrimaryColor","buttonBorderSecondaryColor","buttonTextColor","buttonHoverBorderPrimaryColor","buttonHoverBorderSecondaryColor","buttonHoverBackgroundColor","buttonHoverTextColor","buttonToggleActiveBackgroundColor","buttonToggleActiveBorderPrimaryColor","buttonToggleActiveBorderSecondaryColor","buttonToggleActiveTextColor","buttonToggleHoverBackgroundColor","buttonToggleHoverBorderPrimaryColor","buttonToggleHoverBorderSecondaryColor","buttonToggleHoverTextColor","textPrimaryColor","textSecondaryColor","textTertiaryColor","textHoverPrimaryColor","textHoverSecondaryColor","textHoverTertiaryColor","GROUP_TYPE","COMPENDIUM","CUSTOM","SYSTEM","SYSTEM_DERIVED","HUD","DEFAULT_HEIGHT","DEFAULT_WIDTH","DEFAULT_LEFT_POS","DEFAULT_TOP_POS","DEFAULT_SCALE","DEFAULT_ZINDEX","ITEM_MACRO_ICON","ICON","TOOLTIP","LAYOUT_SETTING","customLayout","hint","inputType","filePickerType","dtype","scope","userCustomLayout","exportLayout","label","icon","resetLayout","resetAllLayouts","SETTING","activeCssAsText","classes","cache","allow","alwaysShowHud","clickOpenCategory","customStyle","debug","direction","displayCharacterName","displayIcons","drag","enable","enableCustomization","grid","itemMacro","migrationVersion","reset","renderItemOnRightClick","rollHandler","scale","sortActions","startup","style","tooltips","Logger$1","Logger","info","message","notify","ui","notifications","console","log","error","permanent","data","isDebug","game","tokenActionHud","setting","Utils","getSetting","dataClone","deepClone","Timer","constructor","milliseconds","this","timer","start","abort","Promise","resolve","setTimeout","clearTimeout","checkAllow","userRole","allowSetting","capitalize","value","replace","text","charAt","toUpperCase","substring","toLowerCase","original","options","foundry","utils","getActor","actorId","tokenId","token","canvas","tokens","placeables","find","id","actor","actors","get","getClosestGroupElement","event","target","closest","getControlledActors","controlled","map","getStatusEffect","statusId","effects","effect","statuses","every","status","getImage","entity","defaultImages","push","result","img","includes","getItem","itemId","items","getToken","getControlledTokens","getFirstControlledToken","controlledToken","character","user","key","defaultValue","setSetting","set","getActorFlag","getFlag","setActorFlag","setFlag","unsetActorFlag","unsetFlag","getUserFlag","setUserFlag","unsetUserFlag","i18n","toTranslate","localize","isGmActive","users","some","isGM","active","isModuleActive","module","modules","getModuleTitle","title","getModuleVersion","version","humanizeBinding","keyboardManager","helpers","interaction","KeyboardManager","binding","keybindings","stringParts","modifiers","reduce","parts","part","MODIFIER_CODES","unshift","getKeycodeDisplayString","join","median","numbers","mid","Math","floor","length","nums","sort","a","b","getUpperQuartileAverage","sortedNumbers","slice","startIndex","ceil","endIndex","sum","count","i","upperQuartileAverage","getModifier","num","sign","sortItems","Map","entries","localeCompare","sortItemsByName","switchCSS","tahElement","document","querySelector","styleClass","isNewerVersion","classList","contains","classesToRemove","filter","c","remove","add","registerHandlebars","Handlebars","registerHelper","string","reduceOp","args","reducer","Array","from","pop","first","shift","tokenActionHudCoreTrue","arguments","block","fn","inverse","getModuleVersionParts","moduleVersion","trigger","moduleVersionParts","split","major","minor","patch","isSystemModuleCompatible","requiredCoreModuleVersion","requiredCoreModuleVersionParts","coreModuleVersionParts","requiredVersion","installedVersion","getNestedGroups","groups","order","groupId","groupType","isArray","Object","values","foundGroups","level","nestId","assign","keys","getGroupByNestId","findGroup","async","groupStyle","foundGroup","deleteGroupByNestId","findAndDeleteGroup","index","splice","deleteGroupsById","filePicker","applications","apps","FilePicker","implementation","DataHandler","socket","init","createDirectories","all","private","isPrivate","fileMap","getFilePathsAsGm","isPersistentStorage","ForgeVTT","DATA_FOLDER","moduleDirectory","directoriesToCreate","world","directory","browse","catch","createDirectory","path","getFileParts","filename","folder","hasPermission","files","getFilePaths","executeAsGM","getFilePathsWithSocket","dataHandler","actorFiles","userFiles","canSaveData","saveDataAsGm","saveData","saveDataWithSocket","fileName","encodeURI","File","JSON","stringify","response","upload","has","canGetData","getDataAsGm","getData","getDataWithSocket","foundFile","foundFolder","endsWith","ms","Date","now","fetch","ok","json","getDataMigrate","folderPath","foundFolderPath","foundFilePath","then","MigrationManager","isSuccess","unsetOldFlags","migrateFiles","objects","children","scene","scenes","err","CharacterHandler","hudManager","groupHandler","actionHandler","previousActorId","setCharacter","isCharacter","isMultipleTokens","controlledTokens","isSameActor","resetCharacter","handleMultipleTokens","handleSingleToken","characterName","isValidCharacter","t","testUserPermission","LayoutHandler","systemManager","defaultLayout","setDefaultLayout","setCustomLayout","softReset","hardReset","defaults","layout","userId","saveDataToFile","getTooltip","tooltip","content","styles","GroupHandler","layoutHandler","defaultGroups","actorGroups","userGroups","setDefaultGroups","setSavedActorGroups","setSavedUserGroups","defaultGroup","getUserGroups","savedUserData","prepareGroups","userGroup","createGroup","parentNestId","parentGroup","tabs","lists","getActorGroups","actorGroup","existingGroup","actions","getGroup","getGroups","selected","startsWith","getGroupIds","getGroupSettings","groupData","keepData","groupDataClone","nestIdParts","defaultSettings","showTitle","groupSettings","subtitleClass","groupSystem","system","commonProps","cssClass","info1","info2","info3","listName","isSelected","defaultSelected","updateGroups","groupsData","parentGroupData","childGroupData","existingGroups","existingParentGroup","saveGroupSettings","saveGroups","saveActor","saveUser","saveActorGroups","saveUserGroups","getReducedGroupData","keepActions","isPreset","userSelected","getSelectedGroupsAsTags","toTagify","getAvailableGroupAsTags","derivedGroups","getDerivedGroupsAsTags","systemGroups","getSystemGroupsAsTags","compendiumGroups","getCompendiumGroupsAsTags","macroGroups","getMacroGroupsAsTags","packs","pack","documentName","visible","metadata","addGroup","update","parentGroups","updateGroup","updateExistingGroups","removeGroup","addGroupInfo","groupInfo","forEach","setHasActions","hasActions","HudManager","getActionHandlerCore","getRollHandlerCore","characterHandler","isHudEnabled","buildHud","softResetHud","hardResetHud","previousActor","isGmInactiveUserNotified","prepareHud","buildActionsCore","prepareActions","handleHudEvent","eventType","getAction","registerKeyPresses","setIsHover","handleGroupClickCore","handleActionClickCore","handleActionHoverCore","setIsRightClick","setIsAlt","setIsCtrl","setIsShift","button","originalEvent","isRightClick","isModiferActive","keyboard","isModifierActive","MODIFIER_KEYS","ALT","altKey","emulateKeypress","force","downKeys","isAlt","CONTROL","ctrlKey","isCtrl","SHIFT","shiftKey","isShift","isHover","groupElement","dataset","actionButtonElement","actionId","availableActions","role","e","amd","exports","s","r","window","MutationObserver","WebKitMutationObserver","nodeType","observe","childList","subtree","addEventListener","parentElm","uid","selector","callbacks","setup","bind","bindEvents","prototype","namespace","childNodes","parentNode","removeChild","matches","draggable","gap","getItemsGap","firstElementChild","throttle","call","getDraggableElm","dragstart","saveInitialStyles","source","getInitialState","getBoundingClientRect","elm","idx","getNodeIndex","size","width","height","dataTransfer","effectAllowed","dragStart","afterDragStart","mode","dragover","preventDefault","stopPropagation","hoverDirection","dropEffect","getTargetDirection","directionAwareDragEnter","dragenter","isValidElm","bounding","cleanupLastTarget","abs","toggle","dragend","dragoverTimeout","cleanup","nextElementSibling","insertBefore","dragEnd","isTargetLastChild","lastElementChild","pageY","top","pageX","left","previousSibling","test","setAttribute","getAttribute","removeAttribute","getComputedStyle","parseInt","listeners","destroy","DragSort","n","Symbol","iterator","toString","TypeError","isEnabled","TAGIFY_DEBUG","apply","concat","warn","trim","o","indexOf","DOMParser","parseFromString","body","l","d","u","hasOwnProperty","hasInstance","g","next","done","h","p","return","normalize","navigator","userAgent","f","crypto","getRandomValues","Uint8Array","m","classNames","tag","v","tagSelector","getSelection","getRangeAt","createTextNode","deleteContents","insertNode","w","__tagifyTagData","tagElm","y","rangeCount","setStartAfter","collapse","removeAllRanges","addRange","T","before","O","delimiters","pattern","tagTextProp","maxTags","addTagOnBlur","addTagOn","onChangeAfterBlur","duplicates","whitelist","blacklist","enforceWhitelist","userInput","focusable","keepInvalidTags","createInvalidTags","mixTagsAllowedAfter","mixTagsInterpolator","backspace","skipInvalid","pasteAsTags","editTags","clicks","keepInvalid","transformTag","a11y","focusableTags","mixMode","insertAfterTag","autoComplete","enabled","rightKey","tabKey","selectMode","input","focus","tagNoAnimation","tagInvalid","tagNotAllowed","scopeLoading","hasMaxTags","hasNoTags","empty","inputInvalid","dropdown","dropdownWrapper","dropdownHeader","dropdownFooter","dropdownItem","dropdownItemActive","dropdownItemHidden","dropdownItemSelected","dropdownInital","tagText","tagX","tagLoading","tagEditing","tagFlash","tagHide","classname","maxItems","searchKeys","fuzzySearch","caseSensitive","accentedSearch","includeSelectedTags","escapeHTML","highlightFirst","closeOnSelect","clearOnSelect","position","appendTarget","hooks","beforeRemoveTag","beforePaste","suggestionClick","beforeKeyDown","x","defineProperty","enumerable","configurable","writable","D","getOwnPropertySymbols","getOwnPropertyDescriptor","I","getOwnPropertyDescriptors","defineProperties","S","E","M","N","_dropdown","refs","DOM","__tagify","_","A","C","events","onKeyDown","onMouseOver","onMouseLeave","onClick","onScroll","state","hasFocus","composing","dropdownItemActiveSelector","getSuggestionDataByNode","tagify","getAllSuggestionsRefs","getNextOrPrevOption","dropdownItemSelector","highlightOption","hide","ArrowLeft","editing","getMappedValue","autocomplete","tagData","suggestionElm","selectOption","addTags","inputText","raw","charCodeAt","removeTags","editTag","scrollTop","scrollHeight","clientHeight","percentage","round","refilter","query","suggestedListItems","filterListItems","fill","findIndex","ddItemElm","ddItemData","suggest","offsetTop","normalizeTags","onEditTagDone","__isValid","toggleFocusClass","fillHeaderFooter","once","selectAll","suggestions","exact","isTagDuplicate","sortby","mapValueTo","createListHTML","templates","mappedValue","parseTemplate","getHeaderRef","getFooterRef","querySelectorAll","show","dropdownItemNoMatch","isLoading","readonly","dropdownHide__bindEventsTimeout","setStateSelection","render","removeEventListener","selection","flaggedTags","baseOffset","getAppendTarget","cloneNode","cssText","appendChild","dropdownContent","innerHTML","replaceChild","RTL","pageYOffset","fullscreenElement","webkitFullscreenElement","documentElement","max","clientWidth","innerWidth","startContainer","startOffset","createRange","setStart","setEnd","right","bottom","offsetLeft","placeAbove","pageXOffset","k","L","exceed","duplicate","notAllowed","j","wrapper","className","disabled","required","placeholder","getAttributes","P","V","F","R","H","B","W","K","U","customBinding","customEventsList","on","mainEvents","main","bindGlobal","isJQueryPlugin","jQuery","originalInput","removeAllTags","keydown","onKeydown","click","onClickScope","dblclick","onDoubleClickScope","paste","onPaste","drop","onDrop","compositionstart","onCompositionStart","compositionend","onCompositionEnd","inputMutationObserver","onInputDOMChange","disconnect","bindOriginaInputListener","clearInterval","originalInputValueObserverInterval","setInterval","observeOriginalInputValue","global","isIE","cb","onWindowKeyDown","onFocusBlur","onClickAnywhere","useCapture","unbindGlobal","textContent","relatedTarget","addNew","postUpdate","triggerChangeEvent","loading","getTagElms","activeElement","hasAttribute","anchorOffset","anchorNode","createElement","innerText","nodeValue","fromCharCode","previousElementSibling","Element","nodeName","min","nextSibling","blur","inputSuggestion","onInput","onMixTagsInput","inputElm","validateTag","toggleScopeValidation","isValid","search","createDocumentFragment","createTagElem","setRangeAtStartEnd","lastChild","withoutChangeEvent","cloneRange","focusNode","endOffset","match","lastIndexOf","prefix","matchedPatternCount","onInputIE","tagifyValue","loadOriginalValues","fixFirefoxLastTagNoCaret","clipboardData","pastedText","injectAtCaret","tagsElems","onEditTagInput","__tagId","editTagChangeDetected","originalIsValid","newValue","onEditTagPaste","onEditTagClick","onEditTagFocus","onEditTagBlur","__originalData","onEditTagkeydown","__originalHTML","editable","addedNodes","outerHTML","replaceWith","removedNodes","q","z","X","J","G","$","Proxy","removeAllCustomListeners","off","cloneData","triggerHandler","cloneEvent","HTMLElement","CustomEvent","detail","dispatchEvent","isFirefox","documentMode","getPersistedData","localStorage","parse","setPersistedData","setItem","Event","clearPersistedData","removeItem","applySettings","build","getCSSVars","autofocus","placeCaretAfterNode","getSetTagData","sameStr","removeCollectionProp","omit","isObject","parseHTML","extend","concatWithoutDups","getUID","isNodeTag","dataProps","setContentEditable","generateClassSelectors","RegExp","_delimiters","TEXTS","texts","getCustomAttributes","range","CSSVars","tagHideTransition","unit","getPropertyValue","integrated","originalInput_tabIndex","tabIndex","inputSelector","blockChangeEvent","parseMixTags","tagName","insertAdjacentHTML","lastOriginalValueReported","toggleClass","setPlaceholder","bubbles","simulated","_valueTracker","setValue","random","getTagTextNode","tagTextSelector","setTagTextNode","getLastTag","skipValidation","editTagToggleValidity","removeTagsFromValue","previousData","replaceTag","reCheckInvalidTags","getInvalidTagAttrs","updateValueByDOMTags","appendMixTags","validate","substr","replaceTextWithNode","getTagIdx","getTagIndexByValue","getTagElmByValue","flashTag","isTagBlacklisted","isTagWhitelisted","getWhitelistItem","setReadonly","contentEditable","setDisabled","Error","splitText","prepareNewTagNode","__preInvalidData","aggregatedInvalidInput","postProcessNewTagNode","selectTag","appendTag","addEmptyTag","addMixTags","prefixedTextToTag","createNodeIterator","NodeFilter","SHOW_TEXT","nextNode","node","__removed","parseFloat","clientTop","removeTagsFromDOM","setOriginalInputValue","debouncedUpdateTimeout","getInputValue","getCleanValue","getMixedTagsAsString","originalInputValueFormat","removeTag","ApplicationV2","HandlebarsApplicationMixin","api","TagifyApp","super","dragSort","submit","categoryId","subcategoryId","static","resetActions","unselectAllTags","form","closeOnSubmit","handler","minimizable","resizable","_prepareContext","open","dialogType","tags","dialogData","dialogSubmit","prepareHook","dialog","TagifyAppHud","TagifyAppGroup","TagifyAppSubgroup","Hooks","app","html","tagInput","Infinity","onDragEnd","available","Tagify","tagifyInput","dropdownLabelElement","DialogV2","confirm","modal","yes","callback","resetActorData","no","_onKeyDown","close","defaultChoice","buttons","formData","slugify","replacement","strict","object","template","TagifyAppHelper","openEditHudApp","topLabel","choices","callAll","openEditGroupApp","choice","characterCount","customWidth","image","openEditSubgroupApp","getAvailableActionsAsTags","availableGroups","selectedActions","getSelectedActionsAsTags","selectedGroups","_style","updateActions","GroupResizer","minCols","isCustomWidth","spacing","resizeGroup","setVariables","subgroupsElement","setWidth","setHeight","resetVariables","setSubgroupsElement","resetGroupsElements","setSubgroupElementArr","actionsElements","availableHeight","availableWidth","gridWidth","subgroupElementArr","subgroupsElementPadding","subgroupsElementRect","level1GroupElement","groupsElements","maxHeight","overflowY","resetCSS","getGridWidth","emptyStyle","display","gridTemplateColumns","actionWidths","actionWidthsForMedian","actionsElement","actionElements","actionElement","actionRect","actionWidth","actionButtonText","actionButtonTextRect","actionButtonTextWidth","minActionButtonTextWidth","availableactionButtonTextWidth","resizeGrid","groupCustomWidth","assignCSS","squaredCols","sqrt","availableGroupWidth","availableCols","cols","resize","sqrtActions","currentRow","maxRowWidth","rowWidth","maxWidth","getAvailableWidth","windowWidth","screenDimensions","contentLeft","uiRight","uiRightClientWidth","subgroupsElementComputed","paddingLeft","paddingRight","hasGrid","subgroupElement","requestAnimationFrame","getAvailableHeight","windowHeight","innerHeight","contentBottom","contentTop","uiTopBottom","siblingsHeight","sibling","siblings","siblingHeight","uiTopBottomOffsetHeight","offsetHeight","element","elements","TokenActionHud","openGroups","Set","updatePendingTimer","updateTimer","closeTimer","renderTimer","clickGroup","clickSubgroup","clickAction","collapseHud","expandHud","lockHud","unlockHud","editHud","background","zIndex","frame","styleData","context","collapsibleSubgroups","cacheSettings","updateCachedSettings","updateSettingsPending","setPosition","_onRender","cacheElements","setInitialHudState","addHoverEvents","actionArr","tabSubgroupArr","editHudButton","listSubgroupsArr","subgroupsContainerArr","subgroupArr","listSubgroupTitleArr","groupButtonArr","collapseExpandContainer","collapseHudButton","expandHudButton","unlockButton","lockButton","isCollapsed","isUnlocked","toggleGroup","passive","dragEvent","handleActionHover","postRender","rendering","applyDirection","reopenGroups","toggleHudEnable","format","toggleHudCollapse","isCollapsing","toggleHudLock","isUnlocking","toggleElements","hideIfEmpty","bringToFront","currentTarget","handleGroupClick","collapseExpandSubgroup","isOpen","shouldOpen","toggleOtherGroups","groupResizer","delete","groupToIgnore","isParentToIgnore","groupsElement","imageElement","toggleGroupVisibility","parsedLevel","isDraggable","clientX","changedTouches","clientY","pos1","pos2","pos3","pos4","originalElementTop","originalElementLeft","newElementTop","newElementLeft","mouseMoveEvent","topPos","mouseUpEvent","onmousemove","ontouchmove","onmouseup","ontouchend","hudPosition","setDockedPosition","setUndockedPosition","interfaceElement","isV13","sidebarElement","prepend","rightUiElement","leftUiElement","setPositionFromFlag","check","leftPos","obj","bool","resetPosition","copy","fromUserId","toUserIds","copyUserData","fromGroup","resetLayoutWithSocket","resetUserAndActorData","resetAllActorData","resetUserData","resetAllUserData","handleUpdate","performUpdate","isUpdatePending","waitForUpdateCompletion","maxWaitTime","interval","iterations","isUpdating","hasCompleted","initialised","windows","abortUpdate","closeHud","animate","isValidTokenChange","flags","isRelevantToken","isControlledActor","isValidActorOrItemUpdate","registerSocket","socketlib","registerModule","register","isSocketlibActive","getSocket","GenericActionHandler","buildActions","buildUtilities","buildSingleTokenUtilities","buildMultipleTokenUtilities","actionsData","toggleCombatId","toggleCombatName","inCombat","toggleCombatAction","toggleCombatant","toggleVisibilityId","toggleVisibilityName","hidden","toggleVisibilityAction","isHidden","addActions","toggleVisibilityname","CompendiumActionHandler","compendiumActions","packIds","packId","setActions","getIndex","actionType","getCompendiumActionType","entry","createAction","_id","getOnClick","getGroupId","documentId","getOnClickFunction","getOnClickEntry","journalEntry","getDocument","sheet","execute","isLinkedCompendium","MacroActionHandler","clearCache","macroActions","getActions","macros","getListName","ownership","actionTypeName","ActionHandler","genericActionHandler","compendiumActionHandler","macroActionHandler","delimiter","actionHandlerExtenders","buildSystemActionsCore","buildGenericActionsCore","buildCompendiumActionsCore","buildMacroActionsCore","buildExtendedActionsCore","updateNonPresetActions","setCharacterLimit","groupIds","buildSystemActions","extender","extendActionHandler","nonPresetActions","nonPresetAction","availableAction","systemSelected","groupCharacterCount","subgroups","subgroup","subgroupCharacterCount","word","actionData","fullName","infoProps","onHover","encodedValue","icons","icon1","icon2","icon3","isAction","isItem","useRawHtmlName","addToAvailableActions","existingActions","reorderedActions","existingAction","existingActionId","actionClone","addActionHandlerExtender","actionHandlerExtender","ActionHandlerExtender","RollHandler","preRollHandlers","rollHandlerExtenders","throwInvalidValueErr","addRollHandlerExtender","rollHandlerExtender","buttonValue","getButtonValue","prehandleActionEvent","handleActionClick","addPreRollHandler","buttonElement","renderItem","item","isRenderItem","PreRollHandler","RollHandlerExtender","CustomStyleForm","ColorPicker","install","setProperty","isCustom","resetLayoutDialog","customLayoutElement","userCustomLayoutElement","resetAllLayoutsDialog","executeForEveryone","TahSettingsForm","settingType","Function","isButton","isCheckbox","isFilePicker","isNumber","isRange","isSelect","undefined","TahSettingsFormLayout","onChangeFunction","onDown","registerSettingsCore","rollHandlers","registerMenu","restricted","config","Boolean","onChange","styleChoices","fromEntries","requiresReload","auto","up","down","step","always","whenUnlocked","never","full","nameOnly","none","setTooltipDelay","tooltipDelay","root","both","registerCustomStyleSettings","registerSettings","ItemMacroActionHandlerExtender","itemacro","command","itemMacroSetting","replaceExisting","addGroupActions","existingItemMacroAction","actionToReplace","macroAction","createItemMacroAction","itemMacroIcon","executeMacro","SystemManager","coreModuleId","getActionHandler","getRollHandler","rollHandlerId","getAvailableRollHandlers","registerDefaults","registerStyles","registerDefaultsCore","registerStylesCore","systemStyles","mergeObject","addActionHandlerExtenders","addRollHandlerExtenders","addHandler","registerApi","registerCoreModule","systemModule","handlebars","loadTemplates","registerHud","migrationManager","checkColorPicker","registerHudHooks","hook","handleHookEvent","hookData","hookName","validateHookData","parent","validateCompendium","hasOwn","compendiumHandler","addContextMenuListener","htmlElement","sendHudToBottom"],"mappings":"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","x_google_ignoreList":[9,10]}