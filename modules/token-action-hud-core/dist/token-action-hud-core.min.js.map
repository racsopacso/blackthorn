{"version":3,"file":"token-action-hud-core.min.js","sources":["../scripts/constants.js","../scripts/utils.js","../scripts/data-handler.js","../scripts/action-handlers/generic-action-handler.js","../scripts/action-handlers/compendium-action-handler.js","../scripts/action-handlers/macro-action-handler.js","../scripts/action-handlers/action-handler.js","../scripts/action-handlers/action-handler-extender.js","../scripts/migration-manager.js","../scripts/roll-handlers/roll-handler.js","../scripts/roll-handlers/pre-roll-handler.js","../scripts/forms/custom-style-form.js","../scripts/forms/settings-form.js","../scripts/settings.js","../scripts/action-handlers/item-macro-extender.js","../scripts/roll-handlers/compendium-macro-pre-handler.js","../scripts/roll-handlers/pre-item-macro.js","../scripts/system-manager.js","../node_modules/@yaireo/dragsort/dist/dragsort.js","../node_modules/@yaireo/tagify/dist/tagify.min.js","../scripts/dialogs/tag-dialog.js","../scripts/dialogs/tag-dialog-helper.js","../scripts/group-resizer.js","../scripts/token-action-hud.js","../scripts/init.js"],"sourcesContent":["/**\n * Module-based constants\n */\nexport const MODULE = {\n    ID: 'token-action-hud-core',\n    NAME: 'Token Action HUD'\n}\n\n/**\n * Template directory\n */\nconst TEMPLATE_DIR = `modules/${MODULE.ID}/templates`\n\n/**\n * Templates\n */\nexport const TEMPLATE = {\n    action: `${TEMPLATE_DIR}/action.hbs`,\n    customStyleForm: `${TEMPLATE_DIR}/custom-style-form.hbs`,\n    group: `${TEMPLATE_DIR}/group.hbs`,\n    hud: `${TEMPLATE_DIR}/hud.hbs`,\n    listGroup: `${TEMPLATE_DIR}/list-group.hbs`,\n    settings: `${TEMPLATE_DIR}/settings.hbs`,\n    tabGroup: `${TEMPLATE_DIR}/tab-group.hbs`,\n    tagDialogGroup: `${TEMPLATE_DIR}/tag-dialog-group.hbs`,\n    tagDialogHud: `${TEMPLATE_DIR}/tag-dialog-hud.hbs`,\n    tagDialogTopLevelGroup: `${TEMPLATE_DIR}/tag-dialog-top-level-group.hbs`\n}\n\n/**\n * Delimiter character\n */\nexport const DELIMITER = '|'\n\n/**\n * Action types\n */\nexport const ACTION_TYPE = {\n    compendiumEntry: 'tokenActionHud.compendiumEntry',\n    compendiumMacro: 'tokenActionHud.compendiumMacro',\n    compendiumPlaylist: 'tokenActionHud.compendiumPlaylist',\n    macro: 'tokenActionHud.macro'\n}\n\n/**\n * Compendium action types\n */\nexport const COMPENDIUM_ACTION_TYPES = ['compendiumEntry', 'compendiumMacro', 'compendiumPlaylist', 'macro']\n\n/**\n * Compendium pack types\n */\nexport const COMPENDIUM_PACK_TYPES = ['JournalEntry', 'Macro', 'RollTable']\n\n/**\n * CSS styles\n */\nexport const CSS_STYLE = {\n    foundryVTT: {\n        class: 'tah-style-foundry-vtt-dark',\n        file: 'tah-foundry-vtt-dark',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Dark',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    foundryVttLight: {\n        class: 'tah-style-foundry-vtt-light',\n        file: 'tah-foundry-vtt-light',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Light',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    compact: {\n        class: 'tah-style-foundry-vtt',\n        file: 'tah-compact',\n        moduleId: MODULE.ID,\n        name: 'Foundry VTT Compact',\n        primaryColor: '#dddddd',\n        secondaryColor: '#dddddd80',\n        tertiaryColor: '#ff6400'\n    },\n    dorakoUI: {\n        class: 'tah-style-dorako-ui',\n        file: 'tah-dorako',\n        moduleId: MODULE.ID,\n        name: 'Dorako UI'\n    },\n    pathfinder: {\n        class: 'tah-style-pathfinder',\n        file: 'tah-pathfinder',\n        moduleId: MODULE.ID,\n        name: 'Pathfinder'\n    },\n    highContrast: {\n        class: 'tah-style-high-contrast',\n        file: 'tah-high-contrast',\n        moduleId: MODULE.ID,\n        name: 'High Contrast',\n        primaryColor: '#ffff00',\n        secondaryColor: '#ffff00',\n        tertiaryColor: '#0C7BDC'\n    },\n    custom: {\n        class: 'tah-style-custom',\n        file: 'tah-custom',\n        moduleId: MODULE.ID,\n        name: 'Custom'\n    },\n}\n\n/**\n * Custom styles\n */\nexport const CUSTOM_STYLE = {\n    backgroundColor: { cssProperty: '--tah-background-color', type: String, default: '#00000000' },\n    buttonHeight: { cssProperty: '--tah-button-height-editable', type: Number, default: 32 },\n    buttonBackgroundColor: { cssProperty: '--tah-button-background-color-editable', type: String, default: '#000000b3' },\n    buttonBorderPrimaryColor: { cssProperty: '--tah-button-border-primary-color-editable', type: String, default: '#0C0C0CFF' },\n    buttonBorderSecondaryColor: { cssProperty: '--tah-button-border-secondary-color-editable', type: String, default: '#060606FF' },\n    buttonTextColor: { cssProperty: '--tah-button-text-color-editable', type: String, default: '#DDDDDDFF' },\n    buttonHoverBorderPrimaryColor: { cssProperty: '--tah-button-hover-border-primary-color-editable', type: String, default: '#FF6400FF' },\n    buttonHoverBorderSecondaryColor: { cssProperty: '--tah-button-hover-border-secondary-color-editable', type: String, default: '#FF0000FF' },\n    buttonHoverBackgroundColor: { cssProperty: '--tah-button-hover-background-color-editable', type: String, default: '#000000B3' },\n    buttonHoverTextColor: { cssProperty: '--tah-button-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleActiveBackgroundColor: { cssProperty: '--tah-button-toggle-active-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleActiveBorderPrimaryColor: { cssProperty: '--tah-button-toggle-active-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveBorderSecondaryColor: { cssProperty: '--tah-button-toggle-active-border-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleActiveTextColor: { cssProperty: '--tah-button-toggle-active-text-color-editable', type: String, default: '#FFFFFFFF' },\n    buttonToggleHoverBackgroundColor: { cssProperty: '--tah-button-toggle-hover-background-color-editable', type: String, default: '#3C0078BF' },\n    buttonToggleHoverBorderPrimaryColor: { cssProperty: '--tah-button-toggle-hover-border-primary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverBorderSecondaryColor: { cssProperty: '--tah-button-toggle-hover-secondary-color-editable', type: String, default: '#9B8DFFFF' },\n    buttonToggleHoverTextColor: { cssProperty: '--tah-button-toggle-hover-text-color-editable', type: String, default: '#FFFFFFFF' },\n    textPrimaryColor: { cssProperty: '--tah-text-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textSecondaryColor: { cssProperty: '--tah-text-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' },\n    textHoverPrimaryColor: { cssProperty: '--tah-text-hover-primary-color-editable', type: String, default: '#DDDDDDFF' },\n    textHoverSecondaryColor: { cssProperty: '--tah-text-hover-secondary-color-editable', type: String, default: '#DDDDDD80' },\n    textHoverTertiaryColor: { cssProperty: '--tah-text-tertiary-color-editable', type: String, default: '#FF6400FF' }\n}\n\n/**\n * Group types\n */\nexport const GROUP_TYPE = {\n    COMPENDIUM: 'compendium',\n    CUSTOM: 'custom',\n    SYSTEM: 'system',\n    SYSTEM_DERIVED: 'system-derived'\n}\n\n/**\n * Item Macro icon\n */\nexport const ITEM_MACRO_ICON = {\n    ICON: 'fas fa-sd-card',\n    TOOLTIP: 'Item Macro'\n}\n\n/**\n * Layout settings\n */\nexport const LAYOUT_SETTING = {\n    customLayout: {\n        hint: 'tokenActionHud.settings.customLayout.hint',\n        name: 'tokenActionHud.settings.customLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'world'\n    },\n    userCustomLayout: {\n        hint: 'tokenActionHud.settings.userCustomLayout.hint',\n        name: 'tokenActionHud.settings.userCustomLayout.name',\n        inputType: 'filePicker',\n        filePickerType: 'json',\n        dtype: 'String',\n        scope: 'user'\n    },\n    exportLayout: {\n        hint: 'tokenActionHud.settings.exportLayout.hint',\n        label: 'tokenActionHud.settings.exportLayout.label',\n        name: 'tokenActionHud.settings.exportLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-file-export',\n        onClick: 'game?.tokenActionHud?.actionHandler?.exportLayout()'\n    },\n    resetLayout: {\n        hint: 'tokenActionHud.settings.resetLayout.hint',\n        label: 'tokenActionHud.settings.resetLayout.label',\n        name: 'tokenActionHud.settings.resetLayout.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-arrow-rotate-left',\n        onClick: 'game?.tokenActionHud?.resetDialog()',\n        scope: 'client'\n    },\n    resetAllLayouts: {\n        hint: 'tokenActionHud.settings.resetAllLayouts.hint',\n        label: 'tokenActionHud.settings.resetAllLayouts.label',\n        name: 'tokenActionHud.settings.resetAllLayouts.name',\n        inputType: 'button',\n        icon: 'fa-solid fa-bomb',\n        onClick: 'game?.tokenActionHud?.resetAllDialog()',\n        scope: 'world'\n    }\n}\n\n/**\n * Settings\n */\nexport const SETTING = {\n    activeCssAsText: { classes: ['TokenActionHud'], variable: 'activeCssAsTextSetting' },\n    allow: { classes: ['TokenActionHud'], variable: 'allowSetting' },\n    alwaysShowHud: { classes: ['TokenActionHud'], variable: 'alwaysShowHudSetting' },\n    backgroundColor: {},\n    buttonBackgroundColor: {},\n    buttonBorderPrimaryColor: {},\n    buttonBorderSecondaryColor: {},\n    buttonHeight: {},\n    buttonHoverBorderPrimaryColor: {},\n    buttonHoverBorderSecondaryColor: {},\n    buttonHoverBackgroundColor: {},\n    buttonHoverTextColor: {},\n    buttonTextColor: {},\n    buttonToggleActiveBackgroundColor: {},\n    buttonToggleActiveBorderPrimaryColor: {},\n    buttonToggleActiveBorderSecondaryColor: {},\n    buttonToggleActiveTextColor: {},\n    buttonToggleHoverBackgroundColor: {},\n    buttonToggleHoverBorderPrimaryColor: {},\n    buttonToggleHoverBorderSecondaryColor: {},\n    buttonToggleHoverTextColor: {},\n    clickOpenCategory: { classes: ['TokenActionHud'], variable: 'clickOpenCategorySetting' },\n    customLayout: { classes: ['ActionHandler'], variable: 'customLayoutSetting' },\n    customStyle: {},\n    debug: { classes: ['TokenActionHud'], variable: 'debugSetting' },\n    direction: { classes: ['TokenActionHud'], variable: 'directionSetting' },\n    displayCharacterName: { classes: ['TokenActionHud'], variable: 'displayCharacterName' },\n    displayIcons: { classes: ['TokenActionHud'], variable: 'displayIconsSetting' },\n    drag: { classes: ['TokenActionHud'], variable: 'dragSetting' },\n    enable: { classes: ['TokenActionHud'], variable: 'enableSetting' },\n    enableCustomization: { classes: ['ActionHandler', 'TokenActionHud'], variable: 'enableCustomizationSetting' },\n    grid: { classes: ['TokenActionHud'], variable: 'gridSetting' },\n    itemMacro: {},\n    migrationVersion: {},\n    reset: {},\n    renderItemOnRightClick: {},\n    rollHandler: { default: 'core' },\n    scale: { classes: ['TokenActionHud'], variable: 'scaleSetting' },\n    sortActions: { classes: ['ActionHandler'], variable: 'sortActionsSetting' },\n    startup: {},\n    style: {},\n    tooltips: { classes: ['ActionHandler'], variable: 'tooltipsSetting' },\n    textPrimaryColor: {},\n    textSecondaryColor: {},\n    textTertiaryColor: {},\n    textHoverPrimaryColor: {},\n    textHoverSecondaryColor: {},\n    textHoverTertiaryColor: {},\n    userCustomLayout: { classes: ['ActionHandler'], variable: 'userCustomLayoutFlag' }\n}\n","import { CSS_STYLE, CUSTOM_STYLE, MODULE } from './constants.js'\n\n/**\n * Console logger\n */\nexport class Logger {\n    static info (message, notify = false) {\n        if (notify) ui.notifications.info(`Token Action HUD | ${message}`)\n        else console.log(`Token Action HUD Info | ${message}`)\n    }\n\n    static error (message, notify = false) {\n        if (notify) ui.notifications.error(`Token Action HUD | ${message}`)\n        else console.error(`Token Action HUD Error | ${message}`)\n    }\n\n    static debug (message, data) {\n        const isDebug = (game.tokenActionHud) ? game.tokenActionHud.debugSetting : Utils.getSetting('debug')\n        if (isDebug) {\n            if (!data) {\n                console.log(`Token Action HUD Debug | ${message}`)\n                return\n            }\n            const dataClone = Utils.deepClone(data)\n            console.log(`Token Action HUD Debug | ${message}`, dataClone)\n        }\n    }\n}\n\n/**\n * Timer for setting and aborting timeouts\n */\nexport class Timer {\n    constructor (milliseconds) {\n        this.milliseconds = milliseconds\n        this.timer = null\n    }\n\n    async start () {\n        if (this.timer) this.abort()\n        return new Promise(resolve => {\n            this.timer = setTimeout(() => { resolve() }, this.milliseconds ?? 100)\n        })\n    }\n\n    async abort () {\n        clearTimeout(this.timer)\n        this.timer = null\n    }\n}\n\nexport class Utils {\n    /**\n    * Whether the user is allowed to use the HUD\n    * @public\n    * @param {number} userRole The user's role\n    * @returns {boolean}\n    */\n    static checkAllow (userRole, allowSetting) {\n        if (userRole >= allowSetting) return true\n        return false\n    }\n\n    /**\n     * Foundry VTT's deepClone function wrapped here to avoid code error highlighting due to missing definition.\n     * @public\n     * @param {*} original\n     * @param {*} options\n     */\n    static deepClone (original, options) {\n        // eslint-disable-next-line no-undef\n        return deepClone(original, options)\n    }\n\n    /**\n     * Get actor from the token or actor object\n     * @public\n     * @param {string} actorId The actor id\n     * @param {string} tokenId The token id\n     * @returns {object}       The actor\n     */\n    static getActor (actorId, tokenId) {\n        let token = null\n        if (tokenId) token = canvas.tokens.placeables.find((token) => token.id === tokenId)\n        if (token) return token.actor\n        return game.actors.get(actorId)\n    }\n\n    /**\n     * Get status effect from actor based on the status id\n     * @param {object} actor    The actor\n     * @param {string} statusId The status id\n     * @returns {object}        The status effect\n     */\n    static getStatusEffect (actor, statusId) {\n        if (game.version.startsWith('11')) {\n            return actor.effects.find((effect) => effect.statuses.every((status) => status === statusId))\n        } else {\n            // V10\n            return actor.effects.find((effect) => effect.flags?.core?.statusId === statusId)\n        }\n    }\n\n    /**\n     * Get image from entity\n     * @public\n     * @param {object} entity       The entity, e.g., actor, item\n     * @param {array} defaultImages Any default images to exclude\n     * @returns {string}            The image URL\n     */\n    static getImage (entity, defaultImages = []) {\n        defaultImages.push('icons/svg/mystery-man.svg')\n        let result = ''\n        if (game.tokenActionHud.displayIconsSetting) result = (typeof entity === 'string') ? entity : entity?.img ?? entity?.icon ?? ''\n        return !defaultImages.includes(result) ? result : ''\n    }\n\n    /**\n     * Get item from the actor object\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     * @returns {object}      The item\n     */\n    static getItem (actor, itemId) {\n        return actor.items.get(itemId)\n    }\n\n    /**\n     * Get token\n     * @public\n     * @param {string} tokenId The token id\n     * @returns {object}       The token\n     */\n    static getToken (tokenId) {\n        return canvas.tokens.placeables.find((token) => token.id === tokenId)\n    }\n\n    /**\n     * Get controlled tokens\n     * @public\n     * @returns {array} The controlled tokens\n     */\n    static getControlledTokens () {\n        return game.canvas.tokens?.controlled ?? []\n    }\n\n    /**\n     * Get first controlled tokens\n     * @public\n     * @returns {object} The first controlled token\n     */\n    static getFirstControlledToken () {\n        const controlledToken = game.canvas.tokens.controlled[0]\n        if (controlledToken) {\n            return controlledToken\n        }\n        const character = game.user?.character\n        if (character) {\n            return canvas.tokens.placeables.find(token => token.actor?.id === character.id)\n        }\n    }\n\n    /**\n     * Get setting value\n     * @public\n     * @param {string} key               The setting key\n     * @param {string=null} defaultValue The setting default value\n     * @returns {*}                      The setting value\n     */\n    static getSetting (key, defaultValue = null) {\n        let value = defaultValue ?? null\n        try {\n            value = game.settings.get(MODULE.ID, key)\n        } catch {\n            Logger.debug(`Setting '${key}' not found`)\n        }\n        return value\n    }\n\n    /**\n     * Set setting value\n     * @public\n     * @param {string} key   The setting key\n     * @param {string} value The setting value\n     */\n    static async setSetting (key, value) {\n        if (game.settings.settings.get(`${MODULE.ID}.${key}`)) {\n            await game.settings.set(MODULE.ID, key, value)\n            Logger.debug(`Setting '${key}' set to '${value}'`)\n        } else {\n            Logger.debug(`Setting '${key}' not found`)\n        }\n    }\n\n    /**\n     * Get module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getActorFlag (key) {\n        return game.tokenActionHud.actor.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module actor flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setActorFlag (key, value) {\n        await game.tokenActionHud.actor.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module actor flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetActorFlag (key) {\n        await game.tokenActionHud.actor.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Get module user flag\n     * @public\n     * @param {string} key The flag key\n     * @returns {*}        The flag value\n     */\n    static getUserFlag (key) {\n        return game.user.getFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Set module user flag\n     * @public\n     * @param {string} key The flag key\n     * @param {*} value    The flag value\n     */\n    static async setUserFlag (key, value) {\n        await game.user.setFlag(MODULE.ID, key, value)\n    }\n\n    /**\n     * Unset module user flag\n     * @public\n     * @param {string} key The flag key\n     */\n    static async unsetUserFlag (key) {\n        await game.user.unsetFlag(MODULE.ID, key)\n    }\n\n    /**\n     * Language translation\n     * @public\n     * @param {string} toTranslate The value to translate\n     * @returns {string}           The translated value\n     */\n    static i18n (toTranslate) {\n        return game.i18n.localize(toTranslate)\n    }\n\n    /**\n     * Whether a GM is active\n     * @public\n     * @returns {boolean} Whether a GM is active\n     */\n    static isGmActive () {\n        return game.users.some(user => user.isGM && user.active)\n    }\n\n    /**\n     * Whether the given module is active\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {boolean}       Whether the given module is active\n     */\n    static isModuleActive (moduleId) {\n        const module = game.modules.get(moduleId)\n        return module && module.active\n    }\n\n    /**\n     * Get the given module's title\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module title\n     */\n    static getModuleTitle (moduleId) {\n        return game.modules.get(moduleId)?.title ?? ''\n    }\n\n    /**\n     * Get the given module's version\n     * @public\n     * @param {string} moduleId The module id\n     * @returns {string}        The module version\n     */\n    static getModuleVersion (moduleId) {\n        return game.modules.get(moduleId)?.version ?? ''\n    }\n\n    /**\n     * Humanize keybinding\n     * @param {object} key The keybinding key\n     * @returns {string}   The humanized keybinding\n     */\n    static humanizeBinding (key) {\n        const binding = game.keybindings.get(MODULE.ID, key)\n        if (!binding) return ''\n        const stringParts = binding[0].modifiers.reduce((parts, part) => {\n            if (KeyboardManager.MODIFIER_CODES[part]?.includes(binding[0].key)) return parts\n            parts.unshift(KeyboardManager.getKeycodeDisplayString(part))\n            return parts\n        }, [KeyboardManager.getKeycodeDisplayString(binding[0].key)])\n        return stringParts.join(' + ')\n    }\n\n    /**\n     * Get the median\n     * @public\n     * @param {array} numbers The array of numbers\n     * @returns {number}      The median\n     */\n    static median (numbers) {\n        const mid = Math.floor(numbers.length / 2)\n        const nums = [...numbers].sort((a, b) => a - b)\n        return numbers.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2\n    }\n\n    /**\n     * Get upper quartile average\n     * @param {array} numbers The numbers\n     * @returns {number}      The upper quartile average\n     */\n    static getUpperQuartileAverage (numbers) {\n        const sortedNumbers = numbers.slice().sort((a, b) => a - b)\n        const length = sortedNumbers.length\n        const startIndex = Math.ceil(length * 0.75)\n        const endIndex = length - 1\n\n        let sum = 0\n        let count = 0\n\n        for (let i = startIndex; i <= endIndex; i++) {\n            sum += sortedNumbers[i]\n            count++\n        }\n\n        const upperQuartileAverage = sum / count\n\n        return upperQuartileAverage\n    }\n\n    /**\n     * Get modifier\n     * @param {number} value The value\n     * @returns {string}     The modifier\n     */\n    static getModifier (value) {\n        if (!value && value !== 0) return ''\n        const sign = (value >= 0) ? '+' : ''\n        return `${sign}${value}`\n    }\n\n    /**\n     * Sort items\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItems (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].sort.localeCompare(b[1].sort)))\n    }\n\n    /**\n     * Sort items by name\n     * @public\n     * @param {object} items The items\n     * @returns {object}     The sorted items\n     */\n    static sortItemsByName (items) {\n        return new Map([...items.entries()].sort((a, b) => a[1].name.localeCompare(b[1].name)))\n    }\n\n    /**\n     * Enable stylesheet based on setting and disable all other stylesheets\n     * @public\n     * @param {string} style The 'style' setting value\n     */\n    static switchCSS (style) {\n        for (const [key, value] of Object.entries(CSS_STYLE)) {\n            const href = [`modules/${value.moduleId}/`, `${value.file}`]\n            if (key === style) {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = false\n            } else {\n                Object.values(document.styleSheets).find(\n                    (ss) => ss.href?.includes(href[0]) && ss.href?.includes(href[1])\n                ).disabled = true\n            }\n        }\n\n        if (style === 'custom') {\n            for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n                const setting = Utils.getSetting(key)\n                if (setting) {\n                    document.querySelector(':root').style.setProperty(value.cssProperty, setting)\n                }\n            }\n        }\n\n        const tahElement = document.querySelector('#token-action-hud')\n        if (tahElement) {\n            tahElement.classList.remove(...tahElement.classList)\n            tahElement.classList.add(CSS_STYLE[style].class)\n        }\n    }\n\n    /**\n     * Register Handlebar helpers\n     * @public\n     */\n    static registerHandlebars () {\n        // Capitalise first character\n        Handlebars.registerHelper('cap', function (string) {\n            if (!string || string.length < 1) return ''\n            return string[0].toUpperCase() + string.slice(1)\n        })\n\n        const reduceOp = function (args, reducer) {\n            args = Array.from(args)\n            args.pop() // => options\n            const first = args.shift()\n            return args.reduce(reducer, first)\n        }\n\n        // Support operators\n        Handlebars.registerHelper({\n            eq: function () { return reduceOp(arguments, (a, b) => a === b) },\n            ne: function () { return reduceOp(arguments, (a, b) => a !== b) },\n            lt: function () { return reduceOp(arguments, (a, b) => a < b) },\n            gt: function () { return reduceOp(arguments, (a, b) => a > b) },\n            lte: function () { return reduceOp(arguments, (a, b) => a <= b) },\n            gte: function () { return reduceOp(arguments, (a, b) => a >= b) },\n            and: function () { return reduceOp(arguments, (a, b) => a && b) },\n            or: function () { return reduceOp(arguments, (a, b) => a || b) },\n            true: function () { return reduceOp(arguments, (a) => a) },\n            false: function () { return reduceOp(arguments, (a) => !a) }\n        })\n\n        // Add asterisk to toggleable actions\n        Handlebars.registerHelper('activeText', function (block) {\n            if (game.tokenActionHud.activeCssAsTextSetting) {\n                return block.fn(this)\n            }\n            return block.inverse(this)\n        })\n    }\n\n    /**\n     * Get the major, minor and patch parts of the module version\n     * @public\n     * @param {string} moduleVersion The module version\n     * @returns {object}             The module version parts\n     */\n    static getModuleVersionParts (moduleVersion) {\n        if (!moduleVersion) {\n            Logger.debug('Module version not retrieved', { trigger: 'getModuleVersionParts' })\n            return\n        }\n        const moduleVersionParts = moduleVersion.split('.')\n        return {\n            major: moduleVersionParts[0],\n            minor: moduleVersionParts[1],\n            patch: moduleVersionParts[2]\n        }\n    }\n\n    /**\n     * Whether the system module is compatible with the core module version\n     * @public\n     * @param {object} systemModuleCoreModuleVersion The system module's required core module version\n     * @returns {boolean}\n     */\n    static checkModuleCompatibility (requiredCoreModuleVersion) {\n        // Get core module version in parts\n        const requiredCoreModuleVersionParts = this.getModuleVersionParts(requiredCoreModuleVersion)\n        const coreModuleVersionParts = this.getModuleVersionParts(game.modules.get(MODULE.ID).version)\n\n        if (coreModuleVersionParts.major !== requiredCoreModuleVersionParts.major ||\n            coreModuleVersionParts.minor !== requiredCoreModuleVersionParts.minor ||\n            (requiredCoreModuleVersionParts.patch && coreModuleVersionParts.patch !== requiredCoreModuleVersionParts.patch)\n        ) {\n            ui.notifications.error(\n                `The installed Token Action HUD system module requires Token Action HUD Core module version ${requiredCoreModuleVersion}. Install the required version to continue using Token Action HUD.`\n            )\n            return false\n        }\n        return true\n    }\n\n    /**\n     * Get subcategories by criteria\n     * @public\n     * @param {object} subcategories  The subcategories\n     * @param {object} data           The search data\n     * @returns {object}\n     */\n    static getSubcategories (subcategories, data = {}) {\n        let order = 0\n        if (!subcategories) return\n        const subcategoryId = data?.id\n        const subcategoryType = data?.type\n        subcategories = (Array.isArray(subcategories)) ? subcategories : Object.values(subcategories)\n        const foundSubcategories = {}\n        for (const subcategory of subcategories) {\n            if ((!subcategoryId || subcategory.id === subcategoryId) && (!subcategoryType || subcategory.type === subcategoryType)) {\n                order++\n                const level = subcategory.nestId.split('_').length\n                foundSubcategories[subcategory.nestId] = { ...subcategory, order, level }\n            }\n            if (subcategory.subcategories?.length > 0) {\n                const subcategories = this.getSubcategories(subcategory.subcategories, data)\n                if (subcategories) Object.assign(foundSubcategories, subcategories)\n            }\n        }\n        return (Object.keys(foundSubcategories).length > 0) ? foundSubcategories : null\n    }\n\n    /**\n     * Get nested groups by criteria\n     * @public\n     * @param {object} groups  The groups\n     * @param {object} data    The search data\n     * @returns {object}\n     */\n    static getNestedGroups (groups, data = {}) {\n        let order = 0\n        if (!groups) return\n        const groupId = data?.id\n        const groupType = data?.type\n        groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n        const foundGroups = {}\n        for (const group of groups) {\n            if ((!groupId || group.id === groupId) && (!groupType || group.type === groupType)) {\n                order++\n                const level = group.nestId.split('_').length\n                foundGroups[group.nestId] = { ...group, order, level }\n            }\n            if (group.groups?.length > 0) {\n                const groups = this.getNestedGroups(group.groups, data)\n                if (groups) Object.assign(foundGroups, groups)\n            }\n        }\n        return (Object.keys(foundGroups).length > 0) ? foundGroups : null\n    }\n\n    /**\n     * Get group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     * @returns {object}\n     */\n    static async getGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        const groupType = data?.type\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const group of groups) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        if (!group.type || !groupType || group.type === groupType) return group\n                        return\n                    }\n                    parts.shift()\n                    for (const groupStyle of Object.values(group.groups)) {\n                        if (groupStyle.length === 0) continue\n                        const foundGroup = await findGroup(groupStyle, parts)\n                        if (foundGroup) return foundGroup\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete group by nest id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupByNestId (groups, data = {}) {\n        const nestId = (typeof data === 'string' ? data : data?.nestId)\n        if (!nestId) return\n\n        const parts = nestId.split('_')\n        return await findGroup(groups, parts)\n\n        async function findGroup (groups, parts) {\n            groups = (Array.isArray(groups)) ? groups : Object.values(groups)\n            for (const [index, group] of groups.entries()) {\n                if (group.id === parts[0]) {\n                    if (parts.length === 1) {\n                        groups.splice(index, 1)\n                        return\n                    }\n                    if (group.groups.length === 0) return\n                    parts.shift()\n                    const foundGroup = await findGroup(group.groups, parts)\n                    if (foundGroup) return\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete groups by id\n     * @public\n     * @param {object} groups The groups\n     * @param {string} data   The search data\n     */\n    static async deleteGroupsById (groups, data = {}) {\n        const id = (typeof data === 'string' ? data : data?.id)\n        if (!id) return\n\n        for (let i = groups.length - 1; i >= 0; i--) {\n            if (groups[i].id === id) {\n                groups.splice(i, 1)\n            } else if (groups[i].groups?.length > 0) {\n                this.deleteGroupsById(groups[i].groups, data)\n            }\n        }\n    }\n}\n","import { MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Get file parts\n * @param {string} file The file\n * @returns {object}    The file parts\n */\nfunction getFileParts (file) {\n    const parts = file.split('/')\n    const filename = parts.pop()\n    const folder = parts.join('/')\n    const id = filename.split('.')[0]\n    return { folder, filename, id }\n}\n\nexport function isPersistentStorage () {\n    return (game.version >= '11.305' && typeof ForgeVTT === 'undefined')\n}\n\nexport class DataHandler {\n    async init () {\n        this.path = DataHandler.getPath()\n        this.private = await DataHandler.isPrivate()\n        this.fileMap = await DataHandler.getFilePathsAsGm()\n    }\n\n    /**\n     * Create directories\n     */\n    static async createDirectories () {\n        const DATA_FOLDER = 'data'\n        const moduleDirectory = (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage`\n            : MODULE.ID\n\n        const directoriesToCreate = [\n            moduleDirectory,\n            `${moduleDirectory}/${game.world.id}`,\n            `${moduleDirectory}/${game.world.id}/actor`,\n            `${moduleDirectory}/${game.world.id}/user`\n        ]\n\n        for (const directory of directoriesToCreate) {\n            await FilePicker.browse(DATA_FOLDER, directory).catch(async (_) => {\n                if (!(await FilePicker.createDirectory(DATA_FOLDER, directory, {}))) {\n                    Logger.debug('Failed to create directory: ' + directory)\n                }\n            })\n        }\n    }\n\n    /**\n     * Get base path to the layout files\n     * @returns {string} The path\n     */\n    static getPath () {\n        return (isPersistentStorage())\n            ? `modules/${MODULE.ID}/storage/${game.world.id}/`\n            : `${MODULE.ID}/${game.world.id}/`\n    }\n\n    /**\n     * Whether the module directory is set to private\n     * @returns {boolean} Whether the module directory is set to private\n     */\n    static async isPrivate () {\n        if (game.user.isGM) return false\n\n        const dataHandler = game?.tokenActionHud?.dataHandler\n\n        if (game.user.hasPermission('FILES_BROWSE')) {\n            try {\n                await FilePicker.browse('data', dataHandler.path)\n                return false\n            } catch {\n                return true\n            }\n        }\n    }\n\n    /**\n     * Get file paths as GM\n     * @returns {object} The file paths\n     */\n    static async getFilePathsAsGm () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        if ((!game.user.hasPermission('FILES_BROWSE') || dataHandler.private) && !Utils.isGmActive()) {\n            Logger.info('Cannot get file paths without a GM present', true)\n            return new Map() // Return an empty map if no permissions and no GM\n        }\n\n        const files = game.user.hasPermission('FILES_BROWSE') && !dataHandler.private\n            ? await DataHandler.getFilePaths()\n            : await game.tokenActionHud.socket.executeAsGM('getFilePaths')\n\n        return new Map(files.map(file => {\n            const { id } = getFileParts(file)\n            return [id, file]\n        }))\n    }\n\n    /**\n     * Get file paths\n     */\n    static async getFilePaths () {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n        const [actorFiles, userFiles] = await Promise.all([\n            FilePicker.browse('data', `${dataHandler.path}actor/`),\n            FilePicker.browse('data', `${dataHandler.path}user/`)\n        ])\n\n        return [...(actorFiles?.files ?? []), ...(userFiles?.files ?? [])]\n    }\n\n    /**\n     * Whether the user can save data\n     * @returns {boolean} Whether the user can save data\n     */\n    static canSaveData () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        return ((game.user.hasPermission('FILES_UPLOAD') && !dataHandler.private) || Utils.isGmActive())\n    }\n\n    /**\n     * Save data the GM\n     * @public\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataAsGm (type, id, data) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        if (game.user.hasPermission('FILES_UPLOAD') && !dataHandler.private) {\n            return await DataHandler.saveData(type, id, data)\n        }\n\n        if (!Utils.isGmActive()) {\n            Logger.info('Cannot save data without a GM present', true)\n            return\n        }\n\n        await game.tokenActionHud.socket.executeAsGM('saveData', type, id, data)\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveData (type, id, data) {\n        const dataHandler = game?.tokenActionHud?.dataHandler\n\n        try {\n            // Get the folder path\n            const folder = `${dataHandler.path}${type}`\n\n            // Generate the system-safe filename\n            const fileName = encodeURI(`${id}.json`)\n\n            // Create the file and contents\n            const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n\n            // Upload the file\n            const response = await FilePicker.upload('data', folder, file, {}, { notify: false })\n\n            if (response.path) {\n                if (!dataHandler.fileMap.has(id)) {\n                    dataHandler.fileMap.set(id, response.path)\n                }\n            } else {\n                Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response.error || 'Unknown error'}`)\n            }\n        } catch (error) {\n            Logger.error(`An error occurred while saving data for ${id}.json: ${error.message}`)\n        }\n    }\n\n    /**\n     * Whether the user can get data\n     * @returns {boolean} Whether the user can get data\n     */\n    static canGetData () {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        return ((game.user.hasPermission('FILES_BROWSE') && !dataHandler.private) || Utils.isGmActive())\n    }\n\n    /**\n     * Get data as GM\n     * @public\n     * @param {object} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getDataAsGm (options) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        try {\n            if ((!game.user.hasPermission('FILES_BROWSE') || dataHandler.private) && !Utils.isGmActive()) {\n                Logger.info('Cannot get data without a GM present', true)\n                return\n            }\n\n            return (game.user.hasPermission('FILES_BROWSE'))\n                ? await DataHandler.getData(options)\n                : await game.tokenActionHud.socket.executeAsGM('getData', options)\n        } catch (error) {\n            Logger.error(`An error occurred while getting data: ${error.message}`)\n            return null\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} options The options: file, type, id\n     * @returns {object}       The data\n     */\n    static async getData (options) {\n        const dataHandler = game.tokenActionHud.dataHandler\n\n        const { id, file } = options\n\n        // Check if the file is available in the fileMap\n        let foundFile = dataHandler.fileMap.get(id) ?? null\n\n        // If not found, try to browse, otherwise return null\n        if (!foundFile) {\n            if (!file) return null\n            const { folder, filename } = getFileParts(file)\n            const foundFolder = await FilePicker.browse('data', folder)\n            foundFile = foundFolder.files.find(file => file.endsWith(filename))\n            if (!foundFile) return null\n        }\n\n        try {\n            const ms = Date.now()\n            const response = await fetch(`${foundFile}?ms=${ms}`)\n\n            // Check if the fetch was successful\n            if (response.ok) {\n                return await response.json()\n            } else {\n                return null\n            }\n        } catch (error) {\n            console.error(error)\n            return null\n        }\n    }\n\n    /**\n     * Save data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @param {object} data The data\n     */\n    static async saveDataMigrate (type, id, data) {\n        // Get the folder path\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        // Generate the system safe filename\n        const fileName = encodeURI(`${id}.json`)\n        // Create the File and contents\n        const file = new File([JSON.stringify(data, null, '')], fileName, { type: 'application/json' })\n        const response = await FilePicker.upload('data', folderPath, file, {}, { notify: false })\n        if (!response.path) {\n            Logger.debug(`Failed to save data to: ${fileName}\\nReason: ${response}`)\n        }\n    }\n\n    /**\n     * Get data\n     * @param {string} type The type: actor or user\n     * @param {string} id   The actor or user id\n     * @returns {object}    The data\n     */\n    static async getDataMigrate (type, id) {\n        const folderPath = `${MODULE.ID}/${game.world.id}/${type}`\n        const fileName = encodeURI(`${id}.json`)\n        try {\n            const foundFolderPath = await FilePicker.browse('data', folderPath)\n            const foundFilePath = foundFolderPath.files.find(file => file.endsWith(fileName))\n            if (foundFilePath) {\n                const ms = Date.now()\n                return await fetch(`${foundFilePath}?ms=${ms}`)\n                    .then(response => {\n                        if (response.ok) {\n                            return response.json()\n                        } else {\n                            return null\n                        }\n                    })\n                    .catch(error => {\n                        console.error(error)\n                    })\n            } else {\n                return null\n            }\n        } catch {\n            return null\n        }\n    }\n}\n","import { DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's generic actions.\n */\nexport class GenericActionHandler {\n    actionHandler\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n    }\n\n    /**\n     * Build generic actions\n     * @public\n     * @param {object} character The actor and/or token\n     */\n    buildGenericActions () {\n        this.#buildUtilities()\n    }\n\n    /**\n     * Build utilities\n     * @private\n     */\n    #buildUtilities () {\n        if (this.actor) return this.#buildSingleTokenUtilities()\n        this.#buildMultipleTokenUtilities()\n    }\n\n    /**\n     * Build utilities for a single token\n     * @private\n     */\n    #buildSingleTokenUtilities () {\n        if (!this.token) return\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Build Toggle Combat action\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = this.token?.inCombat\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [\n            actionType,\n            toggleCombatId\n        ].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Build Toggle Visibility action\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityName = this.token?.document?.hidden\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [\n                actionType,\n                toggleVisibilityId\n            ].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityName,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n\n    /**\n     * Build utilities for multiple tokens\n     * @private\n     */\n    #buildMultipleTokenUtilities () {\n        const tokens = Utils.getControlledTokens()\n        const actionsData = []\n\n        const actionType = 'utility'\n\n        // Toggle Combat\n        const toggleCombatId = 'toggleCombat'\n        const toggleCombatName = tokens.every((token) => token.inCombat)\n            ? Utils.i18n('tokenActionHud.removeFromCombat')\n            : Utils.i18n('tokenActionHud.addToCombat')\n        const toggleCombatEncodedValue = [actionType, toggleCombatId].join(DELIMITER)\n        const toggleCombatAction = {\n            id: toggleCombatId,\n            name: toggleCombatName,\n            encodedValue: toggleCombatEncodedValue\n        }\n        actionsData.push(toggleCombatAction)\n\n        // Toggle Visibility\n        if (game.user.isGM) {\n            const toggleVisibilityId = 'toggleVisibility'\n            const toggleVisibilityname = tokens.every((token) => token.document?.hidden)\n                ? Utils.i18n('tokenActionHud.makeVisible')\n                : Utils.i18n('tokenActionHud.makeInvisible')\n            const toggleVisbilityEncodedValue = [actionType, toggleVisibilityId].join(DELIMITER)\n            const toggleVisibilityAction = {\n                id: toggleVisibilityId,\n                name: toggleVisibilityname,\n                encodedValue: toggleVisbilityEncodedValue\n            }\n            actionsData.push(toggleVisibilityAction)\n        }\n\n        const groupData = { id: 'token', type: GROUP_TYPE.SYSTEM }\n\n        // Add actions to HUD\n        this.actionHandler.addActions(actionsData, groupData)\n    }\n}\n","import { ACTION_TYPE, COMPENDIUM_PACK_TYPES, DELIMITER } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's compendium actions.\n */\nexport class CompendiumActionHandler {\n    actionHandler\n    compendiumActions\n    packIds\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.compendiumActions = new Map()\n        this.packIds = []\n    }\n\n    /**\n     * Build compendium actions\n     */\n    async buildCompendiumActions () {\n        if (this.compendiumActions.size === 0) {\n            this.packIds = game.packs\n                .filter(\n                    (pack) =>\n                        COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n              (game.version.startsWith('11') ? pack.visible : !pack.private || game.user.isGM)\n                )\n                .map((pack) => pack.metadata.id)\n\n            if (this.packIds.length === 0) return\n\n            await Promise.all(this.packIds.map(packId => this.#setCompendiumActions(packId)))\n        }\n\n        for (const pack of this.compendiumActions.values()) {\n            this.actionHandler.addActions(pack.actionsData, pack.groupData)\n        }\n    }\n\n    /**\n     * Set compendium actions into the compendiumActions map\n     * @param {string} packId The pack id\n     */\n    async #setCompendiumActions (packId) {\n        const pack = game.packs.get(packId)\n        const entries = pack ? pack.index.size > 0 ? pack.index : await pack.getIndex() : null\n        if (!entries) return\n        const actionType = this.#getCompendiumActionType(pack?.documentName)\n        const actionsData = entries.map((entry) => ({\n            id: entry._id,\n            name: entry.name,\n            encodedValue: [actionType, packId, entry._id].join(DELIMITER),\n            img: Utils.getImage(entry),\n            listName: `${Utils.i18n(ACTION_TYPE[actionType])}: ${entry.name}`\n        }))\n        const groupData = { id: this.#getGroupId(packId), type: 'core' }\n        this.compendiumActions.set(packId, { actionsData, groupData })\n    }\n\n    /**\n     * Get compendium action type based on documentName\n     * @param {string} documentName The pack document name\n     * @returns {string}            The compendium action type\n     */\n    #getCompendiumActionType (documentName) {\n        switch (documentName) {\n        case 'Macro':\n            return 'compendiumMacro'\n        case 'Playlist':\n            return 'compendiumPlaylist'\n        default:\n            return 'compendiumEntry'\n        }\n    }\n\n    /**\n     * @param {string} packId The pack id\n     * @returns {string}      The group id\n     */\n    #getGroupId (packId) {\n        return packId.replace('.', '-')\n    }\n\n    /**\n     * Whether the compendium is linked\n     * @public\n     * @param {string} packId The pack id\n     * @returns {boolean}     Whether the compendium is linked\n     */\n    isLinkedCompendium (packId) {\n        return (this.packIds.length)\n            ? this.packIds?.includes(packId)\n            : false\n    }\n}\n","import { DELIMITER, ACTION_TYPE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD's macro actions.\n */\nexport class MacroActionHandler {\n    actionHandler\n    macroActions\n\n    constructor (actionHandler) {\n        this.actionHandler = actionHandler\n        this.macroActions = null\n    }\n\n    /**\n     * Build macro actions\n     * @override\n     */\n    async buildMacroActions () {\n        if (!this.macroActions) {\n            const groupData = { id: 'macros', type: 'core' }\n            const actionsData = await this.#getActions()\n            this.macroActions = { actionsData, groupData }\n        }\n\n        this.actionHandler.addActions(this.macroActions.actionsData, this.macroActions.groupData)\n    }\n\n    /**\n     * Get actions\n     * @private\n     * @returns {object} The actions\n     */\n    async #getActions () {\n        const actionType = 'macro'\n        const macros = game.macros.filter((macro) => {\n            const permissions = macro.ownership\n            if (permissions[game.userId]) return permissions[game.userId] > 0\n            return permissions.default > 0\n        })\n        return macros.map((macro) => {\n            const id = macro.id\n            const name = macro.name\n            const actionTypeName = `${Utils.i18n(ACTION_TYPE[actionType])}: ` ?? ''\n            const listName = `${actionTypeName}${name}`\n            const encodedValue = [actionType, macro.id].join(DELIMITER)\n            const img = Utils.getImage(macro)\n            return {\n                id,\n                name,\n                listName,\n                encodedValue,\n                img\n            }\n        })\n    }\n}\n","import { DataHandler } from '../data-handler.js'\nimport { GenericActionHandler } from './generic-action-handler.js'\nimport { CompendiumActionHandler } from './compendium-action-handler.js'\nimport { MacroActionHandler } from './macro-action-handler.js'\nimport { COMPENDIUM_PACK_TYPES, DELIMITER, GROUP_TYPE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Handler for building the HUD.\n */\nexport class ActionHandler {\n    characterName = null\n    actor = null\n    token = null\n    actionHandlerExtenders = []\n    delimiter = DELIMITER\n\n    constructor () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.compendiumActionHandler = new CompendiumActionHandler(this)\n        this.macroActionHandler = new MacroActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actorGroups = {}\n        this.userGroups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.sortActionsSetting = Utils.getSetting('sortActions')\n        this.tooltipsSetting = Utils.getSetting('tooltips')\n    }\n\n    /**\n     * Reset action handler variables except actorGroups and userGroups\n     * @public\n     */\n    softResetActionHandler () {\n        this.genericActionHandler = new GenericActionHandler(this)\n        this.hud = []\n        this.defaultGroups = {}\n        this.defaultLayout = {}\n        this.groups = {}\n        this.actions = []\n        this.availableActionsMap = new Map()\n    }\n\n    /**\n     * Reset all action handler variables\n     * @public\n     */\n    hardResetActionHandler () {\n        this.softResetActionHandler()\n        this.customLayoutSetting = Utils.getSetting('customLayout')\n        this.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.customLayout = null\n        this.actorGroups = {}\n        this.userGroups = {}\n    }\n\n    /**\n     * Register default categories from the Token Action Hud system module\n     * @public\n     */\n    async registerDefaultCategories () {}\n\n    /**\n     * Build the HUD\n     * @public\n     * @returns {object} The HUD\n     */\n    async buildHud (options) {\n        Logger.debug('Building HUD...', { actor: this.actor, token: this.token })\n        if (this.previousActor?.id === this.actor?.id) {\n            this.isSameActor = true\n        } else {\n            this.previousActor = this.actor\n            this.isSameActor = false\n        }\n        this.softResetActionHandler()\n        await Promise.all([\n            this.#getDefaultGroups(),\n            this.#getDefaultLayout(),\n            this.#getCustomLayout()\n        ])\n        if (!DataHandler.canGetData() && !this.isGmInactiveUserNotified) {\n            Logger.info('Cannot retrieve HUD layout without GM present', true)\n            this.isGmInactiveUserNotified = true\n        }\n        await Promise.all([\n            this.#getSavedUserGroups(),\n            this.#getSavedActorGroups()\n        ])\n        this.hud = await this.#prepareHud()\n        await Promise.all([\n            this.#buildSystemActions(),\n            this.#buildGenericActions(),\n            this.#buildCompendiumActions(),\n            this.#buildMacroActions()\n        ])\n        this.#buildExtendedActions()\n        this.#updateNonPresetActions()\n        this.#setHasActions()\n        this.#setCharacterLimit()\n        await this.saveGroups(options)\n        Logger.debug('HUD built', { hud: this.hud, actor: this.actor, token: this.token })\n        return this.hud\n    }\n\n    /**\n     * Prepare the HUD\n     * @private\n     * @returns {object} The HUD\n     */\n    async #prepareHud () {\n        Logger.debug('Preparing HUD...', { actor: this.actor, token: this.token })\n\n        const title = (this.displayCharacterNameSetting)\n            ? this.characterName ?? 'Multiple'\n            : ''\n        const actorId = this.actor?.id ?? 'multi'\n        const tokenId = this.token?.id ?? 'multi'\n        const hud = {\n            title,\n            tokenId,\n            actorId,\n            groups: []\n        }\n\n        if (Object.keys(this.userGroups).length) {\n            const userGroups = this.#getUserGroups()\n            for (const userGroup of userGroups) {\n                if (userGroup.level === 1) {\n                    const group = this.#createGroup(userGroup)\n                    hud.groups.push(group)\n                    this.groups[group.nestId] = group\n                } else {\n                    const parentNestId = userGroup.nestId.split('_', userGroup.level - 1).join('_')\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup) {\n                        const group = this.#createGroup(userGroup)\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        if (Object.keys(this.actorGroups).length) {\n            const actorGroups = this.#getActorGroups()\n            for (const actorGroup of actorGroups) {\n                const parentNestId = actorGroup.nestId.split('_', actorGroup.level - 1).join('_')\n                const existingGroup = await Utils.getGroupByNestId(hud.groups, { nestId: actorGroup.nestId })\n                if (existingGroup) {\n                    if (actorGroup.actions?.length) {\n                        existingGroup.actions = actorGroup.actions\n                        this.actions.push(...existingGroup.actions)\n                        for (const action of existingGroup.actions) {\n                            action.selected = false\n                        }\n                    }\n                } else {\n                    const parentGroup = await Utils.getGroupByNestId(hud.groups, { nestId: parentNestId })\n                    if (parentGroup && actorGroup.type === 'system-derived') {\n                        const group = this.#createGroup(actorGroup)\n                        if (actorGroup.actions?.length) {\n                            group.actions = actorGroup.actions\n                            this.actions.push(...group.actions)\n                            for (const action of group.actions) {\n                                action.selected = false\n                            }\n                        }\n                        if (group.settings.style === 'tab') {\n                            parentGroup.groups.tabs.push(group)\n                        } else {\n                            parentGroup.groups.lists.push(group)\n                        }\n                        this.groups[group.nestId] = group\n                    }\n                }\n            }\n        }\n\n        Logger.debug('HUD prepared', { hud, actor: this.actor, token: this.token })\n        return hud\n    }\n\n    /**\n     * Placeholder function for the system module\n     * @public\n     */\n    async buildSystemActions (groupIds) {}\n\n    /**\n     * Build system-specific actions\n     * @private\n     */\n    async #buildSystemActions () {\n        Logger.debug('Building system actions...', { actor: this.actor, token: this.token })\n        const groupIds = Object.values(this.groups).map(group => group.id)\n        await this.buildSystemActions(groupIds)\n        Logger.debug('System actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build compendium-specific actions\n     * @private\n     */\n    async #buildCompendiumActions () {\n        Logger.debug('Building compendium actions...')\n        await this.compendiumActionHandler.buildCompendiumActions()\n        Logger.debug('Compendium actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build generic actions\n     * @private\n     */\n    #buildGenericActions () {\n        Logger.debug('Building generic actions...', { actor: this.actor, token: this.token })\n        this.genericActionHandler.buildGenericActions()\n        Logger.debug('Generic actions built', { hud: this.hud, actor: this.actor, token: this.token })\n    }\n\n    /**\n     * Build macro-specific actions\n     * @private\n     */\n    async #buildMacroActions () {\n        Logger.debug('Building macro actions...')\n        await this.macroActionHandler.buildMacroActions()\n        Logger.debug('Macro actions built', { hud: this.hud })\n    }\n\n    /**\n     * Build extended actions\n     * @private\n     */\n    #buildExtendedActions () {\n        this.actionHandlerExtenders.forEach(extender => extender.extendActionHandler())\n    }\n\n    /**\n     * Update non-preset actions\n     * @private\n     */\n    #updateNonPresetActions () {\n        const nonPresetActions = this.actions.filter(action => !action?.isPreset)\n\n        for (const nonPresetAction of nonPresetActions) {\n            const availableAction = this.availableActionsMap.get(nonPresetAction.id)\n\n            if (availableAction) {\n                const systemSelected = availableAction.systemSelected ?? nonPresetAction.systemSelected\n                const userSelected = nonPresetAction.userSelected ?? availableAction.userSelected\n                Object.assign(nonPresetAction, this.#createAction({ ...availableAction, systemSelected, userSelected }))\n            }\n        }\n    }\n\n    /**\n     * Set property to indicate whether a group has actions within it\n     * @private\n     */\n    #setHasActions () {\n        for (const group of Object.values(this.groups)) {\n            if (group.actions.some(action => action.selected)) {\n                group.hasActions = true\n            } else {\n                group.hasActions = false\n            }\n        }\n    }\n\n    /**\n     * Get the default groups\n     * @private\n     */\n    #getDefaultGroups () {\n        const defaultGroups = game.tokenActionHud.defaults?.groups\n        if (!defaultGroups) return {}\n        for (const defaultGroup of defaultGroups) {\n            this.defaultGroups[defaultGroup.id] = defaultGroup\n        }\n    }\n\n    /**\n     * Get the default layout\n     * @private\n     */\n    async #getDefaultLayout () {\n        if (Object.keys(this.defaultLayout).length) return\n        const defaultLayout = game.tokenActionHud.defaults?.layout\n        if (!defaultLayout) return {}\n        this.defaultLayout = await Utils.getNestedGroups(defaultLayout)\n    }\n\n    /**\n     * Get custom layout\n     * @private\n     */\n    async #getCustomLayout () {\n        if (this.customLayout) return\n        const file = this.userCustomLayoutFlag || this.customLayoutSetting || null\n        this.customLayout = (file) ? await DataHandler.getDataAsGm({ file }) : null\n    }\n\n    /**\n     * Export layout to file\n     */\n    async exportLayout () {\n        const data = await DataHandler.getDataAsGm({ type: 'user', id: game.userId }) ?? this.customLayout ?? this.defaultLayout\n        if (data) {\n            saveDataToFile(JSON.stringify(data, null, 2), 'text/json', 'token-action-hud-layout.json')\n        }\n    }\n\n    /**\n     * Get the saved groups from the actor flag\n     * @private\n     */\n    async #getSavedActorGroups () {\n        if (!this.actor) return\n\n        if (!this.enableCustomizationSetting) {\n            this.actorGroups = {}\n            return\n        }\n\n        if (this.isSameActor && Object.entries(this.actorGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.actorGroups = {}\n            return\n        }\n\n        Logger.debug('Retrieving groups from actor...', { actor: this.actor })\n        this.actorGroups = {}\n        const actorGroups = await DataHandler.getDataAsGm({ type: 'actor', id: this.actor.id }) ?? null\n        if (!actorGroups) return\n        for (const group of Object.entries(actorGroups)) {\n            group[1].nestId = group[0]\n        }\n        this.actorGroups = actorGroups\n        Logger.debug('Groups from actor retrieved', { actorGroups: this.actorGroups, actor: this.actor })\n    }\n\n    /**\n     * Get the saved groups from the user flag\n     * @private\n     */\n    async #getSavedUserGroups () {\n        const user = game.user\n        const layout = this.customLayout ?? this.defaultLayout\n\n        const getUserGroups = (data) => {\n            const userGroups = Object.keys(data).length ? data : layout\n            for (const group of Object.entries(userGroups)) {\n                group[1].nestId = group[0]\n            }\n            return userGroups\n        }\n\n        if (!this.enableCustomizationSetting) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        if (Object.entries(this.userGroups).length) return\n\n        if (!DataHandler.canGetData()) {\n            this.userGroups = getUserGroups(layout)\n            return\n        }\n\n        Logger.debug('Retrieving groups from user...', { user })\n        this.userGroups = {}\n        const savedUserData = await DataHandler.getDataAsGm({ type: 'user', id: user.id }) ?? {}\n        this.userGroups = getUserGroups(savedUserData)\n        Logger.debug('Groups retrieved from user', { userGroups: this.userGroups, user })\n    }\n\n    /**\n     * Get first matching action group based on criteria\n     * @public\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    getGroup (data = {}) {\n        if (data?.nestId) {\n            return this.groups[data.nestId]\n        } else {\n            return Object.values(this.groups).find(\n                group =>\n                    (!data.id || group.id === data.id) &&\n                    (!data.type || group.type === data.type) &&\n                    (!data.level || group.level === data.level)\n            )\n        }\n    }\n\n    /**\n     * Get groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getGroups (data = {}) {\n        return Object.values(this.groups).filter(\n            group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level) &&\n                (!data.selected || group.selected === data.selected)\n        )\n    }\n\n    /**\n     * Get actor-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getActorGroups (data = {}) {\n        return Object.values(this.actorGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => (a.level - b.level || a.order - b.order))\n    }\n\n    /**\n     * Get user-related groups based on criteria\n     * @private\n     * @param {object} [data = {}] The search data\n     * @returns {array}            The groups\n     */\n    #getUserGroups (data = {}) {\n        return Object.values(this.userGroups)\n            .filter(group =>\n                (!data.id || group.id === data.id) &&\n                (!data.nestId || group.nestId.startsWith(data.nestId)) &&\n                (!data.type || group.type === data.type) &&\n                (!data.level || group.level === data.level)\n            )\n            .sort((a, b) => {\n                if (a.level === b.level) {\n                    return a.order - b.order\n                } else {\n                    return a.level - b.level\n                }\n            })\n    }\n\n    /**\n     * Get advanced options\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The group settings\n     */\n    getGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        return group?.settings ?? null\n    }\n\n    /**\n     * Save group settings\n     * @param {object} groupData The group data\n     */\n    saveGroupSettings (groupData) {\n        const group = this.getGroup(groupData)\n        group.settings = { ...group.settings, ...groupData.settings }\n        this.saveGroups({ saveActor: true, saveUser: true })\n    }\n\n    /**\n     * Create group\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The group\n     */\n    #createGroup (groupData, keepData = false) {\n        const groupDataClone = Utils.deepClone(groupData)\n        const nestIdParts = groupData.nestId.split('_')\n        const level = nestIdParts.length ?? 1\n\n        const tooltip = this.#getTooltip(groupData?.tooltip, groupDataClone?.name)\n\n        if (!keepData) {\n            groupDataClone.actions = []\n            groupDataClone.groups = { lists: [], tabs: [] }\n        }\n\n        const defaultSettings = {\n            showTitle: true,\n            style: (level === 1) ? 'tab' : 'list'\n        }\n\n        const groupSettings = groupDataClone.settings || {}\n        groupSettings.showTitle ??= defaultSettings.showTitle\n        groupSettings.style ??= defaultSettings.style\n\n        groupDataClone.subtitleClass = (groupSettings.showTitle) ? '' : 'tah-hidden'\n\n        const groupSystem = groupDataClone.system || {}\n\n        const commonProps = {\n            actions: groupDataClone.actions,\n            class: groupDataClone.class || groupDataClone.cssClass || '',\n            groups: groupDataClone.groups,\n            id: groupDataClone.id,\n            info1: groupDataClone.info1 || '',\n            info2: groupDataClone.info2 || '',\n            info3: groupDataClone.info3 || '',\n            level: groupDataClone.level || level || 1,\n            listName: groupDataClone.listName || groupDataClone.name,\n            name: groupDataClone.name,\n            nestId: groupDataClone.nestId || groupDataClone.id,\n            order: groupDataClone.order,\n            selected: groupDataClone.selected ?? groupDataClone.isSelected ?? groupDataClone.defaultSelected ?? true,\n            settings: groupSettings,\n            system: groupSystem,\n            tooltip,\n            type: groupDataClone.type || GROUP_TYPE.CUSTOM\n        }\n\n        if (level > 1) {\n            commonProps.subtitleClass = groupDataClone.subtitleClass || ''\n        }\n\n        return commonProps\n    }\n\n    /**\n     * Update groups\n     * @public\n     * @param {array|object} groupsData         The groups data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroups (groupsData, parentGroupData) {\n        if (!Array.isArray(groupsData)) groupsData = [groupsData]\n\n        const level = (parentGroupData?.level ?? 0) + 1\n        const childGroupData = { level }\n        if (parentGroupData?.nestId) childGroupData.nestId = parentGroupData.nestId\n\n        const existingGroups = this.#getGroups(childGroupData)\n\n        // Remove any groups that are no longer present\n        for (const existingGroup of existingGroups) {\n            if (existingGroup.type === 'system-derived') {\n                existingGroup.selected = false\n                existingGroup.order = 999\n            } else {\n                if (!groupsData.find(groupData => groupData.id === existingGroup.id)) {\n                    delete this.groups[existingGroup.nestId]\n                }\n            }\n        }\n\n        // Add or update groups\n        let order = 0\n        for (const groupData of groupsData) {\n            groupData.nestId = (parentGroupData?.nestId)\n                ? `${parentGroupData.nestId}_${groupData.id}`\n                : groupData.id\n            groupData.selected = groupData.selected ?? true\n            groupData.order = order\n\n            const existingGroup = this.getGroup(groupData)\n\n            if (existingGroup) {\n                Object.assign(existingGroup, groupData)\n            } else {\n                const group = this.#createGroup(groupData)\n                this.groups[groupData.nestId] = group\n            }\n            order++\n        }\n\n        // Update parent group settings\n        if (parentGroupData?.settings) {\n            const existingParentGroup = this.getGroup(parentGroupData)\n            if (existingParentGroup) {\n                existingParentGroup.settings = parentGroupData.settings\n            }\n        }\n    }\n\n    /**\n     * Save groups\n     * @public\n     */\n    async saveGroups (options = { saveActor: false, saveUser: false }) {\n        if (!this.enableCustomizationSetting) return\n        Logger.debug('Saving groups...')\n        if (options?.saveActor) await this.#saveActorGroups()\n        if (options?.saveUser) await this.#saveUserGroups()\n        Logger.debug('Groups saved', { groups: this.groups })\n    }\n\n    /**\n     * Save actor groups to file\n     * @private\n     */\n    async #saveActorGroups () {\n        if (!this.actor) return\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving actor groups...')\n        const actorGroups = {}\n        this.actorGroups = {}\n        for (const group of Object.values(this.groups)) {\n            this.actorGroups[group.nestId] = group\n            actorGroups[group.nestId] = this.#getReducedGroupData(group, true)\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('actor', this.actor.id, actorGroups)\n\n            Logger.debug('Actor groups saved', { actorGroups })\n        } else {\n            Logger.debug('Actor groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Save user groups to file\n     * @private\n     */\n    async #saveUserGroups () {\n        if (!Object.keys(this.groups).length) return\n        Logger.debug('Saving user groups...')\n        const userGroups = {}\n        this.userGroups = {}\n        for (const group of Object.values(this.groups)) {\n            if (group.type !== 'system-derived') {\n                this.userGroups[group.nestId] = group\n                userGroups[group.nestId] = this.#getReducedGroupData(group, false)\n            }\n        }\n        if (DataHandler.canSaveData()) {\n            await DataHandler.saveDataAsGm('user', game.userId, userGroups)\n            Logger.debug('User groups saved', { userGroups })\n        } else {\n            Logger.debug('User groups not saved as no GM present')\n        }\n    }\n\n    /**\n     * Get reduced groups data for saving to flags\n     * @param {object} groupData    The group data\n     * @param {boolean} keepActions Whether to keep action data\n     * @returns                     The reduced group data\n     */\n    #getReducedGroupData (groupData, keepActions = false) {\n        const data = {\n            id: groupData.id,\n            name: groupData.name,\n            listName: groupData.listName,\n            selected: groupData.selected,\n            level: groupData.level,\n            order: groupData.order,\n            settings: groupData.settings,\n            type: groupData.type\n        }\n        if (keepActions) {\n            data.actions = groupData.actions.map(action => {\n                return {\n                    id: action.id,\n                    isPreset: action.isPreset,\n                    userSelected: action.userSelected\n                }\n            })\n        }\n        return data\n    }\n\n    /**\n     * Get actions by id\n     * @private\n     * @param {object} actionData The action data\n     * @returns {array}           The actions\n     */\n    #getActions (actionData) {\n        return this.actions.filter(action => action.id === actionData.id)\n    }\n\n    /**\n     * Get tooltip based on module setting\n     * @param {string} tooltip The tooltip\n     * @param {string} name    The name\n     * @returns {string}       The tooltip\n     */\n    #getTooltip (tooltip, name) {\n        if (this.tooltipsSetting === 'none') return null\n        if (this.tooltipsSetting === 'nameOnly') return name\n        if (this.tooltipsSetting === 'full' && tooltip) {\n            return (tooltip.includes('tah-tooltip-wrapper'))\n                ? tooltip\n                : `<div class=\"tah-tooltip-wrapper\">${tooltip}</div>`\n        }\n        return name\n    }\n\n    /**\n     * Create action\n     * @private\n     * @param {object} actionData The action data\n     * @returns {object}          The action\n     */\n    #createAction(actionData) {\n        const fullName = actionData.fullName ?? actionData.name\n        const tooltip = this.#getTooltip(actionData?.tooltip, fullName)\n\n        const infoProps = (info) => {\n            return {\n                class: info?.class || '',\n                icon: info?.icon || '',\n                text: info?.text || '',\n                title: info?.title || ''\n            }\n        }\n\n        return {\n            encodedValue: actionData.encodedValue,\n            id: actionData.id,\n            name: actionData.name,\n            fullName,\n            listName: actionData.listName || actionData.name,\n            cssClass: actionData.cssClass || '',\n            icons: actionData.icon || {},\n            icon1: actionData.icon1 || '',\n            icon2: actionData.icon2 || '',\n            icon3: actionData.icon3 || '',\n            img: actionData.img || '',\n            info1: infoProps(actionData.info1),\n            info2: infoProps(actionData.info2),\n            info3: infoProps(actionData.info3),\n            isAction: true,\n            isItem: actionData.isitem || null,\n            isPreset: actionData.isPreset || false,\n            userSelected: actionData.userSelected ?? true,\n            systemSelected: actionData.systemSelected ?? true,\n            system: actionData.system || {},\n            selected: actionData.systemSelected\n                ? actionData.userSelected ?? actionData.systemSelected ?? true\n                : false,\n            tooltip,\n            useRawHtmlName: actionData.useRawHtmlName || false\n        }\n    }\n\n    /**\n     * Update actions\n     * @public\n     * @param {array} actionsData The actions data\n     * @param {object} groupData  The group data\n     */\n    updateActions (actionsData, groupData) {\n        const group = this.getGroup(groupData)\n        const actions = group.actions\n\n        const reorderedActions = []\n\n        // Set 'selected' to true for selected actions\n        // Reorder actions based on order in dialog\n        for (const actionData of actionsData) {\n            if (actionData.id.includes('itemMacro')) continue\n            const existingAction = group.actions.find(action => action.id === actionData.id)\n            if (existingAction) {\n                const actionClone = { ...existingAction, userSelected: true }\n                reorderedActions.push(actionClone)\n            } else {\n                const availableAction = this.availableActionsMap.get(actionData.id)\n                if (availableAction) {\n                    const actionClone = { ...availableAction, userSelected: true }\n                    reorderedActions.push(actionClone)\n                }\n            }\n        }\n        // Set 'selected' to false for unselected actions\n        for (const action of actions) {\n            if (!action.id || action?.id.includes('itemMacro')) continue\n\n            const actionData = actionsData.find(actionData => actionData.id === action.id)\n            if (!actionData && action.isPreset) {\n                const actionClone = { ...action, userSelected: false }\n                reorderedActions.push(actionClone)\n            }\n        }\n\n        // Sort actions alphabetically\n        if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n            reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n        }\n\n        // Replace group actions\n        group.actions = reorderedActions\n    }\n\n    /**\n     * Add to available actions\n     * @private\n     * @param {array} actionsMap The actions\n     */\n    #addToAvailableActions (actionsMap) {\n        actionsMap.forEach((action, actionId) => {\n            if (!this.availableActionsMap.has(actionId)) this.availableActionsMap.set(actionId, action)\n        })\n    }\n\n    /**\n     * Get available actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The available actions\n     */\n    getAvailableActions () {\n        return [...this.availableActionsMap.values()].map(action => this.#toActionTagifyEntry(action)).sort((a, b) => a.value.localeCompare(b.value))\n    }\n\n    /**\n     * Get selected actions as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {array}          The selected actions\n     */\n    getSelectedActions (groupData) {\n        const group = this.getGroup(groupData)\n        if (!group) return\n        return group.actions\n            .filter(action => action.selected === true)\n            .map(action => this.#toActionTagifyEntry(action))\n    }\n\n    /**\n     * Get selected groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The selected groups\n     */\n    getSelectedGroups (groupData = {}) {\n        groupData.selected = true\n        groupData.level = (groupData.level || 0) + 1\n        const groups = this.#getGroups(groupData)\n        return groups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get available groups as Tagify entries\n     * @public\n     * @param {object} groupData The group data\n     * @returns {object}         The groups\n     */\n    async getAvailableGroups (groupData) {\n        const derivedGroups = await this.#getDerivedGroups(groupData)\n        const systemGroups = await this.#getSystemGroups()\n        const compendiumGroups = await this.#getCompendiumGroups()\n        const macroGroups = await this.#getMacroGroups()\n        return [...derivedGroups, ...systemGroups, ...compendiumGroups, ...macroGroups]\n    }\n\n    /**\n     * Get compendium groups as Tagify entries\n     * @private\n     * @returns {object} The compendium groups\n     */\n    #getCompendiumGroups () {\n        const packs = game.packs.filter(pack =>\n            COMPENDIUM_PACK_TYPES.includes(pack.documentName) &&\n            (game.version.startsWith('11') ? pack.visible : (!pack.private || game.user.isGM))\n        )\n        const groups = packs.map(pack => {\n            return {\n                id: pack.metadata.id.replace('.', '-'),\n                listName: `Group: ${pack.metadata.label}`,\n                name: pack.metadata.label,\n                type: 'core'\n            }\n        })\n        return groups.map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Get derived groups as Tagify entries\n     * @private\n     * @param {object} groupData The group data\n     * @returns {object}         The derived groups\n     */\n    #getDerivedGroups (groupData) {\n        const derivedGroups = this.#getGroups({\n            nestId: groupData?.nestId,\n            type: GROUP_TYPE.SYSTEM_DERIVED\n        })\n        return derivedGroups?.map(group => this.#toGroupTagifyEntry(group)) ?? []\n    }\n\n    /**\n     * Get macro groups as Tagify entries\n     * @private\n     * @returns {object} The macro groups\n     */\n    #getMacroGroups () {\n        return [this.#toGroupTagifyEntry({\n            id: 'macros',\n            listName: `Group: ${Utils.i18n('tokenActionHud.macros')}`,\n            name: Utils.i18n('tokenActionHud.macros'),\n            type: 'core'\n        })]\n    }\n\n    /**\n     * Get system groups as Tagify entries\n     * @private\n     * @returns {object} The system groups\n     */\n    #getSystemGroups () {\n        return Object.values(this.defaultGroups).map(group => this.#toGroupTagifyEntry(group))\n    }\n\n    /**\n     * Add group to the HUD\n     * @public\n     * @param {object} groupData         The group data\n     * @param {object} parentGroupData   The parent group data\n     * @param {boolean} [update = false] Whether to update an existing group\n     */\n    addGroup (groupData, parentGroupData, update = false) {\n        groupData.type = groupData?.type ?? 'system-derived'\n        groupData.style = groupData?.style ?? 'list'\n\n        if (!parentGroupData?.id && !parentGroupData?.nestId) return\n\n        const parentGroups = this.#getGroups(parentGroupData)\n        if (!parentGroups?.length) return\n\n        for (const parentGroup of parentGroups) {\n            const nestId = `${parentGroup.nestId}_${groupData.id}`\n            const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n            if (existingGroups.length) {\n                if (update) {\n                    for (const existingGroup of existingGroups) {\n                        // Temporary fix until info1-3 properties are grouped into info object\n                        if (groupData.info) {\n                            Object.assign(groupData, { ...groupData.info })\n                            delete groupData.info\n                        }\n\n                        Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n                    }\n                } else {\n                    for (const existingGroup of existingGroups) {\n                        const tooltip = this.#getTooltip(groupData.tooltip, existingGroup.name)\n                        Object.assign(existingGroup, { tooltip })\n                    }\n                }\n            } else {\n                const group = this.#createGroup({ ...groupData, nestId })\n                if (group.settings.style === 'tab') {\n                    parentGroup.groups.tabs.push(group)\n                } else {\n                    parentGroup.groups.lists.push(group)\n                }\n                this.groups[group.nestId] = group\n            }\n        }\n    }\n\n    /**\n     * Update group in the HUD\n     * @public\n     * @param {object} groupData                The group data\n     * @param {object} [parentGroupData = null] The parent group data\n     */\n    updateGroup (groupData, parentGroupData = null) {\n        groupData.type = groupData?.type ?? 'system-derived'\n\n        const updateExistingGroups = (existingGroups) => {\n            for (const existingGroup of existingGroups) {\n                // Temporary fix until info1-3 properties are grouped into info object\n                if (groupData.info) {\n                    Object.assign(groupData, { ...groupData.info })\n                    delete groupData.info\n                }\n\n                Object.assign(existingGroup, this.#createGroup({ ...existingGroup, ...groupData }, true))\n            }\n        }\n\n        if (parentGroupData) {\n            const parentGroups = this.#getGroups(parentGroupData)\n            for (const parentGroup of parentGroups) {\n                const nestId = `${parentGroup.nestId}_${groupData.id}`\n                const existingGroups = this.#getGroups({ ...groupData, nestId })\n\n                updateExistingGroups(existingGroups)\n            }\n        } else {\n            const existingGroups = this.#getGroups(groupData)\n\n            updateExistingGroups(existingGroups)\n        }\n    }\n\n    /**\n     * Remove group from HUD\n     * @public\n     * @param {object} groupData The group data\n     */\n    removeGroup (groupData) {\n        if (!groupData?.nestId && groupData?.id) {\n            Utils.deleteGroupsById(this.hud.groups, groupData.id)\n        }\n\n        const groups = this.#getGroups(groupData)\n        if (!groups?.length) return\n\n        for (const group of groups) {\n            delete this.groups[group.nestId]\n            if (groupData?.nestId) {\n                Utils.deleteGroupByNestId(this.hud.groups, group.nestId)\n            }\n        }\n    }\n\n    /**\n     * Add info to group in the HUD\n     * @public\n     * @param {string} groupData The group data\n     */\n    addGroupInfo (groupData) {\n        const groupId = groupData?.id\n        const groupInfo = groupData?.info\n\n        if (!groupId || !groupInfo) return\n\n        const groups = this.#getGroups(groupData)\n\n        groups.forEach(group => {\n            group.info1 = groupInfo.info1\n            group.info2 = groupInfo.info2\n            group.info3 = groupInfo.info3\n        })\n    }\n\n    /**\n     * Add actions to the HUD\n     * @public\n     * @param {object} actionsData The actions data\n     * @param {object} groupData   The group data\n     */\n    addActions (actionsData, groupData) {\n        if (!actionsData.length) return\n\n        // Create actions\n        const actions = new Map(actionsData.map(actionData => [actionData.id, this.#createAction(actionData)]))\n        this.#addToAvailableActions(actions)\n\n        if (!groupData?.id) return\n\n        const groups = this.#getGroups(groupData)\n\n        if (!groups) return\n\n        for (const group of groups) {\n            // Get existing actions\n            const existingActions = new Map(group.actions.map(action => [action.id, action]))\n\n            const reorderedActions = []\n\n            // Loop the previously saved actions in the group\n            existingActions.forEach((existingAction, existingActionId) => {\n                const action = actions.get(existingActionId)\n                if (action) {\n                    const systemSelected = action.systemSelected ?? existingAction.systemSelected\n                    const userSelected = existingAction.userSelected ?? action.userSelected\n                    const selected = (!systemSelected)\n                        ? false\n                        : userSelected ?? systemSelected ?? true\n                    Object.assign(existingAction, { ...action, isPreset: true, selected, systemSelected, userSelected })\n                } else if (!existingAction.selected && existingAction.isPreset) {\n                    const systemSelected = false\n                    Object.assign(existingAction, this.#createAction({ ...existingAction, systemSelected }))\n                }\n            })\n\n            // Loop the generated actions and add any not previously saved\n            actions.forEach((action, actionId) => {\n                const existingAction = existingActions.get(actionId)\n                if (!existingAction) reorderedActions.push(this.#createAction({ ...action, isPreset: true }))\n            })\n\n            // Sort actions alphabetically\n            if (groupData?.settings?.sort || (typeof groupData?.settings?.sort === 'undefined' && this.sortActionsSetting)) {\n                reorderedActions.sort((a, b) => a.name.localeCompare(b.name))\n            }\n\n            // Add actions to group\n            group.actions.push(...reorderedActions)\n        }\n    }\n\n    /**\n     * Set character limit for action names based on the 'Character per Word' setting\n     * @private\n     */\n    #setCharacterLimit () {\n        const topLevelGroups = this.#getGroups({ level: 1 })\n\n        for (const topLevelGroup of topLevelGroups) {\n            const topLevelGroupCharacterCount = topLevelGroup?.settings?.characterCount\n\n            const groups = this.#getGroups({ nestId: topLevelGroup.nestId })\n\n            for (const group of groups) {\n                const actions = group.actions\n\n                if (!actions || actions?.length === 0) continue\n\n                const groupCharacterCount = group?.settings?.characterCount\n                const characterCount = (groupCharacterCount >= 0)\n                    ? topLevelGroupCharacterCount\n                    : groupCharacterCount\n\n                // Exit if character limit is not defined\n                if ((!characterCount && characterCount !== 0) || characterCount < 0) continue\n\n                for (const action of actions) {\n                    if (action.name.length <= characterCount) continue\n                    if (characterCount === 0) {\n                        action.name = ''\n                        continue\n                    }\n                    // Set each word to the character limit\n                    action.name = action.name\n                        .split(' ')\n                        .map(word => word.slice(0, characterCount))\n                        .join(' ')\n                }\n            }\n        }\n    }\n\n    /**\n     * Add action handler extender\n     * @public\n     * @param {object} actioHandlerExtender The action handler extender\n     */\n    addActionHandlerExtender (actionHandlerExtender) {\n        Logger.debug('Adding action handler extender...', { actionHandlerExtender })\n        this.actionHandlerExtenders.push(actionHandlerExtender)\n    }\n\n    /**\n     * Convert group into Tagify entry\n     * @private\n     * @param {object} data\n     * @returns {object}\n     */\n    #toGroupTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: data.type,\n            value: data.listName ?? data.name\n        }\n    }\n\n    /**\n     * Convert action into Tagify entry\n     * @private\n     * @param {object} data The data\n     * @returns {object}    Tagify entry\n     */\n    #toActionTagifyEntry (data) {\n        return {\n            id: data.id,\n            name: data.name,\n            type: 'action',\n            value: data.listName ?? data.name\n        }\n    }\n\n    /** DEPRECATED */\n\n    /**\n     * Add further action handler\n     * @public\n     * @param {object} handler The handler\n     */\n    addFurtherActionHandler (handler) {\n        globalThis.logger.warn('Token Action HUD | ActionHandler.addFurtherActionHandler is deprecated. Use ActionHandler.addActionHandlerExtender')\n        this.addActionHandlerExtender(handler)\n    }\n}\n","import { ActionHandler } from './action-handler.js'\n\n/**\n * An extension of the base ActionHandler which extends the HUD via core or system modules.\n */\nexport class ActionHandlerExtender extends ActionHandler {\n    extendActionList () {}\n\n    /**\n     * @override\n     */\n    extendActionHandler () {\n        globalThis.logger.warn('Token Action HUD | ActionListExtender.extendActionList is deprecated. Use ActionHandlerExtender.extendActionHandler')\n        this.extendActionList()\n    }\n}\n","import { MODULE } from './constants.js'\nimport { isPersistentStorage, DataHandler } from './data-handler.js'\nimport { Logger, Utils } from './utils.js'\n\n/**\n * Manages migrations between module versions\n */\nexport class MigrationManager {\n    constructor (socket) {\n        this.socket = socket\n    }\n\n    /**\n     * Initialise migrations\n     * @public\n     */\n    async init () {\n        if (!game.user.isGM) return\n\n        const moduleVersion = game.modules.get('token-action-hud-core').version\n        const migrationVersion = Utils.getSetting('migrationVersion')\n        if (moduleVersion === migrationVersion) return\n\n        let isSuccess = true\n        isSuccess = (!migrationVersion || migrationVersion < '1.4.10') ? await this.#unsetOldFlags() : true\n        isSuccess = (isPersistentStorage() && (!migrationVersion || migrationVersion < '1.4.11')) ? await this.#migrateFiles() : true\n\n        if (isSuccess) {\n            Utils.setSetting('migrationVersion', moduleVersion)\n        }\n    }\n\n    /**\n     * Unset old flags\n     * @private\n     */\n    async #unsetOldFlags () {\n        try {\n            const users = game.users.filter(user => user.getFlag(MODULE.ID, 'categories'))\n            for (const user of users) {\n                user.unsetFlag(MODULE.ID, 'categories')\n                user.unsetFlag(MODULE.ID, 'defaults')\n            }\n\n            const actors = game.actors.filter(actor => actor.getFlag(MODULE.ID, 'categories'))\n            for (const actor of actors) {\n                actor.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            const tokens = game.canvas.tokens.objects.children.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n            for (const token of tokens) {\n                token.actor?.unsetFlag(MODULE.ID, 'categories')\n            }\n\n            for (const scene of game.scenes) {\n                const tokens = scene.tokens.filter(token => token.actor?.getFlag(MODULE.ID, 'categories'))\n                for (const token of tokens) {\n                    token.actor?.unsetFlag(MODULE.ID, 'categories')\n                }\n            }\n\n            return true\n        } catch (err) {\n            Logger.debug(err.message, err)\n\n            return false\n        }\n    }\n\n    async #migrateFiles () {\n        try {\n            Logger.info('Migrating files to persistent storage...', true)\n            for (const user of game.users) {\n                const data = await DataHandler.getDataMigrate('user', user.id)\n                if (data) {\n                    await DataHandler.saveData('user', user.id, data)\n                }\n            }\n\n            for (const actor of game.actors) {\n                const data = await DataHandler.getDataMigrate('actor', actor.id)\n                if (data) {\n                    await DataHandler.saveData('actor', actor.id, data)\n                }\n            }\n            Logger.info('Successfully migrated files to persistent storage', true)\n            return true\n        } catch {\n            Logger.info('Failed to migrate files to persistent storage', true)\n            return false\n        }\n    }\n}\n","import { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\n/**\n * Resolves core actions triggered from the HUD\n */\nexport class RollHandler {\n    actor = null\n    token = null\n    delimiter = DELIMITER\n    preRollHandlers = []\n\n    /**\n     * Throw error\n     * @public\n     * @param {*} err The error\n     */\n    throwInvalidValueErr (err) {\n        throw new Error(\n            `Error handling button click: ${err}`\n        )\n    }\n\n    /**\n     * Handle action events\n     * @public\n     * @param {object} event         The event\n     * @param {string} encodedValue  The encoded value\n     * @param {class}  actionHandler The ActionHandler class\n     */\n    async handleActionClickCore (event, encodedValue, actionHandler) {\n        Logger.debug(`Handling click event for action [${encodedValue}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        this.registerKeyPresses(event)\n\n        let handled = false\n        this.preRollHandlers.forEach((handler) => {\n            if (handled) return\n\n            handled = handler.prehandleActionEvent(event, encodedValue, actionHandler)\n        })\n\n        if (handled) return\n\n        if (this.#isGenericAction(encodedValue)) {\n            await this.#handleGenericActionClick(encodedValue)\n        } else {\n            if (this.handleActionClick.toString().slice(-2) !== '{}') {\n                this.handleActionClick(event, encodedValue)\n            } else {\n                globalThis.logger.warn('Token Action HUD | RollHandler.doHandleActionEvent is deprecated. Use RollHandler.handleActionClick')\n                this.doHandleActionEvent(event, encodedValue)\n            }\n        }\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    handleActionClick (event, encodedValue) {}\n\n    /**\n     * Handle action hover events\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     * @param {class} actionHandler The ActionHandler class\n     */\n    async handleActionHoverCore (event, encodedValue, actionHandler) {\n        Logger.debug(`Handling hover event for action [${encodedValue}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        this.registerKeyPresses(event)\n\n        this.handleActionHover(event, encodedValue)\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    handleActionHover (event, encodedValue) {}\n\n    /**\n     * Handle group click events\n     * @param {object} event        The event\n     * @param {string} nestId       The nest ID\n     * @param {class} actionHandler The ActionHandler class\n     */\n    async handleGroupClickCore (event, nestId, actionHandler) {\n        Logger.debug(`Handling click event for group [${nestId}]`, { event })\n\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        this.token = actionHandler.token\n\n        const group = actionHandler.getGroup({ nestId })\n\n        this.registerKeyPresses(event)\n\n        this.handleGroupClick(event, group)\n    }\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event The event\n     * @param {object} group The group\n     */\n    handleGroupClick (event, group) {}\n\n    /**\n     * Add a pre-roll handler\n     * @public\n     * @param {object} handler The roll handler\n     */\n    addPreRollHandler (handler) {\n        Logger.debug(`Adding pre-roll handler ${handler.constructor.name}`)\n        this.preRollHandlers.push(handler)\n    }\n\n    /**\n     * Registers key presses\n     * @public\n     * @param {object} event The events\n     */\n    registerKeyPresses (event) {\n        this.rightClick = this.isRightClick(event)\n        this.ctrl = this.isCtrl(event)\n        this.alt = this.isAlt(event)\n        this.shift = this.isShift(event)\n    }\n\n    /**\n     * Renders the item sheet\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     * @returns {boolean}     Whether the item was rendered\n     */\n    renderItem (actor, itemId) {\n        // If actor is not specified, use the RollHandler's actor\n        if (!actor) {\n            actor = this.actor\n        }\n\n        // Get the item\n        const item = Utils.getItem(actor, itemId)\n\n        // If the item is not found, return false\n        if (!item) return false\n\n        // Render the item and return true\n        item.sheet.render(true)\n        return true\n    }\n\n    /**\n     * Whether the item sheet should be rendered\n     * @public\n     * @returns {boolean}\n     */\n    isRenderItem () {\n        return (\n            this.rightClick &&\n            !(this.alt || this.ctrl || this.shift)\n        )\n    }\n\n    /**\n     * Whether the button was right-clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isRightClick (event) {\n        return event?.originalEvent?.button === 2\n    }\n\n    /**\n     * Whether the ALT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isAlt (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.ALT)\n        if (event.altKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT ALT key press')\n            KeyboardManager.emulateKeypress(false, 'AltLeft', { altKey: true, force: true })\n            game.keyboard.downKeys.add('AltLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the CTRL key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isCtrl (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.CONTROL)\n        if (event.ctrlKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT CTRL key press')\n            KeyboardManager.emulateKeypress(false, 'ControlLeft', { ctrlKey: true, force: true })\n            game.keyboard.downKeys.add('ControlLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the SHIFT key was pressed when the button was clicked\n     * @public\n     * @param {object} event The event\n     * @returns {boolean}\n     */\n    isShift (event) {\n        const isModiferActive = game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.SHIFT)\n        if (event.shiftKey && !isModiferActive) {\n            Logger.debug('Emulating LEFT SHIFT key press')\n            KeyboardManager.emulateKeypress(false, 'ShiftLeft', { shiftKey: true, force: true })\n            game.keyboard.downKeys.add('ShiftLeft')\n            return true\n        }\n        return isModiferActive\n    }\n\n    /**\n     * Whether the action is a generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     * @returns {boolean}           Whether the action is a generic action\n     */\n    #isGenericAction (encodedValue) {\n        const [actionType, actionId] = encodedValue.split(DELIMITER)\n        return actionType === 'utility' && actionId.includes('toggle')\n    }\n\n    /**\n     * Handle generic action\n     * @private\n     * @param {string} encodedValue The encoded value\n     */\n    async #handleGenericActionClick (encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n        const actionId = payload[1]\n\n        const firstControlledToken = Utils.getFirstControlledToken()\n\n        if (actionId === 'toggleVisibility') await firstControlledToken.toggleVisibility()\n        if (actionId === 'toggleCombat') await firstControlledToken.toggleCombat()\n\n        Hooks.callAll('forceUpdateTokenActionHud')\n    }\n\n    // DEPRECATED\n\n    /**\n     * Overide for the TAH system module\n     * @override\n     * @param {object} event        The event\n     * @param {string} encodedValue The encoded value\n     */\n    doHandleActionEvent (event, encodedValue) {}\n\n    /**\n     * Renders the item sheet\n     * @public\n     * @param {object} actor  The actor\n     * @param {string} itemId The item id\n     */\n    doRenderItem (actor, itemId) {\n        globalThis.logger.warn('Token Action HUD | RollHandler.doRenderItem is deprecated. Use RollHandler.renderItem')\n        this.renderItem(actor, itemId)\n    }\n}\n","import { RollHandler } from './roll-handler.js'\n\n/*\n * Used for adding support for actions not part of the core functions.\n * Returns true from prehandleActionEvent() if it can perform an action and stops\n * further actions being performed.\n */\nexport class PreRollHandler extends RollHandler {\n    prehandleActionEvent (event, encodedValue) {\n        return false\n    }\n}\n","import { CUSTOM_STYLE, MODULE, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class CustomStyleForm extends FormApplication {\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.customStyle.form.title'),\n            template: TEMPLATE.customStyleForm,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 600,\n            popOut: true,\n            resizable: true,\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    getData () {\n        this.data = {\n            backgroundColor: Utils.getSetting('backgroundColor', CUSTOM_STYLE.backgroundColor.default),\n            buttonHeight: Utils.getSetting('buttonHeight', CUSTOM_STYLE.buttonHeight.default),\n            buttonBackgroundColor: Utils.getSetting('buttonBackgroundColor', CUSTOM_STYLE.buttonBackgroundColor.default),\n            buttonHoverBackgroundColor: Utils.getSetting('buttonHoverBackgroundColor', CUSTOM_STYLE.buttonHoverBackgroundColor.default),\n            buttonToggleActiveBackgroundColor: Utils.getSetting('buttonToggleActiveBackgroundColor', CUSTOM_STYLE.buttonToggleActiveBackgroundColor.default),\n            buttonToggleHoverBackgroundColor: Utils.getSetting('buttonToggleHoverBackgroundColor', CUSTOM_STYLE.buttonToggleHoverBackgroundColor.default),\n            buttonTextColor: Utils.getSetting('buttonTextColor', CUSTOM_STYLE.buttonTextColor.default),\n            buttonHoverTextColor: Utils.getSetting('buttonHoverTextColor', CUSTOM_STYLE.buttonHoverTextColor.default),\n            buttonToggleActiveTextColor: Utils.getSetting('buttonToggleActiveTextColor', CUSTOM_STYLE.buttonToggleActiveTextColor.default),\n            buttonToggleHoverTextColor: Utils.getSetting('buttonToggleHoverTextColor', CUSTOM_STYLE.buttonToggleHoverTextColor.default),\n            buttonBorderPrimaryColor: Utils.getSetting('buttonBorderPrimaryColor', CUSTOM_STYLE.buttonBorderPrimaryColor.default),\n            buttonBorderSecondaryColor: Utils.getSetting('buttonBorderSecondaryColor', CUSTOM_STYLE.buttonBorderSecondaryColor.default),\n            buttonHoverBorderPrimaryColor: Utils.getSetting('buttonHoverBorderPrimaryColor', CUSTOM_STYLE.buttonHoverBorderPrimaryColor.default),\n            buttonHoverBorderSecondaryColor: Utils.getSetting('buttonHoverBorderSecondaryColor', CUSTOM_STYLE.buttonHoverBorderSecondaryColor.default),\n            buttonToggleActiveBorderPrimaryColor: Utils.getSetting('buttonToggleActiveBorderPrimaryColor', CUSTOM_STYLE.buttonToggleActiveBorderPrimaryColor.default),\n            buttonToggleActiveBorderSecondaryColor: Utils.getSetting('buttonToggleActiveBorderSecondaryColor', CUSTOM_STYLE.buttonToggleActiveBorderSecondaryColor.default),\n            buttonToggleHoverBorderPrimaryColor: Utils.getSetting('buttonToggleHoverBorderPrimaryColor', CUSTOM_STYLE.buttonToggleHoverBorderPrimaryColor.default),\n            buttonToggleHoverBorderSecondaryColor: Utils.getSetting('buttonToggleHoverBorderSecondaryColor', CUSTOM_STYLE.buttonToggleHoverBorderSecondaryColor.default),\n            textPrimaryColor: Utils.getSetting('textPrimaryColor', CUSTOM_STYLE.textPrimaryColor.default),\n            textSecondaryColor: Utils.getSetting('textSecondaryColor', CUSTOM_STYLE.textSecondaryColor.default),\n            textTertiaryColor: Utils.getSetting('textTertiaryColor', CUSTOM_STYLE.textTertiaryColor.default),\n            textHoverPrimaryColor: Utils.getSetting('textHoverPrimaryColor', CUSTOM_STYLE.textHoverPrimaryColor.default),\n            textHoverSecondaryColor: Utils.getSetting('textHoverSecondaryColor', CUSTOM_STYLE.textHoverSecondaryColor.default),\n            textHoverTertiaryColor: Utils.getSetting('textHoverTertiaryColor', CUSTOM_STYLE.textHoverTertiaryColor.default)\n        }\n        return this.data\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        const resetButtonElement = html.find('#tah-custom-style-reset-button')\n        resetButtonElement.on('click', this._reset.bind(this))\n\n        if (typeof ColorPicker !== 'undefined') { ColorPicker.install() }\n    }\n\n    _reset () {\n        for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n            Utils.setSetting(key, value.default)\n            document.querySelector(':root').style.setProperty(value.cssProperty, value.default)\n        }\n        this.render(true)\n    }\n\n    _updateObject (event, formData) {\n        for (const [key, value] of Object.entries(formData)) {\n            const customStyle = CUSTOM_STYLE[key]\n            if (value !== this.data[key]) {\n                Utils.setSetting(key, value)\n                document.querySelector(':root').style.setProperty(customStyle.cssProperty, value)\n            }\n        }\n    }\n}\n","import { CUSTOM_STYLE, MODULE, LAYOUT_SETTING, TEMPLATE } from '../constants.js'\nimport { Utils } from '../utils.js'\n\nexport class TahSettingsForm extends FormApplication {\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            template: TEMPLATE.settings,\n            id: 'token-action-hud-core-settings',\n            width: 600,\n            height: 'auto',\n            closeOnSubmit: true\n        })\n    }\n\n    constructor (...args) {\n        super(args)\n    }\n\n    async getData () {\n        const settings = []\n        for (const [key, setting] of Object.entries(this.settings)) {\n            if (setting?.scope === 'world' && !game.user.isGM) continue\n            const id = key\n            const hint = Utils.i18n(setting.hint)\n            const icon = setting.icon\n            const label = Utils.i18n(setting.label)\n            const name = Utils.i18n(setting.name)\n            const value = (setting?.scope)\n                ? (setting?.scope === 'user')\n                    ? await Utils.getUserFlag(key)\n                    : await Utils.getSetting(key)\n                : ''\n            const type = setting.type instanceof Function ? setting.type.name : 'String'\n            const isButton = setting.inputType === 'button'\n            const onClick = setting.onClick\n            const isCheckbox = setting.inputType === 'checkbox'\n            const isFilePicker = setting.inputType === 'filePicker'\n            const filePickerType = (setting.inputType === 'filePicker') ? type ?? 'any' : ''\n            const isNumber = setting.inputType === 'number'\n            const isRange = (setting.inputType === 'range') && setting.range\n            const isSelect = setting.choices !== undefined\n            settings.push({\n                id,\n                hint,\n                icon,\n                label,\n                name,\n                value,\n                type,\n                isButton,\n                onClick,\n                isCheckbox,\n                isFilePicker,\n                filePickerType,\n                isNumber,\n                isRange,\n                isSelect\n            })\n        }\n        return { settings }\n    }\n\n    activateListeners (html) {\n        super.activateListeners(html)\n\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n    }\n\n    async _updateObject (event, formData) {\n        for (const [key, value] of Object.entries(formData)) {\n            switch (this.settings[key].scope) {\n            case 'client':\n            case 'world':\n                await Utils.setSetting(key, value)\n                break\n            case 'user':\n                await Utils.setUserFlag(key, value)\n            }\n\n            await game.tokenActionHud.updateSettings(key, value)\n        }\n\n        game.tokenActionHud.update()\n    }\n}\n\nexport class TahSettingsFormLayout extends TahSettingsForm {\n    constructor () {\n        super()\n        this.settings = LAYOUT_SETTING\n    }\n\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            title: Utils.i18n('tokenActionHud.settings.layout.form.title')\n        })\n    }\n}\n","import { CustomStyleForm } from './forms/custom-style-form.js'\nimport { TahSettingsFormLayout } from './forms/settings-form.js'\nimport { CUSTOM_STYLE, MODULE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nfunction onChangeFunction (setting, value) { if (game.tokenActionHud) game.tokenActionHud.updateSettings(setting, value) }\n\n// Register key bindings\nHooks.on('init', async () => {\n    game.keybindings.register(MODULE.ID, 'toggleHud', {\n        name: Utils.i18n('tokenActionHud.toggleHud'),\n        editable: [],\n        onDown: () => { game.tokenActionHud.toggleHud() }\n    })\n})\n\n/**\n * Register module settings\n * @param {object} systemManager The SystemManager class\n * @param {array} rollHandlers   The available roll handlers\n */\nexport const registerSettingsCore = function (systemManager, rollHandlers, styles) {\n    game.settings.registerMenu(MODULE.ID, 'customStyle', {\n        hint: Utils.i18n('tokenActionHud.settings.customStyle.hint'),\n        label: Utils.i18n('tokenActionHud.settings.customStyle.label'),\n        name: Utils.i18n('tokenActionHud.settings.customStyle.name'),\n        icon: 'fas fa-palette',\n        type: CustomStyleForm,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.registerMenu(MODULE.ID, 'layout', {\n        hint: Utils.i18n('tokenActionHud.settings.layout.hint'),\n        label: Utils.i18n('tokenActionHud.settings.layout.label'),\n        name: Utils.i18n('tokenActionHud.settings.layout.name'),\n        icon: 'fas fa-table-layout',\n        type: TahSettingsFormLayout,\n        restricted: false,\n        scope: 'client'\n    })\n\n    game.settings.register(MODULE.ID, 'startup', {\n        name: 'One-Time Startup Prompt',\n        scope: 'world',\n        config: false,\n        type: Boolean,\n        default: false\n    })\n\n    game.settings.register(MODULE.ID, 'migrationVersion', {\n        name: 'Migration Version',\n        scope: 'world',\n        config: false,\n        type: String,\n        default: '0.0'\n    })\n\n    const styleChoices = Object.fromEntries(Object.entries(styles).map(([key, value]) => [key, value.name]))\n\n    game.settings.register(MODULE.ID, 'style', {\n        name: Utils.i18n('tokenActionHud.settings.style.name'),\n        hint: Utils.i18n('tokenActionHud.settings.style.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'foundryVTT',\n        choices: styleChoices,\n        onChange: (value) => {\n            Utils.switchCSS(value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'customLayout', {\n        name: Utils.i18n('tokenActionHud.settings.customLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.customLayout.hint'),\n        scope: 'world',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'userCustomLayout', {\n        name: Utils.i18n('tokenActionHud.settings.userCustomLayout.name'),\n        hint: Utils.i18n('tokenActionHud.settings.userCustomLayout.hint'),\n        scope: 'client',\n        config: false,\n        type: String\n    })\n\n    game.settings.register(MODULE.ID, 'direction', {\n        name: Utils.i18n('tokenActionHud.settings.direction.name'),\n        hint: Utils.i18n('tokenActionHud.settings.direction.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'auto',\n        choices: {\n            auto: Utils.i18n('tokenActionHud.settings.direction.choice.auto'),\n            up: Utils.i18n('tokenActionHud.settings.direction.choice.up'),\n            down: Utils.i18n('tokenActionHud.settings.direction.choice.down')\n        },\n        onChange: (value) => {\n            onChangeFunction('direction', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'grid', {\n        name: Utils.i18n('tokenActionHud.settings.grid.name'),\n        hint: Utils.i18n('tokenActionHud.settings.grid.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('grid', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'scale', {\n        name: Utils.i18n('tokenActionHud.settings.scale.name'),\n        hint: Utils.i18n('tokenActionHud.settings.scale.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        range: {\n            min: 0.5,\n            max: 2,\n            step: 0.05\n        },\n        default: 1,\n        onChange: (value) => {\n            onChangeFunction('scale', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'drag', {\n        name: Utils.i18n('tokenActionHud.settings.drag.name'),\n        hint: Utils.i18n('tokenActionHud.settings.drag.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'whenUnlocked',\n        choices: {\n            always: Utils.i18n('tokenActionHud.settings.drag.choices.always'),\n            whenUnlocked: Utils.i18n('tokenActionHud.settings.drag.choices.whenUnlocked'),\n            never: Utils.i18n('tokenActionHud.settings.drag.choices.never')\n        },\n        onChange: (value) => {\n            onChangeFunction('drag', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'enable', {\n        name: Utils.i18n('tokenActionHud.settings.enable.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enable.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enable', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'rollHandler', {\n        name: Utils.i18n('tokenActionHud.settings.rollHandler.name'),\n        hint: Utils.i18n('tokenActionHud.settings.rollHandler.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: rollHandlers,\n        default: 'core',\n        onChange: (value) => {\n            onChangeFunction('rollHandler', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'allow', {\n        name: Utils.i18n('tokenActionHud.settings.allow.name'),\n        hint: Utils.i18n('tokenActionHud.settings.allow.hint'),\n        scope: 'world',\n        config: true,\n        type: String,\n        choices: {\n            4: Utils.i18n('tokenActionHud.settings.allow.choice.4'),\n            3: Utils.i18n('tokenActionHud.settings.allow.choice.3'),\n            2: Utils.i18n('tokenActionHud.settings.allow.choice.2'),\n            1: Utils.i18n('tokenActionHud.settings.allow.choice.1')\n        },\n        default: 1,\n        requiresReload: true\n    })\n\n    game.settings.register(MODULE.ID, 'enableCustomization', {\n        name: Utils.i18n('tokenActionHud.settings.enableCustomization.name'),\n        hint: Utils.i18n('tokenActionHud.settings.enableCustomization.hint'),\n        scope: 'world',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('enableCustomization', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'alwaysShowHud', {\n        name: Utils.i18n('tokenActionHud.settings.alwaysShowHud.name'),\n        hint: Utils.i18n('tokenActionHud.settings.alwaysShowHud.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('alwaysShowHud', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayCharacterName', {\n        name: Utils.i18n('tokenActionHud.settings.displayCharacterName.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayCharacterName.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayCharacterName', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'sortActions', {\n        name: Utils.i18n('tokenActionHud.settings.sortActions.name'),\n        hint: Utils.i18n('tokenActionHud.settings.sortActions.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('sortActions', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'displayIcons', {\n        name: Utils.i18n('tokenActionHud.settings.displayIcons.name'),\n        hint: Utils.i18n('tokenActionHud.settings.displayIcons.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: true,\n        onChange: (value) => {\n            onChangeFunction('displayIcons', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltips', {\n        name: Utils.i18n('tokenActionHud.settings.tooltips.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltips.hint'),\n        scope: 'client',\n        config: true,\n        type: String,\n        default: 'full',\n        choices: {\n            full: Utils.i18n('tokenActionHud.settings.tooltips.choices.full'),\n            nameOnly: Utils.i18n('tokenActionHud.settings.tooltips.choices.nameOnly'),\n            none: Utils.i18n('tokenActionHud.settings.tooltips.choices.none')\n        },\n        onChange: (value) => {\n            onChangeFunction('tooltips', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'tooltipDelay', {\n        name: Utils.i18n('tokenActionHud.settings.tooltipDelay.name'),\n        hint: Utils.i18n('tokenActionHud.settings.tooltipDelay.hint'),\n        scope: 'client',\n        config: true,\n        type: Number,\n        default: 1500,\n        onChange: (value) => {\n            setTooltipDelay(value)\n        }\n    })\n\n    const tooltipDelay = Utils.getSetting('tooltipDelay') || 1500\n    setTooltipDelay(tooltipDelay)\n\n    function setTooltipDelay (ms) {\n        const root = document.querySelector(':root')\n        root.style.setProperty('--tah-tooltip-delay', `${ms}ms`)\n    }\n\n    game.settings.register(MODULE.ID, 'clickOpenCategory', {\n        name: Utils.i18n('tokenActionHud.settings.clickOpenCategory.name'),\n        hint: Utils.i18n('tokenActionHud.settings.clickOpenCategory.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('clickOpenCategory', value)\n        }\n    })\n\n    if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n        game.settings.register(MODULE.ID, 'itemMacro', {\n            name: Utils.i18n('tokenActionHud.settings.itemMacro.name'),\n            hint: Utils.i18n('tokenActionHud.settings.itemMacro.hint'),\n            scope: 'client',\n            config: true,\n            type: String,\n            choices: {\n                both: Utils.i18n('tokenActionHud.settings.itemMacro.choices.both'),\n                itemMacro: Utils.i18n('tokenActionHud.settings.itemMacro.choices.itemMacro'),\n                original: Utils.i18n('tokenActionHud.settings.itemMacro.choices.original')\n            },\n            default: 'both',\n            onChange: (value) => {\n                onChangeFunction('itemMacro', value)\n            }\n        })\n    }\n\n    game.settings.register(MODULE.ID, 'activeCssAsText', {\n        name: Utils.i18n('tokenActionHud.settings.activeCssAsText.name'),\n        hint: Utils.i18n('tokenActionHud.settings.activeCssAsText.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('activeCssAsText', value)\n        }\n    })\n\n    game.settings.register(MODULE.ID, 'debug', {\n        name: Utils.i18n('tokenActionHud.settings.debug.name'),\n        hint: Utils.i18n('tokenActionHud.settings.debug.hint'),\n        scope: 'client',\n        config: true,\n        type: Boolean,\n        default: false,\n        onChange: (value) => {\n            onChangeFunction('debug', value)\n        }\n    })\n\n    registerCustomStyleSettings()\n\n    if (systemManager.registerSettings.toString().slice(-2) !== '{}') {\n        systemManager.registerSettings(onChangeFunction)\n    } else {\n        globalThis.logger.warn('Token Action HUD | SystemHandler.doRegisterSettings is deprecated. Use SystemHandler.registerSettings')\n        systemManager.doRegisterSettings(onChangeFunction)\n    }\n\n    Logger.debug('Available roll handlers', { rollHandlers })\n}\n\n/**\n * Register color settings\n */\nfunction registerCustomStyleSettings () {\n    for (const [key, value] of Object.entries(CUSTOM_STYLE)) {\n        game.settings.register(MODULE.ID, key, {\n            scope: 'client',\n            config: false,\n            type: value.type,\n            default: value.default\n        })\n    }\n}\n","import { ActionHandlerExtender } from './action-handler-extender.js'\nimport { DELIMITER, ITEM_MACRO_ICON } from '../constants.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Handler for building actions related to the Item Macro module.\n */\nexport class ItemMacroActionHandlerExtender extends ActionHandlerExtender {\n    constructor (actionHandler) {\n        super(actionHandler)\n        this.actionHandler = actionHandler\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n    }\n\n    /**\n     * Extend the action list\n     * @override\n     */\n    extendActionHandler () {\n        // Update actor and token with current action handler context\n        this.actor = this.actionHandler.actor\n        this.token = this.actionHandler.token\n\n        if (!this.actor) return\n        const items = this.actor.items.filter((item) => item.flags?.itemacro?.macro?.command)\n\n        let itemIds\n        if (Utils.isModuleActive('midi-qol')) {\n            itemIds = items\n                .filter(this.#isUnsupportedByMidiQoL)\n                .map((item) => item.id)\n        } else {\n            itemIds = items.map((item) => item.id)\n        }\n\n        if (!itemIds) return\n\n        if (itemIds.length === 0) return\n\n        const itemMacroSetting = Utils.getSetting('itemMacro')\n\n        if (itemMacroSetting === 'original') return\n\n        const replace = itemMacroSetting === 'itemMacro'\n\n        Object.keys(this.actionHandler.groups).forEach(groupKey => {\n            const group = this.actionHandler.groups[groupKey]\n            this.#addGroupActions(itemIds, group, replace)\n        })\n    }\n\n    /**\n     * Add group actions\n     * @private\n     * @param {array} itemIds   The list of item IDs\n     * @param {object} group    The group\n     * @param {boolean} replace Whether to replace the action or not\n     */\n    #addGroupActions (itemIds, group, replace) {\n        // Exit if no actions exist\n        if (!group?.actions?.length) return\n\n        const actions = []\n        group.actions.forEach(existingAction => {\n            if (!itemIds.includes(existingAction.id)) return\n\n            const existingItemMacroAction = group.actions.find(action => action.id === `itemMacro+${existingAction.id}`)\n            const actionToReplace = existingItemMacroAction ?? existingAction\n\n            if (existingItemMacroAction) {\n                replace = true\n            }\n\n            const macroAction = this.#createItemMacroAction(existingAction, actionToReplace, replace)\n\n            if (!replace) actions.push(macroAction)\n        })\n\n        this.#addActions(actions, group)\n    }\n\n    /**\n     * Create item macro action\n     * @private\n     * @param {object} existingAction  The existing action\n     * @param {object} actionToReplace The action to replace\n     * @param {boolean} replace        Whether to replace the action or not\n     * @returns {object}               The item macro action\n     */\n    #createItemMacroAction (existingAction, actionToReplace, replace) {\n        const action = (replace) ? actionToReplace : Utils.deepClone(existingAction)\n        action.encodedValue = `itemMacro${existingAction.encodedValue?.substr(existingAction.encodedValue.indexOf(DELIMITER))}`\n        action.id = `itemMacro+${existingAction.id}`\n        action.fullName = existingAction.fullName\n        action.listName = `Item Macro: ${existingAction.fullName}`\n        action.name = existingAction.name\n        action.itemMacroIcon = `<i class=\"${ITEM_MACRO_ICON.ICON}\" data-tooltip=\"${ITEM_MACRO_ICON.TOOLTIP}\"></i>`\n        return action\n    }\n\n    /**\n     * Add actions to the group\n     * @private\n     * @param {object} actions The actions\n     * @param {object} group   The group\n     */\n    #addActions (actions, group) {\n        actions.forEach(macroAction => {\n            const index = group.actions.findIndex(action => action.id === macroAction.id) + 1\n            group.actions.splice(index, 0, macroAction)\n        })\n    }\n\n    /**\n     * Whether the item is supported by MidiQoL or not\n     * @private\n     * @param {object} item The item\n     * @returns {boolean}\n     */\n    #isUnsupportedByMidiQoL (item) {\n        const flag = item.getFlag('midi-qol', 'onUseMacroName')\n        return !flag\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { COMPENDIUM_ACTION_TYPES, DELIMITER } from '../constants.js'\n\nexport class CompendiumMacroPreHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue) {\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length < 2) return false\n\n        let actionType = null\n        let key = null\n        let actionId = null\n\n        if (payload.length === 2) {\n            actionType = payload[0]\n            actionId = payload[1]\n        }\n        if (payload.length === 3) {\n            actionType = payload[0]\n            key = payload[1]\n            actionId = payload[2]\n        }\n\n        if (!COMPENDIUM_ACTION_TYPES.includes(actionType)) return false\n\n        switch (actionType) {\n        case 'compendiumEntry':\n            this.#handleCompendium(key, actionId)\n            break\n        case 'compendiumMacro':\n            this.#handleMacroCompendium(key, actionId)\n            break\n        case 'compendiumPlaylist':\n            this.#handlePlaylistCompendium(key, actionId)\n            break\n        case 'macro':\n            this.#handleMacro(actionId)\n            break\n        default:\n            return false\n        }\n\n        return true\n    }\n\n    /**\n     * Handle compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.sheet.render(true))\n    }\n\n    /**\n     * Handle macro compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    #handleMacroCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        pack.getDocument(actionId).then((entity) => entity.execute())\n    }\n\n    /**\n     * Handle playlist compendium\n     * @private\n     * @param {string} compendiumKey The compendium key\n     * @param {string} actionId      The action id\n     */\n    async #handlePlaylistCompendium (compendiumKey, actionId) {\n        const pack = game.packs.get(compendiumKey)\n        const actionPayload = actionId.split('>')\n        const playlistId = actionPayload[0]\n        const soundId = actionPayload[1]\n        const playlist = await pack.getDocument(playlistId)\n        const sound = playlist.sounds.find((sound) => sound._id === soundId)\n        AudioHelper.play({ src: sound.path }, {})\n    }\n\n    /**\n     * Handle macro\n     * @private\n     * @param {string} actionId The action id\n     */\n    #handleMacro (actionId) {\n        game.macros.get(actionId).execute()\n    }\n}\n","import { PreRollHandler } from './pre-roll-handler.js'\nimport { DELIMITER } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\n\nexport class ItemMacroPreRollHandler extends PreRollHandler {\n    /** @override */\n    prehandleActionEvent (event, encodedValue, actionHandler) {\n        // Update variables with current action context\n        this.actor = actionHandler.actor\n        const payload = encodedValue.split(DELIMITER)\n\n        if (payload.length !== 2) return false\n\n        const actionType = payload[0]\n        const actionId = payload[1]\n\n        if (actionType !== 'itemMacro') return false\n\n        if (this.isRenderItem()) {\n            this.doRenderItem(this.actor, actionId)\n            return true\n        }\n\n        return this.#tryExecuteItemMacro(actionId)\n    }\n\n    /**\n     * Try to execute item macro\n     * @private\n     * @param {string} actionId The action id\n     * @returns {boolean}       Whether the item macro executed\n     */\n    #tryExecuteItemMacro (actionId) {\n        const item = Utils.getItem(this.actor, actionId)\n\n        try {\n            item.executeMacro()\n        } catch (e) {\n            Logger.debug('ItemMacro Error', e)\n            return false\n        }\n\n        return true\n    }\n}\n","import { registerSettingsCore } from './settings.js'\nimport { ItemMacroActionHandlerExtender } from './action-handlers/item-macro-extender.js'\nimport { CompendiumMacroPreHandler } from './roll-handlers/compendium-macro-pre-handler.js'\nimport { ItemMacroPreRollHandler } from './roll-handlers/pre-item-macro.js'\nimport { MODULE, CSS_STYLE } from './constants.js'\nimport { Logger, Utils } from './utils.js'\n\nexport class SystemManager {\n    constructor () {\n        this.coreModuleId = MODULE.ID\n        this.styles = null\n    }\n\n    /** ACTION HANDLERS */\n    /** OVERRIDDEN BY SYSTEM */\n\n    getActionHandler () {}\n    getRollHandler (rollHandlerId) {}\n    getAvailableRollHandlers () {}\n    registerSettings (onChangeFunction) {}\n    async registerDefaults () {}\n\n    /**\n     * Register defaults\n     * @public\n     */\n    async registerDefaultsCore () {\n        let func = null\n        if (this.registerDefaults.toString().slice(-2) !== '{}') {\n            func = this.registerDefaults\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doRegisterDefaultFlags is deprecated. Use SystemHandler.registerDefaults')\n            func = this.doRegisterDefaultFlags\n        }\n        const defaults = await func() ?? []\n\n        Hooks.callAll('tokenActionHudCoreRegisterDefaults', defaults)\n\n        if (defaults) {\n            game.tokenActionHud.defaults = defaults\n        }\n    }\n\n    /**\n     * Register styles\n     */\n    async registerStylesCore () {\n        const systemStyles = this.registerStyles() ?? {}\n        this.styles = mergeObject(CSS_STYLE, systemStyles)\n\n        Hooks.callAll('tokenActionHudCoreRegisterStyles', this.styles)\n    }\n\n    /**\n     * @override\n     */\n    async registerStyles () {}\n\n    /**\n     * Initialise the action handler\n     * @public\n     * @returns {class} The ActionHandler class\n     */\n    async getActionHandlerCore () {\n        let func = null\n        if (this.getActionHandler.toString().slice(-2) !== '{}') {\n            func = this.getActionHandler\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doGetActionHandler is deprecated. Use SystemHandler.getActionHandler')\n            func = this.doGetActionHandler\n        }\n        const actionHandler = func()\n\n        this.#addActionHandlerExtenders(actionHandler)\n\n        return actionHandler\n    }\n\n    /**\n     * Add action handler extensions\n     * @public\n     * @param {class} actionHandler The ActionHandler class\n     */\n    #addActionHandlerExtenders (actionHandler) {\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n            actionHandler.addActionHandlerExtender(new ItemMacroActionHandlerExtender(actionHandler))\n        }\n\n        Hooks.callAll('tokenActionHudCoreAddActionHandlerExtenders', actionHandler)\n    }\n\n    /**\n     * Get the roll handler\n     * @public\n     * @returns {class} The RollHandler class\n     */\n    getRollHandlerCore () {\n        let rollHandlerId = Utils.getSetting('rollHandler')\n\n        if (!(rollHandlerId === 'core' || Utils.isModuleActive(rollHandlerId))) {\n            Logger.error(rollHandlerId, Utils.i18n('tokenActionHud.handlerNotFound'))\n            rollHandlerId = 'core'\n            Utils.setSetting('rollHandler', rollHandlerId)\n        }\n\n        let func = null\n        if (this.getRollHandler.toString().slice(-2) !== '{}') {\n            func = this.getRollHandler\n        } else {\n            globalThis.logger.warn('Token Action HUD | SystemHandler.doGetRollHandler is deprecated. Use SystemHandler.getRollHandler')\n            func = this.doGetRollHandler\n        }\n        const rollHandler = func(rollHandlerId)\n        this.addPreHandlers(rollHandler)\n        return rollHandler\n    }\n\n    /**\n     * Add pre-handlers\n     * @public\n     * @param {object} rollHandler\n     */\n    addPreHandlers (rollHandler) {\n        rollHandler.addPreRollHandler(new CompendiumMacroPreHandler())\n\n        if (Utils.isModuleActive('itemacro') && !Utils.isModuleActive('midi-qol')) {\n            rollHandler.addPreRollHandler(new ItemMacroPreRollHandler())\n        }\n    }\n\n    /**\n     * Register module settings\n     * @public\n     */\n    registerSettingsCore () {\n        const rollHandlers = this.getAvailableRollHandlers()\n        registerSettingsCore(this, rollHandlers, this.styles)\n    }\n\n    /**\n     * Add handler\n     * @param {array} choices The choices\n     * @param {string} id     The module id\n     */\n    static addHandler (choices, id) {\n        if (Utils.isModuleActive(id)) {\n            const title = Utils.getModuleTitle(id)\n            mergeObject(choices, { [id]: title })\n        }\n    }\n\n    // DEPRECATED\n    doGetActionHandler () {}\n    doGetRollHandler (rollHandlerId) {}\n    async doRegisterDefaultFlags () {}\n    doRegisterSettings (onChangeFunction) {}\n}\n","!function(t,e){var s=s||{};\"function\"==typeof s&&s.amd?s([],e):\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"object\"==typeof exports?exports.DragSort=e():t.DragSort=e()}(this,(function(){var t,e=0,s={},i={},r=(t=window.MutationObserver||window.WebKitMutationObserver,function(e,s){e&&1===e.nodeType&&(t?new t((function(t,e){s(t)})).observe(e,{childList:!0,subtree:!1}):window.addEventListener&&e.addEventListener(\"DOMNodeInserted\",s,!1))});function a(t,e){if(!t)return this;e=e||{},this.parentElm=t,this.uid=e.uid,this.settings={selector:\"*\",callbacks:{}},Object.assign(this.settings,e),this.setup(),r(this.parentElm,this.setup.bind(this)),this.bindEvents()}return a.prototype={namespace:\"dragsort\",setup(){[...this.parentElm.childNodes].forEach((t=>{if(1!=t.nodeType)return t.parentNode.removeChild(t);t.matches(this.settings.selector)&&(t.draggable=!0)})),this.gap=this.getItemsGap(this.parentElm.firstElementChild)},throttle(t,e){var s=!1,i=this;return function(r){s||(t.call(i,r),s=!0,setTimeout((()=>s=!1),e))}},getDraggableElm(t){if(!t.closest)return null;var e=t.closest('[draggable=\"true\"]');return this.uid==s.uid?e:null},dragstart(t,e){s=this;var i,r=this.getDraggableElm(e);r?(this.source=this.getInitialState(),this.target=this.getInitialState(),i=r.getBoundingClientRect(),this.source.elm=r,this.source.idx=this.getNodeIndex(r),this.source.size.width=i.width,this.source.size.height=i.height,t.dataTransfer.effectAllowed=\"move\",this.settings.callbacks.dragStart&&this.settings.callbacks.dragStart(this.source.elm,t),setTimeout(this.afterDragStart.bind(this))):s={}},afterDragStart(){var t=\"vertical\"==this.settings.mode?\"height\":\"width\";this.parentElm.classList.add(`${this.namespace}--dragStart`),this.source.elm.style[t]=this.source.size[t]+\"px\",this.source.elm.classList.add(`${this.namespace}--dragElem`)},dragover(t){t.preventDefault(),t.stopPropagation();var e=t.target;if((e=this.getDraggableElm(e))&&this.target){var s=this.target.elm,i=this.target.hoverDirection;t.dataTransfer.dropEffect=\"move\",this.target.hoverDirection=this.getTargetDirection(t),s==e&&i==this.target.hoverDirection||this.directionAwareDragEnter(t,e)}},dragenter(t,e){(e=this.getDraggableElm(e))&&this.target&&this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(this.target.bounding=e.getBoundingClientRect())},directionAwareDragEnter(t,e){var s;t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=\"none\",this.isValidElm(e)&&this.source.elm!=e&&this.source.elm&&(t.dataTransfer.dropEffect=\"move\",this.cleanupLastTarget(),this.target.elm=e,this.target.idx=this.getNodeIndex(e),e.classList.add(\"over\"),s=Math.abs(this.target.idx-this.source.idx),this.source.elm.classList.toggle(`${this.namespace}--hide`,s>0),\"vertical\"==this.settings.mode?this.target.elm.style[this.target.hoverDirection?\"marginBottom\":\"marginTop\"]=this.source.size.height+this.gap+\"px\":this.target.elm.style[this.target.hoverDirection?\"marginRight\":\"marginLeft\"]=this.source.size.width+this.gap+\"px\")},dragend(t){if(clearTimeout(this.dragoverTimeout),this.dragoverTimeout=null,this.parentElm.classList.remove(`${this.namespace}--dragStart`),!this.isValidElm(this.target.elm))return this.cleanup();var e=this.target.hoverDirection?this.target.elm.nextElementSibling:this.target.elm;return this.source.elm!=this.target.elm&&this.target.elm&&(this.target.elm.classList.add(`${this.namespace}--noAnim`),this.cleanup(),this.parentElm.insertBefore(this.source.elm,e)),this.source.elm&&this.source.elm.classList.remove(`${this.namespace}--dragElem`,`${this.namespace}--hide`),this.settings.callbacks.dragEnd&&this.settings.callbacks.dragEnd(this.source.elm),this},isTargetLastChild(){return this.parentElm.lastElementChild==this.target.elm},getTargetDirection(t){if(this.target.bounding)return\"vertical\"==this.settings.mode?t.pageY>this.target.bounding.top+this.target.bounding.height/2?1:0:t.pageX>this.target.bounding.left+this.target.bounding.width/2?1:0},getNodeIndex(t){for(var e=0;t=t.previousSibling;)3==t.nodeType&&/^\\s*$/.test(t.data)||e++;return e},isValidElm(t){return t&&t.nodeType&&t.parentNode==this.parentElm},cleanup(){s={},[...this.parentElm.children].forEach((t=>{t.removeAttribute(\"style\"),setTimeout((()=>{t.classList.remove(`${this.namespace}--over`,`${this.namespace}--noAnim`,`${this.namespace}--dragElem`)}),50)}))},cleanupLastTarget(){this.target.elm&&(this.target.elm.classList.remove(`${this.namespace}--hide`,`${this.namespace}--over`),this.target.elm.removeAttribute(\"style\"))},getInitialState:()=>({elm:null,size:{}}),getItemsGap(t){var e=getComputedStyle(t),s=getComputedStyle(t.parentNode),i=\"vertical\"==this.settings.mode,r=parseInt(s.gap)||0;return parseInt(e[\"margin\"+(i?\"Top\":\"Left\")])+parseInt(e[\"margin\"+(i?\"Bottom\":\"Right\")])+r},bindEvents(t){for(var e in this.listeners=this.listeners||{dragstart:t=>this.dragstart(t,t.target),dragenter:t=>this.dragenter(t,t.target),dragend:t=>this.dragend(t,t.target),dragover:this.throttle(this.dragover,350)},this.listeners)this.parentElm[t?\"removeEventListener\":\"addEventListener\"](e,this.listeners[e])},destroy(){this.cleanup(),this.bindEvents(!0),delete i[this.uid]}},function(t,s){return i[++e]=t.DragSort?i[t.DragSort]:new a(t,{...s,uid:e}),t.DragSort=e,i[e]}}));","/**\n * Tagify (v 4.17.8) - tags input component\n * By undefined\n * https://github.com/yairEO/tagify\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n * \r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n * \r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n * \r\n * THE SOFTWARE IS NOT PERMISSIBLE TO BE SOLD.\n */\n\n!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).Tagify=e()}(this,(function(){\"use strict\";function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function e(e){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?t(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(t,e,i){return(e=function(t){var e=function(t,e){if(\"object\"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||\"default\");if(\"object\"!=typeof s)return s;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===e?String:Number)(t)}(t,\"string\");return\"symbol\"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const s=(t,e,i,s)=>(t=\"\"+t,e=\"\"+e,s&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()),a=(t,e)=>t&&Array.isArray(t)&&t.map((t=>n(t,e)));function n(t,e){var i,s={};for(i in t)e.indexOf(i)<0&&(s[i]=t[i]);return s}function o(t){var e=document.createElement(\"div\");return t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function r(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function l(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function d(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function h(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function g(t,e,i){function s(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(h(e[i])){h(t[i])?s(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return t instanceof Object||(t={}),s(t,e),i&&s(t,i),t}function p(){const t=[],e={};for(let i of arguments)for(let s of i)h(s)?e[s.value]||(t.push(s),e[s.value]=1):t.includes(s)||t.push(s);return t}function c(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}function v(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function f(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function T(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:g({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(console.warn(\"tag element doesn't exist\",t,e),e)}var w={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\"\"},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var y={refs(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t){var e,i,a,n=this.settings,o=\"mix\"==n.mode&&!n.enforceWhitelist,r=!n.whitelist||!n.whitelist.length,l=\"manual\"==n.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(r&&!o&&!n.templates.dropdownItemNoMatch||!1===n.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),n.templates.dropdownItemNoMatch&&(a=n.templates.dropdownItemNoMatch.call(this,{value:t}))),!a){if(this.suggestedListItems.length)t&&o&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!o||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(h(e=this.suggestedListItems[0])?e.value:e),n.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(a),n.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(n.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),l||setTimeout((()=>{this.dropdown.position(),this.dropdown.render()})),setTimeout((()=>{this.trigger(\"dropdown:show\",this.DOM.dropdown)}))}},hide(t){var e=this.DOM,i=e.scope,s=e.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((()=>{this.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},render(){var t,e,i,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings;return\"number\"==typeof a.dropdown.enabled&&a.dropdown.enabled>=0?(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),a.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout((()=>this.DOM.dropdown.classList.remove(a.classNames.dropdownInital)))),this):this},fill(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").replace(/(<.*?>)|\\s+/g,((t,e)=>e||\" \")):\"\"},fillHeaderFooter(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),s=this.dropdown.getHeaderRef(),a=this.dropdown.getFooterRef();e&&s?.parentNode.replaceChild(e,s),i&&a?.parentNode.replaceChild(i,a)},refilter(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},position(t){var e=this.settings.dropdown;if(\"manual\"!=e.position){var i,s,a,n,o,r,l=this.DOM.dropdown,d=e.placeAbove,h=e.appendTarget===document.body,g=h?window.pageYOffset:e.appendTarget.scrollTop,p=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,c=p.clientHeight,u=Math.max(p.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",m=this.DOM[\"input\"==u?\"input\":\"scope\"];if(t=t||l.clientHeight,this.state.dropdown.visible){if(\"text\"==u?(a=(i=function(){const t=document.getSelection();if(t.rangeCount){const e=t.getRangeAt(0),i=e.startContainer,s=e.startOffset;let a,n;if(s>0)return n=document.createRange(),n.setStart(i,s-1),n.setEnd(i,s),a=n.getBoundingClientRect(),{left:a.right,top:a.top,bottom:a.bottom};if(i.getBoundingClientRect)return i.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=i.top,n=i.left,o=\"auto\"):(r=function(t){for(var e=0,i=0;t&&t!=p;)e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.parentNode;return{left:e,top:i}}(e.appendTarget),s=(i=m.getBoundingClientRect()).top-r.top,a=i.bottom-1-r.top,n=i.left-r.left,o=i.width+\"px\"),!h){let t=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=t,a+=t}s=Math.floor(s),a=Math.ceil(a),d=void 0===d?c-i.bottom<t:d,l.style.cssText=\"left:\"+(n+window.pageXOffset)+\"px; width:\"+o+\";\"+(d?\"top: \"+(s+g)+\"px\":\"top: \"+(a+g)+\"px\"),l.setAttribute(\"placement\",d?\"top\":\"bottom\"),l.setAttribute(\"position\",u)}}},events:{binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},s=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[s](\"scroll\",i.position,!0),window[s](\"resize\",i.position),window[s](\"keydown\",i.onKeyDown)),this.DOM.dropdown[s](\"mouseover\",i.onMouseOver),this.DOM.dropdown[s](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[s](\"mousedown\",i.onClick),this.DOM.dropdown.content[s](\"scroll\",i.onScroll)},callbacks:{onKeyDown(t){if(this.state.hasFocus&&!this.state.composing){var e=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(e);switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var s=this.dropdown.getAllSuggestionsRefs(),a=\"ArrowUp\"==t.key||\"Up\"==t.key;e&&(e=this.dropdown.getNextOrPrevOption(e,!a)),e&&e.matches(this.settings.classNames.dropdownItemSelector)||(e=s[a?s.length-1:0]),this.dropdown.highlightOption(e,!0);break;case\"Escape\":case\"Esc\":this.dropdown.hide();break;case\"ArrowRight\":if(this.state.actions.ArrowLeft)return;case\"Tab\":if(\"mix\"!=this.settings.mode&&e&&!this.settings.autoComplete.rightKey&&!this.state.editing){t.preventDefault();var n=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,n),!1}return!0;case\"Enter\":t.preventDefault(),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{if(e)return this.dropdown.selectOption(e),e=this.dropdown.getNextOrPrevOption(e,!a),void this.dropdown.highlightOption(e);this.dropdown.hide(),\"mix\"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)})).catch((t=>t));break;case\"Backspace\":{if(\"mix\"==this.settings.mode||this.state.editing.scope)return;const t=this.input.raw.call(this);\"\"!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():\"edit\"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);e&&this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),i=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout((()=>this.state.actions.selectOption=!1),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then((()=>{e?this.dropdown.selectOption(e,t):this.dropdown.hide()})).catch((t=>console.warn(t)))}},onScroll(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},getSuggestionDataByNode(t){var e=t&&t.getAttribute(\"value\");return this.suggestedListItems.find((t=>t.value==e))||null},getNextOrPrevOption(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.dropdown.getAllSuggestionsRefs(),s=i.findIndex((e=>e===t));return e?i[s+1]:i[s-1]},highlightOption(t,e){var i,s=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(s),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(s),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption(t,e){var i=this.settings.dropdown,s=i.clearOnSelect,a=i.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(a&&this.dropdown.hide());e=e||{};var n=t.getAttribute(\"value\"),o=\"noMatch\"==n,r=this.suggestedListItems.find((t=>(t.value??t)==n));this.trigger(\"dropdown:select\",{data:r,elm:t,event:e}),n&&(r||o)?(this.state.editing?this.onEditTagDone(null,g({__isValid:!0},this.normalizeTags([r])[0])):this[\"mix\"==this.settings.mode?\"addMixTags\":\"addTags\"]([r||this.input.raw.call(this)],s),this.DOM.input.parentNode&&(setTimeout((()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)})),a&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(()=>{this.dropdown.fillHeaderFooter(),setTimeout((()=>t.remove()),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))):a&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems(t,e){var i,s,a,n,o,r=this.settings,l=r.dropdown,d=(e=e||{},[]),g=[],p=r.whitelist,u=l.maxItems>=0?l.maxItems:1/0,m=l.searchKeys,v=0;if(!(t=\"select\"==r.mode&&this.value.length&&this.value[0][r.tagTextProp]==t?\"\":t)||!m.length)return d=l.includeSelectedTags?p:p.filter((t=>!this.isTagDuplicate(h(t)?t.value:t))),this.state.dropdown.suggestions=d,d.slice(0,u);function f(t,e){return e.toLowerCase().split(\" \").every((e=>t.includes(e.toLowerCase())))}for(o=l.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();v<p.length;v++){let t,r;i=p[v]instanceof Object?p[v]:{value:p[v]};let u=!Object.keys(i).some((t=>m.includes(t)))?[\"value\"]:m;l.fuzzySearch&&!e.exact?(a=u.reduce(((t,e)=>t+\" \"+(i[e]||\"\")),\"\").toLowerCase().trim(),l.accentedSearch&&(a=c(a),o=c(o)),t=0==a.indexOf(o),r=a===o,s=f(a,o)):(t=!0,s=u.some((t=>{var s=\"\"+(i[t]||\"\");return l.accentedSearch&&(s=c(s),o=c(o)),l.caseSensitive||(s=s.toLowerCase()),r=s===o,e.exact?s===o:0==s.indexOf(o)}))),n=!l.includeSelectedTags&&this.isTagDuplicate(h(i)?i.value:i),s&&!n&&(r&&t?g.push(i):\"startsWith\"==l.sortby&&t?d.unshift(i):d.push(i))}return this.state.dropdown.suggestions=g.concat(d),\"function\"==typeof l.sortby?l.sortby(g.concat(d),o):g.concat(d).slice(0,u)},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML(t){return g([],t).map(((t,i)=>{\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var s=this.dropdown.getMappedValue(t);return s=\"string\"==typeof s?d(s):s,this.settings.templates.dropdownItem.apply(this,[e(e({},t),{},{mappedValue:s}),this])})).join(\"\")}};const x=\"@yaireo/tagify/\";var O,D={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},M={wrapper:(t,e)=>`<tags class=\"${e.classNames.namespace} ${e.mode?`${e.classNames[e.mode+\"Mode\"]}`:\"\"} ${t.className}\"\\n                    ${e.readonly?\"readonly\":\"\"}\\n                    ${e.disabled?\"disabled\":\"\"}\\n                    ${e.required?\"required\":\"\"}\\n                    ${\"select\"===e.mode?\"spellcheck='false'\":\"\"}\\n                    tabIndex=\"-1\">\\n            <span ${!e.readonly&&e.userInput?\"contenteditable\":\"\"} tabIndex=\"0\" data-placeholder=\"${e.placeholder||\"&#8203;\"}\" aria-placeholder=\"${e.placeholder||\"\"}\"\\n                class=\"${e.classNames.input}\"\\n                role=\"textbox\"\\n                aria-autocomplete=\"both\"\\n                aria-multiline=\"${\"mix\"==e.mode}\"></span>\\n                &#8203;\\n        </tags>`,tag(t,e){let i=e.settings;return`<tag title=\"${t.title||t.value}\"\\n                    contenteditable='false'\\n                    spellcheck='false'\\n                    tabIndex=\"${i.a11y.focusableTags?0:-1}\"\\n                    class=\"${i.classNames.tag} ${t.class||\"\"}\"\\n                    ${this.getAttributes(t)}>\\n            <x title='' class=\"${i.classNames.tagX}\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span class=\"${i.classNames.tagText}\">${t[i.tagTextProp]||t.value}</span>\\n            </div>\\n        </tag>`},dropdown(t){var e=t.dropdown,i=\"manual\"==e.position,s=`${t.classNames.dropdown}`;return`<div class=\"${i?\"\":s} ${e.classname}\" role=\"listbox\" aria-labelledby=\"dropdown\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\"${t.classNames.dropdownWrapper}\"></div>\\n                </div>`},dropdownContent(t){var e=this.settings,i=this.state.dropdown.suggestions;return`\\n            ${e.templates.dropdownHeader.call(this,i)}\\n            ${t}\\n            ${e.templates.dropdownFooter.call(this,i)}\\n        `},dropdownItem(t){return`<div ${this.getAttributes(t)}\\n                    class='${this.settings.classNames.dropdownItem} ${t.class?t.class:\"\"}'\\n                    tabindex=\"0\"\\n                    role=\"option\">${t.mappedValue||t.value}</div>`},dropdownHeader(t){return`<header data-selector='tagify-suggestions-header' class=\"${this.settings.classNames.dropdownHeader}\"></header>`},dropdownFooter(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?`<footer data-selector='tagify-suggestions-footer' class=\"${this.settings.classNames.dropdownFooter}\">\\n                ${e} more items. Refine your search.\\n            </footer>`:\"\"},dropdownItemNoMatch:null};var I={customBinding(){this.customEventsList.forEach((t=>{this.on(t,this.settings.callbacks[t])}))},binding(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e,i=this.events.callbacks,s=t?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!t){for(var a in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:[\"input\",i.onFocusBlur.bind(this)],keydown:[\"input\",i.onKeydown.bind(this)],click:[\"scope\",i.onClickScope.bind(this)],dblclick:[\"scope\",i.onDoubleClickScope.bind(this)],paste:[\"input\",i.onPaste.bind(this)],drop:[\"input\",i.onDrop.bind(this)],compositionstart:[\"input\",i.onCompositionStart.bind(this)],compositionend:[\"input\",i.onCompositionEnd.bind(this)]})this.DOM[e[a][0]][s](a,e[a][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(i.observeOriginalInputValue.bind(this),500);var n=this.listeners.main.inputMutationObserver||new MutationObserver(i.onInputDOMChange.bind(this));n.disconnect(),\"mix\"==this.settings.mode&&n.observe(this.DOM.input,{childList:!0})}},bindGlobal(t){var e,i=this.events.callbacks,s=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global))for(e of(this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"blur\",target:this.DOM.input,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this)}],this.listeners.global))e.target[s](e.type,e.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var e=this.settings,i=t.target?this.trim(t.target.textContent):\"\",s=this.value?.[0]?.[e.tagTextProp],a=t.type,n=e.dropdown.enabled>=0,o={relatedTarget:t.relatedTarget},r=this.state.actions.selectOption&&(n||!e.dropdown.closeOnSelect),l=this.state.actions.addNew&&n,d=t.relatedTarget&&v.call(this,t.relatedTarget)&&this.DOM.scope.contains(t.relatedTarget);if(\"blur\"==a){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e.onChangeAfterBlur&&this.triggerChangeEvent()}if(!r&&!l)if(this.state.hasFocus=\"focus\"==a&&+new Date,this.toggleFocusClass(this.state.hasFocus),\"mix\"!=e.mode){if(\"focus\"==a)return this.trigger(\"focus\",o),void(0!==e.dropdown.enabled&&e.userInput||this.dropdown.show(this.value.length?\"\":void 0));\"blur\"==a&&(this.trigger(\"blur\",o),this.loading(!1),\"select\"==e.mode&&(d&&(this.removeTags(),i=\"\"),s===i&&(i=\"\")),i&&!this.state.actions.selectOption&&e.addTagOnBlur&&this.addTags(i,!0)),this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide()}else\"focus\"==a?this.trigger(\"focus\",o):\"blur\"==t.type&&(this.trigger(\"blur\",o),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t){this.state.composing=!0},onCompositionEnd(t){this.state.composing=!1},onWindowKeyDown(t){var e,i=document.activeElement,s=v.call(this,i)&&this.DOM.scope.contains(document.activeElement),a=s&&i.hasAttribute(\"readonly\");if(s&&!a)switch(e=i.nextElementSibling,t.key){case\"Backspace\":this.settings.readonly||(this.removeTags(i),(e||this.DOM.input).focus());break;case\"Enter\":setTimeout(this.editTag.bind(this),0,i)}},onKeydown(t){var e=this.settings;if(!this.state.composing&&e.userInput){\"select\"==e.mode&&e.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var i=this.trim(t.target.textContent);if(this.trigger(\"keydown\",{event:t}),\"mix\"==e.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":this.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(this.state.editing)return;var s=document.getSelection(),a=\"Delete\"==t.key&&s.anchorOffset==(s.anchorNode.length||0),n=s.anchorNode.previousSibling,r=1==s.anchorNode.nodeType||!s.anchorOffset&&n&&1==n.nodeType&&s.anchorNode.previousSibling;o(this.DOM.input.innerHTML);var d,h,g,p=this.getTagElms();if(\"edit\"==e.backspace&&r)return d=1==s.anchorNode.nodeType?null:s.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,d),void t.preventDefault();if(u()&&r instanceof Element)return g=l(r),r.hasAttribute(\"readonly\")||r.remove(),this.DOM.input.focus(),void setTimeout((()=>{this.placeCaretAfterNode(g),this.DOM.input.click()}));if(\"BR\"==s.anchorNode.nodeName)return;if((a||r)&&1==s.anchorNode.nodeType?h=0==s.anchorOffset?a?p[0]:null:p[Math.min(p.length,s.anchorOffset)-1]:a?h=s.anchorNode.nextElementSibling:r instanceof Element&&(h=r),3==s.anchorNode.nodeType&&!s.anchorNode.nodeValue&&s.anchorNode.previousElementSibling&&t.preventDefault(),(r||a)&&!e.backspace)return void t.preventDefault();if(\"Range\"!=s.type&&!s.anchorOffset&&s.anchorNode==this.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=s.type&&h&&h.hasAttribute(\"readonly\"))return void this.placeCaretAfterNode(l(h));clearTimeout(O),O=setTimeout((()=>{var t=document.getSelection();o(this.DOM.input.innerHTML),!a&&t.anchorNode.previousSibling,this.value=[].map.call(p,((t,e)=>{var i=T(t);if(t.parentNode||i.readonly)return i;this.trigger(\"remove\",{tag:t,index:e,data:i})})).filter((t=>t))}),20)}return!0}switch(t.key){case\"Backspace\":\"select\"==e.mode&&e.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&\"manual\"!=e.dropdown.position||\"\"!=t.target.textContent&&8203!=i.charCodeAt(0)||(!0===e.backspace?this.removeTags():\"edit\"==e.backspace&&setTimeout(this.editTag.bind(this),0));break;case\"Esc\":case\"Escape\":if(this.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":this.state.dropdown.visible||this.dropdown.show();break;case\"ArrowRight\":{let t=this.state.inputSuggestion||this.state.ddItemData;if(t&&e.autoComplete.rightKey)return void this.addTags([t],!0);break}case\"Tab\":{let s=\"select\"==e.mode;if(!i||s)return!0;t.preventDefault()}case\"Enter\":if(this.state.dropdown.visible&&\"manual\"!=e.dropdown.position)return;t.preventDefault(),setTimeout((()=>{this.state.dropdown.visible||this.state.actions.selectOption||this.addTags(i,!0)}))}}},onInput(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this),s=i.length>=e.dropdown.enabled,a={value:i,inputElm:this.DOM.input},n=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(n),a.isValid=n,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[s?\"show\":\"hide\"](i),this.trigger(\"input\",a))},onMixTagsInput(t){var e,i,s,a,n,o,r,l,d=this.settings,h=this.value.length,p=this.getTagElms(),c=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(p,(t=>T(t).value));if(\"deleteContentBackward\"==t.inputType&&u()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),this.value.slice().forEach((t=>{t.readonly&&!v.includes(t.value)&&c.appendChild(this.createTagElem(t))})),c.childNodes.length&&(m.insertNode(c),this.setRangeAtStartEnd(!1,c.lastChild)),p.length!=h)return this.value=[].map.call(this.getTagElms(),(t=>T(t))),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),s=(e=m.toString().slice(0,m.endOffset)).split(d.pattern).length-1,(i=e.match(d.pattern))&&(a=e.slice(e.lastIndexOf(i[i.length-1]))),a){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:a.match(d.pattern)[0],value:a.replace(d.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(d.delimiters))return this.state.tag.value=this.state.tag.value.replace(d.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,d.dropdown.clearOnSelect),void this.dropdown.hide();n=this.state.tag.value.length>=d.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||s<this.state.mixMode.matchedPatternCount)&&(n=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=s}setTimeout((()=>{this.update({withoutChangeEvent:!0}),this.trigger(\"input\",g({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[n?\"show\":\"hide\"](this.state.tag.value)}),10)},onInputIE(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1)},onClickScope(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),s=+new Date-this.state.hasFocus;if(t.target!=this.DOM.scope){if(!t.target.classList.contains(e.classNames.tagX))return i?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:T(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||this.dropdown.show());this.removeTags(t.target.parentNode)}else this.DOM.input.focus()},onPaste(t){t.preventDefault();var e,i,s=this.settings;if(\"select\"==s.mode&&s.enforceWhitelist||!s.userInput)return!1;s.readonly||(e=t.clipboardData||window.clipboardData,i=e.getData(\"Text\"),s.hooks.beforePaste(t,{tagify:this,pastedText:i,clipboardData:e}).then((e=>{void 0===e&&(e=i),e&&(this.injectAtCaret(e,window.getSelection().getRangeAt(0)),\"mix\"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?this.addTags(this.state.inputText+e,!0):this.state.inputText=e)})).catch((t=>t)))},onDrop(t){t.preventDefault()},onEditTagInput(t,e){var i=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(i),a=T(i),n=this.input.normalize.call(this,t),o={[this.settings.tagTextProp]:n,__tagId:a.__tagId},r=this.validateTag(o);this.editTagChangeDetected(g(a,o))||!0!==t.originalIsValid||(r=!0),i.classList.toggle(this.settings.classNames.tagInvalid,!0!==r),a.__isValid=r,i.title=!0===r?a.title||a.value:r,n.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=n),this.dropdown.show(n)),this.trigger(\"edit:input\",{tag:i,index:s,data:g({},this.value[s],{newValue:n}),event:e})},onEditTagPaste(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var s=f(i);this.setRangeAtStartEnd(!1,s)},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur(t){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t)){var e,i,s=this.settings,a=t.closest(\".\"+s.classNames.tag),n=T(a),o=this.input.normalize.call(this,t),r={[s.tagTextProp]:o,__tagId:n.__tagId},l=n.__originalData,d=this.editTagChangeDetected(g(n,r)),h=this.validateTag(r);if(o)if(d){if(e=this.hasMaxTags(),i=g({},l,{[s.tagTextProp]:this.trim(o),__isValid:h}),s.transformTag.call(this,i,l),!0!==(h=(!e||!0===l.__isValid)&&this.validateTag(i))){if(this.trigger(\"invalid\",{data:i,tag:a,message:h}),s.editTags.keepInvalid)return;s.keepInvalidTags?i.__isValid=h:i=l}else s.keepInvalidTags&&(delete i.title,delete i[\"aria-invalid\"],delete i.class);this.onEditTagDone(a,i)}else this.onEditTagDone(a,l);else this.onEditTagDone(a)}},onEditTagkeydown(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e),this.state.editing=!1;case\"Enter\":case\"Tab\":t.preventDefault(),t.target.blur()}},onDoubleClickScope(t){var e,i,s=t.target.closest(\".\"+this.settings.classNames.tag),a=T(s),n=this.settings;s&&n.userInput&&!1!==a.editable&&(e=s.classList.contains(this.settings.classNames.tagEditing),i=s.hasAttribute(\"readonly\"),\"select\"==n.mode||n.readonly||e||i||!this.settings.editTags||this.editTag(s),this.toggleFocusClass(!0),this.trigger(\"dblclick\",{tag:s,index:this.getNodeIndex(s),data:T(s)}))},onInputDOMChange(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(this.settings.classNames.tagSelector)){let e=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(e=document.createTextNode(\"\\n\")),t.replaceWith(e,...[...t.childNodes].slice(0,-1)),this.placeCaretAfterNode(e)}else if(v.call(this,t)&&(3!=t.previousSibling?.nodeType||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName)){t.previousSibling.replaceWith(\"\\n\");let e=t.nextSibling,i=\"\";for(;e;)i+=e.textContent,e=e.nextSibling;i.trim()&&this.placeCaretAfterNode(t.previousSibling)}})),t.removedNodes.forEach((t=>{t&&\"BR\"==t.nodeName&&v.call(this,e)&&(this.removeTags(e),this.fixFirefoxLastTagNoCaret())}))}));var e=this.DOM.input.lastChild;e&&\"\"==e.nodeValue&&e.remove(),e&&\"BR\"==e.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function N(t,e){if(!t){console.warn(\"Tagify:\",\"input element not found\",t);const e=new Proxy(this,{get:()=>()=>e});return e}if(t.__tagify)return console.warn(\"Tagify: \",\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var i;g(this,function(t){var e=document.createTextNode(\"\");function i(t,i,s){s&&i.split(/\\s+/g).forEach((i=>e[t+\"EventListener\"].call(e,i,s)))}return{off(t,e){return i(\"remove\",t,e),this},on(t,e){return e&&\"function\"==typeof e&&i(\"add\",t,e),this},trigger(i,s,a){var n;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var o=\"object\"==typeof s?s:{value:s};if((o=a.cloneData?g({},o):o).tagify=this,s.event&&(o.event=this.cloneEvent(s.event)),s instanceof Object)for(var r in s)s[r]instanceof HTMLElement&&(o[r]=s[r]);n=new CustomEvent(i,{detail:o})}catch(t){console.warn(t)}e.dispatchEvent(n)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(i=e.id,t=>{let e,s=\"/\"+t;if(1==localStorage.getItem(x+i+\"/v\",1))try{e=JSON.parse(localStorage[x+i+s])}catch(t){}return e}),this.setPersistedData=(t=>t?(localStorage.setItem(x+t+\"/v\",1),(e,i)=>{let s=\"/\"+i,a=JSON.stringify(e);e&&i&&(localStorage.setItem(x+t+s,a),dispatchEvent(new Event(\"storage\")))}):()=>{})(e.id),this.clearPersistedData=(t=>e=>{const i=x+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(let t in localStorage)t.includes(i)&&localStorage.removeItem(t)})(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),b.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return N.prototype={_dropdown:y,getSetTagData:T,helpers:{sameStr:s,removeCollectionProp:a,omit:n,isObject:h,parseHTML:r,escapeHTML:d,extend:g,concatWithoutDups:p,getUID:m,isNodeTag:v},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:r,templates:M,parseTemplate(t,e){return r((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){const e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t){for(let e in t){let i=e;Object.defineProperty(t,i+\"Selector\",{get(){return\".\"+this[i].split(\" \")[0]}})}},applySettings(t,i){w.templates=this.templates;var s=g({},w,\"mix\"==i.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=g({},s,i);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=d(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((e=>{var i=t.getAttribute(\"data-\"+e);i&&(i=i.split(a.delimiters))instanceof Array&&(a[e]=i)})),\"autoComplete\"in i&&!h(i.autoComplete)&&(a.autoComplete=w.autoComplete,a.autoComplete.enabled=i.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=i.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=e(e({},D),a.texts||{}),(\"select\"!=a.mode||i.dropdown?.enabled)&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=i.dropdown?.appendTarget||document.body;let n=this.getPersistedData(\"whitelist\");Array.isArray(n)&&(this.whitelist=Array.isArray(a.whitelist)?p(a.whitelist,n):n)},getAttributes(t){var e,i=this.getCustomAttributes(t),s=\"\";for(e in i)s+=\" \"+e+(void 0!==t[e]?`=\"${i[e]}\"`:\"\");return s},getCustomAttributes(t){if(!h(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=d(t[e]));return i},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars(){var t=getComputedStyle(this.DOM.scope,null);var e;this.CSSVars={tagHideTransition:(t=>{let e=t.value;return\"s\"==t.unit?1e3*e:e})(function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((t=>t)).pop().trim();return{value:+t.split(e).filter((t=>t))[0].trim(),unit:e}}((e=\"tag-hide-transition\",t.getPropertyValue(\"--\"+e))))}},build(t){var e=this.DOM;this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1)},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){const e=this.getPersistedData(\"value\");t=e&&!this.DOM.originalInput.value?e:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((t=>t&&t.classList.add(i.classNames.tagNoAnimation)))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:I,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if(i.focusNode instanceof Element&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((s=>i.getRangeAt(0)[\"set\"+s](e,t||e.length)))}catch(t){}}},placeCaretAfterNode(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),s=i.getRangeAt(0);i.rangeCount&&(s.setStartAfter(e),s.collapse(!0),i.removeAllRanges(),i.addRange(s))}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t,e){this.getTagTextNode(t).innerHTML=d(e)},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var i=this.settings,s=this.getTagTextNode(t),a=this.getNodeIndex(t),n=T(t),o=this.events.callbacks,r=this,l=!0;if(s){if(!(n instanceof Object&&\"editable\"in n)||n.editable)return n=T(t,{__originalData:g({},n),__originalHTML:t.cloneNode(!0)}),T(n.__originalHTML,n.__originalData),s.setAttribute(\"contenteditable\",!0),t.classList.add(i.classNames.tagEditing),s.addEventListener(\"focus\",o.onEditTagFocus.bind(this,t)),s.addEventListener(\"blur\",(function(){setTimeout((()=>o.onEditTagBlur.call(r,r.getTagTextNode(t))))})),s.addEventListener(\"input\",o.onEditTagInput.bind(this,s)),s.addEventListener(\"paste\",o.onEditTagPaste.bind(this,s)),s.addEventListener(\"keydown\",(e=>o.onEditTagkeydown.call(this,e,t))),s.addEventListener(\"compositionstart\",o.onCompositionStart.bind(this)),s.addEventListener(\"compositionend\",o.onCompositionEnd.bind(this)),e.skipValidation||(l=this.editTagToggleValidity(t)),s.originalIsValid=l,this.trigger(\"edit:start\",{tag:t,index:a,data:n,isValid:l}),s.focus(),this.setRangeAtStartEnd(!1,s),this}else console.warn(\"Cannot find element in Tag template: .\",i.classNames.tagTextSelector)},editTagToggleValidity(t,e){var i;if(e=e||T(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid;console.warn(\"tag has no data: \",t,e)},onEditTagDone(t,e){e=e||{};var i={tag:t=t||this.state.editing.scope,index:this.getNodeIndex(t),previousData:T(t),data:e};this.trigger(\"edit:beforeUpdate\",i,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&e[this.settings.tagTextProp]?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),this.settings.a11y.focusableTags?t.focus():this.placeCaretAfterNode(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&g(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),(t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(\" \")[0])||this.value.push(T(t))})),this.update()},injectAtCaret(t,e){return!(e=e||this.state.selection?.range)&&t?(this.appendMixTags(t),this):(f(t,e),this.setRangeAtStartEnd(!1,t),this.updateValueByDOMTags(),this.update(),this)},input:{set(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=d(\"\"+t)),!t&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t){var e=t||this.DOM.input,i=[];e.childNodes.forEach((t=>3==t.nodeType&&i.push(t.nodeValue))),i=i.join(\"\\n\");try{i=i.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return i=i.replace(/\\s/g,\" \"),this.trim(i)},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){\"string\"==typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&i==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex((e=>e.__tagId==(t||{}).__tagId))},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var s=\".\"+[...this.settings.classNames.tag.split(\" \"),...e].join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(s))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},isTagDuplicate(t,e,i){var a=0;if(\"select\"==this.settings.mode)return!1;for(let n of this.value){s(this.trim(\"\"+t),n.value,e)&&i!=n.__tagId&&a++}return a},getTagIndexByValue(t){var e=[];return this.getTagElms().forEach(((i,a)=>{s(this.trim(i.textContent),t,this.settings.dropdown.caseSensitive)&&e.push(a)})),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((()=>{t.classList.remove(this.settings.classNames.tagFlash)}),100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((e=>(\"\"+e).toLowerCase()==t)).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,i){e=e||\"value\";var a,n=this.settings;return(i=i||n.whitelist).some((i=>{var o=\"string\"==typeof i?i:i[e]||i.value;if(s(o,t,n.dropdown.caseSensitive,n.trim))return a=\"string\"==typeof i?{value:i}:i,!0})),a||\"value\"!=e||\"value\"==n.tagTextProp||(a=this.getWhitelistItem(t,n.tagTextProp,i)),a},validateTag(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,s=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(s)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(s,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(s)||e.enforceWhitelist&&!this.isTagWhitelisted(s)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{\"aria-invalid\":!0,class:`${t.class||\"\"} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var i=this.settings;document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.setContentEditable(!t)},setContentEditable(t){this.settings.userInput&&(this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1)},setDisabled(t){this.setReadonly(t,\"disabled\")},normalizeTags(t){var e=this.settings,i=e.whitelist,s=e.delimiters,a=e.mode,n=e.tagTextProp,o=[],r=!!i&&i[0]instanceof Object,l=Array.isArray(t),d=l&&t[0].value,h=t=>(t+\"\").split(s).filter((t=>t)).map((t=>({[n]:this.trim(t),value:this.trim(t)})));if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=h(t)}else l&&(t=[].concat(...t.map((t=>null!=t.value?t:h(t)))));return r&&!d&&(t.forEach((t=>{var e=o.map((t=>t.value)),i=this.dropdown.filterListItems.call(this,t[n],{exact:!0});this.settings.duplicates||(i=i.filter((t=>!e.includes(t.value))));var s=i.length>1?this.getWhitelistItem(t[n],n,i):i[0];s&&s instanceof Object?o.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[n]),o.push(t))})),o.length&&(t=o)),t},parseMixTags(t){var e=this.settings,i=e.mixTagsInterpolator,s=e.duplicates,a=e.transformTag,n=e.enforceWhitelist,o=e.maxTags,r=e.tagTextProp,l=[];return t=t.split(i[0]).map(((t,e)=>{var d,h,g,p=t.split(i[1]),c=p[0],u=l.length==o;try{if(c==+c)throw Error;h=JSON.parse(c)}catch(t){h=this.normalizeTags(c)[0]||{value:c}}if(a.call(this,h),u||!(p.length>1)||n&&!this.isTagWhitelisted(h.value)||!s&&this.isTagDuplicate(h.value)){if(t)return e?i[0]+t:t}else h[d=h[r]?r:\"value\"]=this.trim(h[d]),g=this.createTagElem(h),l.push(h),g.classList.add(this.settings.classNames.tagNoAnimation),p[0]=g.outerHTML,this.value.push(h);return p.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize(),this.getTagElms().forEach(((t,e)=>T(t,l[e]))),this.update({withoutChangeEvent:!0}),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,s,a=this.state.selection||window.getSelection(),n=a.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return n.splitText(a.anchorOffset-o),-1==(i=n.nodeValue.lastIndexOf(e))?!0:(s=n.splitText(i),t&&n.parentNode.replaceChild(t,s),!0)}},selectTag(t,e){var i=this.settings;if(!i.enforceWhitelist||this.isTagWhitelisted(e.value)){this.input.set.call(this,e[i.tagTextProp]||e.value,!0),this.state.actions.selectOption&&setTimeout((()=>this.setRangeAtStartEnd(!1,this.DOM.input)));var s=this.getLastTag();return s?this.replaceTag(s,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag(t){var e=g({value:\"\"},t||{}),i=this.createTagElem(e);T(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0})},addTags(t,e,i){var s=[],a=this.settings,n=[],o=document.createDocumentFragment();if(i=i||a.skipInvalid,!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((t=>{var e,r={},l=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},l),a.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(i)return;if(g(r,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:l}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!a.createInvalidTags)return void n.push(t.value)}if(\"readonly\"in t&&(t.readonly?r[\"aria-readonly\"]=!0:delete t.readonly),e=this.createTagElem(t,r),s.push(e),\"select\"==a.mode)return this.selectTag(e,t);o.appendChild(e),t.__isValid&&!0===t.__isValid?(this.value.push(t),this.trigger(\"add\",{tag:e,index:this.value.length-1,data:t})):(this.trigger(\"invalid\",{data:t,index:this.value.length,tag:e,message:t.__isValid}),a.keepInvalidTags||setTimeout((()=>this.removeTags(e,!0)),1e3)),this.dropdown.position()})),this.appendTag(o),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":n.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a.dropdown.enabled&&this.dropdown.refilter(),s},addMixTags(t){if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var e=document.createDocumentFragment();return t.forEach((t=>{var i=this.createTagElem(t);e.appendChild(i)})),this.appendMixTags(e),e},appendMixTags(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t){var e,i=this.settings,s=this.state.tag.delimiters;if(i.transformTag.call(this,t),t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],e=this.createTagElem(t),this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout((()=>e.classList.add(this.settings.classNames.tagNoAnimation)),300),this.value.push(t),this.update(),!s){var a=this.insertAfterTag(e)||e;setTimeout(this.placeCaretAfterNode,0,a)}return this.state.tag=null,this.trigger(\"add\",g({},{tag:e},{data:t})),e},appendTag(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem(t,i){t.__tagId=m();var s,a=g({},t,e({value:d(t.value+\"\")},i));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(s=this.parseTemplate(\"tag\",[a,this])),T(s,t),s},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach(((e,i)=>{var s=T(e),a=this.hasMaxTags(),n=this.validateTag(s),o=!0===n&&!a;if(\"select\"==t.mode&&this.toggleScopeValidation(n),o)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},this.replaceTag(e,s);e.title=a||n}))},removeTags(t,e,i){var s,a=this.settings;if(t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],s=t.reduce(((t,e)=>{e&&\"string\"==typeof e&&(e=this.getTagElmByValue(e));var i=T(e);return e&&i&&!i.readonly&&t.push({node:e,idx:this.getTagIdx(i),data:T(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==s.length&&\"select\"!=a.mode&&s[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),s.length)return a.hooks.beforeRemoveTag(s,{tagify:this}).then((()=>{function t(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))}i&&i>10&&1==s.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(this,s[0]):s.forEach(t.bind(this)),e||(this.removeTagsFromValue(s.map((t=>t.node))),this.update(),\"select\"==a.mode&&this.setContentEditable(!0))})).catch((t=>{}))},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach((t=>t.parentNode.removeChild(t)))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach((t=>{var e=T(t),i=this.getTagIdx(e);i>-1&&this.value.splice(i,1)}))},removeAllTags(t){t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((()=>{this.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t)},postUpdate(){this.state.blockChangeEvent=!1;var t=this.settings,e=t.classNames,i=\"mix\"==t.mode?t.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e.hasMaxTags,this.value.length>=t.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!i),\"select\"==t.mode&&this.toggleScopeValidation(this.value?.[0]?.__isValid)},setOriginalInputValue(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100)},getInputValue(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString(){var t=\"\",e=this,i=this.settings,s=i.originalInputValueFormat||JSON.stringify,a=i.mixTagsInterpolator;return function i(o){o.childNodes.forEach((o=>{if(1==o.nodeType){const r=T(o);if(\"BR\"==o.tagName&&(t+=\"\\r\\n\"),r&&v.call(e,o)){if(r.__removed)return;t+=a[0]+s(n(r,e.dataProps))+a[1]}else o.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(o.tagName)?t+=o.textContent:\"DIV\"!=o.tagName&&\"P\"!=o.tagName||(t+=\"\\r\\n\",i(o))}else t+=o.textContent}))}(this.DOM.input),t}},N.prototype.removeTag=N.prototype.removeTags,N}));\n","import { MODULE, TEMPLATE } from '../constants.js'\nimport { Logger, Utils } from '../utils.js'\nimport DragSort from '@yaireo/dragsort'\nimport Tagify from '@yaireo/tagify'\n\n/**\n * Form Application for the dialogs.\n */\nexport class TagDialog extends FormApplication {\n    tagify = null\n    dragSort = null\n\n    constructor (data) {\n        super(data, { title: data.title })\n        this.content = data.content\n        this.submit = data.submit\n        this.categoryId = null\n        this.subcategoryId = null\n    }\n\n    static get defaultOptions () {\n        const defaults = super.defaultOptions\n        const overrides = {\n            classes: ['tah-dialog', 'sheet'],\n            closeOnSubmit: true,\n            id: 'token-action-hud-dialog',\n            popOut: true,\n            resizable: true,\n            height: 'auto',\n            width: 600\n        }\n\n        const mergedOptions = foundry.utils.mergeObject(defaults, overrides)\n\n        return mergedOptions\n    }\n\n    getData (options) {\n        return this.content\n    }\n\n    /**\n     * Activate listeners\n     * @public\n     * @param {object} html The HTML element\n     */\n    activateListeners (html) {\n        super.activateListeners(html)\n        const cancel = html.find('#tah-form-cancel')\n        cancel.on('click', this.close.bind(this))\n\n        const resetActions = html.find('#tah-dialog-reset-actions')\n        resetActions.on('click', this.#resetActions)\n    }\n\n    /**\n     * Show dialog\n     * @public\n     * @param {string} dialogType      The dialog type\n     * @param {string} nestId          The nest id\n     * @param {object} tags            The available and selected tags\n     * @param {object} dialogData      The dialog data\n     * @param {function*} dialogSubmit The dialog submit function\n     */\n    static showDialog (dialogType, nestId, tags, dialogData, dialogSubmit) {\n        this.nestId = nestId\n        TagDialog._prepareHook(tags)\n\n        const data = {\n            title: dialogData.title,\n            content: dialogData.content,\n            submit: dialogSubmit\n        }\n\n        let dialog\n        switch (dialogType) {\n        case 'hud':\n            dialog = new TagDialogHud(data)\n            break\n        case 'topLevelGroup':\n            dialog = new TagDialogTopLevelGroup(data)\n            break\n        case 'group':\n            dialog = new TagDialogGroup(data)\n            break\n        }\n\n        dialog.render(true)\n    }\n\n    /**\n     * Prepare dialog hook\n     * @private\n     * @param {object} tags The tags\n     */\n    static _prepareHook (tags) {\n        Hooks.once('renderTagDialog', (app, html, options) => {\n            const $tagFilter = html.find('input[class=\"tah-dialog-tagify\"]')\n\n            if ($tagFilter.length > 0) {\n                const tagifyOptions = {\n                    delimiters: ';',\n                    maxTags: 'Infinity',\n                    dropdown: {\n                        position: 'manual',\n                        maxItems: Infinity, // <- maximum allowed rendered suggestions\n                        classname: 'tah-dialog-tags-dropdown', // <- custom classname for this dropdown, so it could be targeted\n                        enabled: 0 // <- show suggestions on focus\n                    },\n                    templates: {\n                        dropdownItemNoMatch () {\n                            return '<div class=\\'empty\\'>Nothing Found</div>'\n                        }\n                    }\n                }\n\n                if (tags.available) tagifyOptions.whitelist = tags.available\n                TagDialog.tagify = new Tagify($tagFilter[0], tagifyOptions)\n\n                if (tags.selected) TagDialog.tagify.addTags(tags.selected)\n\n                TagDialog.dragSort = new DragSort(TagDialog.tagify.DOM.scope, {\n                    selector: '.' + TagDialog.tagify.settings.classNames.tag,\n                    callbacks: { dragEnd: onDragEnd }\n                })\n\n                function onDragEnd (elm) {\n                    TagDialog.tagify.updateValueByDOMTags()\n                }\n\n                html.find('.tagify__input').on('keydown', (event) => {\n                    if (event.key === 'Enter') {\n                        event.preventDefault()\n                        TagDialog.tagify.addTags(TagDialog.tagify.state.inputText, !0)\n                    }\n                })\n\n                // \"remove all tags\" button event listener\n                const unselectAllButton = html.find('#tah-dialog-unselect-all')\n                unselectAllButton.on('click', TagDialog.tagify.removeAllTags.bind(TagDialog.tagify))\n\n                if (app.constructor.name === 'TagDialogHud') return\n\n                TagDialog.tagify.dropdown.show()\n                const dropdownLabelElement = document.createElement('div')\n                dropdownLabelElement.classList.add('tah-dialog-label')\n                dropdownLabelElement.innerHTML = Utils.i18n('tokenActionHud.form.hud.availableItems')\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(dropdownLabelElement)\n                TagDialog.tagify.DOM.scope.parentNode.appendChild(TagDialog.tagify.DOM.dropdown)\n            }\n        })\n\n        Hooks.on('renderApplication', (app, html, options) => {\n            if (app.constructor.name.startsWith('TagDialog')) {\n                app.setPosition()\n                app.setPosition({ top: 50 })\n            }\n        })\n    }\n\n    /**\n     * Reset actions\n     * @private\n     */\n    async #resetActions () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetActions.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetActions.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        await game.tokenActionHud.resetActorData()\n                        Logger.info('Actions reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /** @override */\n    _onKeyDown (event) {\n    // Close dialog\n        if (event.key === 'Escape' && !event.target.className.includes('tagify')) {\n            event.preventDefault()\n            event.stopPropagation()\n            return this.close()\n        }\n\n        // Confirm default choice\n        if (\n            event.key === 'Enter' &&\n            this.data.default &&\n            !event.target.className.includes('tagify')\n        ) {\n            event.preventDefault()\n            event.stopPropagation()\n            const defaultChoice = this.data.buttons[this.data.default]\n            return this.submit(defaultChoice)\n        }\n    }\n\n    /**\n     * Handle form submission\n     * @param {object} event       The event\n     * @param {object} formDataThe form data\n     */\n    async _updateObject (event, formData) {\n        const selection = TagDialog.tagify.value.map((c) => {\n            c.id = c.id ?? c.value.slugify({ replacement: '-', strict: true })\n            return {\n                id: c.id,\n                listName: c.value,\n                name: c.name ?? c.value,\n                type: c.type\n            }\n        })\n        await this.submit(selection, formData)\n    }\n}\n\nexport class TagDialogHud extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions,\n            {\n                template: TEMPLATE.tagDialogHud\n            })\n    }\n}\n\nexport class TagDialogTopLevelGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogTopLevelGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n\nexport class TagDialogGroup extends TagDialog {\n    static get defaultOptions () {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: TEMPLATE.tagDialogGroup,\n            tabs: [{\n                navSelector: '.tabs',\n                contentSelector: 'form',\n                initial: 'groups'\n            }]\n        })\n    }\n}\n","import { TEMPLATE } from '../constants.js'\nimport { TagDialog } from './tag-dialog.js'\nimport { Utils } from '../utils.js'\n\n/**\n * Generates data for the dialogs.\n */\nexport class TagDialogHelper {\n    /**\n     * Show the HUD dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     */\n    static async showHudDialog (actionHandler) {\n        // Set available and selected tags\n        const tags = {}\n        tags.available = []\n        tags.selected = await actionHandler.getSelectedGroups()\n        const grid = await Utils.getSetting('grid')\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.hudTitle'),\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.hudDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: { grid }\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const grid = formData?.grid\n            await actionHandler.updateGroups(choices, { level: 0 })\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            await Utils.setSetting('grid', grid)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        // Show dialog\n        TagDialog.showDialog('hud', null, tags, dialogData, dialogSubmit)\n    }\n\n    /**\n     * Show group dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showGroupDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available subcategories\n        tags.available = await actionHandler.getAvailableGroups({ nestId, level })\n\n        // Get selected subcategories\n        tags.selected = await actionHandler.getSelectedGroups({ nestId, level })\n\n        // Set dialog data\n        const dialogData = {\n            title: Utils.i18n('tokenActionHud.form.hud.groupTitle') + ` (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            choices = choices.map((choice) => {\n                choice.id =\n                choice.id ??\n                choice.name.slugify({\n                    replacement: '-',\n                    strict: true\n                })\n                choice.type = choice.type ?? 'custom'\n                return {\n                    id: choice.id,\n                    listName: choice.listName,\n                    name: choice.name,\n                    type: choice.type\n                }\n            })\n\n            const characterCount = formData?.characterCount\n            const customWidth = formData?.customWidth\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            groupData.settings = { characterCount, customWidth, grid, image, showTitle, sort }\n\n            // Save selected subcategories to user action list\n            await actionHandler.updateGroups(choices, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'topLevelGroup',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n\n    /**\n     * Show action dialog\n     * @public\n     * @param {object} actionHandler The ActionHandler class\n     * @param {object} groupData    The group data\n     */\n    static async showActionDialog (actionHandler, groupData) {\n        const { nestId, name, level } = groupData\n\n        // Set available and selected tags\n        const tags = {}\n\n        // Get available actions and subcategories\n        const availableActions = await actionHandler.getAvailableActions(groupData)\n        const availableSubcategories = await actionHandler.getAvailableGroups({ nestId, level })\n        tags.available = [...availableActions, ...availableSubcategories]\n\n        // Get selected actions and subcategories\n        const selectedActions = await actionHandler.getSelectedActions(groupData)\n        const selectedGroups = await actionHandler.getSelectedGroups({ nestId, level })\n        tags.selected = [...selectedActions, ...selectedGroups]\n\n        // Set dialog data\n        const dialogData = {\n            title: `${Utils.i18n('tokenActionHud.form.hud.groupTitle')} (${name})`,\n            content: {\n                topLabel: Utils.i18n('tokenActionHud.form.hud.groupDetail'),\n                placeholder: Utils.i18n('tokenActionHud.form.hud.tagPlaceholder'),\n                settings: await actionHandler.getGroupSettings(groupData)\n            }\n        }\n\n        // Set function on submit\n        const dialogSubmit = async (choices, formData) => {\n            const selectedGroups = []\n            const selectedActions = []\n            for (const choice of choices) {\n                if (choice.type === 'action') {\n                    selectedActions.push(choice)\n                } else {\n                    selectedGroups.push(choice)\n                }\n            }\n\n            // Get advanced category options\n            const characterCount = formData?.characterCount\n            const collapse = formData?.collapse\n            const customWidth = formData?.customWidth\n            const grid = formData?.grid\n            const image = formData?.image\n            const showTitle = formData?.showTitle\n            const sort = formData?.sort\n            const style = formData?.style\n            groupData.settings = { characterCount, collapse, customWidth, grid, image, showTitle, sort, style }\n\n            // Save subcategories to user action list\n            await actionHandler.updateGroups(selectedGroups, groupData)\n            await actionHandler.updateActions(selectedActions, groupData)\n            await actionHandler.saveGroups({ saveActor: true, saveUser: true })\n\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n\n        TagDialog.showDialog(\n            'group',\n            nestId,\n            tags,\n            dialogData,\n            dialogSubmit\n        )\n    }\n}\n","import { Utils } from './utils.js'\n\nexport class GroupResizer {\n    direction = null\n    minCols = 3\n    isCustomWidth = false\n    settings = null\n    spacing = 10\n\n    /**\n     * Resize the groups element\n     * @param {ActionHandler} actionHandler The actionHandler class\n     * @param {object} groupElement         The group element\n     * @param {string} autoDirection        The direction the HUD will expand\n     * @param {boolean} gridModuleSetting   The grid module setting\n     */\n    async resizeGroup (actionHandler, groupElement, autoDirection, gridModuleSetting) {\n        // Exit early if no group element exists\n        if (!groupElement) return\n\n        this.#resetVariables()\n\n        this.groupElement = groupElement\n\n        // Get groups element\n        await this.#getGroupsElement()\n\n        // Exit early if no groups element exists\n        if (!this.groupsElement) return\n\n        this.actionsElements = this.groupElement.querySelectorAll('.tah-actions')\n\n        // Exit early if no action elements exist\n        if (this.actionsElements.length === 0) return\n\n        // Reset groups elements\n        this.#resetGroupsElements()\n\n        // Set direction\n        this.direction = autoDirection\n\n        // Get group settings\n        const nestId = this.groupElement.dataset.nestId\n        this.settings = await actionHandler.getGroupSettings({ nestId, level: 1 })\n\n        // Get available width\n        this.availableWidth = this.#getAvailableWidth()\n\n        // Get groups\n        this.#getGroupElements()\n\n        // Loop groups\n        let hasGrid = false\n        for (const groupElement of this.groupElements) {\n            const actionsElement = groupElement.querySelector('.tah-actions')\n            if (!actionsElement) continue\n            const nestId = groupElement.dataset.nestId\n            const groupSettings = await actionHandler.getGroupSettings({ nestId })\n            const groupCustomWidth = groupSettings.customWidth\n            const grid = gridModuleSetting || this.settings?.grid || groupSettings?.grid\n            if (grid) {\n                if (!hasGrid) {\n                    await this.#getGridWidth()\n                    hasGrid = true\n                }\n                await this.#resizeGrid(actionsElement, groupCustomWidth)\n            } else {\n                await this.#resize(actionsElement, groupCustomWidth)\n            }\n        }\n\n        // Set group height\n        await this.#setHeight()\n    }\n\n    /**\n     * Reset variables\n     * @private\n     */\n    #resetVariables () {\n        this.actionsElements = null\n        this.availableHeight = null\n        this.availableWidth = null\n        this.direction = null\n        this.gridWidth = null\n        this.groupElement = null\n        this.groupElements = null\n        this.groupsElement = null\n        this.groupsElementPadding = null\n        this.groupsElementRect = null\n        this.isCustomWidth = false\n        this.minCols = 3\n        this.settings = null\n        this.spacing = 10\n    }\n\n    /**\n     * Reset groups elements\n     */\n    #resetGroupsElements () {\n        const level1GroupElement = this.groupElement.closest('.tah-tab-group[data-level=\"1\"]')\n        const groupsElements = level1GroupElement.querySelectorAll('.tah-groups')\n        const style = { maxHeight: '', overflowY: '' }\n        this.#resetCSS(groupsElements, style)\n    }\n\n    /**\n     * Get the grid width\n     * @private\n     */\n    async #getGridWidth () {\n        // Reset action elements\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#resetCSS(this.actionsElements, emptyStyle)\n\n        const actionWidths = []\n        const actionWidthsForMedian = []\n        for (const actionsElement of this.actionsElements) {\n            const actionElements = actionsElement.querySelectorAll('.tah-action:not(.shrink)')\n            for (const actionElement of actionElements) {\n                const actionRect = actionElement.getBoundingClientRect()\n                const actionWidth = Math.round(parseFloat(actionRect.width) + 1 || 0)\n                const actionButtonText = actionElement.querySelector('.tah-action-button-text')\n                const actionButtonTextRect = actionButtonText?.getBoundingClientRect()\n                const actionButtonTextWidth = Math.round(parseFloat(actionButtonTextRect?.width) || 0)\n                actionWidthsForMedian.push(actionWidth)\n                actionWidths.push({ actionWidth, actionButtonTextWidth })\n            }\n        }\n\n        let upperQuartileAverage = Math.ceil(Utils.getUpperQuartileAverage(actionWidthsForMedian))\n        const minActionButtonTextWidth = 30\n\n        for (const actionWidth of actionWidths) {\n            const availableactionButtonTextWidth = upperQuartileAverage - (actionWidth.actionWidth - actionWidth.actionButtonTextWidth)\n            if (availableactionButtonTextWidth < minActionButtonTextWidth) {\n                upperQuartileAverage = (upperQuartileAverage - availableactionButtonTextWidth) + minActionButtonTextWidth\n            }\n        }\n\n        this.gridWidth = upperQuartileAverage\n    }\n\n    /**\n     * Resize the actions element into the grid format\n     * @private\n     * @param {object} actionsElement The actions element\n     * @param {number} customWidth    The custom width\n     */\n    async #resizeGrid (actionsElement, groupCustomWidth) {\n        if (!actionsElement) return\n        const emptyStyle = { display: '', gridTemplateColumns: '', width: '' }\n        await this.#assignCSS(actionsElement, emptyStyle)\n\n        const actions = actionsElement.querySelectorAll('.tah-action')\n        const squaredCols = Math.ceil(Math.sqrt(actions.length))\n        const availableGroupWidth = groupCustomWidth ?? this.availableWidth\n        const availableCols = Math.floor(availableGroupWidth / this.gridWidth)\n        const cols = (squaredCols > availableCols || groupCustomWidth) ? availableCols : (actions.length <= this.minCols) ? actions.length : squaredCols\n        // Apply maxHeight and width styles to content\n        const style = { display: 'grid', gridTemplateColumns: `repeat(${cols}, ${this.gridWidth}px)` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Resize the actions element\n     * @private\n     * @param {object} actionsElement The actions element\n     * @param {number} customWidth    The custom width\n     */\n    async #resize (actionsElement, groupCustomWidth) {\n        if (!actionsElement) return\n\n        let width = 500\n\n        if (this.isCustomWidth) {\n            width = this.availableWidth\n        } else if (groupCustomWidth) {\n            width = groupCustomWidth\n        } else {\n            const actions = actionsElement.querySelectorAll('.tah-action')\n            if (!actions.length) return\n            const sqrtActions = Math.ceil(Math.sqrt(actions.length)) // 4\n\n            // Initialize variables\n            let currentRow = 1\n            let maxRowWidth = 0\n            let rowWidth = 0\n            // Iterate through action groups, calculating dimensions and counts\n            if (actions.length > 0) {\n                actions.forEach((action, index) => {\n                    if ((index + 1) / sqrtActions > currentRow) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                        rowWidth = 0\n                        currentRow++\n                    }\n                    const actionRect = action.getBoundingClientRect()\n                    // const actionLeft = (index === 0) ? actionRect.left - this.groupsElementRect.left : 0\n                    const actionWidth = Math.ceil(parseFloat(actionRect.width) + 1 || 0)\n                    rowWidth += actionWidth\n                    // + actionLeft + 5\n                    if (index + 1 === actions.length) {\n                        rowWidth = rowWidth - 5\n                        maxRowWidth = (rowWidth > maxRowWidth) ? rowWidth : maxRowWidth\n                    }\n                })\n            }\n\n            // Add padding to maxAvgGroupWidth and maxGroupWidth\n            maxRowWidth += this.groupsElementPadding\n\n            // Determine width of content\n            width = (maxRowWidth < this.availableWidth && actions.length > 3) ? maxRowWidth : this.availableWidth\n            if (width < 200) width = 200\n        }\n\n        const style = { maxWidth: `${width}px` }\n        await this.#assignCSS(actionsElement, style)\n    }\n\n    /**\n     * Get available content width\n     * @private\n     */\n    #getAvailableWidth () {\n        const customWidth = this.settings?.customWidth\n\n        if (customWidth) {\n            this.isCustomWidth = true\n            return customWidth\n        }\n\n        const windowWidth = canvas.screenDimensions[0] || window.innerWidth\n        const contentLeft = this.groupsElementRect.left\n        const uiRight = document.querySelector('#ui-right')\n        const uiRightClientWidth = uiRight.clientWidth\n        return Math.floor((\n            uiRightClientWidth > 0\n                ? windowWidth - uiRightClientWidth\n                : windowWidth\n        ) - this.spacing - contentLeft)\n    }\n\n    /**\n     * Get available content height\n     * @private\n     */\n    #getAvailableHeight () {\n        const windowHeight = canvas.screenDimensions[1] || window.innerHeight\n        const contentBottom = this.groupsElementRect.bottom\n        const contentTop = this.groupsElementRect.top\n        const uiTopBottom = (this.direction === 'down')\n            ? document.querySelector('#ui-bottom')\n            : document.querySelector('#ui-top')\n        const uiTopBottomOffsetHeight = uiTopBottom.offsetHeight\n        const availableHeight = (this.direction === 'down')\n            ? windowHeight - contentTop - uiTopBottomOffsetHeight - this.spacing\n            : contentBottom - uiTopBottomOffsetHeight - this.spacing\n        return Math.floor(availableHeight < 100 ? 100 : availableHeight)\n    }\n\n    /**\n     * Get content\n     * @private\n     */\n    async #getGroupsElement () {\n        this.groupsElement = this.groupElement.querySelector('.tah-groups')\n        if (!this.groupsElement) return\n        this.groupsElementRect = this.groupsElement.getBoundingClientRect()\n        this.groupsElementComputed = getComputedStyle(this.groupsElement)\n        this.groupsElementPadding =\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingLeft) || 0) +\n            Math.ceil(parseFloat(this.groupsElementComputed.paddingRight) || 0)\n    }\n\n    /**\n     * Get groups\n     * @private\n     */\n    #getGroupElements () {\n        this.groupElements = this.groupElement.querySelectorAll('.tah-group')\n        if (this.groupElements.length === 0) this.groupElements = [this.groupElement]\n    }\n\n    /**\n     * Set the content height\n     * @private\n     */\n    async #setHeight () {\n        requestAnimationFrame(() => {\n            this.availableHeight = this.#getAvailableHeight()\n            const style = { maxHeight: `${this.availableHeight}px`, overflowY: 'auto' }\n            Object.assign(this.groupsElement.style, style)\n        })\n    }\n\n    /**\n     * Assign CSS\n     * @private\n     * @param {object} element The DOM element\n     * @param {object} style   The style\n     */\n    async #assignCSS (element, style) {\n        if (!element) return\n        requestAnimationFrame(() => {\n            Object.assign(element.style, style)\n        })\n    }\n\n    /**\n     * Reset CSS\n     * @private\n     * @param {array} elements The DOM elements\n     * @param {object} style   The style\n     */\n    async #resetCSS (elements, style) {\n        for (const element of elements) {\n            Object.assign(element.style, style)\n        }\n    }\n}\n","import { TagDialogHelper } from './dialogs/tag-dialog-helper.js'\nimport { GroupResizer } from './group-resizer.js'\nimport { DataHandler } from './data-handler.js'\nimport { CSS_STYLE, MODULE, SETTING, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\n/**\n * Token Action HUD application\n */\nexport class TokenActionHud extends Application {\n    // Set defaults\n    hoveredGroups = []\n    defaults = {}\n    defaultHeight = 200\n    defaultWidth = 20\n    defaultLeftPos = 150\n    defaultTopPos = 80\n    leftPos = this.defaultLeftPos\n    topPos = this.defaultTopPos\n    defaultScale = 1\n    refreshTimeout = null\n    rendering = false\n    tokens = null\n    isUpdatePending = false\n    isUpdating = false\n    updatePendingTimer = new Timer(10)\n    updateTimer = new Timer(10)\n\n    constructor (module, systemManager) {\n        super()\n        this.module = MODULE\n        this.systemManager = systemManager\n        this.autoDirection = 'down'\n        this.directionSetting = 'down'\n        this.alwaysShowSetting = false\n        this.clickOpenCategorySetting = false\n        this.isCollapsed = false\n        this.enableCustomizationSetting = false\n        this.dragSetting = 'whenUnlocked'\n        this.enableSetting = false\n        this.isHudEnabled = false\n        this.gridSetting = false\n        this.isUnlocked = false\n        this.styleSetting = null\n    }\n\n    /**\n     * Initialise the HUD\n     * @public\n     */\n    async init () {\n        this.activeCssAsTextSetting = Utils.getSetting('activeCssAsText')\n        this.allowSetting = Utils.getSetting('allow')\n        this.alwaysShowSetting = Utils.getSetting('alwaysShowHud')\n        this.clickOpenCategorySetting = Utils.getSetting('clickOpenCategory')\n        this.directionSetting = Utils.getSetting('direction')\n        this.debugSetting = Utils.getSetting('debug')\n        this.displayIconsSetting = Utils.getSetting('displayIcons')\n        this.dragSetting = Utils.getSetting('drag')\n        this.enableCustomizationSetting = Utils.getSetting('enableCustomization')\n        this.enableSetting = Utils.getSetting('enable')\n        this.gridSetting = Utils.getSetting('grid')\n        this.scaleSetting = Utils.getSetting('scale')\n        this.styleSetting = Utils.getSetting('style')\n\n        this.isCollapsed = Utils.getUserFlag('isCollapsed')\n        this.isHudEnabled = this.#getHudEnabled()\n        this.hudPosition = Utils.getUserFlag('position')\n        this.isUnlocked = Utils.getUserFlag('isUnlocked')\n\n        await this.systemManager.registerDefaultsCore()\n\n        this.dataHandler = new DataHandler()\n        await this.dataHandler.init()\n\n        this.actionHandler = await this.systemManager.getActionHandlerCore()\n        this.actionHandler.customLayoutSetting = Utils.getSetting('customLayout')\n        this.actionHandler.userCustomLayoutFlag = Utils.getUserFlag('userCustomLayout')\n        this.actionHandler.enableCustomizationSetting = this.enableCustomizationSetting\n        this.actionHandler.displayCharacterNameSetting = Utils.getSetting('displayCharacterName')\n        this.actionHandler.sortActionsSetting = Utils.getSetting('sortActions')\n        this.actionHandler.tooltipsSetting = Utils.getSetting('tooltips')\n\n        this.GroupResizer = new GroupResizer()\n        this.rollHandler = this.systemManager.getRollHandlerCore()\n    }\n\n    /**\n     * Update Token Action HUD following change to module settings\n     * @public\n     */\n    async updateSettings (key, value = null) {\n        if (!this.updateSettingsPending) {\n            this.updateSettingsPending = true\n            Logger.debug('Updating settings...')\n        }\n\n        const setting = SETTING[key]\n        const variable = setting?.variable\n        if (variable) {\n            if (setting.classes.includes('TokenActionHud')) this[variable] = value\n            if (setting.classes.includes('ActionHandler')) this.actionHandler[variable] = value\n        }\n\n        switch (key) {\n        case 'allow':\n        case 'enable':\n            this.isHudEnabled = this.#getHudEnabled()\n            break\n        case 'customLayout':\n        case 'userCustomLayout':\n            this.actionHandler.customLayout = null\n            break\n        case 'rollHandler':\n            this.updateRollHandler()\n            break\n        }\n    }\n\n    /**\n     * Update the RollHandler\n     * @public\n     */\n    updateRollHandler () {\n        this.rollHandler = this.systemManager.getRollHandlerCore()\n    }\n\n    /**\n     * Merge Token Action Hud's default options with Application\n     * @override\n     */\n    static get defaultOptions () {\n        return mergeObject(super.defaultOptions, {\n            template: TEMPLATE.hud,\n            id: 'token-action-hud',\n            classes: [],\n            width: this.defaultWidth,\n            height: this.defaultHeight,\n            left: this.defaultLeftPos,\n            top: this.defaultTopPos,\n            scale: this.defaultScale,\n            background: 'none',\n            popOut: false,\n            minimizable: false,\n            resizable: false,\n            title: 'token-action-hud',\n            dragDrop: [],\n            tabs: [],\n            scrollY: [],\n            zIndex: 100\n        })\n    }\n\n    /**\n     * Whether the HUD can be dragged\n     * @returns {boolean} Whether the HUD can be dragged\n     */\n    #isDraggable () {\n        return ((this.dragSetting === 'always') || (this.dragSetting === 'whenUnlocked' && this.isUnlocked))\n    }\n\n    /**\n     * Get Token Action Hud scale\n     * @private\n     * @returns {number} The scale\n     */\n    #getScale () {\n        const scale = parseFloat(this.scaleSetting)\n        if (scale < 0.5) return 0.5\n        if (scale > 2) return 2\n        return scale\n    }\n\n    /**\n     * Get data\n     * @override\n     */\n    getData (options = {}) {\n        const data = super.getData()\n        data.hud = this.hud\n        data.id = 'token-action-hud'\n        data.style = game.tokenActionHud.systemManager.styles[this.styleSetting].class ?? ''\n        data.scale = this.#getScale()\n        data.background = '#00000000'\n        Logger.debug('Application data', { data })\n\n        return data\n    }\n\n    /**\n     * Activate listeners\n     * @override\n     */\n    activateListeners (html) {\n        const elements = {\n            action: html.find('.tah-action'),\n            buttons: html.find('#tah-buttons'),\n            tabGroup: html.find('.tah-tab-group'),\n            groups: html.find('#tah-groups'),\n            editHudButton: html.find('#tah-edit-hud'),\n            listGroups: html.find('.tah-list-groups'),\n            group: html.find('.tah-group'),\n            subtitle: html.find('.tah-subtitle'),\n            groupButton: html.find('.tah-group-button'),\n            collapseHudButton: html.find('#tah-collapse-hud'),\n            expandHudButton: html.find('#tah-expand-hud'),\n            unlockButton: html.find('#tah-unlock'),\n            lockButton: html.find('#tah-lock')\n        }\n\n        // Bind event listeners\n        this.#bindGroupEvents(elements)\n        this.#bindActionEvents(elements)\n        this.#bindEditHudButton(elements)\n        this.#bindLockUnlockButtons(elements)\n        this.#bindCollapseExpandButtons(elements)\n    }\n\n    /**\n     * Post-render HUD\n     */\n    postRender () {\n        this.#applySettings()\n\n        // Resize category\n        if (this.hoveredGroups.length) {\n            for (const groupId of this.hoveredGroups) {\n                const group = document.querySelector(`#${groupId}`)\n                this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            }\n        }\n    }\n\n    /**\n    * Bind category events\n    * @private\n    */\n    #bindGroupEvents (elements) {\n        /**\n         * Close the group\n         * @param {object} event The event\n         */\n        const closeGroup = (event) => {\n            if (game.tokenActionHud.rendering) return\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.remove('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.remove('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.#clearHoveredGroup(group.id)\n        }\n\n        /**\n         * Open the group\n         * @param {object} event The event\n         */\n        const openGroup = async (event) => {\n            const group = (this.clickOpenCategorySetting) ? event.currentTarget.parentElement : event.currentTarget\n            group.classList.add('hover')\n            const closestGroupElement = group.closest('.tah-group')\n            let sibling = closestGroupElement?.nextElementSibling\n            while (sibling) {\n                if (sibling.classList.contains('tah-group')) {\n                    sibling.classList.add('tah-hidden')\n                }\n                sibling = sibling.nextElementSibling\n            }\n            this.GroupResizer.resizeGroup(this.actionHandler, group, this.autoDirection, this.gridSetting)\n            this.#setHoveredGroup(group.id)\n        }\n\n        /**\n         * Toggle the group\n         * @param {object} event The event\n         */\n        const toggleGroup = (event) => {\n            const group = event.currentTarget.parentElement\n            if (group.classList.contains('hover')) {\n                closeGroup(event)\n            } else {\n                const groupElements = group.parentElement.querySelectorAll('.tah-tab-group')\n                for (const groupElement of groupElements) {\n                    groupElement.classList.remove('hover')\n                    this.#clearHoveredGroup(groupElement.id)\n                }\n                openGroup(event)\n            }\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        }\n\n        // Bring HUD to top\n        elements.groupButton.on('click', (event) => {\n            this.bringToTop()\n            // Remove focus to allow core ESC interactions\n            event.currentTarget.blur()\n        })\n\n        if (this.clickOpenCategorySetting) {\n            // When a category button is clicked...\n            elements.groupButton.on('click', toggleGroup)\n        } else {\n            // When a category button is hovered over...\n            elements.tabGroup.get().forEach(element => {\n                element.addEventListener('touchstart', toggleGroup, { passive: true })\n            })\n            elements.tabGroup.hover(openGroup, closeGroup)\n        }\n\n        // When a category button is clicked and held...\n        elements.groupButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.groupButton.get().forEach(element => {\n            element.addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n        })\n    }\n\n    /**\n     * Bind action events\n     * @private\n     * @param {object} elements The DOM elements\n     */\n    #bindActionEvents (elements) {\n        /**\n         * Action click\n         * @param {object} event The event\n         */\n        const actionClick = (event) => {\n            const target = ((event.target.tagName === 'BUTTON')) ? event.target : event.currentTarget.children[0]\n            const value = target.value\n            try {\n                this.rollHandler.handleActionClickCore(event, value, this.actionHandler)\n                target.blur()\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Action hover\n         * @param {object} event The event\n         */\n        const actionHover = (event) => {\n            const target = ((event.target.tagName === 'BUTTON')) ? event.target : event.currentTarget.children[0]\n            const value = target.value\n            try {\n                this.rollHandler.handleActionHoverCore(event, value, this.actionHandler)\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Group click\n         * @param {object} event The event\n         */\n        const groupClick = (event) => {\n            const target = (event.target.classList.contains('tah-button-text')) || (event.target.classList.contains('tah-button-image')) || (event.target.classList.contains('tah-group-button'))\n                ? event.target.closest('.tah-tab-group')\n                : event.target.closest('.tah-group')\n            if (!target?.dataset?.nestId) return\n            const nestId = target?.dataset?.nestId\n            try {\n                this.rollHandler.handleGroupClickCore(event, nestId, this.actionHandler)\n            } catch (error) {\n                Logger.error(event)\n            }\n        }\n\n        /**\n         * Open the group dialog\n         * @param {object} event\n         */\n        const openGroupDialog = (event) => {\n            const target = event.currentTarget\n            if (!target?.parentElement?.dataset?.nestId) return\n\n            const nestId = target?.parentElement?.dataset?.nestId\n            const name = target?.parentElement?.dataset?.name ?? target.innerText ?? target.outerText\n            const level = parseInt(target?.parentElement?.dataset?.level) || null\n            const type = target?.parentElement?.dataset?.type\n\n            TagDialogHelper.showGroupDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        /**\n         * Open the Action dialog\n         * @param {object} event The event\n         */\n        const openActionDialog = (event) => {\n            const target = (event.target.classList.contains('tah-button-text')) || (event.target.classList.contains('tah-button-image')) || (event.target.classList.contains('tah-group-button'))\n                ? event.target.closest('.tah-tab-group')\n                : event.target.closest('.tah-group')\n            if (!target?.dataset?.nestId) return\n            const nestId = target?.dataset?.nestId\n            const name = event.target.innerText ?? event.target.outerText\n            const level = parseInt(target?.dataset?.level) || null\n            const type = target?.dataset?.type\n\n            TagDialogHelper.showActionDialog(\n                this.actionHandler,\n                { nestId, name, level, type }\n            )\n        }\n\n        /**\n         * Collapse/expand group\n         * @param {object} event                   The event\n         * @param {boolean} enableCustomizationSetting Whether customization is enabled\n         */\n        const collapseExpandGroup = (event, enableCustomizationSetting) => {\n            const target = event.target.classList.contains('tah-subtitle-text')\n                ? event.target.parentElement\n                : event.target\n            const groupElement = target?.closest('.tah-group')\n            const nestId = groupElement?.dataset?.nestId\n            const tabGroup = target.closest('.tah-tab-group.hover')\n            const groupsElement = groupElement?.querySelector('.tah-groups')\n            const collapseIcon = target.querySelector('.tah-collapse-icon')\n            const expandIcon = target.querySelector('.tah-expand-icon')\n            const imageElement = groupElement.querySelector('.tah-list-image')\n\n            const toggleGroupVisibility = () => {\n                groupsElement?.classList.toggle('tah-hidden')\n                collapseIcon?.classList.toggle('tah-hidden')\n                expandIcon?.classList.toggle('tah-hidden')\n                imageElement?.classList.toggle('tah-hidden')\n            }\n\n            const saveGroupSettings = (collapse) => {\n                if (enableCustomizationSetting) {\n                    this.actionHandler.saveGroupSettings({ nestId, settings: { collapse } })\n                }\n            }\n\n            if (groupsElement?.classList.contains('tah-hidden')) {\n                toggleGroupVisibility()\n                saveGroupSettings(false)\n                this.GroupResizer.resizeGroup(this.actionHandler, tabGroup, this.autoDirection, this.gridSetting)\n            } else {\n                toggleGroupVisibility()\n                saveGroupSettings(true)\n            }\n        }\n\n        // When a subcategory title is right-clicked...\n        elements.subtitle.on('contextmenu', (event) => {\n            if (this.isUnlocked) {\n                openActionDialog(event)\n            } else {\n                groupClick(event)\n            }\n        })\n\n        // When a subcategory title is clicked...\n        elements.subtitle.on('click', (event) => {\n            if (event.target.classList.contains('tah-button-text')) return\n            collapseExpandGroup(event, this.enableCustomizationSetting)\n        })\n\n        // When an action is clicked or right-clicked...\n        elements.action.on('click contextmenu', (event) => {\n            event.preventDefault()\n            actionClick(event)\n        })\n\n        // When an action is hovered...\n        elements.action.hover((event) => {\n            actionHover(event)\n        })\n\n        elements.groupButton.on('contextmenu', (event) => {\n            if (this.isUnlocked) {\n                if (event.currentTarget.parentElement.dataset.level === '1') {\n                    openGroupDialog(event)\n                } else {\n                    openActionDialog(event)\n                }\n            } else {\n                groupClick(event)\n            }\n        })\n    }\n\n    /**\n     * Bind 'Edit HUD' button\n     * @private\n     */\n    #bindEditHudButton (elements) {\n        // When the 'Edit HUD' button is clicked...\n        elements.editHudButton.on('click', (event) => {\n            event.preventDefault()\n            event = event || window.event\n            TagDialogHelper.showHudDialog(this.actionHandler)\n        })\n    }\n\n    /**\n     * Bind lock and unlock buttons\n     * @private\n     */\n    #bindLockUnlockButtons (elements) {\n        /**\n         * Unlock the HUD\n         * @param {object} event\n         */\n        const unlockHud = async (event) => {\n            if (event) {\n                event.preventDefault()\n            }\n\n            const target = event?.target || elements.unlockButton\n            $(target).addClass('tah-hidden')\n            elements.editHudButton.removeClass('tah-hidden')\n            elements.group.removeClass('tah-hidden')\n            elements.groupButton.removeClass('disable-edit')\n            elements.groups.addClass('tah-unlocked')\n            elements.listGroups.removeClass('tah-hidden')\n            elements.lockButton.removeClass('tah-hidden')\n            elements.tabGroup.removeClass('tah-hidden')\n            elements.subtitle.removeClass('disable-edit tah-hidden')\n\n            if (!this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', true)\n                this.isUnlocked = true\n            }\n        }\n\n        /**\n         * Lock the HUD\n         * @param {object} event\n         */\n        const lockHud = async (event = null) => {\n            if (event) {\n                event.preventDefault()\n            }\n            const target = event?.target || elements.lockButton\n            $(target).addClass('tah-hidden')\n            elements.unlockButton.removeClass('tah-hidden')\n            elements.editHudButton.addClass('tah-hidden')\n            elements.groups.removeClass('tah-unlocked')\n            for (const topGroupElement of elements.tabGroup) {\n                const hasActions = (topGroupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) topGroupElement.classList.add('tah-hidden')\n            }\n            for (const groupElement of elements.group) {\n                const hasActions = (groupElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) groupElement.classList.add('tah-hidden')\n            }\n            for (const listGroupsElement of elements.listGroups) {\n                const hasActions = (listGroupsElement.getElementsByClassName('tah-action').length > 0)\n                if (!hasActions) listGroupsElement.classList.add('tah-hidden')\n            }\n            for (const subtitleElement of elements.subtitle) {\n                const groupElement = subtitleElement.closest('.tah-group')\n                if (groupElement?.dataset?.showTitle === 'false') {\n                    subtitleElement.classList.add('tah-hidden')\n                }\n            }\n            elements.groupButton.addClass('disable-edit')\n            elements.subtitle.addClass('disable-edit')\n            if (this.isUnlocked) {\n                await Utils.setUserFlag('isUnlocked', false)\n                this.isUnlocked = false\n            }\n        }\n\n        // Set initial lock state\n        if (this.isUnlocked && this.enableCustomizationSetting) {\n            unlockHud()\n        } else {\n            lockHud()\n        }\n\n        if (!this.enableCustomizationSetting) {\n            elements.unlockButton.addClass('tah-hidden')\n        }\n\n        // Add event listeners\n        elements.unlockButton.on('click', unlockHud)\n        elements.lockButton.on('click', lockHud)\n    }\n\n    /**\n     * Bind collapse and expand buttons\n     * @private\n     */\n    #bindCollapseExpandButtons (elements) {\n        /**\n         * Collapse the HUD\n         * @param {object} event The event\n         */\n        const collapseHud = (event = null) => {\n            if (event) {\n                event.preventDefault()\n                event = event || window.event\n            }\n            const target = event?.target || elements.collapseHudButton\n            $(target).addClass('tah-hidden')\n            elements.expandHudButton.removeClass('tah-hidden')\n            elements.groups.addClass('tah-hidden')\n            elements.buttons.addClass('tah-hidden')\n            if (!this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', true)\n                this.isCollapsed = true\n            }\n        }\n\n        /**\n         * Expand the HUD\n         * @param {object} event The event\n         */\n        const expandHud = (event) => {\n            event.preventDefault()\n            event = event || window.event\n            $(event.target).addClass('tah-hidden')\n            elements.collapseHudButton.removeClass('tah-hidden')\n            elements.groups.removeClass('tah-hidden')\n            elements.buttons.removeClass('tah-hidden')\n            if (this.isCollapsed) {\n                Utils.setUserFlag('isCollapsed', false)\n                this.isCollapsed = false\n            }\n        }\n\n        // Set initial state\n        if (this.isCollapsed) { collapseHud() }\n\n        // Add event listeners\n        // When the 'Collapse HUD' button is clicked...\n        elements.collapseHudButton.on('click', collapseHud)\n\n        // When the 'Expand HUD' Button is clicked...\n        elements.expandHudButton.on('click', expandHud)\n\n        // When the 'Expand HUD' button is clicked and held...\n        elements.expandHudButton.on('mousedown', (event) => this.#dragEvent(event))\n        elements.expandHudButton.get(0).addEventListener('touchstart', (event) => this.#dragEvent(event), { passive: true })\n    }\n\n    /**\n     * Drag event handler\n     * @private\n     * @param {object} event The event\n     */\n    #dragEvent (event) {\n        if (!this.#isDraggable()) return\n\n        // Get the main element\n        const element = document.getElementById('token-action-hud')\n\n        const clientX = event.clientX ?? event.changedTouches[0].clientX\n        const clientY = event.clientY ?? event.changedTouches[0].clientY\n\n        // Initialise positions and starting positions\n        let pos1 = 0\n        let pos2 = 0\n        let pos3 = clientX\n        let pos4 = clientY\n        const originalElementTop = element.offsetTop\n        const originalElementLeft = element.offsetLeft\n        let newElementTop = originalElementTop\n        let newElementLeft = originalElementLeft\n\n        /**\n         * Mouse movement event handler\n         * @param {object} event The event\n         */\n        const mouseMoveEvent = (event) => {\n            const clientX = event.clientX ?? event.changedTouches[0].clientX\n            const clientY = event.clientY ?? event.changedTouches[0].clientY\n            pos1 = pos3 - clientX\n            pos2 = pos4 - clientY\n            pos3 = clientX\n            pos4 = clientY\n\n            // If the mouse has not moved, do not update\n            if (pos1 === pos3 && pos2 === pos4) return\n\n            newElementTop = newElementTop - pos2\n            newElementLeft = newElementLeft - pos1\n\n            this.topPos = newElementTop\n\n            // Apply styles\n            requestAnimationFrame(() => {\n                Object.assign(element.style, { left: `${newElementLeft}px`, position: 'fixed', top: `${newElementTop}px` })\n            })\n        }\n\n        /**\n         * Mouse up event handler\n         */\n        const mouseUpEvent = () => {\n            // Remove the mouse move and touch move events\n            document.onmousemove = null\n            element.ontouchmove = null\n\n            // Remove the mouse up and touch end events\n            document.onmouseup = null\n            element.ontouchend = null\n\n            // If position has not changed, do not update\n            if (newElementTop === originalElementTop && newElementLeft === originalElementLeft) return\n\n            this.topPos = newElementTop\n\n            this.#applySettings()\n\n            // Save the new position to the user's flags\n            this.hudPosition = { top: newElementTop, left: newElementLeft }\n            Utils.setUserFlag('position', this.hudPosition)\n\n            Logger.debug(`Set position to x: ${newElementTop}px, y: ${newElementLeft}px`)\n        }\n\n        // Bind mouse move and touch move events\n        document.onmousemove = mouseMoveEvent\n        element.ontouchmove = mouseMoveEvent\n\n        // Bind mouse up and touch end events\n        document.onmouseup = mouseUpEvent\n        element.ontouchend = mouseUpEvent\n    }\n\n    /**\n     * Get the automatic direction the HUD expands\n     * @private\n     * @returns {string} The direction\n     */\n    #getAutoDirection () {\n        if (this.directionSetting === 'up' || (this.directionSetting === 'auto' && this.topPos > window.innerHeight / 2)) return 'up'\n        return 'down'\n    }\n\n    /**\n     * Apply settings\n     * @private\n     */\n    #applySettings () {\n        this.autoDirection = this.#getAutoDirection()\n        if (this.autoDirection === 'up') {\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('.tah-groups-container').removeClass('expand-down')\n            $(document).find('.tah-groups-container').addClass('expand-up')\n            $(document).find('#tah-character-name').addClass('tah-hidden')\n        } else {\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('.tah-groups-container').addClass('expand-down')\n            $(document).find('.tah-groups-container').removeClass('expand-up')\n            $(document).find('#tah-character-name').removeClass('tah-hidden')\n        }\n    }\n\n    /**\n     * Set position of the HUD\n     * @public\n     */\n    setPosition () {\n        if (!this.hud) return\n        this.#setPositionFromFlag()\n        this.#restoreHoveredGroups()\n        this.rendering = false\n    }\n\n    /**\n     * Set the position of the HUD based on user flag\n     * @private\n     */\n    #setPositionFromFlag () {\n        if (!this.hudPosition) return\n\n        const defaultLeftPos = this.defaultLeftPos\n        const defaultTopPos = this.defaultTopPos\n\n        return new Promise((resolve) => {\n            const check = () => {\n                const element = document.getElementById('token-action-hud')\n                if (element) {\n                    element.style.bottom = null\n                    this.topPos = this.hudPosition.top < 5 || this.hudPosition.top > window.innerHeight + 5\n                        ? defaultTopPos\n                        : this.hudPosition.top\n                    element.style.top = `${this.topPos}px`\n                    this.leftPos = this.hudPosition.left < 5 || this.hudPosition.left > window.innerWidth + 5\n                        ? defaultLeftPos\n                        : this.hudPosition.left\n                    element.style.left = `${this.leftPos}px`\n                    element.style.position = 'fixed'\n                    resolve()\n                } else {\n                    setTimeout(check, 10)\n                }\n            }\n\n            check()\n        })\n    }\n\n    /**\n     * Reset the position of the HUD\n     * @public\n     */\n    async resetPosition () {\n        Logger.debug('Resetting position...')\n        this.hudPosition = { top: this.defaultTopPos, left: this.defaultLeftPos }\n        await Utils.setUserFlag('position', this.hudPosition)\n        Logger.debug(`Position reset to x: ${this.defaultTopPos}px, y: ${this.defaultLeftPos}px`)\n    }\n\n    /**\n     * Set hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #setHoveredGroup (groupId) {\n        if (this.hoveredGroups.length > 10) { this.hoveredGroups = [] }\n        this.hoveredGroups.push(groupId)\n    }\n\n    /**\n     * Clear hovered group\n     * @private\n     * @param {string} groupId The group id\n     */\n    #clearHoveredGroup (groupId) {\n        this.hoveredGroups = this.hoveredGroups.filter(id => id !== groupId)\n    }\n\n    /**\n     * Restore the hovered category state on the HUD\n     * @private\n     */\n    #restoreHoveredGroups () {\n        if (!this.hoveredGroups.length) return\n\n        for (const groupId of this.hoveredGroups) {\n            const groupElement = $(`#${groupId}`)\n\n            if (!groupElement[0]) continue\n\n            if (this.clickOpenCategorySetting) {\n                const button = groupElement.find('.tah-group-button')[0]\n                button.click()\n            } else {\n                groupElement.mouseenter()\n            }\n        }\n    }\n\n    /**\n     * Toggle HUD\n     * @public\n     */\n    async toggleHud () {\n        const binding = Utils.humanizeBinding('toggleHud')\n        if (this.enableSetting) {\n            this.#close()\n            this.enableSetting = false\n            await Utils.setSetting('enable', false)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.disabled', { binding }), true)\n        } else {\n            this.enableSetting = true\n            await Utils.setSetting('enable', true)\n            Logger.info(game.i18n.format('tokenActionHud.keybinding.toggleHud.enabled', { binding }), true)\n            Hooks.callAll('forceUpdateTokenActionHud')\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @public\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async copy (fromUserId, toUserIds) {\n        if (!game.user.isGM) return\n\n        const isCopied = await this.#copyUserData(fromUserId, toUserIds)\n        if (isCopied) {\n            Logger.info('HUD copied', true)\n        } else {\n            Logger.info('Copy HUD failed', true)\n        }\n    }\n\n    /**\n     * Copy user's 'groups' flag to others users\n     * @private\n     * @param {string} fromUserId      The user id to copy from\n     * @param {string|array} toUserIds The user ids to copy to\n     */\n    async #copyUserData (fromUserId, toUserIds) {\n        // Exit if parameters are missing\n        if (!fromUserId || !toUserIds.length) return false\n\n        Logger.debug('Copying user data...')\n\n        const fromGroup = await DataHandler.getDataAsGm({ type: 'user', id: fromUserId })\n\n        if (typeof toUserIds === 'string') {\n            await DataHandler.saveDataAsGm('user', toUserIds, fromGroup)\n        } else if (Array.isArray(toUserIds)) {\n            for (const userId of toUserIds) {\n                await DataHandler.saveDataAsGm('user', userId, fromGroup)\n            }\n        }\n\n        Logger.debug('User data copied')\n        return true\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetLayout.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetLayout.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await this.updateSettings('customLayout', customLayoutElement?.value ?? '')\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await this.updateSettings('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                            await Utils.setUserFlag('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                        }\n                        await TokenActionHud.reset()\n                        Logger.info('Layout reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    /**\n     * Reset the HUD\n     * @public\n     */\n    async resetAllDialog () {\n        const d = new Dialog({\n            title: Utils.i18n('tokenActionHud.dialog.resetAllLayouts.title'),\n            content: `<p>${Utils.i18n('tokenActionHud.dialog.resetAllLayouts.content')}</p>`,\n            buttons: {\n                yes: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.yes'),\n                    callback: async () => {\n                        const customLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=customLayout]')\n                        if (customLayoutElement) {\n                            await Utils.setSetting('customLayout', customLayoutElement?.value ?? '')\n                        }\n                        const userCustomLayoutElement = document.querySelector('#token-action-hud-core-settings input[name=userCustomLayout]')\n                        if (userCustomLayoutElement) {\n                            await Utils.setUserFlag('userCustomLayout', userCustomLayoutElement?.value ?? '')\n                        }\n                        await game.tokenActionHud.socket.executeForEveryone('reset')\n                        Logger.info('All layouts reset', true)\n                    }\n                },\n                no: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: Utils.i18n('tokenActionHud.dialog.button.no')\n                }\n            }\n        })\n        d.render(true)\n    }\n\n    static async reset () {\n        Logger.debug('Resetting layout...')\n        await game?.tokenActionHud?.resetUserAndActorData()\n        game?.tokenActionHud?.resetPosition()\n        Logger.debug('Layout reset')\n    }\n\n    /**\n     * Reset actor data\n     */\n    async resetActorData () {\n        Logger.debug('Resetting actor data...')\n\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('Actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all actor data\n     * @public\n     */\n    async resetAllActorData () {\n        Logger.debug('Resetting all actor data...')\n\n        for (const actor of game.actors) {\n            Logger.debug(`Resetting flags for actor [${actor.id}]`, { actor })\n            await DataHandler.saveDataAsGm('actor', actor.id, {})\n        }\n        this.actionHandler.hardResetActionHandler()\n\n        Logger.debug('All actor data reset')\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user data\n     * @public\n     */\n    async resetUserData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset all user data\n     * @public\n     */\n    async resetAllUserData () {\n        Logger.debug('Resetting all user data...')\n        for (const user of game.users) {\n            await DataHandler.saveDataAsGm('user', user.id, {})\n        }\n        Logger.debug('All user data reset')\n        this.actionHandler.hardResetActionHandler()\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetAllUserData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Reset user and actor data\n     */\n    async resetUserAndActorData () {\n        Logger.debug('Resetting user data...')\n        await DataHandler.saveDataAsGm('user', game.userId, {})\n        Logger.debug('User data reset')\n\n        Logger.debug('Resetting actor data...')\n        await DataHandler.saveDataAsGm('actor', this.actor.id, {})\n        Logger.debug('Actor data reset')\n\n        this.actionHandler.hardResetActionHandler()\n\n        const trigger = { trigger: { type: 'method', name: 'TokenActionHud#resetUserAndActorData' } }\n        this.update(trigger)\n    }\n\n    /**\n     * Update the HUD\n     * @public\n     * @param {object} trigger The trigger for the update\n     */\n    async update (trigger = null) {\n        // Stops settings updates from triggering the HUD update multiple times\n        // Instead an update is triggered when settings are updated and the settings config window is closed\n        if (trigger?.name === 'closeSettingsConfig') {\n            if (!this.updateSettingsPending) return\n            this.updateSettingsPending = false\n            Logger.debug('Settings updated')\n        }\n\n        await this.#handleUpdate()\n\n        await this.#performUpdate(trigger)\n    }\n\n    /**\n     * Handles HUD updates to avoid overlapping updates\n     */\n    async #handleUpdate () {\n        // Start a timer and reset it each time an update call is received before the timer has elapsed\n        if (this.isUpdatePending) this.updatePendingTimer.abort()\n\n        this.isUpdatePending = true\n        await this.updatePendingTimer.start()\n        this.isUpdatePending = false\n\n        // Wait for the current update to complete before progressing a pending update\n        // Stop waiting if the current update takes longer than 5 seconds\n        const waitForUpdateCompletion = async () => {\n            const maxWaitTime = 5000\n            const interval = 10\n            const iterations = maxWaitTime / interval\n\n            let i = 0\n            while (i < iterations && this.isUpdating) {\n                await this.updateTimer.start()\n                i++\n            }\n\n            return !this.isUpdating\n        }\n\n        if (this.isUpdating) {\n            const hasCompleted = await waitForUpdateCompletion()\n            if (!hasCompleted) {\n                Logger.debug('Update took too long. Aborting...')\n            }\n        }\n    }\n\n    /**\n     * Perform the HUD update following handling\n     * @param {object} trigger The trigger for the update\n     */\n    async #performUpdate (trigger) {\n        this.isUpdating = true\n\n        Logger.debug('Updating HUD...', trigger)\n\n        const previousActorId = this.actor?.id\n        const controlledTokens = Utils.getControlledTokens()\n        const character = this.#getCharacter(controlledTokens)\n        const multipleTokens = controlledTokens.length > 1 && !character\n\n        if ((!character && !multipleTokens) || !this.isHudEnabled) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as no character(s) found or HUD is disabled')\n            this.isUpdating = false\n            return\n        }\n\n        const options = (trigger === 'controlToken' && previousActorId !== this.actor?.id) ? { saveActor: true } : {}\n\n        this.hud = await this.actionHandler.buildHud(options)\n\n        if (this.hud.length === 0) {\n            this.#close()\n            this.hoveredGroups = []\n            Logger.debug('HUD update aborted as action list empty')\n            this.isUpdating = false\n            return\n        }\n\n        this.rendering = true\n        this.render(true)\n        if (!ui.windows[this.appId]) {\n            ui.windows[this.appId] = this\n        }\n\n        this.isUpdating = false\n\n        Hooks.callAll('tokenActionHudCoreHudUpdated', this.module)\n        Logger.debug('HUD updated')\n    }\n\n    /**\n     * Close application\n     * @private\n     */\n    #close () {\n        this.close()\n    }\n\n    /**\n     * Whether the token change is valid for a HUD update\n     * @public\n     * @param {object} token The token\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the token change is valid for a HUD update\n     */\n    isValidTokenChange (token, data = null) {\n        if (data?.actorData?.flags) return false\n        if (this.alwaysShowSetting) {\n            return (this.#isRelevantToken(token) || token.actorId === game.user.character?.id)\n        } else {\n            return this.#isRelevantToken(token)\n        }\n    }\n\n    /**\n     * Whether the token is controlled or on the canvas\n     * @private\n     * @param {object} token The token\n     * @returns {boolean} Whether the token is controlled or on the canvas\n     */\n    #isRelevantToken (token) {\n        const controlledTokens = Utils.getControlledTokens()\n        return (\n            controlledTokens?.some((controlledToken) => controlledToken.id === token.id) ||\n            (\n                controlledTokens?.length === 0 &&\n                canvas?.tokens?.placeables?.some((token) => token.id === this.hud?.tokenId)\n            )\n        )\n    }\n\n    /**\n     * Whether the given actor is the selected actor\n     * @param {object} actor The actor\n     * @returns {boolean}    Whether the given actor is the selected actor\n     */\n    isSelectedActor (actor) {\n        if (!actor?.id) return true\n        if (actor?.id === this.actor?.id) return true\n        return false\n    }\n\n    /**\n     * Whether the actor or item update is valid for a HUD update\n     * @param {object} actor The actor\n     * @param {object} data  The data\n     * @returns {boolean}    Whether the actor or item update is valid for a HUD update\n     */\n    isValidActorOrItemUpdate (actor, data) {\n        if (!this.isSelectedActor(actor)) return false\n\n        if (actor) {\n            if (!actor) {\n                Logger.debug('No actor, update hud', { data })\n                return true\n            }\n\n            if (this.hud && actor.id === this.hud.actorId) {\n                Logger.debug('Same actor, update hud', { actor, data })\n                return true\n            }\n\n            Logger.debug('Different actor, do not update hud', { actor, data })\n            return false\n        }\n    }\n\n    /**\n     * Whether the character is a valid selection for the current user\n     * @private\n     * @param {object} [token = {}] The token\n     * @returns {boolean}           Whether the character is a valid selection for the current user\n     */\n    #isValidCharacter (token = {}) {\n        const actor = token?.actor\n        return game.user.isGM || actor?.testUserPermission(game.user, 'OWNER')\n    }\n\n    /**\n     * Whether the hud is enabled for the current user\n     * @private\n     * @returns {boolean} Whether the hud is enabled for the current user\n     */\n    #getHudEnabled () {\n        const userRole = game.user.role\n        const isGM = game.user.isGM\n        const isEnabled = this.enableSetting\n\n        if (!isEnabled) return false\n\n        if (isGM) return true\n\n        return Utils.checkAllow(userRole, this.allowSetting)\n    }\n\n    /**\n     * Get character from selected tokens\n     * @private\n     * @param {array} [controlled = []] The controlled tokens\n     */\n    #getCharacter (controlled = []) {\n        if (controlled.length > 1) {\n            this.actor = null\n            this.token = null\n            this.actionHandler.characterName = 'Multiple'\n            this.actionHandler.actor = null\n            this.actionHandler.token = null\n            this.rollHandler.actor = null\n            this.rollHandler.token = null\n            return null\n        }\n\n        const character = { token: null, actor: null }\n        if (controlled.length === 1) {\n            const token = controlled[0]\n            const actor = token.actor\n\n            if (!this.#isValidCharacter(token)) return null\n\n            character.token = token\n            character.actor = actor\n        } else if (controlled.length === 0 && game.user.character && this.alwaysShowSetting) {\n            character.actor = game.user.character\n            character.token = canvas.tokens?.placeables.find(t => t.actor?.id === character.actor.id) ?? null\n        }\n\n        if (!character.actor) return null\n\n        this.actor = character.actor\n        this.token = character.token\n        this.actionHandler.characterName = character.token?.name ?? character.actor.name\n        this.actionHandler.actor = character.actor\n        this.actionHandler.token = character.token\n        this.rollHandler.actor = character.actor\n        this.rollHandler.token = character.token\n        return character\n    }\n}\n","import { ActionHandler } from './action-handlers/action-handler.js'\nimport { ActionHandlerExtender } from './action-handlers/action-handler-extender.js'\nimport { DataHandler } from './data-handler.js'\nimport { MigrationManager } from './migration-manager.js'\nimport { PreRollHandler } from './roll-handlers/pre-roll-handler.js'\nimport { RollHandler } from './roll-handlers/roll-handler.js'\nimport { SystemManager } from './system-manager.js'\nimport { TokenActionHud } from './token-action-hud.js'\nimport { MODULE, TEMPLATE } from './constants.js'\nimport { Logger, Timer, Utils } from './utils.js'\n\nlet systemManager\nlet module\nlet socket\n\nHooks.once('socketlib.ready', () => {\n    socket = socketlib.registerModule(MODULE.ID)\n    socket.register('getFilePaths', DataHandler.getFilePaths)\n    socket.register('getData', DataHandler.getData)\n    socket.register('saveData', DataHandler.saveData)\n    socket.register('reset', TokenActionHud.reset)\n})\n\nHooks.on('ready', async () => {\n    module = game.modules.get(MODULE.ID)\n    const ActionListExtender = ActionHandlerExtender\n    module.api = {\n        ActionListExtender,\n        ActionHandlerExtender,\n        ActionHandler,\n        DataHandler,\n        Logger,\n        PreRollHandler,\n        RollHandler,\n        SystemManager,\n        Timer,\n        Utils\n    }\n\n    Hooks.callAll('tokenActionHudCoreApiReady', module)\n})\n\nHooks.on('tokenActionHudSystemReady', async (systemModule) => {\n    // Exit if core module version is not compatible with the system module\n    const isCompatible = await Utils.checkModuleCompatibility(systemModule.api.requiredCoreModuleVersion)\n    if (!isCompatible) return\n\n    const socketlibModule = game.modules.get('socketlib')\n    if (!socketlibModule || !socketlibModule.active) {\n        Logger.error(\n            'This module requires the \\'socketlib\\' module to be installed and enabled.',\n            true\n        )\n        return\n    }\n\n    // Create new SystemManager and register core and system module settings\n    systemManager = new systemModule.api.SystemManager(MODULE.ID)\n    systemManager.registerStylesCore()\n    systemManager.registerSettingsCore()\n    // Set stylesheet to 'style' core module setting\n    Utils.switchCSS(Utils.getSetting('style'))\n\n    // Register Handlebar helpers\n    Utils.registerHandlebars()\n\n    // Load templates\n    loadTemplates([\n        TEMPLATE.action,\n        TEMPLATE.customStyleForm,\n        TEMPLATE.group,\n        TEMPLATE.hud,\n        TEMPLATE.listGroup,\n        TEMPLATE.settings,\n        TEMPLATE.tabGroup,\n        TEMPLATE.tagDialogGroup,\n        TEMPLATE.tagDialogHud,\n        TEMPLATE.tagDialogTopLevelGroup\n    ])\n\n    Hooks.callAll('tokenActionHudCoreReady')\n})\n\nHooks.on('tokenActionHudCoreReady', async () => {\n    // If no supported color picker modules are active, for the first time only, display a notification\n    if (game.user.isGM && !(game.modules.get('color-picker')?.active ?? false)) {\n        const firstStartup = Utils.getSetting('startup') === false\n        if (firstStartup) {\n            Logger.info(\n                'To enable color pickers in this module\\'s settings, install the \\'Color Picker\\' module.',\n                true\n            )\n            Utils.setSetting('startup', true)\n        }\n    }\n\n    // Create directories for json data\n    const enableCustomizationSetting = Utils.getSetting('enableCustomization')\n    if (game.user.isGM && enableCustomizationSetting) {\n        await DataHandler.createDirectories()\n    }\n\n    // Initialise MigrationManager\n    const migrationManager = new MigrationManager(socket)\n    await migrationManager.init()\n\n    // If no Token Action Hud application exists, create a new TokenActionHud and initialise it\n    if (!game.tokenActionHud) {\n        game.tokenActionHud = new TokenActionHud(module, systemManager)\n        game.tokenActionHud.socket = socket\n        await game.tokenActionHud.init()\n    }\n\n    // Register hooks\n    Hooks.on('renderTokenActionHud', () => game.tokenActionHud.postRender())\n    Hooks.on('deleteActor', (actor, data) => handleHookEvent({ actor, data }, 'deleteActor'))\n    Hooks.on('updateActor', (actor, data) => handleHookEvent({ actor, data }, 'updateActor'))\n    Hooks.on('createActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'createActiveEffect'))\n    Hooks.on('deleteActiveEffect', (activeEffect, options, userId) => handleHookEvent({ activeEffect, options, userId }, 'deleteActiveEffect'))\n    Hooks.on('createCombat', (combat) => handleHookEvent({ combat }, 'createCombat'))\n    Hooks.on('deleteCombat', (combat) => handleHookEvent({ combat }, 'deleteCombat'))\n    Hooks.on('updateCombat', (combat) => handleHookEvent({ combat }, 'updateCombat'))\n    Hooks.on('updateCombatant', (combatant, data, options, userId) => handleHookEvent({ combatant, data, options, userId }, 'updateCombatant'))\n    Hooks.on('deleteCompendium', (source, html) => handleHookEvent({ source, html }, 'deleteCompendium'))\n    Hooks.on('renderCompendium', (source, html) => handleHookEvent({ source, html }, 'renderCompendium'))\n    Hooks.on('updateCompendium', (source, html) => handleHookEvent({ source, html }, 'updateCompendium'))\n    Hooks.on('createItem', (item) => handleHookEvent({ item }, 'createItem'))\n    Hooks.on('deleteItem', (item) => handleHookEvent({ item }, 'deleteItem'))\n    Hooks.on('updateItem', (item) => handleHookEvent({ item }, 'updateItem'))\n    Hooks.on('deleteMacro', () => handleHookEvent({}, 'deleteMacro'))\n    Hooks.on('updateMacro', () => handleHookEvent({}, 'updateMacro'))\n    Hooks.on('controlToken', (token, controlled) => handleHookEvent({ token, controlled }, 'controlToken'))\n    Hooks.on('deleteToken', (scene, token, change, userId) => handleHookEvent({ scene, token, change, userId }, 'deleteToken'))\n    Hooks.on('updateToken', (token, data, diff) => handleHookEvent({ token, data, diff }, 'updateToken'))\n    Hooks.on('closeSettingsConfig', () => handleHookEvent({}, 'closeSettingsConfig'))\n    Hooks.on('forceUpdateTokenActionHud', () => handleHookEvent({}, 'forceUpdateTokenActionHud'))\n\n    function handleHookEvent (hookData, hookName) {\n        const trigger = { type: 'hook', name: hookName, data: hookData }\n        switch (hookName) {\n        case 'deleteActor':\n        case 'updateActor':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.actor, hookData.data)) return\n            break\n        case 'createActiveEffect':\n        case 'deleteActiveEffect':\n            if (!game.tokenActionHud.isSelectedActor(hookData.activeEffect.parent)) return\n            break\n        case 'updateCombatant':\n            if (!game.tokenActionHud.isSelectedActor(hookData.combatant.actor)) return\n            break\n        case 'deleteCompendium':\n        case 'updateCompendium':\n            if (!game.tokenActionHud.actionHandler.compendiumActionHandler.isLinkedCompendium(hookData.source?.metadata?.id)) return\n            game.tokenActionHud.actionHandler.compendiumActionHandler.compendiumActions = new Map()\n            break\n        case 'createItem':\n        case 'deleteItem':\n        case 'updateItem':\n            if (!game.tokenActionHud.isValidActorOrItemUpdate(hookData.item?.actor)) return\n            break\n        case 'deleteMacro':\n        case 'updateMacro':\n            game.tokenActionHud.actionHandler.macroActionHandler.macroActions = null\n            break\n        case 'updateToken':\n            // If it's an X or Y change, assume the token is just moving\n            if (Object.hasOwn(hookData.data, 'y') || Object.hasOwn(hookData.data, 'x')) return\n            // If it's a flag change\n            if (Object.hasOwn(hookData.data, 'flags') && Object.keys(hookData.data).length <= 2) return\n            if (!game.tokenActionHud.isValidTokenChange(hookData.token, hookData.data)) return\n            break\n        }\n        game.tokenActionHud.update(trigger)\n    }\n\n    const trigger = { type: 'hook', name: 'canvasReady' }\n    game.tokenActionHud.update(trigger)\n})\n\n/**\n  * Move the HUD below the scene context menus\n  */\nHooks.on('renderSceneNavigation', (data, html) => {\n    html.find('li.scene.nav-item').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n  * Move the HUD below the hotbar context menus\n  */\nHooks.on('renderHotbar', (data, html) => {\n    html.find('li.macro').contextmenu((ev) => sendHudToBottom())\n})\n\n/**\n * Send HUD to bottom\n */\nfunction sendHudToBottom () {\n    if (!game.tokenActionHud?.element[0]) return\n    game.tokenActionHud.element[0].style.zIndex = 0\n}\n"],"names":["MODULE","ID","NAME","TEMPLATE_DIR","TEMPLATE","action","customStyleForm","group","hud","listGroup","settings","tabGroup","tagDialogGroup","tagDialogHud","tagDialogTopLevelGroup","DELIMITER","ACTION_TYPE","compendiumEntry","compendiumMacro","compendiumPlaylist","macro","COMPENDIUM_ACTION_TYPES","COMPENDIUM_PACK_TYPES","CSS_STYLE","foundryVTT","class","file","moduleId","name","primaryColor","secondaryColor","tertiaryColor","foundryVttLight","compact","dorakoUI","pathfinder","highContrast","custom","CUSTOM_STYLE","backgroundColor","cssProperty","type","String","default","buttonHeight","Number","buttonBackgroundColor","buttonBorderPrimaryColor","buttonBorderSecondaryColor","buttonTextColor","buttonHoverBorderPrimaryColor","buttonHoverBorderSecondaryColor","buttonHoverBackgroundColor","buttonHoverTextColor","buttonToggleActiveBackgroundColor","buttonToggleActiveBorderPrimaryColor","buttonToggleActiveBorderSecondaryColor","buttonToggleActiveTextColor","buttonToggleHoverBackgroundColor","buttonToggleHoverBorderPrimaryColor","buttonToggleHoverBorderSecondaryColor","buttonToggleHoverTextColor","textPrimaryColor","textSecondaryColor","textTertiaryColor","textHoverPrimaryColor","textHoverSecondaryColor","textHoverTertiaryColor","GROUP_TYPE","ITEM_MACRO_ICON","LAYOUT_SETTING","customLayout","hint","inputType","filePickerType","dtype","scope","userCustomLayout","exportLayout","label","icon","onClick","resetLayout","resetAllLayouts","SETTING","activeCssAsText","classes","variable","allow","alwaysShowHud","clickOpenCategory","customStyle","debug","direction","displayCharacterName","displayIcons","drag","enable","enableCustomization","grid","itemMacro","migrationVersion","reset","renderItemOnRightClick","rollHandler","scale","sortActions","startup","style","tooltips","Logger","info","message","notify","ui","notifications","console","log","error","data","game","tokenActionHud","debugSetting","Utils","getSetting","dataClone","deepClone","Timer","constructor","milliseconds","this","timer","start","abort","Promise","resolve","setTimeout","clearTimeout","checkAllow","userRole","allowSetting","original","options","getActor","actorId","tokenId","token","canvas","tokens","placeables","find","id","actor","actors","get","getStatusEffect","statusId","version","startsWith","effects","effect","statuses","every","status","flags","core","getImage","entity","defaultImages","push","result","displayIconsSetting","img","includes","getItem","itemId","items","getToken","getControlledTokens","controlled","getFirstControlledToken","controlledToken","character","user","key","defaultValue","value","setSetting","set","getActorFlag","getFlag","setActorFlag","setFlag","unsetActorFlag","unsetFlag","getUserFlag","setUserFlag","unsetUserFlag","i18n","toTranslate","localize","isGmActive","users","some","isGM","active","isModuleActive","module","modules","getModuleTitle","title","getModuleVersion","humanizeBinding","binding","keybindings","modifiers","reduce","parts","part","KeyboardManager","MODIFIER_CODES","unshift","getKeycodeDisplayString","join","median","numbers","mid","Math","floor","length","nums","sort","a","b","getUpperQuartileAverage","sortedNumbers","slice","endIndex","sum","count","i","ceil","getModifier","sortItems","Map","entries","localeCompare","sortItemsByName","switchCSS","Object","href","values","document","styleSheets","ss","disabled","setting","querySelector","setProperty","tahElement","classList","remove","add","registerHandlebars","Handlebars","registerHelper","string","toUpperCase","reduceOp","args","reducer","Array","from","pop","first","shift","eq","arguments","ne","lt","gt","lte","gte","and","or","true","false","block","activeCssAsTextSetting","fn","inverse","getModuleVersionParts","moduleVersion","trigger","moduleVersionParts","split","major","minor","patch","checkModuleCompatibility","requiredCoreModuleVersion","requiredCoreModuleVersionParts","coreModuleVersionParts","getSubcategories","subcategories","order","subcategoryId","subcategoryType","isArray","foundSubcategories","subcategory","level","nestId","assign","keys","getNestedGroups","groups","groupId","groupType","foundGroups","getGroupByNestId","async","findGroup","groupStyle","foundGroup","deleteGroupByNestId","index","splice","deleteGroupsById","getFileParts","filename","folder","isPersistentStorage","ForgeVTT","DataHandler","init","path","getPath","private","isPrivate","fileMap","getFilePathsAsGm","createDirectories","DATA_FOLDER","moduleDirectory","directoriesToCreate","world","directory","FilePicker","browse","catch","_","createDirectory","dataHandler","hasPermission","files","getFilePaths","socket","executeAsGM","map","actorFiles","userFiles","all","canSaveData","saveDataAsGm","saveData","fileName","encodeURI","File","JSON","stringify","response","upload","has","canGetData","getDataAsGm","getData","foundFile","endsWith","ms","Date","now","fetch","ok","json","saveDataMigrate","folderPath","getDataMigrate","foundFilePath","then","GenericActionHandler","actionHandler","buildGenericActions","buildUtilities","buildSingleTokenUtilities","buildMultipleTokenUtilities","actionsData","actionType","toggleCombatId","toggleCombatName","inCombat","toggleCombatEncodedValue","toggleCombatAction","encodedValue","toggleVisibilityId","toggleVisibilityName","hidden","toggleVisbilityEncodedValue","toggleVisibilityAction","groupData","addActions","toggleVisibilityname","CompendiumActionHandler","compendiumActions","packIds","buildCompendiumActions","size","packs","filter","pack","documentName","visible","metadata","packId","setCompendiumActions","getIndex","getCompendiumActionType","entry","_id","listName","getGroupId","replace","isLinkedCompendium","MacroActionHandler","macroActions","buildMacroActions","getActions","macros","permissions","ownership","userId","ActionHandler","characterName","actionHandlerExtenders","delimiter","genericActionHandler","compendiumActionHandler","macroActionHandler","defaultGroups","defaultLayout","actorGroups","userGroups","actions","availableActionsMap","customLayoutSetting","userCustomLayoutFlag","enableCustomizationSetting","displayCharacterNameSetting","sortActionsSetting","tooltipsSetting","softResetActionHandler","hardResetActionHandler","registerDefaultCategories","buildHud","previousActor","isSameActor","getDefaultGroups","getDefaultLayout","getCustomLayout","isGmInactiveUserNotified","getSavedUserGroups","getSavedActorGroups","prepareHud","buildSystemActions","buildExtendedActions","updateNonPresetActions","setHasActions","setCharacterLimit","saveGroups","getUserGroups","userGroup","createGroup","parentNestId","parentGroup","tabs","lists","getActorGroups","actorGroup","existingGroup","selected","groupIds","forEach","extender","extendActionHandler","nonPresetActions","isPreset","nonPresetAction","availableAction","systemSelected","userSelected","createAction","hasActions","defaults","defaultGroup","layout","saveDataToFile","savedUserData","getGroup","getGroups","getGroupSettings","saveGroupSettings","saveActor","saveUser","keepData","groupDataClone","tooltip","getTooltip","defaultSettings","showTitle","groupSettings","subtitleClass","groupSystem","system","commonProps","cssClass","info1","info2","info3","isSelected","defaultSelected","updateGroups","groupsData","parentGroupData","childGroupData","existingGroups","existingParentGroup","saveActorGroups","saveUserGroups","getReducedGroupData","keepActions","actionData","fullName","infoProps","text","icons","icon1","icon2","icon3","isAction","isItem","isitem","useRawHtmlName","updateActions","reorderedActions","existingAction","actionClone","addToAvailableActions","actionsMap","actionId","getAvailableActions","toActionTagifyEntry","getSelectedActions","getSelectedGroups","toGroupTagifyEntry","getAvailableGroups","getDerivedGroups","getSystemGroups","getCompendiumGroups","getMacroGroups","derivedGroups","addGroup","update","parentGroups","updateGroup","updateExistingGroups","removeGroup","addGroupInfo","groupInfo","existingActions","existingActionId","topLevelGroups","topLevelGroup","topLevelGroupCharacterCount","characterCount","groupCharacterCount","word","addActionHandlerExtender","actionHandlerExtender","addFurtherActionHandler","handler","globalThis","logger","warn","ActionHandlerExtender","extendActionList","MigrationManager","isSuccess","unsetOldFlags","migrateFiles","objects","children","scene","scenes","err","RollHandler","preRollHandlers","throwInvalidValueErr","Error","handleActionClickCore","event","registerKeyPresses","handled","prehandleActionEvent","isGenericAction","handleGenericActionClick","handleActionClick","toString","doHandleActionEvent","handleActionHoverCore","handleActionHover","handleGroupClickCore","handleGroupClick","addPreRollHandler","rightClick","isRightClick","ctrl","isCtrl","alt","isAlt","isShift","renderItem","item","sheet","render","isRenderItem","originalEvent","button","isModiferActive","keyboard","isModifierActive","MODIFIER_KEYS","ALT","altKey","emulateKeypress","force","downKeys","CONTROL","ctrlKey","SHIFT","shiftKey","firstControlledToken","toggleVisibility","toggleCombat","Hooks","callAll","doRenderItem","PreRollHandler","CustomStyleForm","FormApplication","defaultOptions","mergeObject","super","template","width","height","popOut","resizable","closeOnSubmit","activateListeners","html","on","_reset","bind","ColorPicker","install","_updateObject","formData","TahSettingsForm","Function","isButton","isCheckbox","isFilePicker","isNumber","isRange","range","isSelect","undefined","choices","close","updateSettings","TahSettingsFormLayout","onChangeFunction","register","editable","onDown","toggleHud","registerSettingsCore","systemManager","rollHandlers","styles","registerMenu","restricted","config","Boolean","styleChoices","fromEntries","onChange","auto","up","down","min","max","step","always","whenUnlocked","never","requiresReload","full","nameOnly","none","setTooltipDelay","both","registerCustomStyleSettings","registerSettings","doRegisterSettings","ItemMacroActionHandlerExtender","itemacro","command","itemIds","isUnsupportedByMidiQoL","itemMacroSetting","groupKey","addGroupActions","existingItemMacroAction","actionToReplace","macroAction","createItemMacroAction","substr","indexOf","itemMacroIcon","findIndex","CompendiumMacroPreHandler","payload","handleCompendium","handleMacroCompendium","handlePlaylistCompendium","handleMacro","compendiumKey","getDocument","execute","actionPayload","playlistId","soundId","sound","sounds","AudioHelper","play","src","ItemMacroPreRollHandler","tryExecuteItemMacro","executeMacro","e","SystemManager","coreModuleId","getActionHandler","getRollHandler","rollHandlerId","getAvailableRollHandlers","registerDefaults","registerDefaultsCore","func","doRegisterDefaultFlags","registerStylesCore","systemStyles","registerStyles","getActionHandlerCore","doGetActionHandler","addActionHandlerExtenders","getRollHandlerCore","doGetRollHandler","addPreHandlers","addHandler","s","t","r","window","MutationObserver","WebKitMutationObserver","nodeType","observe","childList","subtree","addEventListener","parentElm","uid","selector","callbacks","setup","bindEvents","prototype","namespace","childNodes","parentNode","removeChild","matches","draggable","gap","getItemsGap","firstElementChild","throttle","call","getDraggableElm","closest","dragstart","source","getInitialState","target","getBoundingClientRect","elm","idx","getNodeIndex","dataTransfer","effectAllowed","dragStart","afterDragStart","mode","dragover","preventDefault","stopPropagation","hoverDirection","dropEffect","getTargetDirection","directionAwareDragEnter","dragenter","isValidElm","bounding","cleanupLastTarget","abs","toggle","dragend","dragoverTimeout","cleanup","nextElementSibling","insertBefore","dragEnd","isTargetLastChild","lastElementChild","pageY","top","pageX","left","previousSibling","test","removeAttribute","getComputedStyle","parseInt","listeners","destroy","DragSort","amd","exports","getOwnPropertySymbols","getOwnPropertyDescriptor","enumerable","apply","getOwnPropertyDescriptors","defineProperties","defineProperty","Symbol","toPrimitive","TypeError","configurable","writable","trim","toLowerCase","n","o","createElement","innerHTML","innerText","DOMParser","parseFromString","body","l","d","h","g","hasOwnProperty","p","c","normalize","u","navigator","userAgent","m","crypto","getRandomValues","Uint8Array","v","contains","classNames","tag","f","getSelection","getRangeAt","createTextNode","deleteContents","insertNode","T","__tagifyTagData","w","delimiters","pattern","tagTextProp","maxTags","addTagOnBlur","onChangeAfterBlur","duplicates","whitelist","blacklist","enforceWhitelist","userInput","keepInvalidTags","createInvalidTags","mixTagsAllowedAfter","mixTagsInterpolator","backspace","skipInvalid","pasteAsTags","editTags","clicks","keepInvalid","transformTag","a11y","focusableTags","mixMode","insertAfterTag","autoComplete","enabled","rightKey","selectMode","input","focus","tagNoAnimation","tagInvalid","tagNotAllowed","scopeLoading","hasMaxTags","hasNoTags","empty","inputInvalid","dropdown","dropdownWrapper","dropdownHeader","dropdownFooter","dropdownItem","dropdownItemActive","dropdownItemHidden","dropdownInital","tagText","tagX","tagLoading","tagEditing","tagFlash","tagHide","classname","maxItems","searchKeys","fuzzySearch","caseSensitive","accentedSearch","includeSelectedTags","highlightFirst","closeOnSelect","clearOnSelect","position","appendTarget","hooks","beforeRemoveTag","beforePaste","suggestionClick","_dropdown","refs","y","DOM","parseTemplate","content","getHeaderRef","getFooterRef","getAllSuggestionsRefs","querySelectorAll","dropdownItemSelector","show","state","inputText","templates","dropdownItemNoMatch","isLoading","readonly","dropdownHide__bindEventsTimeout","suggestedListItems","filterListItems","editing","autocomplete","suggest","hide","fill","highlightOption","events","query","setStateSelection","removeEventListener","setAttribute","ddItemData","ddItemElm","selection","flaggedTags","baseOffset","cloneNode","cssText","appendChild","clientHeight","createListHTML","dropdownContent","fillHeaderFooter","replaceChild","refilter","placeAbove","pageYOffset","scrollTop","fullscreenElement","webkitFullscreenElement","documentElement","clientWidth","innerWidth","rangeCount","startContainer","startOffset","createRange","setStart","setEnd","right","bottom","offsetLeft","offsetTop","pageXOffset","onKeyDown","onMouseOver","onMouseLeave","onScroll","hasFocus","composing","dropdownItemActiveSelector","getSuggestionDataByNode","getNextOrPrevOption","ArrowLeft","getMappedValue","tagify","tagData","suggestionElm","selectOption","addTags","raw","charCodeAt","removeTags","editTag","scrollHeight","percentage","round","getAttribute","onEditTagDone","__isValid","normalizeTags","toggleFocusClass","once","selectAll","suggestions","isTagDuplicate","exact","sortby","concat","mapValueTo","mappedValue","x","O","D","exceed","duplicate","notAllowed","M","wrapper","className","required","placeholder","getAttributes","I","customBinding","customEventsList","mainEvents","main","bindGlobal","isJQueryPlugin","jQuery","originalInput","removeAllTags","onFocusBlur","keydown","onKeydown","click","onClickScope","dblclick","onDoubleClickScope","paste","onPaste","drop","onDrop","compositionstart","onCompositionStart","compositionend","onCompositionEnd","clearInterval","originalInputValueObserverInterval","setInterval","observeOriginalInputValue","inputMutationObserver","onInputDOMChange","disconnect","global","isIE","cb","onWindowKeyDown","onClickAnywhere","unbindGlobal","textContent","relatedTarget","addNew","postUpdate","triggerChangeEvent","loading","activeElement","hasAttribute","anchorOffset","anchorNode","getTagElms","previousElementSibling","Element","placeCaretAfterNode","nodeName","nodeValue","blur","inputSuggestion","onInput","onMixTagsInput","inputElm","validateTag","toggleScopeValidation","isValid","search","createDocumentFragment","createTagElem","setRangeAtStartEnd","lastChild","withoutChangeEvent","cloneRange","collapse","focusNode","endOffset","match","lastIndexOf","prefix","matchedPatternCount","onInputIE","tagifyValue","loadOriginalValues","fixFirefoxLastTagNoCaret","clipboardData","pastedText","injectAtCaret","onEditTagInput","__tagId","editTagChangeDetected","originalIsValid","newValue","onEditTagPaste","onEditTagFocus","onEditTagBlur","__originalData","onEditTagkeydown","__originalHTML","addedNodes","outerHTML","replaceWith","tagSelector","nextSibling","removedNodes","N","Proxy","__tagify","off","cloneData","triggerHandler","cloneEvent","HTMLElement","CustomEvent","detail","dispatchEvent","isFirefox","documentMode","getPersistedData","localStorage","parse","setPersistedData","setItem","Event","clearPersistedData","removeItem","applySettings","build","getCSSVars","autofocus","getSetTagData","helpers","sameStr","removeCollectionProp","omit","isObject","parseHTML","escapeHTML","extend","concatWithoutDups","getUID","isNodeTag","dataProps","generateClassSelectors","RegExp","_delimiters","TEXTS","texts","getCustomAttributes","CSSVars","tagHideTransition","unit","getPropertyValue","integrated","originalInput_tabIndex","tabIndex","inputSelector","blockChangeEvent","parseMixTags","tagName","insertAdjacentHTML","lastOriginalValueReported","toggleClass","bubbles","simulated","_valueTracker","setValue","random","setStartAfter","removeAllRanges","addRange","getTagTextNode","tagTextSelector","setTagTextNode","getLastTag","skipValidation","editTagToggleValidity","removeTagsFromValue","previousData","replaceTag","reCheckInvalidTags","getInvalidTagAttrs","updateValueByDOMTags","appendMixTags","validate","charAt","substring","replaceTextWithNode","getTagIdx","getTagIndexByValue","getTagElmByValue","flashTag","isTagBlacklisted","isTagWhitelisted","getWhitelistItem","setReadonly","setContentEditable","contentEditable","setDisabled","splitText","selectTag","appendTag","addEmptyTag","addMixTags","__preInvalidData","prefixedTextToTag","createNodeIterator","NodeFilter","SHOW_TEXT","nextNode","node","__removed","parseFloat","clientTop","removeTagsFromDOM","setOriginalInputValue","debouncedUpdateTimeout","getInputValue","getCleanValue","getMixedTagsAsString","originalInputValueFormat","removeTag","TagDialog","dragSort","submit","categoryId","foundry","utils","resetActions","showDialog","dialogType","tags","dialogData","dialogSubmit","_prepareHook","dialog","TagDialogHud","TagDialogTopLevelGroup","TagDialogGroup","app","$tagFilter","tagifyOptions","Infinity","onDragEnd","available","Tagify","dropdownLabelElement","setPosition","Dialog","buttons","yes","callback","resetActorData","no","_onKeyDown","defaultChoice","slugify","replacement","strict","navSelector","contentSelector","initial","TagDialogHelper","showHudDialog","topLabel","showGroupDialog","choice","customWidth","image","showActionDialog","availableActions","availableSubcategories","selectedActions","selectedGroups","GroupResizer","minCols","isCustomWidth","spacing","resizeGroup","groupElement","autoDirection","gridModuleSetting","resetVariables","getGroupsElement","groupsElement","actionsElements","resetGroupsElements","dataset","availableWidth","getAvailableWidth","getGroupElements","hasGrid","groupElements","actionsElement","groupCustomWidth","getGridWidth","resizeGrid","resize","setHeight","availableHeight","gridWidth","groupsElementPadding","groupsElementRect","groupsElements","resetCSS","maxHeight","overflowY","display","gridTemplateColumns","actionWidths","actionWidthsForMedian","actionElements","actionElement","actionRect","actionWidth","actionButtonText","actionButtonTextRect","actionButtonTextWidth","upperQuartileAverage","availableactionButtonTextWidth","assignCSS","squaredCols","sqrt","availableGroupWidth","availableCols","sqrtActions","currentRow","maxRowWidth","rowWidth","maxWidth","windowWidth","screenDimensions","contentLeft","uiRightClientWidth","getAvailableHeight","windowHeight","innerHeight","contentBottom","contentTop","uiTopBottomOffsetHeight","offsetHeight","groupsElementComputed","paddingLeft","paddingRight","requestAnimationFrame","element","elements","TokenActionHud","Application","hoveredGroups","defaultHeight","defaultWidth","defaultLeftPos","defaultTopPos","leftPos","topPos","defaultScale","refreshTimeout","rendering","isUpdatePending","isUpdating","updatePendingTimer","updateTimer","directionSetting","alwaysShowSetting","clickOpenCategorySetting","isCollapsed","dragSetting","enableSetting","isHudEnabled","gridSetting","isUnlocked","styleSetting","scaleSetting","getHudEnabled","hudPosition","updateSettingsPending","updateRollHandler","background","minimizable","dragDrop","scrollY","zIndex","isDraggable","getScale","editHudButton","listGroups","subtitle","groupButton","collapseHudButton","expandHudButton","unlockButton","lockButton","bindGroupEvents","bindActionEvents","bindEditHudButton","bindLockUnlockButtons","bindCollapseExpandButtons","postRender","closeGroup","currentTarget","parentElement","closestGroupElement","sibling","clearHoveredGroup","openGroup","setHoveredGroup","toggleGroup","bringToTop","passive","hover","dragEvent","actionClick","actionHover","groupClick","openGroupDialog","outerText","openActionDialog","collapseExpandGroup","collapseIcon","expandIcon","imageElement","toggleGroupVisibility","unlockHud","$","addClass","removeClass","lockHud","topGroupElement","getElementsByClassName","listGroupsElement","subtitleElement","collapseHud","getElementById","clientX","changedTouches","clientY","pos1","pos2","pos3","pos4","originalElementTop","originalElementLeft","newElementTop","newElementLeft","mouseMoveEvent","mouseUpEvent","onmousemove","ontouchmove","onmouseup","ontouchend","getAutoDirection","setPositionFromFlag","restoreHoveredGroups","check","resetPosition","mouseenter","format","copy","fromUserId","toUserIds","copyUserData","fromGroup","resetDialog","customLayoutElement","userCustomLayoutElement","resetAllDialog","executeForEveryone","resetUserAndActorData","resetAllActorData","resetUserData","resetAllUserData","handleUpdate","performUpdate","waitForUpdateCompletion","maxWaitTime","previousActorId","controlledTokens","getCharacter","multipleTokens","windows","appId","isValidTokenChange","actorData","isRelevantToken","isSelectedActor","isValidActorOrItemUpdate","isValidCharacter","testUserPermission","role","sendHudToBottom","socketlib","registerModule","ActionListExtender","api","systemModule","socketlibModule","loadTemplates","migrationManager","handleHookEvent","hookData","hookName","activeEffect","parent","combatant","hasOwn","combat","change","diff","contextmenu","ev"],"mappings":"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","x_google_ignoreList":[18,19]}