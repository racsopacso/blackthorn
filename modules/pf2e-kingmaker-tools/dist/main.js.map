{"version":3,"file":"main.js","mappings":"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","sources":["webpack://pf2e-kingmaker-tools/./node_modules/joi/dist/joi-browser.min.js","webpack://pf2e-kingmaker-tools/./node_modules/luxon/build/node/luxon.js","webpack://pf2e-kingmaker-tools/./src/armies/data.ts","webpack://pf2e-kingmaker-tools/./src/armies/dialogs/army-setup.ts","webpack://pf2e-kingmaker-tools/./src/armies/dialogs/disable.ts","webpack://pf2e-kingmaker-tools/./src/armies/hooks.ts","webpack://pf2e-kingmaker-tools/./src/armies/sheet.ts","webpack://pf2e-kingmaker-tools/./src/armies/storage.ts","webpack://pf2e-kingmaker-tools/./src/armies/utils.ts","webpack://pf2e-kingmaker-tools/./src/camping/activities.ts","webpack://pf2e-kingmaker-tools/./src/camping/actor.ts","webpack://pf2e-kingmaker-tools/./src/camping/camping.ts","webpack://pf2e-kingmaker-tools/./src/camping/chat.ts","webpack://pf2e-kingmaker-tools/./src/camping/combat-tracks.ts","webpack://pf2e-kingmaker-tools/./src/camping/data.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/add-activity.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/add-recipe.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/ask-dc.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/camping-settings.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/learn-recipe.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/manage-activities.ts","webpack://pf2e-kingmaker-tools/./src/camping/dialogs/manage-recipes.ts","webpack://pf2e-kingmaker-tools/./src/camping/eating.ts","webpack://pf2e-kingmaker-tools/./src/camping/effect-syncing.ts","webpack://pf2e-kingmaker-tools/./src/camping/random-encounters.ts","webpack://pf2e-kingmaker-tools/./src/camping/recipes.ts","webpack://pf2e-kingmaker-tools/./src/camping/regions.ts","webpack://pf2e-kingmaker-tools/./src/camping/resting.ts","webpack://pf2e-kingmaker-tools/./src/camping/sheet.ts","webpack://pf2e-kingmaker-tools/./src/camping/storage.ts","webpack://pf2e-kingmaker-tools/./src/camping/view.ts","webpack://pf2e-kingmaker-tools/./src/common/skills-dialog.ts","webpack://pf2e-kingmaker-tools/./src/degree-of-success.ts","webpack://pf2e-kingmaker-tools/./src/foundry-utils.ts","webpack://pf2e-kingmaker-tools/./src/kingdom-events.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/chat-buttons.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/abilities.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/activities.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/activityData.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/companions.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/feats.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/features.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/kingdom.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/leaders.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/ruin.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/skills.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/structures.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/data/unrest.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/activities-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/add-activity-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/add-bonus-feat-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/add-effect-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/add-group-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/add-ongoing-event-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/check-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/edit-settlement-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/edit-structure-rules.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/kingdom-settings.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/kingdom-size-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/realm-tile-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/settlement-size-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/settlement.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/setup-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/show-help-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/structure-browser.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/dialogs/structure-token-mapping-dialog.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/kingdom-utils.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/modifiers.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/resources.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/rolls.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/scene.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/schema.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/sheet.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/skills.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/storage.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/structures.ts","webpack://pf2e-kingmaker-tools/./src/kingdom/xp.ts","webpack://pf2e-kingmaker-tools/./src/macros.ts","webpack://pf2e-kingmaker-tools/./src/migrations.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration2.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration3.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration4.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration5.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration6.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration7.ts","webpack://pf2e-kingmaker-tools/./src/migrations/migration8.ts","webpack://pf2e-kingmaker-tools/./src/roll-tables.ts","webpack://pf2e-kingmaker-tools/./src/settings.ts","webpack://pf2e-kingmaker-tools/./src/skill-checks.ts","webpack://pf2e-kingmaker-tools/./src/time/app.ts","webpack://pf2e-kingmaker-tools/./src/time/calculation.ts","webpack://pf2e-kingmaker-tools/./src/time/format.ts","webpack://pf2e-kingmaker-tools/./src/utils.ts","webpack://pf2e-kingmaker-tools/./src/weather/data.ts","webpack://pf2e-kingmaker-tools/./src/weather/dialogs/scene-weather-settings.ts","webpack://pf2e-kingmaker-tools/./src/weather/dialogs/set-current-weather.ts","webpack://pf2e-kingmaker-tools/./src/weather/roll-weather.ts","webpack://pf2e-kingmaker-tools/./src/weather/weather.ts","webpack://pf2e-kingmaker-tools/webpack/bootstrap","webpack://pf2e-kingmaker-tools/./src/index.ts"],"sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.joi=t():e.joi=t()}(self,(()=>{return e={7629:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(9474),i=r(1687),o=r(8652),l=r(8160),c=r(3292),u=r(6354),f=r(8901),m=r(9708),h=r(6914),d=r(2294),p=r(6133),g=r(1152),y=r(8863),b=r(2036),v={Base:class{constructor(e){this.type=e,this.$_root=null,this._definition={},this._reset()}_reset(){this._ids=new d.Ids,this._preferences=null,this._refs=new p.Manager,this._cache=null,this._valids=null,this._invalids=null,this._flags={},this._rules=[],this._singleRules=new Map,this.$_terms={},this.$_temp={ruleset:null,whens:{}}}describe(){return s(\"function\"==typeof m.describe,\"Manifest functionality disabled\"),m.describe(this)}allow(...e){return l.verifyFlat(e,\"allow\"),this._values(e,\"_valids\")}alter(e){s(e&&\"object\"==typeof e&&!Array.isArray(e),\"Invalid targets argument\"),s(!this._inRuleset(),\"Cannot set alterations inside a ruleset\");const t=this.clone();t.$_terms.alterations=t.$_terms.alterations||[];for(const r in e){const n=e[r];s(\"function\"==typeof n,\"Alteration adjuster for\",r,\"must be a function\"),t.$_terms.alterations.push({target:r,adjuster:n})}return t.$_temp.ruleset=!1,t}artifact(e){return s(void 0!==e,\"Artifact cannot be undefined\"),s(!this._cache,\"Cannot set an artifact with a rule cache\"),this.$_setFlag(\"artifact\",e)}cast(e){return s(!1===e||\"string\"==typeof e,\"Invalid to value\"),s(!1===e||this._definition.cast[e],\"Type\",this.type,\"does not support casting to\",e),this.$_setFlag(\"cast\",!1===e?void 0:e)}default(e,t){return this._default(\"default\",e,t)}description(e){return s(e&&\"string\"==typeof e,\"Description must be a non-empty string\"),this.$_setFlag(\"description\",e)}empty(e){const t=this.clone();return void 0!==e&&(e=t.$_compile(e,{override:!1})),t.$_setFlag(\"empty\",e,{clone:!1})}error(e){return s(e,\"Missing error\"),s(e instanceof Error||\"function\"==typeof e,\"Must provide a valid Error object or a function\"),this.$_setFlag(\"error\",e)}example(e,t={}){return s(void 0!==e,\"Missing example\"),l.assertOptions(t,[\"override\"]),this._inner(\"examples\",e,{single:!0,override:t.override})}external(e,t){return\"object\"==typeof e&&(s(!t,\"Cannot combine options with description\"),t=e.description,e=e.method),s(\"function\"==typeof e,\"Method must be a function\"),s(void 0===t||t&&\"string\"==typeof t,\"Description must be a non-empty string\"),this._inner(\"externals\",{method:e,description:t},{single:!0})}failover(e,t){return this._default(\"failover\",e,t)}forbidden(){return this.presence(\"forbidden\")}id(e){return e?(s(\"string\"==typeof e,\"id must be a non-empty string\"),s(/^[^\\.]+$/.test(e),\"id cannot contain period character\"),this.$_setFlag(\"id\",e)):this.$_setFlag(\"id\",void 0)}invalid(...e){return this._values(e,\"_invalids\")}label(e){return s(e&&\"string\"==typeof e,\"Label name must be a non-empty string\"),this.$_setFlag(\"label\",e)}meta(e){return s(void 0!==e,\"Meta cannot be undefined\"),this._inner(\"metas\",e,{single:!0})}note(...e){s(e.length,\"Missing notes\");for(const t of e)s(t&&\"string\"==typeof t,\"Notes must be non-empty strings\");return this._inner(\"notes\",e)}only(e=!0){return s(\"boolean\"==typeof e,\"Invalid mode:\",e),this.$_setFlag(\"only\",e)}optional(){return this.presence(\"optional\")}prefs(e){s(e,\"Missing preferences\"),s(void 0===e.context,\"Cannot override context\"),s(void 0===e.externals,\"Cannot override externals\"),s(void 0===e.warnings,\"Cannot override warnings\"),s(void 0===e.debug,\"Cannot override debug\"),l.checkPreferences(e);const t=this.clone();return t._preferences=l.preferences(t._preferences,e),t}presence(e){return s([\"optional\",\"required\",\"forbidden\"].includes(e),\"Unknown presence mode\",e),this.$_setFlag(\"presence\",e)}raw(e=!0){return this.$_setFlag(\"result\",e?\"raw\":void 0)}result(e){return s([\"raw\",\"strip\"].includes(e),\"Unknown result mode\",e),this.$_setFlag(\"result\",e)}required(){return this.presence(\"required\")}strict(e){const t=this.clone(),r=void 0!==e&&!e;return t._preferences=l.preferences(t._preferences,{convert:r}),t}strip(e=!0){return this.$_setFlag(\"result\",e?\"strip\":void 0)}tag(...e){s(e.length,\"Missing tags\");for(const t of e)s(t&&\"string\"==typeof t,\"Tags must be non-empty strings\");return this._inner(\"tags\",e)}unit(e){return s(e&&\"string\"==typeof e,\"Unit name must be a non-empty string\"),this.$_setFlag(\"unit\",e)}valid(...e){l.verifyFlat(e,\"valid\");const t=this.allow(...e);return t.$_setFlag(\"only\",!!t._valids,{clone:!1}),t}when(e,t){const r=this.clone();r.$_terms.whens||(r.$_terms.whens=[]);const n=c.when(r,e,t);if(![\"any\",\"link\"].includes(r.type)){const e=n.is?[n]:n.switch;for(const t of e)s(!t.then||\"any\"===t.then.type||t.then.type===r.type,\"Cannot combine\",r.type,\"with\",t.then&&t.then.type),s(!t.otherwise||\"any\"===t.otherwise.type||t.otherwise.type===r.type,\"Cannot combine\",r.type,\"with\",t.otherwise&&t.otherwise.type)}return r.$_terms.whens.push(n),r.$_mutateRebuild()}cache(e){s(!this._inRuleset(),\"Cannot set caching inside a ruleset\"),s(!this._cache,\"Cannot override schema cache\"),s(void 0===this._flags.artifact,\"Cannot cache a rule with an artifact\");const t=this.clone();return t._cache=e||o.provider.provision(),t.$_temp.ruleset=!1,t}clone(){const e=Object.create(Object.getPrototypeOf(this));return this._assign(e)}concat(e){s(l.isSchema(e),\"Invalid schema object\"),s(\"any\"===this.type||\"any\"===e.type||e.type===this.type,\"Cannot merge type\",this.type,\"with another type:\",e.type),s(!this._inRuleset(),\"Cannot concatenate onto a schema with open ruleset\"),s(!e._inRuleset(),\"Cannot concatenate a schema with open ruleset\");let t=this.clone();if(\"any\"===this.type&&\"any\"!==e.type){const r=e.clone();for(const e of Object.keys(t))\"type\"!==e&&(r[e]=t[e]);t=r}t._ids.concat(e._ids),t._refs.register(e,p.toSibling),t._preferences=t._preferences?l.preferences(t._preferences,e._preferences):e._preferences,t._valids=b.merge(t._valids,e._valids,e._invalids),t._invalids=b.merge(t._invalids,e._invalids,e._valids);for(const r of e._singleRules.keys())t._singleRules.has(r)&&(t._rules=t._rules.filter((e=>e.keep||e.name!==r)),t._singleRules.delete(r));for(const r of e._rules)e._definition.rules[r.method].multi||t._singleRules.set(r.name,r),t._rules.push(r);if(t._flags.empty&&e._flags.empty){t._flags.empty=t._flags.empty.concat(e._flags.empty);const r=Object.assign({},e._flags);delete r.empty,i(t._flags,r)}else if(e._flags.empty){t._flags.empty=e._flags.empty;const r=Object.assign({},e._flags);delete r.empty,i(t._flags,r)}else i(t._flags,e._flags);for(const r in e.$_terms){const s=e.$_terms[r];s?t.$_terms[r]?t.$_terms[r]=t.$_terms[r].concat(s):t.$_terms[r]=s.slice():t.$_terms[r]||(t.$_terms[r]=s)}return this.$_root._tracer&&this.$_root._tracer._combine(t,[this,e]),t.$_mutateRebuild()}extend(e){return s(!e.base,\"Cannot extend type with another base\"),f.type(this,e)}extract(e){return e=Array.isArray(e)?e:e.split(\".\"),this._ids.reach(e)}fork(e,t){s(!this._inRuleset(),\"Cannot fork inside a ruleset\");let r=this;for(let s of[].concat(e))s=Array.isArray(s)?s:s.split(\".\"),r=r._ids.fork(s,t,r);return r.$_temp.ruleset=!1,r}rule(e){const t=this._definition;l.assertOptions(e,Object.keys(t.modifiers)),s(!1!==this.$_temp.ruleset,\"Cannot apply rules to empty ruleset or the last rule added does not support rule properties\");const r=null===this.$_temp.ruleset?this._rules.length-1:this.$_temp.ruleset;s(r>=0&&r<this._rules.length,\"Cannot apply rules to empty ruleset\");const a=this.clone();for(let i=r;i<a._rules.length;++i){const r=a._rules[i],o=n(r);for(const n in e)t.modifiers[n](o,e[n]),s(o.name===r.name,\"Cannot change rule name\");a._rules[i]=o,a._singleRules.get(o.name)===r&&a._singleRules.set(o.name,o)}return a.$_temp.ruleset=!1,a.$_mutateRebuild()}get ruleset(){s(!this._inRuleset(),\"Cannot start a new ruleset without closing the previous one\");const e=this.clone();return e.$_temp.ruleset=e._rules.length,e}get $(){return this.ruleset}tailor(e){e=[].concat(e),s(!this._inRuleset(),\"Cannot tailor inside a ruleset\");let t=this;if(this.$_terms.alterations)for(const{target:r,adjuster:n}of this.$_terms.alterations)e.includes(r)&&(t=n(t),s(l.isSchema(t),\"Alteration adjuster for\",r,\"failed to return a schema object\"));return t=t.$_modify({each:t=>t.tailor(e),ref:!1}),t.$_temp.ruleset=!1,t.$_mutateRebuild()}tracer(){return g.location?g.location(this):this}validate(e,t){return y.entry(e,this,t)}validateAsync(e,t){return y.entryAsync(e,this,t)}$_addRule(e){\"string\"==typeof e&&(e={name:e}),s(e&&\"object\"==typeof e,\"Invalid options\"),s(e.name&&\"string\"==typeof e.name,\"Invalid rule name\");for(const t in e)s(\"_\"!==t[0],\"Cannot set private rule properties\");const t=Object.assign({},e);t._resolve=[],t.method=t.method||t.name;const r=this._definition.rules[t.method],n=t.args;s(r,\"Unknown rule\",t.method);const a=this.clone();if(n){s(1===Object.keys(n).length||Object.keys(n).length===this._definition.rules[t.name].args.length,\"Invalid rule definition for\",this.type,t.name);for(const e in n){let i=n[e];if(r.argsByName){const o=r.argsByName.get(e);if(o.ref&&l.isResolvable(i))t._resolve.push(e),a.$_mutateRegister(i);else if(o.normalize&&(i=o.normalize(i),n[e]=i),o.assert){const t=l.validateArg(i,e,o);s(!t,t,\"or reference\")}}void 0!==i?n[e]=i:delete n[e]}}return r.multi||(a._ruleRemove(t.name,{clone:!1}),a._singleRules.set(t.name,t)),!1===a.$_temp.ruleset&&(a.$_temp.ruleset=null),r.priority?a._rules.unshift(t):a._rules.push(t),a}$_compile(e,t){return c.schema(this.$_root,e,t)}$_createError(e,t,r,s,n,a={}){const i=!1!==a.flags?this._flags:{},o=a.messages?h.merge(this._definition.messages,a.messages):this._definition.messages;return new u.Report(e,t,r,i,o,s,n)}$_getFlag(e){return this._flags[e]}$_getRule(e){return this._singleRules.get(e)}$_mapLabels(e){return e=Array.isArray(e)?e:e.split(\".\"),this._ids.labels(e)}$_match(e,t,r,s){(r=Object.assign({},r)).abortEarly=!0,r._externals=!1,t.snapshot();const n=!y.validate(e,this,t,r,s).errors;return t.restore(),n}$_modify(e){return l.assertOptions(e,[\"each\",\"once\",\"ref\",\"schema\"]),d.schema(this,e)||this}$_mutateRebuild(){return s(!this._inRuleset(),\"Cannot add this rule inside a ruleset\"),this._refs.reset(),this._ids.reset(),this.$_modify({each:(e,{source:t,name:r,path:s,key:n})=>{const a=this._definition[t][r]&&this._definition[t][r].register;!1!==a&&this.$_mutateRegister(e,{family:a,key:n})}}),this._definition.rebuild&&this._definition.rebuild(this),this.$_temp.ruleset=!1,this}$_mutateRegister(e,{family:t,key:r}={}){this._refs.register(e,t),this._ids.register(e,{key:r})}$_property(e){return this._definition.properties[e]}$_reach(e){return this._ids.reach(e)}$_rootReferences(){return this._refs.roots()}$_setFlag(e,t,r={}){s(\"_\"===e[0]||!this._inRuleset(),\"Cannot set flag inside a ruleset\");const n=this._definition.flags[e]||{};if(a(t,n.default)&&(t=void 0),a(t,this._flags[e]))return this;const i=!1!==r.clone?this.clone():this;return void 0!==t?(i._flags[e]=t,i.$_mutateRegister(t)):delete i._flags[e],\"_\"!==e[0]&&(i.$_temp.ruleset=!1),i}$_parent(e,...t){return this[e][l.symbols.parent].call(this,...t)}$_validate(e,t,r){return y.validate(e,this,t,r)}_assign(e){e.type=this.type,e.$_root=this.$_root,e.$_temp=Object.assign({},this.$_temp),e.$_temp.whens={},e._ids=this._ids.clone(),e._preferences=this._preferences,e._valids=this._valids&&this._valids.clone(),e._invalids=this._invalids&&this._invalids.clone(),e._rules=this._rules.slice(),e._singleRules=n(this._singleRules,{shallow:!0}),e._refs=this._refs.clone(),e._flags=Object.assign({},this._flags),e._cache=null,e.$_terms={};for(const t in this.$_terms)e.$_terms[t]=this.$_terms[t]?this.$_terms[t].slice():null;e.$_super={};for(const t in this.$_super)e.$_super[t]=this._super[t].bind(e);return e}_bare(){const e=this.clone();e._reset();const t=e._definition.terms;for(const r in t){const s=t[r];e.$_terms[r]=s.init}return e.$_mutateRebuild()}_default(e,t,r={}){return l.assertOptions(r,\"literal\"),s(void 0!==t,\"Missing\",e,\"value\"),s(\"function\"==typeof t||!r.literal,\"Only function value supports literal option\"),\"function\"==typeof t&&r.literal&&(t={[l.symbols.literal]:!0,literal:t}),this.$_setFlag(e,t)}_generate(e,t,r){if(!this.$_terms.whens)return{schema:this};const s=[],n=[];for(let a=0;a<this.$_terms.whens.length;++a){const i=this.$_terms.whens[a];if(i.concat){s.push(i.concat),n.push(`${a}.concat`);continue}const o=i.ref?i.ref.resolve(e,t,r):e,l=i.is?[i]:i.switch,c=n.length;for(let c=0;c<l.length;++c){const{is:u,then:f,otherwise:m}=l[c],h=`${a}${i.switch?\".\"+c:\"\"}`;if(u.$_match(o,t.nest(u,`${h}.is`),r)){if(f){const a=t.localize([...t.path,`${h}.then`],t.ancestors,t.schemas),{schema:i,id:o}=f._generate(e,a,r);s.push(i),n.push(`${h}.then${o?`(${o})`:\"\"}`);break}}else if(m){const a=t.localize([...t.path,`${h}.otherwise`],t.ancestors,t.schemas),{schema:i,id:o}=m._generate(e,a,r);s.push(i),n.push(`${h}.otherwise${o?`(${o})`:\"\"}`);break}}if(i.break&&n.length>c)break}const a=n.join(\", \");if(t.mainstay.tracer.debug(t,\"rule\",\"when\",a),!a)return{schema:this};if(!t.mainstay.tracer.active&&this.$_temp.whens[a])return{schema:this.$_temp.whens[a],id:a};let i=this;this._definition.generate&&(i=this._definition.generate(this,e,t,r));for(const e of s)i=i.concat(e);return this.$_root._tracer&&this.$_root._tracer._combine(i,[this,...s]),this.$_temp.whens[a]=i,{schema:i,id:a}}_inner(e,t,r={}){s(!this._inRuleset(),`Cannot set ${e} inside a ruleset`);const n=this.clone();return n.$_terms[e]&&!r.override||(n.$_terms[e]=[]),r.single?n.$_terms[e].push(t):n.$_terms[e].push(...t),n.$_temp.ruleset=!1,n}_inRuleset(){return null!==this.$_temp.ruleset&&!1!==this.$_temp.ruleset}_ruleRemove(e,t={}){if(!this._singleRules.has(e))return this;const r=!1!==t.clone?this.clone():this;r._singleRules.delete(e);const s=[];for(let t=0;t<r._rules.length;++t){const n=r._rules[t];n.name!==e||n.keep?s.push(n):r._inRuleset()&&t<r.$_temp.ruleset&&--r.$_temp.ruleset}return r._rules=s,r}_values(e,t){l.verifyFlat(e,t.slice(1,-1));const r=this.clone(),n=e[0]===l.symbols.override;if(n&&(e=e.slice(1)),!r[t]&&e.length?r[t]=new b:n&&(r[t]=e.length?new b:null,r.$_mutateRebuild()),!r[t])return r;n&&r[t].override();for(const n of e){s(void 0!==n,\"Cannot call allow/valid/invalid with undefined\"),s(n!==l.symbols.override,\"Override must be the first value\");const e=\"_invalids\"===t?\"_valids\":\"_invalids\";r[e]&&(r[e].remove(n),r[e].length||(s(\"_valids\"===t||!r._flags.only,\"Setting invalid value\",n,\"leaves schema rejecting all values due to previous valid rule\"),r[e]=null)),r[t].add(n,r._refs)}return r}}};v.Base.prototype[l.symbols.any]={version:l.version,compile:c.compile,root:\"$_root\"},v.Base.prototype.isImmutable=!0,v.Base.prototype.deny=v.Base.prototype.invalid,v.Base.prototype.disallow=v.Base.prototype.invalid,v.Base.prototype.equal=v.Base.prototype.valid,v.Base.prototype.exist=v.Base.prototype.required,v.Base.prototype.not=v.Base.prototype.invalid,v.Base.prototype.options=v.Base.prototype.prefs,v.Base.prototype.preferences=v.Base.prototype.prefs,e.exports=new v.Base},8652:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(8160),i={max:1e3,supported:new Set([\"undefined\",\"boolean\",\"number\",\"string\"])};t.provider={provision:e=>new i.Cache(e)},i.Cache=class{constructor(e={}){a.assertOptions(e,[\"max\"]),s(void 0===e.max||e.max&&e.max>0&&isFinite(e.max),\"Invalid max cache size\"),this._max=e.max||i.max,this._map=new Map,this._list=new i.List}get length(){return this._map.size}set(e,t){if(null!==e&&!i.supported.has(typeof e))return;let r=this._map.get(e);if(r)return r.value=t,void this._list.first(r);r=this._list.unshift({key:e,value:t}),this._map.set(e,r),this._compact()}get(e){const t=this._map.get(e);if(t)return this._list.first(t),n(t.value)}_compact(){if(this._map.size>this._max){const e=this._list.pop();this._map.delete(e.key)}}},i.List=class{constructor(){this.tail=null,this.head=null}unshift(e){return e.next=null,e.prev=this.head,this.head&&(this.head.next=e),this.head=e,this.tail||(this.tail=e),e}first(e){e!==this.head&&(this._remove(e),this.unshift(e))}pop(){return this._remove(this.tail)}_remove(e){const{next:t,prev:r}=e;return t.prev=r,r&&(r.next=t),e===this.tail&&(this.tail=t),e.prev=null,e.next=null,e}}},8160:(e,t,r)=>{\"use strict\";const s=r(375),n=r(7916),a=r(5934);let i,o;const l={isoDate:/^(?:[-+]\\d{2})?(?:\\d{4}(?!\\d{2}\\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\\1(?:[12]\\d|0[1-9]|3[01]))?|W(?:[0-4]\\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\\d|[12]\\d{2}|3(?:[0-5]\\d|6[1-6])))(?![T]$|[T][\\d]+Z$)(?:[T\\s](?:(?:(?:[01]\\d|2[0-3])(?:(:?)[0-5]\\d)?|24\\:?00)(?:[.,]\\d+(?!:))?)(?:\\2[0-5]\\d(?:[.,]\\d+)?)?(?:[Z]|(?:[+-])(?:[01]\\d|2[0-3])(?::?[0-5]\\d)?)?)?)?$/};t.version=a.version,t.defaults={abortEarly:!0,allowUnknown:!1,artifacts:!1,cache:!0,context:null,convert:!0,dateFormat:\"iso\",errors:{escapeHtml:!1,label:\"path\",language:null,render:!0,stack:!1,wrap:{label:'\"',array:\"[]\"}},externals:!0,messages:{},nonEnumerables:!1,noDefaults:!1,presence:\"optional\",skipFunctions:!1,stripUnknown:!1,warnings:!1},t.symbols={any:Symbol.for(\"@hapi/joi/schema\"),arraySingle:Symbol(\"arraySingle\"),deepDefault:Symbol(\"deepDefault\"),errors:Symbol(\"errors\"),literal:Symbol(\"literal\"),override:Symbol(\"override\"),parent:Symbol(\"parent\"),prefs:Symbol(\"prefs\"),ref:Symbol(\"ref\"),template:Symbol(\"template\"),values:Symbol(\"values\")},t.assertOptions=function(e,t,r=\"Options\"){s(e&&\"object\"==typeof e&&!Array.isArray(e),\"Options must be of type object\");const n=Object.keys(e).filter((e=>!t.includes(e)));s(0===n.length,`${r} contain unknown keys: ${n}`)},t.checkPreferences=function(e){o=o||r(3378);const t=o.preferences.validate(e);if(t.error)throw new n([t.error.details[0].message])},t.compare=function(e,t,r){switch(r){case\"=\":return e===t;case\">\":return e>t;case\"<\":return e<t;case\">=\":return e>=t;case\"<=\":return e<=t}},t.default=function(e,t){return void 0===e?t:e},t.isIsoDate=function(e){return l.isoDate.test(e)},t.isNumber=function(e){return\"number\"==typeof e&&!isNaN(e)},t.isResolvable=function(e){return!!e&&(e[t.symbols.ref]||e[t.symbols.template])},t.isSchema=function(e,r={}){const n=e&&e[t.symbols.any];return!!n&&(s(r.legacy||n.version===t.version,\"Cannot mix different versions of joi schemas\"),!0)},t.isValues=function(e){return e[t.symbols.values]},t.limit=function(e){return Number.isSafeInteger(e)&&e>=0},t.preferences=function(e,s){i=i||r(6914),e=e||{},s=s||{};const n=Object.assign({},e,s);return s.errors&&e.errors&&(n.errors=Object.assign({},e.errors,s.errors),n.errors.wrap=Object.assign({},e.errors.wrap,s.errors.wrap)),s.messages&&(n.messages=i.compile(s.messages,e.messages)),delete n[t.symbols.prefs],n},t.tryWithPath=function(e,t,r={}){try{return e()}catch(e){throw void 0!==e.path?e.path=t+\".\"+e.path:e.path=t,r.append&&(e.message=`${e.message} (${e.path})`),e}},t.validateArg=function(e,r,{assert:s,message:n}){if(t.isSchema(s)){const t=s.validate(e);if(!t.error)return;return t.error.message}if(!s(e))return r?`${r} ${n}`:n},t.verifyFlat=function(e,t){for(const r of e)s(!Array.isArray(r),\"Method no longer accepts array arguments:\",t)}},3292:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8160),a=r(6133),i={};t.schema=function(e,t,r={}){n.assertOptions(r,[\"appendPath\",\"override\"]);try{return i.schema(e,t,r)}catch(e){throw r.appendPath&&void 0!==e.path&&(e.message=`${e.message} (${e.path})`),e}},i.schema=function(e,t,r){s(void 0!==t,\"Invalid undefined schema\"),Array.isArray(t)&&(s(t.length,\"Invalid empty array schema\"),1===t.length&&(t=t[0]));const a=(t,...s)=>!1!==r.override?t.valid(e.override,...s):t.valid(...s);if(i.simple(t))return a(e,t);if(\"function\"==typeof t)return e.custom(t);if(s(\"object\"==typeof t,\"Invalid schema content:\",typeof t),n.isResolvable(t))return a(e,t);if(n.isSchema(t))return t;if(Array.isArray(t)){for(const r of t)if(!i.simple(r))return e.alternatives().try(...t);return a(e,...t)}return t instanceof RegExp?e.string().regex(t):t instanceof Date?a(e.date(),t):(s(Object.getPrototypeOf(t)===Object.getPrototypeOf({}),\"Schema can only contain plain objects\"),e.object().keys(t))},t.ref=function(e,t){return a.isRef(e)?e:a.create(e,t)},t.compile=function(e,r,a={}){n.assertOptions(a,[\"legacy\"]);const o=r&&r[n.symbols.any];if(o)return s(a.legacy||o.version===n.version,\"Cannot mix different versions of joi schemas:\",o.version,n.version),r;if(\"object\"!=typeof r||!a.legacy)return t.schema(e,r,{appendPath:!0});const l=i.walk(r);return l?l.compile(l.root,r):t.schema(e,r,{appendPath:!0})},i.walk=function(e){if(\"object\"!=typeof e)return null;if(Array.isArray(e)){for(const t of e){const e=i.walk(t);if(e)return e}return null}const t=e[n.symbols.any];if(t)return{root:e[t.root],compile:t.compile};s(Object.getPrototypeOf(e)===Object.getPrototypeOf({}),\"Schema can only contain plain objects\");for(const t in e){const r=i.walk(e[t]);if(r)return r}return null},i.simple=function(e){return null===e||[\"boolean\",\"string\",\"number\"].includes(typeof e)},t.when=function(e,r,o){if(void 0===o&&(s(r&&\"object\"==typeof r,\"Missing options\"),o=r,r=a.create(\".\")),Array.isArray(o)&&(o={switch:o}),n.assertOptions(o,[\"is\",\"not\",\"then\",\"otherwise\",\"switch\",\"break\"]),n.isSchema(r))return s(void 0===o.is,'\"is\" can not be used with a schema condition'),s(void 0===o.not,'\"not\" can not be used with a schema condition'),s(void 0===o.switch,'\"switch\" can not be used with a schema condition'),i.condition(e,{is:r,then:o.then,otherwise:o.otherwise,break:o.break});if(s(a.isRef(r)||\"string\"==typeof r,\"Invalid condition:\",r),s(void 0===o.not||void 0===o.is,'Cannot combine \"is\" with \"not\"'),void 0===o.switch){let l=o;void 0!==o.not&&(l={is:o.not,then:o.otherwise,otherwise:o.then,break:o.break});let c=void 0!==l.is?e.$_compile(l.is):e.$_root.invalid(null,!1,0,\"\").required();return s(void 0!==l.then||void 0!==l.otherwise,'options must have at least one of \"then\", \"otherwise\", or \"switch\"'),s(void 0===l.break||void 0===l.then||void 0===l.otherwise,\"Cannot specify then, otherwise, and break all together\"),void 0===o.is||a.isRef(o.is)||n.isSchema(o.is)||(c=c.required()),i.condition(e,{ref:t.ref(r),is:c,then:l.then,otherwise:l.otherwise,break:l.break})}s(Array.isArray(o.switch),'\"switch\" must be an array'),s(void 0===o.is,'Cannot combine \"switch\" with \"is\"'),s(void 0===o.not,'Cannot combine \"switch\" with \"not\"'),s(void 0===o.then,'Cannot combine \"switch\" with \"then\"');const l={ref:t.ref(r),switch:[],break:o.break};for(let t=0;t<o.switch.length;++t){const r=o.switch[t],i=t===o.switch.length-1;n.assertOptions(r,i?[\"is\",\"then\",\"otherwise\"]:[\"is\",\"then\"]),s(void 0!==r.is,'Switch statement missing \"is\"'),s(void 0!==r.then,'Switch statement missing \"then\"');const c={is:e.$_compile(r.is),then:e.$_compile(r.then)};if(a.isRef(r.is)||n.isSchema(r.is)||(c.is=c.is.required()),i){s(void 0===o.otherwise||void 0===r.otherwise,'Cannot specify \"otherwise\" inside and outside a \"switch\"');const t=void 0!==o.otherwise?o.otherwise:r.otherwise;void 0!==t&&(s(void 0===l.break,\"Cannot specify both otherwise and break\"),c.otherwise=e.$_compile(t))}l.switch.push(c)}return l},i.condition=function(e,t){for(const r of[\"then\",\"otherwise\"])void 0===t[r]?delete t[r]:t[r]=e.$_compile(t[r]);return t}},6354:(e,t,r)=>{\"use strict\";const s=r(5688),n=r(8160),a=r(3328);t.Report=class{constructor(e,r,s,n,a,i,o){if(this.code=e,this.flags=n,this.messages=a,this.path=i.path,this.prefs=o,this.state=i,this.value=r,this.message=null,this.template=null,this.local=s||{},this.local.label=t.label(this.flags,this.state,this.prefs,this.messages),void 0===this.value||this.local.hasOwnProperty(\"value\")||(this.local.value=this.value),this.path.length){const e=this.path[this.path.length-1];\"object\"!=typeof e&&(this.local.key=e)}}_setTemplate(e){if(this.template=e,!this.flags.label&&0===this.path.length){const e=this._template(this.template,\"root\");e&&(this.local.label=e)}}toString(){if(this.message)return this.message;const e=this.code;if(!this.prefs.errors.render)return this.code;const t=this._template(this.template)||this._template(this.prefs.messages)||this._template(this.messages);return void 0===t?`Error code \"${e}\" is not defined, your custom type is missing the correct messages definition`:(this.message=t.render(this.value,this.state,this.prefs,this.local,{errors:this.prefs.errors,messages:[this.prefs.messages,this.messages]}),this.prefs.errors.label||(this.message=this.message.replace(/^\"\" /,\"\").trim()),this.message)}_template(e,r){return t.template(this.value,e,r||this.code,this.state,this.prefs)}},t.path=function(e){let t=\"\";for(const r of e)\"object\"!=typeof r&&(\"string\"==typeof r?(t&&(t+=\".\"),t+=r):t+=`[${r}]`);return t},t.template=function(e,t,r,s,i){if(!t)return;if(a.isTemplate(t))return\"root\"!==r?t:null;let o=i.errors.language;if(n.isResolvable(o)&&(o=o.resolve(e,s,i)),o&&t[o]){if(void 0!==t[o][r])return t[o][r];if(void 0!==t[o][\"*\"])return t[o][\"*\"]}return t[r]?t[r]:t[\"*\"]},t.label=function(e,r,s,n){if(e.label)return e.label;if(!s.errors.label)return\"\";let a=r.path;\"key\"===s.errors.label&&r.path.length>1&&(a=r.path.slice(-1));return t.path(a)||t.template(null,s.messages,\"root\",r,s)||n&&t.template(null,n,\"root\",r,s)||\"value\"},t.process=function(e,r,s){if(!e)return null;const{override:n,message:a,details:i}=t.details(e);if(n)return n;if(s.errors.stack)return new t.ValidationError(a,i,r);const o=Error.stackTraceLimit;Error.stackTraceLimit=0;const l=new t.ValidationError(a,i,r);return Error.stackTraceLimit=o,l},t.details=function(e,t={}){let r=[];const s=[];for(const n of e){if(n instanceof Error){if(!1!==t.override)return{override:n};const e=n.toString();r.push(e),s.push({message:e,type:\"override\",context:{error:n}});continue}const e=n.toString();r.push(e),s.push({message:e,path:n.path.filter((e=>\"object\"!=typeof e)),type:n.code,context:n.local})}return r.length>1&&(r=[...new Set(r)]),{message:r.join(\". \"),details:s}},t.ValidationError=class extends Error{constructor(e,t,r){super(e),this._original=r,this.details=t}static isError(e){return e instanceof t.ValidationError}},t.ValidationError.prototype.isJoi=!0,t.ValidationError.prototype.name=\"ValidationError\",t.ValidationError.prototype.annotate=s.error},8901:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(8160),i=r(6914),o={};t.type=function(e,t){const r=Object.getPrototypeOf(e),l=n(r),c=e._assign(Object.create(l)),u=Object.assign({},t);delete u.base,l._definition=u;const f=r._definition||{};u.messages=i.merge(f.messages,u.messages),u.properties=Object.assign({},f.properties,u.properties),c.type=u.type,u.flags=Object.assign({},f.flags,u.flags);const m=Object.assign({},f.terms);if(u.terms)for(const e in u.terms){const t=u.terms[e];s(void 0===c.$_terms[e],\"Invalid term override for\",u.type,e),c.$_terms[e]=t.init,m[e]=t}u.terms=m,u.args||(u.args=f.args),u.prepare=o.prepare(u.prepare,f.prepare),u.coerce&&(\"function\"==typeof u.coerce&&(u.coerce={method:u.coerce}),u.coerce.from&&!Array.isArray(u.coerce.from)&&(u.coerce={method:u.coerce.method,from:[].concat(u.coerce.from)})),u.coerce=o.coerce(u.coerce,f.coerce),u.validate=o.validate(u.validate,f.validate);const h=Object.assign({},f.rules);if(u.rules)for(const e in u.rules){const t=u.rules[e];s(\"object\"==typeof t,\"Invalid rule definition for\",u.type,e);let r=t.method;if(void 0===r&&(r=function(){return this.$_addRule(e)}),r&&(s(!l[e],\"Rule conflict in\",u.type,e),l[e]=r),s(!h[e],\"Rule conflict in\",u.type,e),h[e]=t,t.alias){const e=[].concat(t.alias);for(const r of e)l[r]=t.method}t.args&&(t.argsByName=new Map,t.args=t.args.map((e=>(\"string\"==typeof e&&(e={name:e}),s(!t.argsByName.has(e.name),\"Duplicated argument name\",e.name),a.isSchema(e.assert)&&(e.assert=e.assert.strict().label(e.name)),t.argsByName.set(e.name,e),e))))}u.rules=h;const d=Object.assign({},f.modifiers);if(u.modifiers)for(const e in u.modifiers){s(!l[e],\"Rule conflict in\",u.type,e);const t=u.modifiers[e];s(\"function\"==typeof t,\"Invalid modifier definition for\",u.type,e);const r=function(t){return this.rule({[e]:t})};l[e]=r,d[e]=t}if(u.modifiers=d,u.overrides){l._super=r,c.$_super={};for(const e in u.overrides)s(r[e],\"Cannot override missing\",e),u.overrides[e][a.symbols.parent]=r[e],c.$_super[e]=r[e].bind(c);Object.assign(l,u.overrides)}u.cast=Object.assign({},f.cast,u.cast);const p=Object.assign({},f.manifest,u.manifest);return p.build=o.build(u.manifest&&u.manifest.build,f.manifest&&f.manifest.build),u.manifest=p,u.rebuild=o.rebuild(u.rebuild,f.rebuild),c},o.build=function(e,t){return e&&t?function(r,s){return t(e(r,s),s)}:e||t},o.coerce=function(e,t){return e&&t?{from:e.from&&t.from?[...new Set([...e.from,...t.from])]:null,method(r,s){let n;if((!t.from||t.from.includes(typeof r))&&(n=t.method(r,s),n)){if(n.errors||void 0===n.value)return n;r=n.value}if(!e.from||e.from.includes(typeof r)){const t=e.method(r,s);if(t)return t}return n}}:e||t},o.prepare=function(e,t){return e&&t?function(r,s){const n=e(r,s);if(n){if(n.errors||void 0===n.value)return n;r=n.value}return t(r,s)||n}:e||t},o.rebuild=function(e,t){return e&&t?function(r){t(r),e(r)}:e||t},o.validate=function(e,t){return e&&t?function(r,s){const n=t(r,s);if(n){if(n.errors&&(!Array.isArray(n.errors)||n.errors.length))return n;r=n.value}return e(r,s)||n}:e||t}},5107:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(8652),i=r(8160),o=r(3292),l=r(6354),c=r(8901),u=r(9708),f=r(6133),m=r(3328),h=r(1152);let d;const p={types:{alternatives:r(4946),any:r(8068),array:r(546),boolean:r(4937),date:r(7500),function:r(390),link:r(8785),number:r(3832),object:r(8966),string:r(7417),symbol:r(8826)},aliases:{alt:\"alternatives\",bool:\"boolean\",func:\"function\"},root:function(){const e={_types:new Set(Object.keys(p.types))};for(const t of e._types)e[t]=function(...e){return s(!e.length||[\"alternatives\",\"link\",\"object\"].includes(t),\"The\",t,\"type does not allow arguments\"),p.generate(this,p.types[t],e)};for(const t of[\"allow\",\"custom\",\"disallow\",\"equal\",\"exist\",\"forbidden\",\"invalid\",\"not\",\"only\",\"optional\",\"options\",\"prefs\",\"preferences\",\"required\",\"strip\",\"valid\",\"when\"])e[t]=function(...e){return this.any()[t](...e)};Object.assign(e,p.methods);for(const t in p.aliases){const r=p.aliases[t];e[t]=e[r]}return e.x=e.expression,h.setup&&h.setup(e),e}};p.methods={ValidationError:l.ValidationError,version:i.version,cache:a.provider,assert(e,t,...r){p.assert(e,t,!0,r)},attempt:(e,t,...r)=>p.assert(e,t,!1,r),build(e){return s(\"function\"==typeof u.build,\"Manifest functionality disabled\"),u.build(this,e)},checkPreferences(e){i.checkPreferences(e)},compile(e,t){return o.compile(this,e,t)},defaults(e){s(\"function\"==typeof e,\"modifier must be a function\");const t=Object.assign({},this);for(const r of t._types){const n=e(t[r]());s(i.isSchema(n),\"modifier must return a valid schema object\"),t[r]=function(...e){return p.generate(this,n,e)}}return t},expression:(...e)=>new m(...e),extend(...e){i.verifyFlat(e,\"extend\"),d=d||r(3378),s(e.length,\"You need to provide at least one extension\"),this.assert(e,d.extensions);const t=Object.assign({},this);t._types=new Set(t._types);for(let r of e){\"function\"==typeof r&&(r=r(t)),this.assert(r,d.extension);const e=p.expandExtension(r,t);for(const r of e){s(void 0===t[r.type]||t._types.has(r.type),\"Cannot override name\",r.type);const e=r.base||this.any(),n=c.type(e,r);t._types.add(r.type),t[r.type]=function(...e){return p.generate(this,n,e)}}}return t},isError:l.ValidationError.isError,isExpression:m.isTemplate,isRef:f.isRef,isSchema:i.isSchema,in:(...e)=>f.in(...e),override:i.symbols.override,ref:(...e)=>f.create(...e),types(){const e={};for(const t of this._types)e[t]=this[t]();for(const t in p.aliases)e[t]=this[t]();return e}},p.assert=function(e,t,r,s){const a=s[0]instanceof Error||\"string\"==typeof s[0]?s[0]:null,o=null!==a?s[1]:s[0],c=t.validate(e,i.preferences({errors:{stack:!0}},o||{}));let u=c.error;if(!u)return c.value;if(a instanceof Error)throw a;const f=r&&\"function\"==typeof u.annotate?u.annotate():u.message;throw u instanceof l.ValidationError==0&&(u=n(u)),u.message=a?`${a} ${f}`:f,u},p.generate=function(e,t,r){return s(e,\"Must be invoked on a Joi instance.\"),t.$_root=e,t._definition.args&&r.length?t._definition.args(t,...r):t},p.expandExtension=function(e,t){if(\"string\"==typeof e.type)return[e];const r=[];for(const s of t._types)if(e.type.test(s)){const n=Object.assign({},e);n.type=s,n.base=t[s](),r.push(n)}return r},e.exports=p.root()},6914:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(3328);t.compile=function(e,t){if(\"string\"==typeof e)return s(!t,\"Cannot set single message string\"),new a(e);if(a.isTemplate(e))return s(!t,\"Cannot set single message template\"),e;s(\"object\"==typeof e&&!Array.isArray(e),\"Invalid message options\"),t=t?n(t):{};for(let r in e){const n=e[r];if(\"root\"===r||a.isTemplate(n)){t[r]=n;continue}if(\"string\"==typeof n){t[r]=new a(n);continue}s(\"object\"==typeof n&&!Array.isArray(n),\"Invalid message for\",r);const i=r;for(r in t[i]=t[i]||{},n){const e=n[r];\"root\"===r||a.isTemplate(e)?t[i][r]=e:(s(\"string\"==typeof e,\"Invalid message for\",r,\"in\",i),t[i][r]=new a(e))}}return t},t.decompile=function(e){const t={};for(let r in e){const s=e[r];if(\"root\"===r){t.root=s;continue}if(a.isTemplate(s)){t[r]=s.describe({compact:!0});continue}const n=r;for(r in t[n]={},s){const e=s[r];\"root\"!==r?t[n][r]=e.describe({compact:!0}):t[n].root=e}}return t},t.merge=function(e,r){if(!e)return t.compile(r);if(!r)return e;if(\"string\"==typeof r)return new a(r);if(a.isTemplate(r))return r;const i=n(e);for(let e in r){const t=r[e];if(\"root\"===e||a.isTemplate(t)){i[e]=t;continue}if(\"string\"==typeof t){i[e]=new a(t);continue}s(\"object\"==typeof t&&!Array.isArray(t),\"Invalid message for\",e);const n=e;for(e in i[n]=i[n]||{},t){const r=t[e];\"root\"===e||a.isTemplate(r)?i[n][e]=r:(s(\"string\"==typeof r,\"Invalid message for\",e,\"in\",n),i[n][e]=new a(r))}}return i}},2294:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8160),a=r(6133),i={};t.Ids=i.Ids=class{constructor(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}clone(){const e=new i.Ids;return e._byId=new Map(this._byId),e._byKey=new Map(this._byKey),e._schemaChain=this._schemaChain,e}concat(e){e._schemaChain&&(this._schemaChain=!0);for(const[t,r]of e._byId.entries())s(!this._byKey.has(t),\"Schema id conflicts with existing key:\",t),this._byId.set(t,r);for(const[t,r]of e._byKey.entries())s(!this._byId.has(t),\"Schema key conflicts with existing id:\",t),this._byKey.set(t,r)}fork(e,t,r){const a=this._collect(e);a.push({schema:r});const o=a.shift();let l={id:o.id,schema:t(o.schema)};s(n.isSchema(l.schema),\"adjuster function failed to return a joi schema type\");for(const e of a)l={id:e.id,schema:i.fork(e.schema,l.id,l.schema)};return l.schema}labels(e,t=[]){const r=e[0],s=this._get(r);if(!s)return[...t,...e].join(\".\");const n=e.slice(1);return t=[...t,s.schema._flags.label||r],n.length?s.schema._ids.labels(n,t):t.join(\".\")}reach(e,t=[]){const r=e[0],n=this._get(r);s(n,\"Schema does not contain path\",[...t,...e].join(\".\"));const a=e.slice(1);return a.length?n.schema._ids.reach(a,[...t,r]):n.schema}register(e,{key:t}={}){if(!e||!n.isSchema(e))return;(e.$_property(\"schemaChain\")||e._ids._schemaChain)&&(this._schemaChain=!0);const r=e._flags.id;if(r){const t=this._byId.get(r);s(!t||t.schema===e,\"Cannot add different schemas with the same id:\",r),s(!this._byKey.has(r),\"Schema id conflicts with existing key:\",r),this._byId.set(r,{schema:e,id:r})}t&&(s(!this._byKey.has(t),\"Schema already contains key:\",t),s(!this._byId.has(t),\"Schema key conflicts with existing id:\",t),this._byKey.set(t,{schema:e,id:t}))}reset(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}_collect(e,t=[],r=[]){const n=e[0],a=this._get(n);s(a,\"Schema does not contain path\",[...t,...e].join(\".\")),r=[a,...r];const i=e.slice(1);return i.length?a.schema._ids._collect(i,[...t,n],r):r}_get(e){return this._byId.get(e)||this._byKey.get(e)}},i.fork=function(e,r,s){const n=t.schema(e,{each:(e,{key:t})=>{if(r===(e._flags.id||t))return s},ref:!1});return n?n.$_mutateRebuild():e},t.schema=function(e,t){let r;for(const s in e._flags){if(\"_\"===s[0])continue;const n=i.scan(e._flags[s],{source:\"flags\",name:s},t);void 0!==n&&(r=r||e.clone(),r._flags[s]=n)}for(let s=0;s<e._rules.length;++s){const n=e._rules[s],a=i.scan(n.args,{source:\"rules\",name:n.name},t);if(void 0!==a){r=r||e.clone();const t=Object.assign({},n);t.args=a,r._rules[s]=t,r._singleRules.get(n.name)===n&&r._singleRules.set(n.name,t)}}for(const s in e.$_terms){if(\"_\"===s[0])continue;const n=i.scan(e.$_terms[s],{source:\"terms\",name:s},t);void 0!==n&&(r=r||e.clone(),r.$_terms[s]=n)}return r},i.scan=function(e,t,r,s,o){const l=s||[];if(null===e||\"object\"!=typeof e)return;let c;if(Array.isArray(e)){for(let s=0;s<e.length;++s){const n=\"terms\"===t.source&&\"keys\"===t.name&&e[s].key,a=i.scan(e[s],t,r,[s,...l],n);void 0!==a&&(c=c||e.slice(),c[s]=a)}return c}if(!1!==r.schema&&n.isSchema(e)||!1!==r.ref&&a.isRef(e)){const s=r.each(e,{...t,path:l,key:o});if(s===e)return;return s}for(const s in e){if(\"_\"===s[0])continue;const n=i.scan(e[s],t,r,[s,...l],o);void 0!==n&&(c=c||Object.assign({},e),c[s]=n)}return c}},6133:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(9621),i=r(8160);let o;const l={symbol:Symbol(\"ref\"),defaults:{adjust:null,in:!1,iterables:null,map:null,separator:\".\",type:\"value\"}};t.create=function(e,t={}){s(\"string\"==typeof e,\"Invalid reference key:\",e),i.assertOptions(t,[\"adjust\",\"ancestor\",\"in\",\"iterables\",\"map\",\"prefix\",\"render\",\"separator\"]),s(!t.prefix||\"object\"==typeof t.prefix,\"options.prefix must be of type object\");const r=Object.assign({},l.defaults,t);delete r.prefix;const n=r.separator,a=l.context(e,n,t.prefix);if(r.type=a.type,e=a.key,\"value\"===r.type)if(a.root&&(s(!n||e[0]!==n,\"Cannot specify relative path with root prefix\"),r.ancestor=\"root\",e||(e=null)),n&&n===e)e=null,r.ancestor=0;else if(void 0!==r.ancestor)s(!n||!e||e[0]!==n,\"Cannot combine prefix with ancestor option\");else{const[t,s]=l.ancestor(e,n);s&&\"\"===(e=e.slice(s))&&(e=null),r.ancestor=t}return r.path=n?null===e?[]:e.split(n):[e],new l.Ref(r)},t.in=function(e,r={}){return t.create(e,{...r,in:!0})},t.isRef=function(e){return!!e&&!!e[i.symbols.ref]},l.Ref=class{constructor(e){s(\"object\"==typeof e,\"Invalid reference construction\"),i.assertOptions(e,[\"adjust\",\"ancestor\",\"in\",\"iterables\",\"map\",\"path\",\"render\",\"separator\",\"type\",\"depth\",\"key\",\"root\",\"display\"]),s([!1,void 0].includes(e.separator)||\"string\"==typeof e.separator&&1===e.separator.length,\"Invalid separator\"),s(!e.adjust||\"function\"==typeof e.adjust,\"options.adjust must be a function\"),s(!e.map||Array.isArray(e.map),\"options.map must be an array\"),s(!e.map||!e.adjust,\"Cannot set both map and adjust options\"),Object.assign(this,l.defaults,e),s(\"value\"===this.type||void 0===this.ancestor,\"Non-value references cannot reference ancestors\"),Array.isArray(this.map)&&(this.map=new Map(this.map)),this.depth=this.path.length,this.key=this.path.length?this.path.join(this.separator):null,this.root=this.path[0],this.updateDisplay()}resolve(e,t,r,n,a={}){return s(!this.in||a.in,\"Invalid in() reference usage\"),\"global\"===this.type?this._resolve(r.context,t,a):\"local\"===this.type?this._resolve(n,t,a):this.ancestor?\"root\"===this.ancestor?this._resolve(t.ancestors[t.ancestors.length-1],t,a):(s(this.ancestor<=t.ancestors.length,\"Invalid reference exceeds the schema root:\",this.display),this._resolve(t.ancestors[this.ancestor-1],t,a)):this._resolve(e,t,a)}_resolve(e,t,r){let s;if(\"value\"===this.type&&t.mainstay.shadow&&!1!==r.shadow&&(s=t.mainstay.shadow.get(this.absolute(t))),void 0===s&&(s=a(e,this.path,{iterables:this.iterables,functions:!0})),this.adjust&&(s=this.adjust(s)),this.map){const e=this.map.get(s);void 0!==e&&(s=e)}return t.mainstay&&t.mainstay.tracer.resolve(t,this,s),s}toString(){return this.display}absolute(e){return[...e.path.slice(0,-this.ancestor),...this.path]}clone(){return new l.Ref(this)}describe(){const e={path:this.path};\"value\"!==this.type&&(e.type=this.type),\".\"!==this.separator&&(e.separator=this.separator),\"value\"===this.type&&1!==this.ancestor&&(e.ancestor=this.ancestor),this.map&&(e.map=[...this.map]);for(const t of[\"adjust\",\"iterables\",\"render\"])null!==this[t]&&void 0!==this[t]&&(e[t]=this[t]);return!1!==this.in&&(e.in=!0),{ref:e}}updateDisplay(){const e=null!==this.key?this.key:\"\";if(\"value\"!==this.type)return void(this.display=`ref:${this.type}:${e}`);if(!this.separator)return void(this.display=`ref:${e}`);if(!this.ancestor)return void(this.display=`ref:${this.separator}${e}`);if(\"root\"===this.ancestor)return void(this.display=`ref:root:${e}`);if(1===this.ancestor)return void(this.display=`ref:${e||\"..\"}`);const t=new Array(this.ancestor+1).fill(this.separator).join(\"\");this.display=`ref:${t}${e||\"\"}`}},l.Ref.prototype[i.symbols.ref]=!0,t.build=function(e){return\"value\"===(e=Object.assign({},l.defaults,e)).type&&void 0===e.ancestor&&(e.ancestor=1),new l.Ref(e)},l.context=function(e,t,r={}){if(e=e.trim(),r){const s=void 0===r.global?\"$\":r.global;if(s!==t&&e.startsWith(s))return{key:e.slice(s.length),type:\"global\"};const n=void 0===r.local?\"#\":r.local;if(n!==t&&e.startsWith(n))return{key:e.slice(n.length),type:\"local\"};const a=void 0===r.root?\"/\":r.root;if(a!==t&&e.startsWith(a))return{key:e.slice(a.length),type:\"value\",root:!0}}return{key:e,type:\"value\"}},l.ancestor=function(e,t){if(!t)return[1,0];if(e[0]!==t)return[1,0];if(e[1]!==t)return[0,1];let r=2;for(;e[r]===t;)++r;return[r-1,r]},t.toSibling=0,t.toParent=1,t.Manager=class{constructor(){this.refs=[]}register(e,s){if(e)if(s=void 0===s?t.toParent:s,Array.isArray(e))for(const t of e)this.register(t,s);else if(i.isSchema(e))for(const t of e._refs.refs)t.ancestor-s>=0&&this.refs.push({ancestor:t.ancestor-s,root:t.root});else t.isRef(e)&&\"value\"===e.type&&e.ancestor-s>=0&&this.refs.push({ancestor:e.ancestor-s,root:e.root}),o=o||r(3328),o.isTemplate(e)&&this.register(e.refs(),s)}get length(){return this.refs.length}clone(){const e=new t.Manager;return e.refs=n(this.refs),e}reset(){this.refs=[]}roots(){return this.refs.filter((e=>!e.ancestor)).map((e=>e.root))}}},3378:(e,t,r)=>{\"use strict\";const s=r(5107),n={};n.wrap=s.string().min(1).max(2).allow(!1),t.preferences=s.object({allowUnknown:s.boolean(),abortEarly:s.boolean(),artifacts:s.boolean(),cache:s.boolean(),context:s.object(),convert:s.boolean(),dateFormat:s.valid(\"date\",\"iso\",\"string\",\"time\",\"utc\"),debug:s.boolean(),errors:{escapeHtml:s.boolean(),label:s.valid(\"path\",\"key\",!1),language:[s.string(),s.object().ref()],render:s.boolean(),stack:s.boolean(),wrap:{label:n.wrap,array:n.wrap,string:n.wrap}},externals:s.boolean(),messages:s.object(),noDefaults:s.boolean(),nonEnumerables:s.boolean(),presence:s.valid(\"required\",\"optional\",\"forbidden\"),skipFunctions:s.boolean(),stripUnknown:s.object({arrays:s.boolean(),objects:s.boolean()}).or(\"arrays\",\"objects\").allow(!0,!1),warnings:s.boolean()}).strict(),n.nameRx=/^[a-zA-Z0-9]\\w*$/,n.rule=s.object({alias:s.array().items(s.string().pattern(n.nameRx)).single(),args:s.array().items(s.string(),s.object({name:s.string().pattern(n.nameRx).required(),ref:s.boolean(),assert:s.alternatives([s.function(),s.object().schema()]).conditional(\"ref\",{is:!0,then:s.required()}),normalize:s.function(),message:s.string().when(\"assert\",{is:s.function(),then:s.required()})})),convert:s.boolean(),manifest:s.boolean(),method:s.function().allow(!1),multi:s.boolean(),validate:s.function()}),t.extension=s.object({type:s.alternatives([s.string(),s.object().regex()]).required(),args:s.function(),cast:s.object().pattern(n.nameRx,s.object({from:s.function().maxArity(1).required(),to:s.function().minArity(1).maxArity(2).required()})),base:s.object().schema().when(\"type\",{is:s.object().regex(),then:s.forbidden()}),coerce:[s.function().maxArity(3),s.object({method:s.function().maxArity(3).required(),from:s.array().items(s.string()).single()})],flags:s.object().pattern(n.nameRx,s.object({setter:s.string(),default:s.any()})),manifest:{build:s.function().arity(2)},messages:[s.object(),s.string()],modifiers:s.object().pattern(n.nameRx,s.function().minArity(1).maxArity(2)),overrides:s.object().pattern(n.nameRx,s.function()),prepare:s.function().maxArity(3),rebuild:s.function().arity(1),rules:s.object().pattern(n.nameRx,n.rule),terms:s.object().pattern(n.nameRx,s.object({init:s.array().allow(null).required(),manifest:s.object().pattern(/.+/,[s.valid(\"schema\",\"single\"),s.object({mapped:s.object({from:s.string().required(),to:s.string().required()}).required()})])})),validate:s.function().maxArity(3)}).strict(),t.extensions=s.array().items(s.object(),s.function().arity(1)).strict(),n.desc={buffer:s.object({buffer:s.string()}),func:s.object({function:s.function().required(),options:{literal:!0}}),override:s.object({override:!0}),ref:s.object({ref:s.object({type:s.valid(\"value\",\"global\",\"local\"),path:s.array().required(),separator:s.string().length(1).allow(!1),ancestor:s.number().min(0).integer().allow(\"root\"),map:s.array().items(s.array().length(2)).min(1),adjust:s.function(),iterables:s.boolean(),in:s.boolean(),render:s.boolean()}).required()}),regex:s.object({regex:s.string().min(3)}),special:s.object({special:s.valid(\"deep\").required()}),template:s.object({template:s.string().required(),options:s.object()}),value:s.object({value:s.alternatives([s.object(),s.array()]).required()})},n.desc.entity=s.alternatives([s.array().items(s.link(\"...\")),s.boolean(),s.function(),s.number(),s.string(),n.desc.buffer,n.desc.func,n.desc.ref,n.desc.regex,n.desc.special,n.desc.template,n.desc.value,s.link(\"/\")]),n.desc.values=s.array().items(null,s.boolean(),s.function(),s.number().allow(1/0,-1/0),s.string().allow(\"\"),s.symbol(),n.desc.buffer,n.desc.func,n.desc.override,n.desc.ref,n.desc.regex,n.desc.template,n.desc.value),n.desc.messages=s.object().pattern(/.+/,[s.string(),n.desc.template,s.object().pattern(/.+/,[s.string(),n.desc.template])]),t.description=s.object({type:s.string().required(),flags:s.object({cast:s.string(),default:s.any(),description:s.string(),empty:s.link(\"/\"),failover:n.desc.entity,id:s.string(),label:s.string(),only:!0,presence:[\"optional\",\"required\",\"forbidden\"],result:[\"raw\",\"strip\"],strip:s.boolean(),unit:s.string()}).unknown(),preferences:{allowUnknown:s.boolean(),abortEarly:s.boolean(),artifacts:s.boolean(),cache:s.boolean(),convert:s.boolean(),dateFormat:[\"date\",\"iso\",\"string\",\"time\",\"utc\"],errors:{escapeHtml:s.boolean(),label:[\"path\",\"key\"],language:[s.string(),n.desc.ref],wrap:{label:n.wrap,array:n.wrap}},externals:s.boolean(),messages:n.desc.messages,noDefaults:s.boolean(),nonEnumerables:s.boolean(),presence:[\"required\",\"optional\",\"forbidden\"],skipFunctions:s.boolean(),stripUnknown:s.object({arrays:s.boolean(),objects:s.boolean()}).or(\"arrays\",\"objects\").allow(!0,!1),warnings:s.boolean()},allow:n.desc.values,invalid:n.desc.values,rules:s.array().min(1).items({name:s.string().required(),args:s.object().min(1),keep:s.boolean(),message:[s.string(),n.desc.messages],warn:s.boolean()}),keys:s.object().pattern(/.*/,s.link(\"/\")),link:n.desc.ref}).pattern(/^[a-z]\\w*$/,s.any())},493:(e,t,r)=>{\"use strict\";const s=r(8571),n=r(9621),a=r(8160),i={value:Symbol(\"value\")};e.exports=i.State=class{constructor(e,t,r){this.path=e,this.ancestors=t,this.mainstay=r.mainstay,this.schemas=r.schemas,this.debug=null}localize(e,t=null,r=null){const s=new i.State(e,t,this);return r&&s.schemas&&(s.schemas=[i.schemas(r),...s.schemas]),s}nest(e,t){const r=new i.State(this.path,this.ancestors,this);return r.schemas=r.schemas&&[i.schemas(e),...r.schemas],r.debug=t,r}shadow(e,t){this.mainstay.shadow=this.mainstay.shadow||new i.Shadow,this.mainstay.shadow.set(this.path,e,t)}snapshot(){this.mainstay.shadow&&(this._snapshot=s(this.mainstay.shadow.node(this.path))),this.mainstay.snapshot()}restore(){this.mainstay.shadow&&(this.mainstay.shadow.override(this.path,this._snapshot),this._snapshot=void 0),this.mainstay.restore()}commit(){this.mainstay.shadow&&(this.mainstay.shadow.override(this.path,this._snapshot),this._snapshot=void 0),this.mainstay.commit()}},i.schemas=function(e){return a.isSchema(e)?{schema:e}:e},i.Shadow=class{constructor(){this._values=null}set(e,t,r){if(!e.length)return;if(\"strip\"===r&&\"number\"==typeof e[e.length-1])return;this._values=this._values||new Map;let s=this._values;for(let t=0;t<e.length;++t){const r=e[t];let n=s.get(r);n||(n=new Map,s.set(r,n)),s=n}s[i.value]=t}get(e){const t=this.node(e);if(t)return t[i.value]}node(e){if(this._values)return n(this._values,e,{iterables:!0})}override(e,t){if(!this._values)return;const r=e.slice(0,-1),s=e[e.length-1],a=n(this._values,r,{iterables:!0});t?a.set(s,t):a&&a.delete(s)}}},3328:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(5277),i=r(1447),o=r(8160),l=r(6354),c=r(6133),u={symbol:Symbol(\"template\"),opens:new Array(1e3).join(\"\\0\"),closes:new Array(1e3).join(\"\u0001\"),dateFormat:{date:Date.prototype.toDateString,iso:Date.prototype.toISOString,string:Date.prototype.toString,time:Date.prototype.toTimeString,utc:Date.prototype.toUTCString}};e.exports=u.Template=class{constructor(e,t){if(s(\"string\"==typeof e,\"Template source must be a string\"),s(!e.includes(\"\\0\")&&!e.includes(\"\u0001\"),\"Template source cannot contain reserved control characters\"),this.source=e,this.rendered=e,this._template=null,t){const{functions:e,...r}=t;this._settings=Object.keys(r).length?n(r):void 0,this._functions=e,this._functions&&(s(Object.keys(this._functions).every((e=>\"string\"==typeof e)),\"Functions keys must be strings\"),s(Object.values(this._functions).every((e=>\"function\"==typeof e)),\"Functions values must be functions\"))}else this._settings=void 0,this._functions=void 0;this._parse()}_parse(){if(!this.source.includes(\"{\"))return;const e=u.encode(this.source),t=u.split(e);let r=!1;const s=[],n=t.shift();n&&s.push(n);for(const e of t){const t=\"{\"!==e[0],n=t?\"}\":\"}}\",a=e.indexOf(n);if(-1===a||\"{\"===e[1]){s.push(`{${u.decode(e)}`);continue}let i=e.slice(t?0:1,a);const o=\":\"===i[0];o&&(i=i.slice(1));const l=this._ref(u.decode(i),{raw:t,wrapped:o});s.push(l),\"string\"!=typeof l&&(r=!0);const c=e.slice(a+n.length);c&&s.push(u.decode(c))}r?this._template=s:this.rendered=s.join(\"\")}static date(e,t){return u.dateFormat[t.dateFormat].call(e)}describe(e={}){if(!this._settings&&e.compact)return this.source;const t={template:this.source};return this._settings&&(t.options=this._settings),this._functions&&(t.functions=this._functions),t}static build(e){return new u.Template(e.template,e.options||e.functions?{...e.options,functions:e.functions}:void 0)}isDynamic(){return!!this._template}static isTemplate(e){return!!e&&!!e[o.symbols.template]}refs(){if(!this._template)return;const e=[];for(const t of this._template)\"string\"!=typeof t&&e.push(...t.refs);return e}resolve(e,t,r,s){return this._template&&1===this._template.length?this._part(this._template[0],e,t,r,s,{}):this.render(e,t,r,s)}_part(e,...t){return e.ref?e.ref.resolve(...t):e.formula.evaluate(t)}render(e,t,r,s,n={}){if(!this.isDynamic())return this.rendered;const i=[];for(const o of this._template)if(\"string\"==typeof o)i.push(o);else{const l=this._part(o,e,t,r,s,n),c=u.stringify(l,e,t,r,s,n);if(void 0!==c){const e=o.raw||!1===(n.errors&&n.errors.escapeHtml)?c:a(c);i.push(u.wrap(e,o.wrapped&&r.errors.wrap.label))}}return i.join(\"\")}_ref(e,{raw:t,wrapped:r}){const s=[],n=e=>{const t=c.create(e,this._settings);return s.push(t),e=>{const r=t.resolve(...e);return void 0!==r?r:null}};try{const t=this._functions?{...u.functions,...this._functions}:u.functions;var a=new i.Parser(e,{reference:n,functions:t,constants:u.constants})}catch(t){throw t.message=`Invalid template variable \"${e}\" fails due to: ${t.message}`,t}if(a.single){if(\"reference\"===a.single.type){const e=s[0];return{ref:e,raw:t,refs:s,wrapped:r||\"local\"===e.type&&\"label\"===e.key}}return u.stringify(a.single.value)}return{formula:a,raw:t,refs:s}}toString(){return this.source}},u.Template.prototype[o.symbols.template]=!0,u.Template.prototype.isImmutable=!0,u.encode=function(e){return e.replace(/\\\\(\\{+)/g,((e,t)=>u.opens.slice(0,t.length))).replace(/\\\\(\\}+)/g,((e,t)=>u.closes.slice(0,t.length)))},u.decode=function(e){return e.replace(/\\u0000/g,\"{\").replace(/\\u0001/g,\"}\")},u.split=function(e){const t=[];let r=\"\";for(let s=0;s<e.length;++s){const n=e[s];if(\"{\"===n){let n=\"\";for(;s+1<e.length&&\"{\"===e[s+1];)n+=\"{\",++s;t.push(r),r=n}else r+=n}return t.push(r),t},u.wrap=function(e,t){return t?1===t.length?`${t}${e}${t}`:`${t[0]}${e}${t[1]}`:e},u.stringify=function(e,t,r,s,n,a={}){const i=typeof e,o=s&&s.errors&&s.errors.wrap||{};let l=!1;if(c.isRef(e)&&e.render&&(l=e.in,e=e.resolve(t,r,s,n,{in:e.in,...a})),null===e)return\"null\";if(\"string\"===i)return u.wrap(e,a.arrayItems&&o.string);if(\"number\"===i||\"function\"===i||\"symbol\"===i)return e.toString();if(\"object\"!==i)return JSON.stringify(e);if(e instanceof Date)return u.Template.date(e,s);if(e instanceof Map){const t=[];for(const[r,s]of e.entries())t.push(`${r.toString()} -> ${s.toString()}`);e=t}if(!Array.isArray(e))return e.toString();const f=[];for(const i of e)f.push(u.stringify(i,t,r,s,n,{arrayItems:!0,...a}));return u.wrap(f.join(\", \"),!l&&o.array)},u.constants={true:!0,false:!1,null:null,second:1e3,minute:6e4,hour:36e5,day:864e5},u.functions={if:(e,t,r)=>e?t:r,length:e=>\"string\"==typeof e?e.length:e&&\"object\"==typeof e?Array.isArray(e)?e.length:Object.keys(e).length:null,msg(e){const[t,r,s,n,a]=this,i=a.messages;if(!i)return\"\";const o=l.template(t,i[0],e,r,s)||l.template(t,i[1],e,r,s);return o?o.render(t,r,s,n,a):\"\"},number:e=>\"number\"==typeof e?e:\"string\"==typeof e?parseFloat(e):\"boolean\"==typeof e?e?1:0:e instanceof Date?e.getTime():null}},4946:(e,t,r)=>{\"use strict\";const s=r(375),n=r(1687),a=r(8068),i=r(8160),o=r(3292),l=r(6354),c=r(6133),u={};e.exports=a.extend({type:\"alternatives\",flags:{match:{default:\"any\"}},terms:{matches:{init:[],register:c.toSibling}},args:(e,...t)=>1===t.length&&Array.isArray(t[0])?e.try(...t[0]):e.try(...t),validate(e,t){const{schema:r,error:s,state:a,prefs:i}=t;if(r._flags.match){const t=[],o=[];for(let s=0;s<r.$_terms.matches.length;++s){const n=r.$_terms.matches[s],l=a.nest(n.schema,`match.${s}`);l.snapshot();const c=n.schema.$_validate(e,l,i);c.errors?(o.push(c.errors),l.restore()):(t.push(c.value),l.commit())}if(0===t.length)return{errors:s(\"alternatives.any\",{details:o.map((e=>l.details(e,{override:!1})))})};if(\"one\"===r._flags.match)return 1===t.length?{value:t[0]}:{errors:s(\"alternatives.one\")};if(t.length!==r.$_terms.matches.length)return{errors:s(\"alternatives.all\",{details:o.map((e=>l.details(e,{override:!1})))})};const c=e=>e.$_terms.matches.some((e=>\"object\"===e.schema.type||\"alternatives\"===e.schema.type&&c(e.schema)));return c(r)?{value:t.reduce(((e,t)=>n(e,t,{mergeArrays:!1})))}:{value:t[t.length-1]}}const o=[];for(let t=0;t<r.$_terms.matches.length;++t){const s=r.$_terms.matches[t];if(s.schema){const r=a.nest(s.schema,`match.${t}`);r.snapshot();const n=s.schema.$_validate(e,r,i);if(!n.errors)return r.commit(),n;r.restore(),o.push({schema:s.schema,reports:n.errors});continue}const n=s.ref?s.ref.resolve(e,a,i):e,l=s.is?[s]:s.switch;for(let r=0;r<l.length;++r){const o=l[r],{is:c,then:u,otherwise:f}=o,m=`match.${t}${s.switch?\".\"+r:\"\"}`;if(c.$_match(n,a.nest(c,`${m}.is`),i)){if(u)return u.$_validate(e,a.nest(u,`${m}.then`),i)}else if(f)return f.$_validate(e,a.nest(f,`${m}.otherwise`),i)}}return u.errors(o,t)},rules:{conditional:{method(e,t){s(!this._flags._endedSwitch,\"Unreachable condition\"),s(!this._flags.match,\"Cannot combine match mode\",this._flags.match,\"with conditional rule\"),s(void 0===t.break,\"Cannot use break option with alternatives conditional\");const r=this.clone(),n=o.when(r,e,t),a=n.is?[n]:n.switch;for(const e of a)if(e.then&&e.otherwise){r.$_setFlag(\"_endedSwitch\",!0,{clone:!1});break}return r.$_terms.matches.push(n),r.$_mutateRebuild()}},match:{method(e){if(s([\"any\",\"one\",\"all\"].includes(e),\"Invalid alternatives match mode\",e),\"any\"!==e)for(const t of this.$_terms.matches)s(t.schema,\"Cannot combine match mode\",e,\"with conditional rules\");return this.$_setFlag(\"match\",e)}},try:{method(...e){s(e.length,\"Missing alternative schemas\"),i.verifyFlat(e,\"try\"),s(!this._flags._endedSwitch,\"Unreachable condition\");const t=this.clone();for(const r of e)t.$_terms.matches.push({schema:t.$_compile(r)});return t.$_mutateRebuild()}}},overrides:{label(e){return this.$_parent(\"label\",e).$_modify({each:(t,r)=>\"is\"!==r.path[0]&&\"string\"!=typeof t._flags.label?t.label(e):void 0,ref:!1})}},rebuild(e){e.$_modify({each:t=>{i.isSchema(t)&&\"array\"===t.type&&e.$_setFlag(\"_arrayItems\",!0,{clone:!1})}})},manifest:{build(e,t){if(t.matches)for(const r of t.matches){const{schema:t,ref:s,is:n,not:a,then:i,otherwise:o}=r;e=t?e.try(t):s?e.conditional(s,{is:n,then:i,not:a,otherwise:o,switch:r.switch}):e.conditional(n,{then:i,otherwise:o})}return e}},messages:{\"alternatives.all\":\"{{#label}} does not match all of the required types\",\"alternatives.any\":\"{{#label}} does not match any of the allowed types\",\"alternatives.match\":\"{{#label}} does not match any of the allowed types\",\"alternatives.one\":\"{{#label}} matches more than one allowed type\",\"alternatives.types\":\"{{#label}} must be one of {{#types}}\"}}),u.errors=function(e,{error:t,state:r}){if(!e.length)return{errors:t(\"alternatives.any\")};if(1===e.length)return{errors:e[0].reports};const s=new Set,n=[];for(const{reports:a,schema:i}of e){if(a.length>1)return u.unmatched(e,t);const o=a[0];if(o instanceof l.Report==0)return u.unmatched(e,t);if(o.state.path.length!==r.path.length){n.push({type:i.type,report:o});continue}if(\"any.only\"===o.code){for(const e of o.local.valids)s.add(e);continue}const[c,f]=o.code.split(\".\");\"base\"===f?s.add(c):n.push({type:i.type,report:o})}return n.length?1===n.length?{errors:n[0].report}:u.unmatched(e,t):{errors:t(\"alternatives.types\",{types:[...s]})}},u.unmatched=function(e,t){const r=[];for(const t of e)r.push(...t.reports);return{errors:t(\"alternatives.match\",l.details(r,{override:!1}))}}},8068:(e,t,r)=>{\"use strict\";const s=r(375),n=r(7629),a=r(8160),i=r(6914);e.exports=n.extend({type:\"any\",flags:{only:{default:!1}},terms:{alterations:{init:null},examples:{init:null},externals:{init:null},metas:{init:[]},notes:{init:[]},shared:{init:null},tags:{init:[]},whens:{init:null}},rules:{custom:{method(e,t){return s(\"function\"==typeof e,\"Method must be a function\"),s(void 0===t||t&&\"string\"==typeof t,\"Description must be a non-empty string\"),this.$_addRule({name:\"custom\",args:{method:e,description:t}})},validate(e,t,{method:r}){try{return r(e,t)}catch(e){return t.error(\"any.custom\",{error:e})}},args:[\"method\",\"description\"],multi:!0},messages:{method(e){return this.prefs({messages:e})}},shared:{method(e){s(a.isSchema(e)&&e._flags.id,\"Schema must be a schema with an id\");const t=this.clone();return t.$_terms.shared=t.$_terms.shared||[],t.$_terms.shared.push(e),t.$_mutateRegister(e),t}},warning:{method(e,t){return s(e&&\"string\"==typeof e,\"Invalid warning code\"),this.$_addRule({name:\"warning\",args:{code:e,local:t},warn:!0})},validate:(e,t,{code:r,local:s})=>t.error(r,s),args:[\"code\",\"local\"],multi:!0}},modifiers:{keep(e,t=!0){e.keep=t},message(e,t){e.message=i.compile(t)},warn(e,t=!0){e.warn=t}},manifest:{build(e,t){for(const r in t){const s=t[r];if([\"examples\",\"externals\",\"metas\",\"notes\",\"tags\"].includes(r))for(const t of s)e=e[r.slice(0,-1)](t);else if(\"alterations\"!==r)if(\"whens\"!==r){if(\"shared\"===r)for(const t of s)e=e.shared(t)}else for(const t of s){const{ref:r,is:s,not:n,then:a,otherwise:i,concat:o}=t;e=o?e.concat(o):r?e.when(r,{is:s,not:n,then:a,otherwise:i,switch:t.switch,break:t.break}):e.when(s,{then:a,otherwise:i,break:t.break})}else{const t={};for(const{target:e,adjuster:r}of s)t[e]=r;e=e.alter(t)}}return e}},messages:{\"any.custom\":\"{{#label}} failed custom validation because {{#error.message}}\",\"any.default\":\"{{#label}} threw an error when running default method\",\"any.failover\":\"{{#label}} threw an error when running failover method\",\"any.invalid\":\"{{#label}} contains an invalid value\",\"any.only\":'{{#label}} must be {if(#valids.length == 1, \"\", \"one of \")}{{#valids}}',\"any.ref\":\"{{#label}} {{#arg}} references {{:#ref}} which {{#reason}}\",\"any.required\":\"{{#label}} is required\",\"any.unknown\":\"{{#label}} is not allowed\"}})},546:(e,t,r)=>{\"use strict\";const s=r(375),n=r(9474),a=r(9621),i=r(8068),o=r(8160),l=r(3292),c={};e.exports=i.extend({type:\"array\",flags:{single:{default:!1},sparse:{default:!1}},terms:{items:{init:[],manifest:\"schema\"},ordered:{init:[],manifest:\"schema\"},_exclusions:{init:[]},_inclusions:{init:[]},_requireds:{init:[]}},coerce:{from:\"object\",method(e,{schema:t,state:r,prefs:s}){if(!Array.isArray(e))return;const n=t.$_getRule(\"sort\");return n?c.sort(t,e,n.args.options,r,s):void 0}},validate(e,{schema:t,error:r}){if(!Array.isArray(e)){if(t._flags.single){const t=[e];return t[o.symbols.arraySingle]=!0,{value:t}}return{errors:r(\"array.base\")}}if(t.$_getRule(\"items\")||t.$_terms.externals)return{value:e.slice()}},rules:{has:{method(e){e=this.$_compile(e,{appendPath:!0});const t=this.$_addRule({name:\"has\",args:{schema:e}});return t.$_mutateRegister(e),t},validate(e,{state:t,prefs:r,error:s},{schema:n}){const a=[e,...t.ancestors];for(let s=0;s<e.length;++s){const i=t.localize([...t.path,s],a,n);if(n.$_match(e[s],i,r))return e}const i=n._flags.label;return i?s(\"array.hasKnown\",{patternLabel:i}):s(\"array.hasUnknown\",null)},multi:!0},items:{method(...e){o.verifyFlat(e,\"items\");const t=this.$_addRule(\"items\");for(let r=0;r<e.length;++r){const s=o.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});t.$_terms.items.push(s)}return t.$_mutateRebuild()},validate(e,{schema:t,error:r,state:s,prefs:n,errorsArray:a}){const i=t.$_terms._requireds.slice(),l=t.$_terms.ordered.slice(),u=[...t.$_terms._inclusions,...i],f=!e[o.symbols.arraySingle];delete e[o.symbols.arraySingle];const m=a();let h=e.length;for(let a=0;a<h;++a){const o=e[a];let d=!1,p=!1;const g=f?a:new Number(a),y=[...s.path,g];if(!t._flags.sparse&&void 0===o){if(m.push(r(\"array.sparse\",{key:g,path:y,pos:a,value:void 0},s.localize(y))),n.abortEarly)return m;l.shift();continue}const b=[e,...s.ancestors];for(const e of t.$_terms._exclusions)if(e.$_match(o,s.localize(y,b,e),n,{presence:\"ignore\"})){if(m.push(r(\"array.excludes\",{pos:a,value:o},s.localize(y))),n.abortEarly)return m;d=!0,l.shift();break}if(d)continue;if(t.$_terms.ordered.length){if(l.length){const i=l.shift(),u=i.$_validate(o,s.localize(y,b,i),n);if(u.errors){if(m.push(...u.errors),n.abortEarly)return m}else if(\"strip\"===i._flags.result)c.fastSplice(e,a),--a,--h;else{if(!t._flags.sparse&&void 0===u.value){if(m.push(r(\"array.sparse\",{key:g,path:y,pos:a,value:void 0},s.localize(y))),n.abortEarly)return m;continue}e[a]=u.value}continue}if(!t.$_terms.items.length){if(m.push(r(\"array.orderedLength\",{pos:a,limit:t.$_terms.ordered.length})),n.abortEarly)return m;break}}const v=[];let _=i.length;for(let l=0;l<_;++l){const u=s.localize(y,b,i[l]);u.snapshot();const f=i[l].$_validate(o,u,n);if(v[l]=f,!f.errors){if(u.commit(),e[a]=f.value,p=!0,c.fastSplice(i,l),--l,--_,!t._flags.sparse&&void 0===f.value&&(m.push(r(\"array.sparse\",{key:g,path:y,pos:a,value:void 0},s.localize(y))),n.abortEarly))return m;break}u.restore()}if(p)continue;const w=n.stripUnknown&&!!n.stripUnknown.arrays||!1;_=u.length;for(const l of u){let u;const f=i.indexOf(l);if(-1!==f)u=v[f];else{const i=s.localize(y,b,l);if(i.snapshot(),u=l.$_validate(o,i,n),!u.errors){i.commit(),\"strip\"===l._flags.result?(c.fastSplice(e,a),--a,--h):t._flags.sparse||void 0!==u.value?e[a]=u.value:(m.push(r(\"array.sparse\",{key:g,path:y,pos:a,value:void 0},s.localize(y))),d=!0),p=!0;break}i.restore()}if(1===_){if(w){c.fastSplice(e,a),--a,--h,p=!0;break}if(m.push(...u.errors),n.abortEarly)return m;d=!0;break}}if(!d&&(t.$_terms._inclusions.length||t.$_terms._requireds.length)&&!p){if(w){c.fastSplice(e,a),--a,--h;continue}if(m.push(r(\"array.includes\",{pos:a,value:o},s.localize(y))),n.abortEarly)return m}}return i.length&&c.fillMissedErrors(t,m,i,e,s,n),l.length&&(c.fillOrderedErrors(t,m,l,e,s,n),m.length||c.fillDefault(l,e,s,n)),m.length?m:e},priority:!0,manifest:!1},length:{method(e){return this.$_addRule({name:\"length\",args:{limit:e},operator:\"=\"})},validate:(e,t,{limit:r},{name:s,operator:n,args:a})=>o.compare(e.length,r,n)?e:t.error(\"array.\"+s,{limit:a.limit,value:e}),args:[{name:\"limit\",ref:!0,assert:o.limit,message:\"must be a positive integer\"}]},max:{method(e){return this.$_addRule({name:\"max\",method:\"length\",args:{limit:e},operator:\"<=\"})}},min:{method(e){return this.$_addRule({name:\"min\",method:\"length\",args:{limit:e},operator:\">=\"})}},ordered:{method(...e){o.verifyFlat(e,\"ordered\");const t=this.$_addRule(\"items\");for(let r=0;r<e.length;++r){const s=o.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});c.validateSingle(s,t),t.$_mutateRegister(s),t.$_terms.ordered.push(s)}return t.$_mutateRebuild()}},single:{method(e){const t=void 0===e||!!e;return s(!t||!this._flags._arrayItems,\"Cannot specify single rule when array has array items\"),this.$_setFlag(\"single\",t)}},sort:{method(e={}){o.assertOptions(e,[\"by\",\"order\"]);const t={order:e.order||\"ascending\"};return e.by&&(t.by=l.ref(e.by,{ancestor:0}),s(!t.by.ancestor,\"Cannot sort by ancestor\")),this.$_addRule({name:\"sort\",args:{options:t}})},validate(e,{error:t,state:r,prefs:s,schema:n},{options:a}){const{value:i,errors:o}=c.sort(n,e,a,r,s);if(o)return o;for(let r=0;r<e.length;++r)if(e[r]!==i[r])return t(\"array.sort\",{order:a.order,by:a.by?a.by.key:\"value\"});return e},convert:!0},sparse:{method(e){const t=void 0===e||!!e;return this._flags.sparse===t?this:(t?this.clone():this.$_addRule(\"items\")).$_setFlag(\"sparse\",t,{clone:!1})}},unique:{method(e,t={}){s(!e||\"function\"==typeof e||\"string\"==typeof e,\"comparator must be a function or a string\"),o.assertOptions(t,[\"ignoreUndefined\",\"separator\"]);const r={name:\"unique\",args:{options:t,comparator:e}};if(e)if(\"string\"==typeof e){const s=o.default(t.separator,\".\");r.path=s?e.split(s):[e]}else r.comparator=e;return this.$_addRule(r)},validate(e,{state:t,error:r,schema:i},{comparator:o,options:l},{comparator:c,path:u}){const f={string:Object.create(null),number:Object.create(null),undefined:Object.create(null),boolean:Object.create(null),object:new Map,function:new Map,custom:new Map},m=c||n,h=l.ignoreUndefined;for(let n=0;n<e.length;++n){const i=u?a(e[n],u):e[n],l=c?f.custom:f[typeof i];if(s(l,\"Failed to find unique map container for type\",typeof i),l instanceof Map){const s=l.entries();let a;for(;!(a=s.next()).done;)if(m(a.value[0],i)){const s=t.localize([...t.path,n],[e,...t.ancestors]),i={pos:n,value:e[n],dupePos:a.value[1],dupeValue:e[a.value[1]]};return u&&(i.path=o),r(\"array.unique\",i,s)}l.set(i,n)}else{if((!h||void 0!==i)&&void 0!==l[i]){const s={pos:n,value:e[n],dupePos:l[i],dupeValue:e[l[i]]};return u&&(s.path=o),r(\"array.unique\",s,t.localize([...t.path,n],[e,...t.ancestors]))}l[i]=n}}return e},args:[\"comparator\",\"options\"],multi:!0}},cast:{set:{from:Array.isArray,to:(e,t)=>new Set(e)}},rebuild(e){e.$_terms._inclusions=[],e.$_terms._exclusions=[],e.$_terms._requireds=[];for(const t of e.$_terms.items)c.validateSingle(t,e),\"required\"===t._flags.presence?e.$_terms._requireds.push(t):\"forbidden\"===t._flags.presence?e.$_terms._exclusions.push(t):e.$_terms._inclusions.push(t);for(const t of e.$_terms.ordered)c.validateSingle(t,e)},manifest:{build:(e,t)=>(t.items&&(e=e.items(...t.items)),t.ordered&&(e=e.ordered(...t.ordered)),e)},messages:{\"array.base\":\"{{#label}} must be an array\",\"array.excludes\":\"{{#label}} contains an excluded value\",\"array.hasKnown\":\"{{#label}} does not contain at least one required match for type {:#patternLabel}\",\"array.hasUnknown\":\"{{#label}} does not contain at least one required match\",\"array.includes\":\"{{#label}} does not match any of the allowed types\",\"array.includesRequiredBoth\":\"{{#label}} does not contain {{#knownMisses}} and {{#unknownMisses}} other required value(s)\",\"array.includesRequiredKnowns\":\"{{#label}} does not contain {{#knownMisses}}\",\"array.includesRequiredUnknowns\":\"{{#label}} does not contain {{#unknownMisses}} required value(s)\",\"array.length\":\"{{#label}} must contain {{#limit}} items\",\"array.max\":\"{{#label}} must contain less than or equal to {{#limit}} items\",\"array.min\":\"{{#label}} must contain at least {{#limit}} items\",\"array.orderedLength\":\"{{#label}} must contain at most {{#limit}} items\",\"array.sort\":\"{{#label}} must be sorted in {#order} order by {{#by}}\",\"array.sort.mismatching\":\"{{#label}} cannot be sorted due to mismatching types\",\"array.sort.unsupported\":\"{{#label}} cannot be sorted due to unsupported type {#type}\",\"array.sparse\":\"{{#label}} must not be a sparse array item\",\"array.unique\":\"{{#label}} contains a duplicate value\"}}),c.fillMissedErrors=function(e,t,r,s,n,a){const i=[];let o=0;for(const e of r){const t=e._flags.label;t?i.push(t):++o}i.length?o?t.push(e.$_createError(\"array.includesRequiredBoth\",s,{knownMisses:i,unknownMisses:o},n,a)):t.push(e.$_createError(\"array.includesRequiredKnowns\",s,{knownMisses:i},n,a)):t.push(e.$_createError(\"array.includesRequiredUnknowns\",s,{unknownMisses:o},n,a))},c.fillOrderedErrors=function(e,t,r,s,n,a){const i=[];for(const e of r)\"required\"===e._flags.presence&&i.push(e);i.length&&c.fillMissedErrors(e,t,i,s,n,a)},c.fillDefault=function(e,t,r,s){const n=[];let a=!0;for(let i=e.length-1;i>=0;--i){const o=e[i],l=[t,...r.ancestors],c=o.$_validate(void 0,r.localize(r.path,l,o),s).value;if(a){if(void 0===c)continue;a=!1}n.unshift(c)}n.length&&t.push(...n)},c.fastSplice=function(e,t){let r=t;for(;r<e.length;)e[r++]=e[r];--e.length},c.validateSingle=function(e,t){(\"array\"===e.type||e._flags._arrayItems)&&(s(!t._flags.single,\"Cannot specify array item with single rule enabled\"),t.$_setFlag(\"_arrayItems\",!0,{clone:!1}))},c.sort=function(e,t,r,s,n){const a=\"ascending\"===r.order?1:-1,i=-1*a,o=a,l=(l,u)=>{let f=c.compare(l,u,i,o);if(null!==f)return f;if(r.by&&(l=r.by.resolve(l,s,n),u=r.by.resolve(u,s,n)),f=c.compare(l,u,i,o),null!==f)return f;const m=typeof l;if(m!==typeof u)throw e.$_createError(\"array.sort.mismatching\",t,null,s,n);if(\"number\"!==m&&\"string\"!==m)throw e.$_createError(\"array.sort.unsupported\",t,{type:m},s,n);return\"number\"===m?(l-u)*a:l<u?i:o};try{return{value:t.slice().sort(l)}}catch(e){return{errors:e}}},c.compare=function(e,t,r,s){return e===t?0:void 0===e?1:void 0===t?-1:null===e?s:null===t?r:null}},4937:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8068),a=r(8160),i=r(2036),o={isBool:function(e){return\"boolean\"==typeof e}};e.exports=n.extend({type:\"boolean\",flags:{sensitive:{default:!1}},terms:{falsy:{init:null,manifest:\"values\"},truthy:{init:null,manifest:\"values\"}},coerce(e,{schema:t}){if(\"boolean\"!=typeof e){if(\"string\"==typeof e){const r=t._flags.sensitive?e:e.toLowerCase();e=\"true\"===r||\"false\"!==r&&e}return\"boolean\"!=typeof e&&(e=t.$_terms.truthy&&t.$_terms.truthy.has(e,null,null,!t._flags.sensitive)||(!t.$_terms.falsy||!t.$_terms.falsy.has(e,null,null,!t._flags.sensitive))&&e),{value:e}}},validate(e,{error:t}){if(\"boolean\"!=typeof e)return{value:e,errors:t(\"boolean.base\")}},rules:{truthy:{method(...e){a.verifyFlat(e,\"truthy\");const t=this.clone();t.$_terms.truthy=t.$_terms.truthy||new i;for(let r=0;r<e.length;++r){const n=e[r];s(void 0!==n,\"Cannot call truthy with undefined\"),t.$_terms.truthy.add(n)}return t}},falsy:{method(...e){a.verifyFlat(e,\"falsy\");const t=this.clone();t.$_terms.falsy=t.$_terms.falsy||new i;for(let r=0;r<e.length;++r){const n=e[r];s(void 0!==n,\"Cannot call falsy with undefined\"),t.$_terms.falsy.add(n)}return t}},sensitive:{method(e=!0){return this.$_setFlag(\"sensitive\",e)}}},cast:{number:{from:o.isBool,to:(e,t)=>e?1:0},string:{from:o.isBool,to:(e,t)=>e?\"true\":\"false\"}},manifest:{build:(e,t)=>(t.truthy&&(e=e.truthy(...t.truthy)),t.falsy&&(e=e.falsy(...t.falsy)),e)},messages:{\"boolean.base\":\"{{#label}} must be a boolean\"}})},7500:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8068),a=r(8160),i=r(3328),o={isDate:function(e){return e instanceof Date}};e.exports=n.extend({type:\"date\",coerce:{from:[\"number\",\"string\"],method:(e,{schema:t})=>({value:o.parse(e,t._flags.format)||e})},validate(e,{schema:t,error:r,prefs:s}){if(e instanceof Date&&!isNaN(e.getTime()))return;const n=t._flags.format;return s.convert&&n&&\"string\"==typeof e?{value:e,errors:r(\"date.format\",{format:n})}:{value:e,errors:r(\"date.base\")}},rules:{compare:{method:!1,validate(e,t,{date:r},{name:s,operator:n,args:i}){const o=\"now\"===r?Date.now():r.getTime();return a.compare(e.getTime(),o,n)?e:t.error(\"date.\"+s,{limit:i.date,value:e})},args:[{name:\"date\",ref:!0,normalize:e=>\"now\"===e?e:o.parse(e),assert:e=>null!==e,message:\"must have a valid date format\"}]},format:{method(e){return s([\"iso\",\"javascript\",\"unix\"].includes(e),\"Unknown date format\",e),this.$_setFlag(\"format\",e)}},greater:{method(e){return this.$_addRule({name:\"greater\",method:\"compare\",args:{date:e},operator:\">\"})}},iso:{method(){return this.format(\"iso\")}},less:{method(e){return this.$_addRule({name:\"less\",method:\"compare\",args:{date:e},operator:\"<\"})}},max:{method(e){return this.$_addRule({name:\"max\",method:\"compare\",args:{date:e},operator:\"<=\"})}},min:{method(e){return this.$_addRule({name:\"min\",method:\"compare\",args:{date:e},operator:\">=\"})}},timestamp:{method(e=\"javascript\"){return s([\"javascript\",\"unix\"].includes(e),'\"type\" must be one of \"javascript, unix\"'),this.format(e)}}},cast:{number:{from:o.isDate,to:(e,t)=>e.getTime()},string:{from:o.isDate,to:(e,{prefs:t})=>i.date(e,t)}},messages:{\"date.base\":\"{{#label}} must be a valid date\",\"date.format\":'{{#label}} must be in {msg(\"date.format.\" + #format) || #format} format',\"date.greater\":\"{{#label}} must be greater than {{:#limit}}\",\"date.less\":\"{{#label}} must be less than {{:#limit}}\",\"date.max\":\"{{#label}} must be less than or equal to {{:#limit}}\",\"date.min\":\"{{#label}} must be greater than or equal to {{:#limit}}\",\"date.format.iso\":\"ISO 8601 date\",\"date.format.javascript\":\"timestamp or number of milliseconds\",\"date.format.unix\":\"timestamp or number of seconds\"}}),o.parse=function(e,t){if(e instanceof Date)return e;if(\"string\"!=typeof e&&(isNaN(e)||!isFinite(e)))return null;if(/^\\s*$/.test(e))return null;if(\"iso\"===t)return a.isIsoDate(e)?o.date(e.toString()):null;const r=e;if(\"string\"==typeof e&&/^[+-]?\\d+(\\.\\d+)?$/.test(e)&&(e=parseFloat(e)),t){if(\"javascript\"===t)return o.date(1*e);if(\"unix\"===t)return o.date(1e3*e);if(\"string\"==typeof r)return null}return o.date(e)},o.date=function(e){const t=new Date(e);return isNaN(t.getTime())?null:t}},390:(e,t,r)=>{\"use strict\";const s=r(375),n=r(7824);e.exports=n.extend({type:\"function\",properties:{typeof:\"function\"},rules:{arity:{method(e){return s(Number.isSafeInteger(e)&&e>=0,\"n must be a positive integer\"),this.$_addRule({name:\"arity\",args:{n:e}})},validate:(e,t,{n:r})=>e.length===r?e:t.error(\"function.arity\",{n:r})},class:{method(){return this.$_addRule(\"class\")},validate:(e,t)=>/^\\s*class\\s/.test(e.toString())?e:t.error(\"function.class\",{value:e})},minArity:{method(e){return s(Number.isSafeInteger(e)&&e>0,\"n must be a strict positive integer\"),this.$_addRule({name:\"minArity\",args:{n:e}})},validate:(e,t,{n:r})=>e.length>=r?e:t.error(\"function.minArity\",{n:r})},maxArity:{method(e){return s(Number.isSafeInteger(e)&&e>=0,\"n must be a positive integer\"),this.$_addRule({name:\"maxArity\",args:{n:e}})},validate:(e,t,{n:r})=>e.length<=r?e:t.error(\"function.maxArity\",{n:r})}},messages:{\"function.arity\":\"{{#label}} must have an arity of {{#n}}\",\"function.class\":\"{{#label}} must be a class\",\"function.maxArity\":\"{{#label}} must have an arity lesser or equal to {{#n}}\",\"function.minArity\":\"{{#label}} must have an arity greater or equal to {{#n}}\"}})},7824:(e,t,r)=>{\"use strict\";const s=r(978),n=r(375),a=r(8571),i=r(3652),o=r(8068),l=r(8160),c=r(3292),u=r(6354),f=r(6133),m=r(3328),h={renameDefaults:{alias:!1,multiple:!1,override:!1}};e.exports=o.extend({type:\"_keys\",properties:{typeof:\"object\"},flags:{unknown:{default:!1}},terms:{dependencies:{init:null},keys:{init:null,manifest:{mapped:{from:\"schema\",to:\"key\"}}},patterns:{init:null},renames:{init:null}},args:(e,t)=>e.keys(t),validate(e,{schema:t,error:r,state:s,prefs:n}){if(!e||typeof e!==t.$_property(\"typeof\")||Array.isArray(e))return{value:e,errors:r(\"object.base\",{type:t.$_property(\"typeof\")})};if(!(t.$_terms.renames||t.$_terms.dependencies||t.$_terms.keys||t.$_terms.patterns||t.$_terms.externals))return;e=h.clone(e,n);const a=[];if(t.$_terms.renames&&!h.rename(t,e,s,n,a))return{value:e,errors:a};if(!t.$_terms.keys&&!t.$_terms.patterns&&!t.$_terms.dependencies)return{value:e,errors:a};const i=new Set(Object.keys(e));if(t.$_terms.keys){const r=[e,...s.ancestors];for(const o of t.$_terms.keys){const t=o.key,l=e[t];i.delete(t);const c=s.localize([...s.path,t],r,o),u=o.schema.$_validate(l,c,n);if(u.errors){if(n.abortEarly)return{value:e,errors:u.errors};void 0!==u.value&&(e[t]=u.value),a.push(...u.errors)}else\"strip\"===o.schema._flags.result||void 0===u.value&&void 0!==l?delete e[t]:void 0!==u.value&&(e[t]=u.value)}}if(i.size||t._flags._hasPatternMatch){const r=h.unknown(t,e,i,a,s,n);if(r)return r}if(t.$_terms.dependencies)for(const r of t.$_terms.dependencies){if(null!==r.key&&!1===h.isPresent(r.options)(r.key.resolve(e,s,n,null,{shadow:!1})))continue;const i=h.dependencies[r.rel](t,r,e,s,n);if(i){const r=t.$_createError(i.code,e,i.context,s,n);if(n.abortEarly)return{value:e,errors:r};a.push(r)}}return{value:e,errors:a}},rules:{and:{method(...e){return l.verifyFlat(e,\"and\"),h.dependency(this,\"and\",null,e)}},append:{method(e){return null==e||0===Object.keys(e).length?this:this.keys(e)}},assert:{method(e,t,r){m.isTemplate(e)||(e=c.ref(e)),n(void 0===r||\"string\"==typeof r,\"Message must be a string\"),t=this.$_compile(t,{appendPath:!0});const s=this.$_addRule({name:\"assert\",args:{subject:e,schema:t,message:r}});return s.$_mutateRegister(e),s.$_mutateRegister(t),s},validate(e,{error:t,prefs:r,state:s},{subject:n,schema:a,message:i}){const o=n.resolve(e,s,r),l=f.isRef(n)?n.absolute(s):[];return a.$_match(o,s.localize(l,[e,...s.ancestors],a),r)?e:t(\"object.assert\",{subject:n,message:i})},args:[\"subject\",\"schema\",\"message\"],multi:!0},instance:{method(e,t){return n(\"function\"==typeof e,\"constructor must be a function\"),t=t||e.name,this.$_addRule({name:\"instance\",args:{constructor:e,name:t}})},validate:(e,t,{constructor:r,name:s})=>e instanceof r?e:t.error(\"object.instance\",{type:s,value:e}),args:[\"constructor\",\"name\"]},keys:{method(e){n(void 0===e||\"object\"==typeof e,\"Object schema must be a valid object\"),n(!l.isSchema(e),\"Object schema cannot be a joi schema\");const t=this.clone();if(e)if(Object.keys(e).length){t.$_terms.keys=t.$_terms.keys?t.$_terms.keys.filter((t=>!e.hasOwnProperty(t.key))):new h.Keys;for(const r in e)l.tryWithPath((()=>t.$_terms.keys.push({key:r,schema:this.$_compile(e[r])})),r)}else t.$_terms.keys=new h.Keys;else t.$_terms.keys=null;return t.$_mutateRebuild()}},length:{method(e){return this.$_addRule({name:\"length\",args:{limit:e},operator:\"=\"})},validate:(e,t,{limit:r},{name:s,operator:n,args:a})=>l.compare(Object.keys(e).length,r,n)?e:t.error(\"object.\"+s,{limit:a.limit,value:e}),args:[{name:\"limit\",ref:!0,assert:l.limit,message:\"must be a positive integer\"}]},max:{method(e){return this.$_addRule({name:\"max\",method:\"length\",args:{limit:e},operator:\"<=\"})}},min:{method(e){return this.$_addRule({name:\"min\",method:\"length\",args:{limit:e},operator:\">=\"})}},nand:{method(...e){return l.verifyFlat(e,\"nand\"),h.dependency(this,\"nand\",null,e)}},or:{method(...e){return l.verifyFlat(e,\"or\"),h.dependency(this,\"or\",null,e)}},oxor:{method(...e){return h.dependency(this,\"oxor\",null,e)}},pattern:{method(e,t,r={}){const s=e instanceof RegExp;s||(e=this.$_compile(e,{appendPath:!0})),n(void 0!==t,\"Invalid rule\"),l.assertOptions(r,[\"fallthrough\",\"matches\"]),s&&n(!e.flags.includes(\"g\")&&!e.flags.includes(\"y\"),\"pattern should not use global or sticky mode\"),t=this.$_compile(t,{appendPath:!0});const a=this.clone();a.$_terms.patterns=a.$_terms.patterns||[];const i={[s?\"regex\":\"schema\"]:e,rule:t};return r.matches&&(i.matches=this.$_compile(r.matches),\"array\"!==i.matches.type&&(i.matches=i.matches.$_root.array().items(i.matches)),a.$_mutateRegister(i.matches),a.$_setFlag(\"_hasPatternMatch\",!0,{clone:!1})),r.fallthrough&&(i.fallthrough=!0),a.$_terms.patterns.push(i),a.$_mutateRegister(t),a}},ref:{method(){return this.$_addRule(\"ref\")},validate:(e,t)=>f.isRef(e)?e:t.error(\"object.refType\",{value:e})},regex:{method(){return this.$_addRule(\"regex\")},validate:(e,t)=>e instanceof RegExp?e:t.error(\"object.regex\",{value:e})},rename:{method(e,t,r={}){n(\"string\"==typeof e||e instanceof RegExp,\"Rename missing the from argument\"),n(\"string\"==typeof t||t instanceof m,\"Invalid rename to argument\"),n(t!==e,\"Cannot rename key to same name:\",e),l.assertOptions(r,[\"alias\",\"ignoreUndefined\",\"override\",\"multiple\"]);const a=this.clone();a.$_terms.renames=a.$_terms.renames||[];for(const t of a.$_terms.renames)n(t.from!==e,\"Cannot rename the same key multiple times\");return t instanceof m&&a.$_mutateRegister(t),a.$_terms.renames.push({from:e,to:t,options:s(h.renameDefaults,r)}),a}},schema:{method(e=\"any\"){return this.$_addRule({name:\"schema\",args:{type:e}})},validate:(e,t,{type:r})=>!l.isSchema(e)||\"any\"!==r&&e.type!==r?t.error(\"object.schema\",{type:r}):e},unknown:{method(e){return this.$_setFlag(\"unknown\",!1!==e)}},with:{method(e,t,r={}){return h.dependency(this,\"with\",e,t,r)}},without:{method(e,t,r={}){return h.dependency(this,\"without\",e,t,r)}},xor:{method(...e){return l.verifyFlat(e,\"xor\"),h.dependency(this,\"xor\",null,e)}}},overrides:{default(e,t){return void 0===e&&(e=l.symbols.deepDefault),this.$_parent(\"default\",e,t)}},rebuild(e){if(e.$_terms.keys){const t=new i.Sorter;for(const r of e.$_terms.keys)l.tryWithPath((()=>t.add(r,{after:r.schema.$_rootReferences(),group:r.key})),r.key);e.$_terms.keys=new h.Keys(...t.nodes)}},manifest:{build(e,t){if(t.keys&&(e=e.keys(t.keys)),t.dependencies)for(const{rel:r,key:s=null,peers:n,options:a}of t.dependencies)e=h.dependency(e,r,s,n,a);if(t.patterns)for(const{regex:r,schema:s,rule:n,fallthrough:a,matches:i}of t.patterns)e=e.pattern(r||s,n,{fallthrough:a,matches:i});if(t.renames)for(const{from:r,to:s,options:n}of t.renames)e=e.rename(r,s,n);return e}},messages:{\"object.and\":\"{{#label}} contains {{#presentWithLabels}} without its required peers {{#missingWithLabels}}\",\"object.assert\":'{{#label}} is invalid because {if(#subject.key, `\"` + #subject.key + `\" failed to ` + (#message || \"pass the assertion test\"), #message || \"the assertion failed\")}',\"object.base\":\"{{#label}} must be of type {{#type}}\",\"object.instance\":\"{{#label}} must be an instance of {{:#type}}\",\"object.length\":'{{#label}} must have {{#limit}} key{if(#limit == 1, \"\", \"s\")}',\"object.max\":'{{#label}} must have less than or equal to {{#limit}} key{if(#limit == 1, \"\", \"s\")}',\"object.min\":'{{#label}} must have at least {{#limit}} key{if(#limit == 1, \"\", \"s\")}',\"object.missing\":\"{{#label}} must contain at least one of {{#peersWithLabels}}\",\"object.nand\":\"{{:#mainWithLabel}} must not exist simultaneously with {{#peersWithLabels}}\",\"object.oxor\":\"{{#label}} contains a conflict between optional exclusive peers {{#peersWithLabels}}\",\"object.pattern.match\":\"{{#label}} keys failed to match pattern requirements\",\"object.refType\":\"{{#label}} must be a Joi reference\",\"object.regex\":\"{{#label}} must be a RegExp object\",\"object.rename.multiple\":\"{{#label}} cannot rename {{:#from}} because multiple renames are disabled and another key was already renamed to {{:#to}}\",\"object.rename.override\":\"{{#label}} cannot rename {{:#from}} because override is disabled and target {{:#to}} exists\",\"object.schema\":\"{{#label}} must be a Joi schema of {{#type}} type\",\"object.unknown\":\"{{#label}} is not allowed\",\"object.with\":\"{{:#mainWithLabel}} missing required peer {{:#peerWithLabel}}\",\"object.without\":\"{{:#mainWithLabel}} conflict with forbidden peer {{:#peerWithLabel}}\",\"object.xor\":\"{{#label}} contains a conflict between exclusive peers {{#peersWithLabels}}\"}}),h.clone=function(e,t){if(\"object\"==typeof e){if(t.nonEnumerables)return a(e,{shallow:!0});const r=Object.create(Object.getPrototypeOf(e));return Object.assign(r,e),r}const r=function(...t){return e.apply(this,t)};return r.prototype=a(e.prototype),Object.defineProperty(r,\"name\",{value:e.name,writable:!1}),Object.defineProperty(r,\"length\",{value:e.length,writable:!1}),Object.assign(r,e),r},h.dependency=function(e,t,r,s,a){n(null===r||\"string\"==typeof r,t,\"key must be a strings\"),a||(a=s.length>1&&\"object\"==typeof s[s.length-1]?s.pop():{}),l.assertOptions(a,[\"separator\",\"isPresent\"]),s=[].concat(s);const i=l.default(a.separator,\".\"),o=[];for(const e of s)n(\"string\"==typeof e,t,\"peers must be strings\"),o.push(c.ref(e,{separator:i,ancestor:0,prefix:!1}));null!==r&&(r=c.ref(r,{separator:i,ancestor:0,prefix:!1}));const u=e.clone();return u.$_terms.dependencies=u.$_terms.dependencies||[],u.$_terms.dependencies.push(new h.Dependency(t,r,o,s,a)),u},h.dependencies={and(e,t,r,s,n){const a=[],i=[],o=t.peers.length,l=h.isPresent(t.options);for(const e of t.peers)!1===l(e.resolve(r,s,n,null,{shadow:!1}))?a.push(e.key):i.push(e.key);if(a.length!==o&&i.length!==o)return{code:\"object.and\",context:{present:i,presentWithLabels:h.keysToLabels(e,i),missing:a,missingWithLabels:h.keysToLabels(e,a)}}},nand(e,t,r,s,n){const a=[],i=h.isPresent(t.options);for(const e of t.peers)i(e.resolve(r,s,n,null,{shadow:!1}))&&a.push(e.key);if(a.length!==t.peers.length)return;const o=t.paths[0],l=t.paths.slice(1);return{code:\"object.nand\",context:{main:o,mainWithLabel:h.keysToLabels(e,o),peers:l,peersWithLabels:h.keysToLabels(e,l)}}},or(e,t,r,s,n){const a=h.isPresent(t.options);for(const e of t.peers)if(a(e.resolve(r,s,n,null,{shadow:!1})))return;return{code:\"object.missing\",context:{peers:t.paths,peersWithLabels:h.keysToLabels(e,t.paths)}}},oxor(e,t,r,s,n){const a=[],i=h.isPresent(t.options);for(const e of t.peers)i(e.resolve(r,s,n,null,{shadow:!1}))&&a.push(e.key);if(!a.length||1===a.length)return;const o={peers:t.paths,peersWithLabels:h.keysToLabels(e,t.paths)};return o.present=a,o.presentWithLabels=h.keysToLabels(e,a),{code:\"object.oxor\",context:o}},with(e,t,r,s,n){const a=h.isPresent(t.options);for(const i of t.peers)if(!1===a(i.resolve(r,s,n,null,{shadow:!1})))return{code:\"object.with\",context:{main:t.key.key,mainWithLabel:h.keysToLabels(e,t.key.key),peer:i.key,peerWithLabel:h.keysToLabels(e,i.key)}}},without(e,t,r,s,n){const a=h.isPresent(t.options);for(const i of t.peers)if(a(i.resolve(r,s,n,null,{shadow:!1})))return{code:\"object.without\",context:{main:t.key.key,mainWithLabel:h.keysToLabels(e,t.key.key),peer:i.key,peerWithLabel:h.keysToLabels(e,i.key)}}},xor(e,t,r,s,n){const a=[],i=h.isPresent(t.options);for(const e of t.peers)i(e.resolve(r,s,n,null,{shadow:!1}))&&a.push(e.key);if(1===a.length)return;const o={peers:t.paths,peersWithLabels:h.keysToLabels(e,t.paths)};return 0===a.length?{code:\"object.missing\",context:o}:(o.present=a,o.presentWithLabels=h.keysToLabels(e,a),{code:\"object.xor\",context:o})}},h.keysToLabels=function(e,t){return Array.isArray(t)?t.map((t=>e.$_mapLabels(t))):e.$_mapLabels(t)},h.isPresent=function(e){return\"function\"==typeof e.isPresent?e.isPresent:e=>void 0!==e},h.rename=function(e,t,r,s,n){const a={};for(const i of e.$_terms.renames){const o=[],l=\"string\"!=typeof i.from;if(l)for(const e in t){if(void 0===t[e]&&i.options.ignoreUndefined)continue;if(e===i.to)continue;const r=i.from.exec(e);r&&o.push({from:e,to:i.to,match:r})}else!Object.prototype.hasOwnProperty.call(t,i.from)||void 0===t[i.from]&&i.options.ignoreUndefined||o.push(i);for(const c of o){const o=c.from;let u=c.to;if(u instanceof m&&(u=u.render(t,r,s,c.match)),o!==u){if(!i.options.multiple&&a[u]&&(n.push(e.$_createError(\"object.rename.multiple\",t,{from:o,to:u,pattern:l},r,s)),s.abortEarly))return!1;if(Object.prototype.hasOwnProperty.call(t,u)&&!i.options.override&&!a[u]&&(n.push(e.$_createError(\"object.rename.override\",t,{from:o,to:u,pattern:l},r,s)),s.abortEarly))return!1;void 0===t[o]?delete t[u]:t[u]=t[o],a[u]=!0,i.options.alias||delete t[o]}}}return!0},h.unknown=function(e,t,r,s,n,a){if(e.$_terms.patterns){let i=!1;const o=e.$_terms.patterns.map((e=>{if(e.matches)return i=!0,[]})),l=[t,...n.ancestors];for(const i of r){const c=t[i],u=[...n.path,i];for(let f=0;f<e.$_terms.patterns.length;++f){const m=e.$_terms.patterns[f];if(m.regex){const e=m.regex.test(i);if(n.mainstay.tracer.debug(n,\"rule\",`pattern.${f}`,e?\"pass\":\"error\"),!e)continue}else if(!m.schema.$_match(i,n.nest(m.schema,`pattern.${f}`),a))continue;r.delete(i);const h=n.localize(u,l,{schema:m.rule,key:i}),d=m.rule.$_validate(c,h,a);if(d.errors){if(a.abortEarly)return{value:t,errors:d.errors};s.push(...d.errors)}if(m.matches&&o[f].push(i),t[i]=d.value,!m.fallthrough)break}}if(i)for(let r=0;r<o.length;++r){const i=o[r];if(!i)continue;const c=e.$_terms.patterns[r].matches,f=n.localize(n.path,l,c),m=c.$_validate(i,f,a);if(m.errors){const r=u.details(m.errors,{override:!1});r.matches=i;const o=e.$_createError(\"object.pattern.match\",t,r,n,a);if(a.abortEarly)return{value:t,errors:o};s.push(o)}}}if(r.size&&(e.$_terms.keys||e.$_terms.patterns)){if(a.stripUnknown&&!e._flags.unknown||a.skipFunctions){const e=!(!a.stripUnknown||!0!==a.stripUnknown&&!a.stripUnknown.objects);for(const s of r)e?(delete t[s],r.delete(s)):\"function\"==typeof t[s]&&r.delete(s)}if(!l.default(e._flags.unknown,a.allowUnknown))for(const i of r){const r=n.localize([...n.path,i],[]),o=e.$_createError(\"object.unknown\",t[i],{child:i},r,a,{flags:!1});if(a.abortEarly)return{value:t,errors:o};s.push(o)}}},h.Dependency=class{constructor(e,t,r,s,n){this.rel=e,this.key=t,this.peers=r,this.paths=s,this.options=n}describe(){const e={rel:this.rel,peers:this.paths};return null!==this.key&&(e.key=this.key.key),\".\"!==this.peers[0].separator&&(e.options={...e.options,separator:this.peers[0].separator}),this.options.isPresent&&(e.options={...e.options,isPresent:this.options.isPresent}),e}},h.Keys=class extends Array{concat(e){const t=this.slice(),r=new Map;for(let e=0;e<t.length;++e)r.set(t[e].key,e);for(const s of e){const e=s.key,n=r.get(e);void 0!==n?t[n]={key:e,schema:t[n].schema.concat(s.schema)}:t.push(s)}return t}}},8785:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8068),a=r(8160),i=r(3292),o=r(6354),l={};e.exports=n.extend({type:\"link\",properties:{schemaChain:!0},terms:{link:{init:null,manifest:\"single\",register:!1}},args:(e,t)=>e.ref(t),validate(e,{schema:t,state:r,prefs:n}){s(t.$_terms.link,\"Uninitialized link schema\");const a=l.generate(t,e,r,n),i=t.$_terms.link[0].ref;return a.$_validate(e,r.nest(a,`link:${i.display}:${a.type}`),n)},generate:(e,t,r,s)=>l.generate(e,t,r,s),rules:{ref:{method(e){s(!this.$_terms.link,\"Cannot reinitialize schema\"),e=i.ref(e),s(\"value\"===e.type||\"local\"===e.type,\"Invalid reference type:\",e.type),s(\"local\"===e.type||\"root\"===e.ancestor||e.ancestor>0,\"Link cannot reference itself\");const t=this.clone();return t.$_terms.link=[{ref:e}],t}},relative:{method(e=!0){return this.$_setFlag(\"relative\",e)}}},overrides:{concat(e){s(this.$_terms.link,\"Uninitialized link schema\"),s(a.isSchema(e),\"Invalid schema object\"),s(\"link\"!==e.type,\"Cannot merge type link with another link\");const t=this.clone();return t.$_terms.whens||(t.$_terms.whens=[]),t.$_terms.whens.push({concat:e}),t.$_mutateRebuild()}},manifest:{build:(e,t)=>(s(t.link,\"Invalid link description missing link\"),e.ref(t.link))}}),l.generate=function(e,t,r,s){let n=r.mainstay.links.get(e);if(n)return n._generate(t,r,s).schema;const a=e.$_terms.link[0].ref,{perspective:i,path:o}=l.perspective(a,r);l.assert(i,\"which is outside of schema boundaries\",a,e,r,s);try{n=o.length?i.$_reach(o):i}catch(t){l.assert(!1,\"to non-existing schema\",a,e,r,s)}return l.assert(\"link\"!==n.type,\"which is another link\",a,e,r,s),e._flags.relative||r.mainstay.links.set(e,n),n._generate(t,r,s).schema},l.perspective=function(e,t){if(\"local\"===e.type){for(const{schema:r,key:s}of t.schemas){if((r._flags.id||s)===e.path[0])return{perspective:r,path:e.path.slice(1)};if(r.$_terms.shared)for(const t of r.$_terms.shared)if(t._flags.id===e.path[0])return{perspective:t,path:e.path.slice(1)}}return{perspective:null,path:null}}return\"root\"===e.ancestor?{perspective:t.schemas[t.schemas.length-1].schema,path:e.path}:{perspective:t.schemas[e.ancestor]&&t.schemas[e.ancestor].schema,path:e.path}},l.assert=function(e,t,r,n,a,i){e||s(!1,`\"${o.label(n._flags,a,i)}\" contains link reference \"${r.display}\" ${t}`)}},3832:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8068),a=r(8160),i={numberRx:/^\\s*[+-]?(?:(?:\\d+(?:\\.\\d*)?)|(?:\\.\\d+))(?:e([+-]?\\d+))?\\s*$/i,precisionRx:/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/,exponentialPartRegex:/[eE][+-]?\\d+$/,leadingSignAndZerosRegex:/^[+-]?(0*)?/,dotRegex:/\\./,trailingZerosRegex:/0+$/,decimalPlaces(e){const t=e.toString(),r=t.indexOf(\".\"),s=t.indexOf(\"e\");return(r<0?0:(s<0?t.length:s)-r-1)+(s<0?0:Math.max(0,-parseInt(t.slice(s+1))))}};e.exports=n.extend({type:\"number\",flags:{unsafe:{default:!1}},coerce:{from:\"string\",method(e,{schema:t,error:r}){if(!e.match(i.numberRx))return;e=e.trim();const s={value:parseFloat(e)};if(0===s.value&&(s.value=0),!t._flags.unsafe)if(e.match(/e/i)){if(i.extractSignificantDigits(e)!==i.extractSignificantDigits(String(s.value)))return s.errors=r(\"number.unsafe\"),s}else{const t=s.value.toString();if(t.match(/e/i))return s;if(t!==i.normalizeDecimal(e))return s.errors=r(\"number.unsafe\"),s}return s}},validate(e,{schema:t,error:r,prefs:s}){if(e===1/0||e===-1/0)return{value:e,errors:r(\"number.infinity\")};if(!a.isNumber(e))return{value:e,errors:r(\"number.base\")};const n={value:e};if(s.convert){const e=t.$_getRule(\"precision\");if(e){const t=Math.pow(10,e.args.limit);n.value=Math.round(n.value*t)/t}}return 0===n.value&&(n.value=0),!t._flags.unsafe&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&(n.errors=r(\"number.unsafe\")),n},rules:{compare:{method:!1,validate:(e,t,{limit:r},{name:s,operator:n,args:i})=>a.compare(e,r,n)?e:t.error(\"number.\"+s,{limit:i.limit,value:e}),args:[{name:\"limit\",ref:!0,assert:a.isNumber,message:\"must be a number\"}]},greater:{method(e){return this.$_addRule({name:\"greater\",method:\"compare\",args:{limit:e},operator:\">\"})}},integer:{method(){return this.$_addRule(\"integer\")},validate:(e,t)=>Math.trunc(e)-e==0?e:t.error(\"number.integer\")},less:{method(e){return this.$_addRule({name:\"less\",method:\"compare\",args:{limit:e},operator:\"<\"})}},max:{method(e){return this.$_addRule({name:\"max\",method:\"compare\",args:{limit:e},operator:\"<=\"})}},min:{method(e){return this.$_addRule({name:\"min\",method:\"compare\",args:{limit:e},operator:\">=\"})}},multiple:{method(e){const t=\"number\"==typeof e?i.decimalPlaces(e):null,r=Math.pow(10,t);return this.$_addRule({name:\"multiple\",args:{base:e,baseDecimalPlace:t,pfactor:r}})},validate:(e,t,{base:r,baseDecimalPlace:s,pfactor:n},a)=>i.decimalPlaces(e)>s?t.error(\"number.multiple\",{multiple:a.args.base,value:e}):Math.round(n*e)%Math.round(n*r)==0?e:t.error(\"number.multiple\",{multiple:a.args.base,value:e}),args:[{name:\"base\",ref:!0,assert:e=>\"number\"==typeof e&&isFinite(e)&&e>0,message:\"must be a positive number\"},\"baseDecimalPlace\",\"pfactor\"],multi:!0},negative:{method(){return this.sign(\"negative\")}},port:{method(){return this.$_addRule(\"port\")},validate:(e,t)=>Number.isSafeInteger(e)&&e>=0&&e<=65535?e:t.error(\"number.port\")},positive:{method(){return this.sign(\"positive\")}},precision:{method(e){return s(Number.isSafeInteger(e),\"limit must be an integer\"),this.$_addRule({name:\"precision\",args:{limit:e}})},validate(e,t,{limit:r}){const s=e.toString().match(i.precisionRx);return Math.max((s[1]?s[1].length:0)-(s[2]?parseInt(s[2],10):0),0)<=r?e:t.error(\"number.precision\",{limit:r,value:e})},convert:!0},sign:{method(e){return s([\"negative\",\"positive\"].includes(e),\"Invalid sign\",e),this.$_addRule({name:\"sign\",args:{sign:e}})},validate:(e,t,{sign:r})=>\"negative\"===r&&e<0||\"positive\"===r&&e>0?e:t.error(`number.${r}`)},unsafe:{method(e=!0){return s(\"boolean\"==typeof e,\"enabled must be a boolean\"),this.$_setFlag(\"unsafe\",e)}}},cast:{string:{from:e=>\"number\"==typeof e,to:(e,t)=>e.toString()}},messages:{\"number.base\":\"{{#label}} must be a number\",\"number.greater\":\"{{#label}} must be greater than {{#limit}}\",\"number.infinity\":\"{{#label}} cannot be infinity\",\"number.integer\":\"{{#label}} must be an integer\",\"number.less\":\"{{#label}} must be less than {{#limit}}\",\"number.max\":\"{{#label}} must be less than or equal to {{#limit}}\",\"number.min\":\"{{#label}} must be greater than or equal to {{#limit}}\",\"number.multiple\":\"{{#label}} must be a multiple of {{#multiple}}\",\"number.negative\":\"{{#label}} must be a negative number\",\"number.port\":\"{{#label}} must be a valid port\",\"number.positive\":\"{{#label}} must be a positive number\",\"number.precision\":\"{{#label}} must have no more than {{#limit}} decimal places\",\"number.unsafe\":\"{{#label}} must be a safe number\"}}),i.extractSignificantDigits=function(e){return e.replace(i.exponentialPartRegex,\"\").replace(i.dotRegex,\"\").replace(i.trailingZerosRegex,\"\").replace(i.leadingSignAndZerosRegex,\"\")},i.normalizeDecimal=function(e){return(e=e.replace(/^\\+/,\"\").replace(/\\.0*$/,\"\").replace(/^(-?)\\.([^\\.]*)$/,\"$10.$2\").replace(/^(-?)0+([0-9])/,\"$1$2\")).includes(\".\")&&e.endsWith(\"0\")&&(e=e.replace(/0+$/,\"\")),\"-0\"===e?\"0\":e}},8966:(e,t,r)=>{\"use strict\";const s=r(7824);e.exports=s.extend({type:\"object\",cast:{map:{from:e=>e&&\"object\"==typeof e,to:(e,t)=>new Map(Object.entries(e))}}})},7417:(e,t,r)=>{\"use strict\";const s=r(375),n=r(5380),a=r(1745),i=r(9959),o=r(6064),l=r(9926),c=r(5752),u=r(8068),f=r(8160),m={tlds:l instanceof Set&&{tlds:{allow:l,deny:null}},base64Regex:{true:{true:/^(?:[\\w\\-]{2}[\\w\\-]{2})*(?:[\\w\\-]{2}==|[\\w\\-]{3}=)?$/,false:/^(?:[A-Za-z0-9+\\/]{2}[A-Za-z0-9+\\/]{2})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?$/},false:{true:/^(?:[\\w\\-]{2}[\\w\\-]{2})*(?:[\\w\\-]{2}(==)?|[\\w\\-]{3}=?)?$/,false:/^(?:[A-Za-z0-9+\\/]{2}[A-Za-z0-9+\\/]{2})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?$/}},dataUriRegex:/^data:[\\w+.-]+\\/[\\w+.-]+;((charset=[\\w-]+|base64),)?(.*)$/,hexRegex:{withPrefix:/^0x[0-9a-f]+$/i,withOptionalPrefix:/^(?:0x)?[0-9a-f]+$/i,withoutPrefix:/^[0-9a-f]+$/i},ipRegex:i.regex({cidr:\"forbidden\"}).regex,isoDurationRegex:/^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+S)?)?$/,guidBrackets:{\"{\":\"}\",\"[\":\"]\",\"(\":\")\",\"\":\"\"},guidVersions:{uuidv1:\"1\",uuidv2:\"2\",uuidv3:\"3\",uuidv4:\"4\",uuidv5:\"5\",uuidv6:\"6\",uuidv7:\"7\",uuidv8:\"8\"},guidSeparators:new Set([void 0,!0,!1,\"-\",\":\"]),normalizationForms:[\"NFC\",\"NFD\",\"NFKC\",\"NFKD\"]};e.exports=u.extend({type:\"string\",flags:{insensitive:{default:!1},truncate:{default:!1}},terms:{replacements:{init:null}},coerce:{from:\"string\",method(e,{schema:t,state:r,prefs:s}){const n=t.$_getRule(\"normalize\");n&&(e=e.normalize(n.args.form));const a=t.$_getRule(\"case\");a&&(e=\"upper\"===a.args.direction?e.toLocaleUpperCase():e.toLocaleLowerCase());const i=t.$_getRule(\"trim\");if(i&&i.args.enabled&&(e=e.trim()),t.$_terms.replacements)for(const r of t.$_terms.replacements)e=e.replace(r.pattern,r.replacement);const o=t.$_getRule(\"hex\");if(o&&o.args.options.byteAligned&&e.length%2!=0&&(e=`0${e}`),t.$_getRule(\"isoDate\")){const t=m.isoDate(e);t&&(e=t)}if(t._flags.truncate){const n=t.$_getRule(\"max\");if(n){let a=n.args.limit;if(f.isResolvable(a)&&(a=a.resolve(e,r,s),!f.limit(a)))return{value:e,errors:t.$_createError(\"any.ref\",a,{ref:n.args.limit,arg:\"limit\",reason:\"must be a positive integer\"},r,s)};e=e.slice(0,a)}}return{value:e}}},validate(e,{schema:t,error:r}){if(\"string\"!=typeof e)return{value:e,errors:r(\"string.base\")};if(\"\"===e){const s=t.$_getRule(\"min\");if(s&&0===s.args.limit)return;return{value:e,errors:r(\"string.empty\")}}},rules:{alphanum:{method(){return this.$_addRule(\"alphanum\")},validate:(e,t)=>/^[a-zA-Z0-9]+$/.test(e)?e:t.error(\"string.alphanum\")},base64:{method(e={}){return f.assertOptions(e,[\"paddingRequired\",\"urlSafe\"]),e={urlSafe:!1,paddingRequired:!0,...e},s(\"boolean\"==typeof e.paddingRequired,\"paddingRequired must be boolean\"),s(\"boolean\"==typeof e.urlSafe,\"urlSafe must be boolean\"),this.$_addRule({name:\"base64\",args:{options:e}})},validate:(e,t,{options:r})=>m.base64Regex[r.paddingRequired][r.urlSafe].test(e)?e:t.error(\"string.base64\")},case:{method(e){return s([\"lower\",\"upper\"].includes(e),\"Invalid case:\",e),this.$_addRule({name:\"case\",args:{direction:e}})},validate:(e,t,{direction:r})=>\"lower\"===r&&e===e.toLocaleLowerCase()||\"upper\"===r&&e===e.toLocaleUpperCase()?e:t.error(`string.${r}case`),convert:!0},creditCard:{method(){return this.$_addRule(\"creditCard\")},validate(e,t){let r=e.length,s=0,n=1;for(;r--;){const t=e.charAt(r)*n;s+=t-9*(t>9),n^=3}return s>0&&s%10==0?e:t.error(\"string.creditCard\")}},dataUri:{method(e={}){return f.assertOptions(e,[\"paddingRequired\"]),e={paddingRequired:!0,...e},s(\"boolean\"==typeof e.paddingRequired,\"paddingRequired must be boolean\"),this.$_addRule({name:\"dataUri\",args:{options:e}})},validate(e,t,{options:r}){const s=e.match(m.dataUriRegex);if(s){if(!s[2])return e;if(\"base64\"!==s[2])return e;if(m.base64Regex[r.paddingRequired].false.test(s[3]))return e}return t.error(\"string.dataUri\")}},domain:{method(e){e&&f.assertOptions(e,[\"allowFullyQualified\",\"allowUnicode\",\"maxDomainSegments\",\"minDomainSegments\",\"tlds\"]);const t=m.addressOptions(e);return this.$_addRule({name:\"domain\",args:{options:e},address:t})},validate:(e,t,r,{address:s})=>n.isValid(e,s)?e:t.error(\"string.domain\")},email:{method(e={}){f.assertOptions(e,[\"allowFullyQualified\",\"allowUnicode\",\"ignoreLength\",\"maxDomainSegments\",\"minDomainSegments\",\"multiple\",\"separator\",\"tlds\"]),s(void 0===e.multiple||\"boolean\"==typeof e.multiple,\"multiple option must be an boolean\");const t=m.addressOptions(e),r=new RegExp(`\\\\s*[${e.separator?o(e.separator):\",\"}]\\\\s*`);return this.$_addRule({name:\"email\",args:{options:e},regex:r,address:t})},validate(e,t,{options:r},{regex:s,address:n}){const i=r.multiple?e.split(s):[e],o=[];for(const e of i)a.isValid(e,n)||o.push(e);return o.length?t.error(\"string.email\",{value:e,invalids:o}):e}},guid:{alias:\"uuid\",method(e={}){f.assertOptions(e,[\"version\",\"separator\"]);let t=\"\";if(e.version){const r=[].concat(e.version);s(r.length>=1,\"version must have at least 1 valid version specified\");const n=new Set;for(let e=0;e<r.length;++e){const a=r[e];s(\"string\"==typeof a,\"version at position \"+e+\" must be a string\");const i=m.guidVersions[a.toLowerCase()];s(i,\"version at position \"+e+\" must be one of \"+Object.keys(m.guidVersions).join(\", \")),s(!n.has(i),\"version at position \"+e+\" must not be a duplicate\"),t+=i,n.add(i)}}s(m.guidSeparators.has(e.separator),'separator must be one of true, false, \"-\", or \":\"');const r=void 0===e.separator?\"[:-]?\":!0===e.separator?\"[:-]\":!1===e.separator?\"[]?\":`\\\\${e.separator}`,n=new RegExp(`^([\\\\[{\\\\(]?)[0-9A-F]{8}(${r})[0-9A-F]{4}\\\\2?[${t||\"0-9A-F\"}][0-9A-F]{3}\\\\2?[${t?\"89AB\":\"0-9A-F\"}][0-9A-F]{3}\\\\2?[0-9A-F]{12}([\\\\]}\\\\)]?)$`,\"i\");return this.$_addRule({name:\"guid\",args:{options:e},regex:n})},validate(e,t,r,{regex:s}){const n=s.exec(e);return n?m.guidBrackets[n[1]]!==n[n.length-1]?t.error(\"string.guid\"):e:t.error(\"string.guid\")}},hex:{method(e={}){return f.assertOptions(e,[\"byteAligned\",\"prefix\"]),e={byteAligned:!1,prefix:!1,...e},s(\"boolean\"==typeof e.byteAligned,\"byteAligned must be boolean\"),s(\"boolean\"==typeof e.prefix||\"optional\"===e.prefix,'prefix must be boolean or \"optional\"'),this.$_addRule({name:\"hex\",args:{options:e}})},validate:(e,t,{options:r})=>(\"optional\"===r.prefix?m.hexRegex.withOptionalPrefix:!0===r.prefix?m.hexRegex.withPrefix:m.hexRegex.withoutPrefix).test(e)?r.byteAligned&&e.length%2!=0?t.error(\"string.hexAlign\"):e:t.error(\"string.hex\")},hostname:{method(){return this.$_addRule(\"hostname\")},validate:(e,t)=>n.isValid(e,{minDomainSegments:1})||m.ipRegex.test(e)?e:t.error(\"string.hostname\")},insensitive:{method(){return this.$_setFlag(\"insensitive\",!0)}},ip:{method(e={}){f.assertOptions(e,[\"cidr\",\"version\"]);const{cidr:t,versions:r,regex:s}=i.regex(e),n=e.version?r:void 0;return this.$_addRule({name:\"ip\",args:{options:{cidr:t,version:n}},regex:s})},validate:(e,t,{options:r},{regex:s})=>s.test(e)?e:r.version?t.error(\"string.ipVersion\",{value:e,cidr:r.cidr,version:r.version}):t.error(\"string.ip\",{value:e,cidr:r.cidr})},isoDate:{method(){return this.$_addRule(\"isoDate\")},validate:(e,{error:t})=>m.isoDate(e)?e:t(\"string.isoDate\")},isoDuration:{method(){return this.$_addRule(\"isoDuration\")},validate:(e,t)=>m.isoDurationRegex.test(e)?e:t.error(\"string.isoDuration\")},length:{method(e,t){return m.length(this,\"length\",e,\"=\",t)},validate(e,t,{limit:r,encoding:s},{name:n,operator:a,args:i}){const o=!s&&e.length;return f.compare(o,r,a)?e:t.error(\"string.\"+n,{limit:i.limit,value:e,encoding:s})},args:[{name:\"limit\",ref:!0,assert:f.limit,message:\"must be a positive integer\"},\"encoding\"]},lowercase:{method(){return this.case(\"lower\")}},max:{method(e,t){return m.length(this,\"max\",e,\"<=\",t)},args:[\"limit\",\"encoding\"]},min:{method(e,t){return m.length(this,\"min\",e,\">=\",t)},args:[\"limit\",\"encoding\"]},normalize:{method(e=\"NFC\"){return s(m.normalizationForms.includes(e),\"normalization form must be one of \"+m.normalizationForms.join(\", \")),this.$_addRule({name:\"normalize\",args:{form:e}})},validate:(e,{error:t},{form:r})=>e===e.normalize(r)?e:t(\"string.normalize\",{value:e,form:r}),convert:!0},pattern:{alias:\"regex\",method(e,t={}){s(e instanceof RegExp,\"regex must be a RegExp\"),s(!e.flags.includes(\"g\")&&!e.flags.includes(\"y\"),\"regex should not use global or sticky mode\"),\"string\"==typeof t&&(t={name:t}),f.assertOptions(t,[\"invert\",\"name\"]);const r=[\"string.pattern\",t.invert?\".invert\":\"\",t.name?\".name\":\".base\"].join(\"\");return this.$_addRule({name:\"pattern\",args:{regex:e,options:t},errorCode:r})},validate:(e,t,{regex:r,options:s},{errorCode:n})=>r.test(e)^s.invert?e:t.error(n,{name:s.name,regex:r,value:e}),args:[\"regex\",\"options\"],multi:!0},replace:{method(e,t){\"string\"==typeof e&&(e=new RegExp(o(e),\"g\")),s(e instanceof RegExp,\"pattern must be a RegExp\"),s(\"string\"==typeof t,\"replacement must be a String\");const r=this.clone();return r.$_terms.replacements||(r.$_terms.replacements=[]),r.$_terms.replacements.push({pattern:e,replacement:t}),r}},token:{method(){return this.$_addRule(\"token\")},validate:(e,t)=>/^\\w+$/.test(e)?e:t.error(\"string.token\")},trim:{method(e=!0){return s(\"boolean\"==typeof e,\"enabled must be a boolean\"),this.$_addRule({name:\"trim\",args:{enabled:e}})},validate:(e,t,{enabled:r})=>r&&e!==e.trim()?t.error(\"string.trim\"):e,convert:!0},truncate:{method(e=!0){return s(\"boolean\"==typeof e,\"enabled must be a boolean\"),this.$_setFlag(\"truncate\",e)}},uppercase:{method(){return this.case(\"upper\")}},uri:{method(e={}){f.assertOptions(e,[\"allowRelative\",\"allowQuerySquareBrackets\",\"domain\",\"relativeOnly\",\"scheme\"]),e.domain&&f.assertOptions(e.domain,[\"allowFullyQualified\",\"allowUnicode\",\"maxDomainSegments\",\"minDomainSegments\",\"tlds\"]);const{regex:t,scheme:r}=c.regex(e),s=e.domain?m.addressOptions(e.domain):null;return this.$_addRule({name:\"uri\",args:{options:e},regex:t,domain:s,scheme:r})},validate(e,t,{options:r},{regex:s,domain:a,scheme:i}){if([\"http:/\",\"https:/\"].includes(e))return t.error(\"string.uri\");const o=s.exec(e);if(o){const s=o[1]||o[2];return!a||r.allowRelative&&!s||n.isValid(s,a)?e:t.error(\"string.domain\",{value:s})}return r.relativeOnly?t.error(\"string.uriRelativeOnly\"):r.scheme?t.error(\"string.uriCustomScheme\",{scheme:i,value:e}):t.error(\"string.uri\")}}},manifest:{build(e,t){if(t.replacements)for(const{pattern:r,replacement:s}of t.replacements)e=e.replace(r,s);return e}},messages:{\"string.alphanum\":\"{{#label}} must only contain alpha-numeric characters\",\"string.base\":\"{{#label}} must be a string\",\"string.base64\":\"{{#label}} must be a valid base64 string\",\"string.creditCard\":\"{{#label}} must be a credit card\",\"string.dataUri\":\"{{#label}} must be a valid dataUri string\",\"string.domain\":\"{{#label}} must contain a valid domain name\",\"string.email\":\"{{#label}} must be a valid email\",\"string.empty\":\"{{#label}} is not allowed to be empty\",\"string.guid\":\"{{#label}} must be a valid GUID\",\"string.hex\":\"{{#label}} must only contain hexadecimal characters\",\"string.hexAlign\":\"{{#label}} hex decoded representation must be byte aligned\",\"string.hostname\":\"{{#label}} must be a valid hostname\",\"string.ip\":\"{{#label}} must be a valid ip address with a {{#cidr}} CIDR\",\"string.ipVersion\":\"{{#label}} must be a valid ip address of one of the following versions {{#version}} with a {{#cidr}} CIDR\",\"string.isoDate\":\"{{#label}} must be in iso format\",\"string.isoDuration\":\"{{#label}} must be a valid ISO 8601 duration\",\"string.length\":\"{{#label}} length must be {{#limit}} characters long\",\"string.lowercase\":\"{{#label}} must only contain lowercase characters\",\"string.max\":\"{{#label}} length must be less than or equal to {{#limit}} characters long\",\"string.min\":\"{{#label}} length must be at least {{#limit}} characters long\",\"string.normalize\":\"{{#label}} must be unicode normalized in the {{#form}} form\",\"string.token\":\"{{#label}} must only contain alpha-numeric and underscore characters\",\"string.pattern.base\":\"{{#label}} with value {:[.]} fails to match the required pattern: {{#regex}}\",\"string.pattern.name\":\"{{#label}} with value {:[.]} fails to match the {{#name}} pattern\",\"string.pattern.invert.base\":\"{{#label}} with value {:[.]} matches the inverted pattern: {{#regex}}\",\"string.pattern.invert.name\":\"{{#label}} with value {:[.]} matches the inverted {{#name}} pattern\",\"string.trim\":\"{{#label}} must not have leading or trailing whitespace\",\"string.uri\":\"{{#label}} must be a valid uri\",\"string.uriCustomScheme\":\"{{#label}} must be a valid uri with a scheme matching the {{#scheme}} pattern\",\"string.uriRelativeOnly\":\"{{#label}} must be a valid relative uri\",\"string.uppercase\":\"{{#label}} must only contain uppercase characters\"}}),m.addressOptions=function(e){if(!e)return e;if(s(void 0===e.minDomainSegments||Number.isSafeInteger(e.minDomainSegments)&&e.minDomainSegments>0,\"minDomainSegments must be a positive integer\"),s(void 0===e.maxDomainSegments||Number.isSafeInteger(e.maxDomainSegments)&&e.maxDomainSegments>0,\"maxDomainSegments must be a positive integer\"),!1===e.tlds)return e;if(!0===e.tlds||void 0===e.tlds)return s(m.tlds,\"Built-in TLD list disabled\"),Object.assign({},e,m.tlds);s(\"object\"==typeof e.tlds,\"tlds must be true, false, or an object\");const t=e.tlds.deny;if(t)return Array.isArray(t)&&(e=Object.assign({},e,{tlds:{deny:new Set(t)}})),s(e.tlds.deny instanceof Set,\"tlds.deny must be an array, Set, or boolean\"),s(!e.tlds.allow,\"Cannot specify both tlds.allow and tlds.deny lists\"),m.validateTlds(e.tlds.deny,\"tlds.deny\"),e;const r=e.tlds.allow;return r?!0===r?(s(m.tlds,\"Built-in TLD list disabled\"),Object.assign({},e,m.tlds)):(Array.isArray(r)&&(e=Object.assign({},e,{tlds:{allow:new Set(r)}})),s(e.tlds.allow instanceof Set,\"tlds.allow must be an array, Set, or boolean\"),m.validateTlds(e.tlds.allow,\"tlds.allow\"),e):e},m.validateTlds=function(e,t){for(const r of e)s(n.isValid(r,{minDomainSegments:1,maxDomainSegments:1}),`${t} must contain valid top level domain names`)},m.isoDate=function(e){if(!f.isIsoDate(e))return null;/.*T.*[+-]\\d\\d$/.test(e)&&(e+=\"00\");const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString()},m.length=function(e,t,r,n,a){return s(!a||!1,\"Invalid encoding:\",a),e.$_addRule({name:t,method:\"length\",args:{limit:r,encoding:a},operator:n})}},8826:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8068),a={};a.Map=class extends Map{slice(){return new a.Map(this)}},e.exports=n.extend({type:\"symbol\",terms:{map:{init:new a.Map}},coerce:{method(e,{schema:t,error:r}){const s=t.$_terms.map.get(e);return s&&(e=s),t._flags.only&&\"symbol\"!=typeof e?{value:e,errors:r(\"symbol.map\",{map:t.$_terms.map})}:{value:e}}},validate(e,{error:t}){if(\"symbol\"!=typeof e)return{value:e,errors:t(\"symbol.base\")}},rules:{map:{method(e){e&&!e[Symbol.iterator]&&\"object\"==typeof e&&(e=Object.entries(e)),s(e&&e[Symbol.iterator],\"Iterable must be an iterable or object\");const t=this.clone(),r=[];for(const n of e){s(n&&n[Symbol.iterator],\"Entry must be an iterable\");const[e,a]=n;s(\"object\"!=typeof e&&\"function\"!=typeof e&&\"symbol\"!=typeof e,\"Key must not be of type object, function, or Symbol\"),s(\"symbol\"==typeof a,\"Value must be a Symbol\"),t.$_terms.map.set(e,a),r.push(a)}return t.valid(...r)}}},manifest:{build:(e,t)=>(t.map&&(e=e.map(t.map)),e)},messages:{\"symbol.base\":\"{{#label}} must be a symbol\",\"symbol.map\":\"{{#label}} must be one of {{#map}}\"}})},8863:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(738),i=r(9621),o=r(8160),l=r(6354),c=r(493),u={result:Symbol(\"result\")};t.entry=function(e,t,r){let n=o.defaults;r&&(s(void 0===r.warnings,\"Cannot override warnings preference in synchronous validation\"),s(void 0===r.artifacts,\"Cannot override artifacts preference in synchronous validation\"),n=o.preferences(o.defaults,r));const a=u.entry(e,t,n);s(!a.mainstay.externals.length,\"Schema with external rules must use validateAsync()\");const i={value:a.value};return a.error&&(i.error=a.error),a.mainstay.warnings.length&&(i.warning=l.details(a.mainstay.warnings)),a.mainstay.debug&&(i.debug=a.mainstay.debug),a.mainstay.artifacts&&(i.artifacts=a.mainstay.artifacts),i},t.entryAsync=async function(e,t,r){let s=o.defaults;r&&(s=o.preferences(o.defaults,r));const n=u.entry(e,t,s),a=n.mainstay;if(n.error)throw a.debug&&(n.error.debug=a.debug),n.error;if(a.externals.length){let t=n.value;const c=[];for(const n of a.externals){const f=n.state.path,m=\"link\"===n.schema.type?a.links.get(n.schema):null;let h,d,p=t;const g=f.length?[t]:[],y=f.length?i(e,f):e;if(f.length){h=f[f.length-1];let e=t;for(const t of f.slice(0,-1))e=e[t],g.unshift(e);d=g[0],p=d[h]}try{const e=(e,t)=>(m||n.schema).$_createError(e,p,t,n.state,s),i=await n.method(p,{schema:n.schema,linked:m,state:n.state,prefs:r,original:y,error:e,errorsArray:u.errorsArray,warn:(e,t)=>a.warnings.push((m||n.schema).$_createError(e,p,t,n.state,s)),message:(e,t)=>(m||n.schema).$_createError(\"external\",p,t,n.state,s,{messages:e})});if(void 0===i||i===p)continue;if(i instanceof l.Report){if(a.tracer.log(n.schema,n.state,\"rule\",\"external\",\"error\"),c.push(i),s.abortEarly)break;continue}if(Array.isArray(i)&&i[o.symbols.errors]){if(a.tracer.log(n.schema,n.state,\"rule\",\"external\",\"error\"),c.push(...i),s.abortEarly)break;continue}d?(a.tracer.value(n.state,\"rule\",p,i,\"external\"),d[h]=i):(a.tracer.value(n.state,\"rule\",t,i,\"external\"),t=i)}catch(e){throw s.errors.label&&(e.message+=` (${n.label})`),e}}if(n.value=t,c.length)throw n.error=l.process(c,e,s),a.debug&&(n.error.debug=a.debug),n.error}if(!s.warnings&&!s.debug&&!s.artifacts)return n.value;const c={value:n.value};return a.warnings.length&&(c.warning=l.details(a.warnings)),a.debug&&(c.debug=a.debug),a.artifacts&&(c.artifacts=a.artifacts),c},u.Mainstay=class{constructor(e,t,r){this.externals=[],this.warnings=[],this.tracer=e,this.debug=t,this.links=r,this.shadow=null,this.artifacts=null,this._snapshots=[]}snapshot(){this._snapshots.push({externals:this.externals.slice(),warnings:this.warnings.slice()})}restore(){const e=this._snapshots.pop();this.externals=e.externals,this.warnings=e.warnings}commit(){this._snapshots.pop()}},u.entry=function(e,r,s){const{tracer:n,cleanup:a}=u.tracer(r,s),i=s.debug?[]:null,o=r._ids._schemaChain?new Map:null,f=new u.Mainstay(n,i,o),m=r._ids._schemaChain?[{schema:r}]:null,h=new c([],[],{mainstay:f,schemas:m}),d=t.validate(e,r,h,s);a&&r.$_root.untrace();const p=l.process(d.errors,e,s);return{value:d.value,error:p,mainstay:f}},u.tracer=function(e,t){return e.$_root._tracer?{tracer:e.$_root._tracer._register(e)}:t.debug?(s(e.$_root.trace,\"Debug mode not supported\"),{tracer:e.$_root.trace()._register(e),cleanup:!0}):{tracer:u.ignore}},t.validate=function(e,t,r,s,n={}){if(t.$_terms.whens&&(t=t._generate(e,r,s).schema),t._preferences&&(s=u.prefs(t,s)),t._cache&&s.cache){const s=t._cache.get(e);if(r.mainstay.tracer.debug(r,\"validate\",\"cached\",!!s),s)return s}const a=(n,a,i)=>t.$_createError(n,e,a,i||r,s),i={original:e,prefs:s,schema:t,state:r,error:a,errorsArray:u.errorsArray,warn:(e,t,s)=>r.mainstay.warnings.push(a(e,t,s)),message:(n,a)=>t.$_createError(\"custom\",e,a,r,s,{messages:n})};r.mainstay.tracer.entry(t,r);const l=t._definition;if(l.prepare&&void 0!==e&&s.convert){const t=l.prepare(e,i);if(t){if(r.mainstay.tracer.value(r,\"prepare\",e,t.value),t.errors)return u.finalize(t.value,[].concat(t.errors),i);e=t.value}}if(l.coerce&&void 0!==e&&s.convert&&(!l.coerce.from||l.coerce.from.includes(typeof e))){const t=l.coerce.method(e,i);if(t){if(r.mainstay.tracer.value(r,\"coerced\",e,t.value),t.errors)return u.finalize(t.value,[].concat(t.errors),i);e=t.value}}const c=t._flags.empty;c&&c.$_match(u.trim(e,t),r.nest(c),o.defaults)&&(r.mainstay.tracer.value(r,\"empty\",e,void 0),e=void 0);const f=n.presence||t._flags.presence||(t._flags._endedSwitch?null:s.presence);if(void 0===e){if(\"forbidden\"===f)return u.finalize(e,null,i);if(\"required\"===f)return u.finalize(e,[t.$_createError(\"any.required\",e,null,r,s)],i);if(\"optional\"===f){if(t._flags.default!==o.symbols.deepDefault)return u.finalize(e,null,i);r.mainstay.tracer.value(r,\"default\",e,{}),e={}}}else if(\"forbidden\"===f)return u.finalize(e,[t.$_createError(\"any.unknown\",e,null,r,s)],i);const m=[];if(t._valids){const n=t._valids.get(e,r,s,t._flags.insensitive);if(n)return s.convert&&(r.mainstay.tracer.value(r,\"valids\",e,n.value),e=n.value),r.mainstay.tracer.filter(t,r,\"valid\",n),u.finalize(e,null,i);if(t._flags.only){const n=t.$_createError(\"any.only\",e,{valids:t._valids.values({display:!0})},r,s);if(s.abortEarly)return u.finalize(e,[n],i);m.push(n)}}if(t._invalids){const n=t._invalids.get(e,r,s,t._flags.insensitive);if(n){r.mainstay.tracer.filter(t,r,\"invalid\",n);const a=t.$_createError(\"any.invalid\",e,{invalids:t._invalids.values({display:!0})},r,s);if(s.abortEarly)return u.finalize(e,[a],i);m.push(a)}}if(l.validate){const t=l.validate(e,i);if(t&&(r.mainstay.tracer.value(r,\"base\",e,t.value),e=t.value,t.errors)){if(!Array.isArray(t.errors))return m.push(t.errors),u.finalize(e,m,i);if(t.errors.length)return m.push(...t.errors),u.finalize(e,m,i)}}return t._rules.length?u.rules(e,m,i):u.finalize(e,m,i)},u.rules=function(e,t,r){const{schema:s,state:n,prefs:a}=r;for(const i of s._rules){const l=s._definition.rules[i.method];if(l.convert&&a.convert){n.mainstay.tracer.log(s,n,\"rule\",i.name,\"full\");continue}let c,f=i.args;if(i._resolve.length){f=Object.assign({},f);for(const t of i._resolve){const r=l.argsByName.get(t),i=f[t].resolve(e,n,a),u=r.normalize?r.normalize(i):i,m=o.validateArg(u,null,r);if(m){c=s.$_createError(\"any.ref\",i,{arg:t,ref:f[t],reason:m},n,a);break}f[t]=u}}c=c||l.validate(e,r,f,i);const m=u.rule(c,i);if(m.errors){if(n.mainstay.tracer.log(s,n,\"rule\",i.name,\"error\"),i.warn){n.mainstay.warnings.push(...m.errors);continue}if(a.abortEarly)return u.finalize(e,m.errors,r);t.push(...m.errors)}else n.mainstay.tracer.log(s,n,\"rule\",i.name,\"pass\"),n.mainstay.tracer.value(n,\"rule\",e,m.value,i.name),e=m.value}return u.finalize(e,t,r)},u.rule=function(e,t){return e instanceof l.Report?(u.error(e,t),{errors:[e],value:null}):Array.isArray(e)&&e[o.symbols.errors]?(e.forEach((e=>u.error(e,t))),{errors:e,value:null}):{errors:null,value:e}},u.error=function(e,t){return t.message&&e._setTemplate(t.message),e},u.finalize=function(e,t,r){t=t||[];const{schema:n,state:a,prefs:i}=r;if(t.length){const s=u.default(\"failover\",void 0,t,r);void 0!==s&&(a.mainstay.tracer.value(a,\"failover\",e,s),e=s,t=[])}if(t.length&&n._flags.error)if(\"function\"==typeof n._flags.error){t=n._flags.error(t),Array.isArray(t)||(t=[t]);for(const e of t)s(e instanceof Error||e instanceof l.Report,\"error() must return an Error object\")}else t=[n._flags.error];if(void 0===e){const s=u.default(\"default\",e,t,r);a.mainstay.tracer.value(a,\"default\",e,s),e=s}if(n._flags.cast&&void 0!==e){const t=n._definition.cast[n._flags.cast];if(t.from(e)){const s=t.to(e,r);a.mainstay.tracer.value(a,\"cast\",e,s,n._flags.cast),e=s}}if(n.$_terms.externals&&i.externals&&!1!==i._externals)for(const{method:e}of n.$_terms.externals)a.mainstay.externals.push({method:e,schema:n,state:a,label:l.label(n._flags,a,i)});const o={value:e,errors:t.length?t:null};return n._flags.result&&(o.value=\"strip\"===n._flags.result?void 0:r.original,a.mainstay.tracer.value(a,n._flags.result,e,o.value),a.shadow(e,n._flags.result)),n._cache&&!1!==i.cache&&!n._refs.length&&n._cache.set(r.original,o),void 0===e||o.errors||void 0===n._flags.artifact||(a.mainstay.artifacts=a.mainstay.artifacts||new Map,a.mainstay.artifacts.has(n._flags.artifact)||a.mainstay.artifacts.set(n._flags.artifact,[]),a.mainstay.artifacts.get(n._flags.artifact).push(a.path)),o},u.prefs=function(e,t){const r=t===o.defaults;return r&&e._preferences[o.symbols.prefs]?e._preferences[o.symbols.prefs]:(t=o.preferences(t,e._preferences),r&&(e._preferences[o.symbols.prefs]=t),t)},u.default=function(e,t,r,s){const{schema:a,state:i,prefs:l}=s,c=a._flags[e];if(l.noDefaults||void 0===c)return t;if(i.mainstay.tracer.log(a,i,\"rule\",e,\"full\"),!c)return c;if(\"function\"==typeof c){const t=c.length?[n(i.ancestors[0]),s]:[];try{return c(...t)}catch(t){return void r.push(a.$_createError(`any.${e}`,null,{error:t},i,l))}}return\"object\"!=typeof c?c:c[o.symbols.literal]?c.literal:o.isResolvable(c)?c.resolve(t,i,l):n(c)},u.trim=function(e,t){if(\"string\"!=typeof e)return e;const r=t.$_getRule(\"trim\");return r&&r.args.enabled?e.trim():e},u.ignore={active:!1,debug:a,entry:a,filter:a,log:a,resolve:a,value:a},u.errorsArray=function(){const e=[];return e[o.symbols.errors]=!0,e}},2036:(e,t,r)=>{\"use strict\";const s=r(375),n=r(9474),a=r(8160),i={};e.exports=i.Values=class{constructor(e,t){this._values=new Set(e),this._refs=new Set(t),this._lowercase=i.lowercases(e),this._override=!1}get length(){return this._values.size+this._refs.size}add(e,t){a.isResolvable(e)?this._refs.has(e)||(this._refs.add(e),t&&t.register(e)):this.has(e,null,null,!1)||(this._values.add(e),\"string\"==typeof e&&this._lowercase.set(e.toLowerCase(),e))}static merge(e,t,r){if(e=e||new i.Values,t){if(t._override)return t.clone();for(const r of[...t._values,...t._refs])e.add(r)}if(r)for(const t of[...r._values,...r._refs])e.remove(t);return e.length?e:null}remove(e){a.isResolvable(e)?this._refs.delete(e):(this._values.delete(e),\"string\"==typeof e&&this._lowercase.delete(e.toLowerCase()))}has(e,t,r,s){return!!this.get(e,t,r,s)}get(e,t,r,s){if(!this.length)return!1;if(this._values.has(e))return{value:e};if(\"string\"==typeof e&&e&&s){const t=this._lowercase.get(e.toLowerCase());if(t)return{value:t}}if(!this._refs.size&&\"object\"!=typeof e)return!1;if(\"object\"==typeof e)for(const t of this._values)if(n(t,e))return{value:t};if(t)for(const a of this._refs){const i=a.resolve(e,t,r,null,{in:!0});if(void 0===i)continue;const o=a.in&&\"object\"==typeof i?Array.isArray(i)?i:Object.keys(i):[i];for(const t of o)if(typeof t==typeof e)if(s&&e&&\"string\"==typeof e){if(t.toLowerCase()===e.toLowerCase())return{value:t,ref:a}}else if(n(t,e))return{value:t,ref:a}}return!1}override(){this._override=!0}values(e){if(e&&e.display){const e=[];for(const t of[...this._values,...this._refs])void 0!==t&&e.push(t);return e}return Array.from([...this._values,...this._refs])}clone(){const e=new i.Values(this._values,this._refs);return e._override=this._override,e}concat(e){s(!e._override,\"Cannot concat override set of values\");const t=new i.Values([...this._values,...e._values],[...this._refs,...e._refs]);return t._override=this._override,t}describe(){const e=[];this._override&&e.push({override:!0});for(const t of this._values.values())e.push(t&&\"object\"==typeof t?{value:t}:t);for(const t of this._refs.values())e.push(t.describe());return e}},i.Values.prototype[a.symbols.values]=!0,i.Values.prototype.slice=i.Values.prototype.clone,i.lowercases=function(e){const t=new Map;if(e)for(const r of e)\"string\"==typeof r&&t.set(r.toLowerCase(),r);return t}},978:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(1687),i=r(9621),o={};e.exports=function(e,t,r={}){if(s(e&&\"object\"==typeof e,\"Invalid defaults value: must be an object\"),s(!t||!0===t||\"object\"==typeof t,\"Invalid source value: must be true, falsy or an object\"),s(\"object\"==typeof r,\"Invalid options: must be an object\"),!t)return null;if(r.shallow)return o.applyToDefaultsWithShallow(e,t,r);const i=n(e);if(!0===t)return i;const l=void 0!==r.nullOverride&&r.nullOverride;return a(i,t,{nullOverride:l,mergeArrays:!1})},o.applyToDefaultsWithShallow=function(e,t,r){const l=r.shallow;s(Array.isArray(l),\"Invalid keys\");const c=new Map,u=!0===t?null:new Set;for(let r of l){r=Array.isArray(r)?r:r.split(\".\");const s=i(e,r);s&&\"object\"==typeof s?c.set(s,u&&i(t,r)||s):u&&u.add(r)}const f=n(e,{},c);if(!u)return f;for(const e of u)o.reachCopy(f,t,e);const m=void 0!==r.nullOverride&&r.nullOverride;return a(f,t,{nullOverride:m,mergeArrays:!1})},o.reachCopy=function(e,t,r){for(const e of r){if(!(e in t))return;const r=t[e];if(\"object\"!=typeof r||null===r)return;t=r}const s=t;let n=e;for(let e=0;e<r.length-1;++e){const t=r[e];\"object\"!=typeof n[t]&&(n[t]={}),n=n[t]}n[r[r.length-1]]=s}},375:(e,t,r)=>{\"use strict\";const s=r(7916);e.exports=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new s(t)}}},8571:(e,t,r)=>{\"use strict\";const s=r(9621),n=r(4277),a=r(7043),i={needsProtoHack:new Set([n.set,n.map,n.weakSet,n.weakMap])};e.exports=i.clone=function(e,t={},r=null){if(\"object\"!=typeof e||null===e)return e;let s=i.clone,o=r;if(t.shallow){if(!0!==t.shallow)return i.cloneWithShallow(e,t);s=e=>e}else if(o){const t=o.get(e);if(t)return t}else o=new Map;const l=n.getInternalProto(e);if(l===n.buffer)return!1;if(l===n.date)return new Date(e.getTime());if(l===n.regex)return new RegExp(e);const c=i.base(e,l,t);if(c===e)return e;if(o&&o.set(e,c),l===n.set)for(const r of e)c.add(s(r,t,o));else if(l===n.map)for(const[r,n]of e)c.set(r,s(n,t,o));const u=a.keys(e,t);for(const r of u){if(\"__proto__\"===r)continue;if(l===n.array&&\"length\"===r){c.length=e.length;continue}const a=Object.getOwnPropertyDescriptor(e,r);a?a.get||a.set?Object.defineProperty(c,r,a):a.enumerable?c[r]=s(e[r],t,o):Object.defineProperty(c,r,{enumerable:!1,writable:!0,configurable:!0,value:s(e[r],t,o)}):Object.defineProperty(c,r,{enumerable:!0,writable:!0,configurable:!0,value:s(e[r],t,o)})}return c},i.cloneWithShallow=function(e,t){const r=t.shallow;(t=Object.assign({},t)).shallow=!1;const n=new Map;for(const t of r){const r=s(e,t);\"object\"!=typeof r&&\"function\"!=typeof r||n.set(r,r)}return i.clone(e,t,n)},i.base=function(e,t,r){if(!1===r.prototype)return i.needsProtoHack.has(t)?new t.constructor:t===n.array?[]:{};const s=Object.getPrototypeOf(e);if(s&&s.isImmutable)return e;if(t===n.array){const e=[];return s!==t&&Object.setPrototypeOf(e,s),e}if(i.needsProtoHack.has(t)){const e=new s.constructor;return s!==t&&Object.setPrototypeOf(e,s),e}return Object.create(s)}},9474:(e,t,r)=>{\"use strict\";const s=r(4277),n={mismatched:null};e.exports=function(e,t,r){return r=Object.assign({prototype:!0},r),!!n.isDeepEqual(e,t,r,[])},n.isDeepEqual=function(e,t,r,a){if(e===t)return 0!==e||1/e==1/t;const i=typeof e;if(i!==typeof t)return!1;if(null===e||null===t)return!1;if(\"function\"===i){if(!r.deepFunction||e.toString()!==t.toString())return!1}else if(\"object\"!==i)return e!=e&&t!=t;const o=n.getSharedType(e,t,!!r.prototype);switch(o){case s.buffer:return!1;case s.promise:return e===t;case s.regex:return e.toString()===t.toString();case n.mismatched:return!1}for(let r=a.length-1;r>=0;--r)if(a[r].isSame(e,t))return!0;a.push(new n.SeenEntry(e,t));try{return!!n.isDeepEqualObj(o,e,t,r,a)}finally{a.pop()}},n.getSharedType=function(e,t,r){if(r)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?n.mismatched:s.getInternalProto(e);const a=s.getInternalProto(e);return a!==s.getInternalProto(t)?n.mismatched:a},n.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},n.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},n.isSetSimpleEqual=function(e,t){for(const r of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,r))return!1;return!0},n.isDeepEqualObj=function(e,t,r,a,i){const{isDeepEqual:o,valueOf:l,hasOwnEnumerableProperty:c}=n,{keys:u,getOwnPropertySymbols:f}=Object;if(e===s.array){if(!a.part){if(t.length!==r.length)return!1;for(let e=0;e<t.length;++e)if(!o(t[e],r[e],a,i))return!1;return!0}for(const e of t)for(const t of r)if(o(e,t,a,i))return!0}else if(e===s.set){if(t.size!==r.size)return!1;if(!n.isSetSimpleEqual(t,r)){const e=new Set(Set.prototype.values.call(r));for(const r of Set.prototype.values.call(t)){if(e.delete(r))continue;let t=!1;for(const s of e)if(o(r,s,a,i)){e.delete(s),t=!0;break}if(!t)return!1}}}else if(e===s.map){if(t.size!==r.size)return!1;for(const[e,s]of Map.prototype.entries.call(t)){if(void 0===s&&!Map.prototype.has.call(r,e))return!1;if(!o(s,Map.prototype.get.call(r,e),a,i))return!1}}else if(e===s.error&&(t.name!==r.name||t.message!==r.message))return!1;const m=l(t),h=l(r);if((t!==m||r!==h)&&!o(m,h,a,i))return!1;const d=u(t);if(!a.part&&d.length!==u(r).length&&!a.skip)return!1;let p=0;for(const e of d)if(a.skip&&a.skip.includes(e))void 0===r[e]&&++p;else{if(!c(r,e))return!1;if(!o(t[e],r[e],a,i))return!1}if(!a.part&&d.length-p!==u(r).length)return!1;if(!1!==a.symbols){const e=f(t),s=new Set(f(r));for(const n of e){if(!a.skip||!a.skip.includes(n))if(c(t,n)){if(!c(r,n))return!1;if(!o(t[n],r[n],a,i))return!1}else if(c(r,n))return!1;s.delete(n)}for(const e of s)if(c(r,e))return!1}return!0},n.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}}},7916:(e,t,r)=>{\"use strict\";const s=r(8761);e.exports=class extends Error{constructor(e){super(e.filter((e=>\"\"!==e)).map((e=>\"string\"==typeof e?e:e instanceof Error?e.message:s(e))).join(\" \")||\"Unknown error\"),\"function\"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}},5277:e=>{\"use strict\";const t={};e.exports=function(e){if(!e)return\"\";let r=\"\";for(let s=0;s<e.length;++s){const n=e.charCodeAt(s);t.isSafe(n)?r+=e[s]:r+=t.escapeHtmlChar(n)}return r},t.escapeHtmlChar=function(e){return t.namedHtml.get(e)||(e>=256?\"&#\"+e+\";\":`&#x${e.toString(16).padStart(2,\"0\")};`)},t.isSafe=function(e){return t.safeCharCodes.has(e)},t.namedHtml=new Map([[38,\"&amp;\"],[60,\"&lt;\"],[62,\"&gt;\"],[34,\"&quot;\"],[160,\"&nbsp;\"],[162,\"&cent;\"],[163,\"&pound;\"],[164,\"&curren;\"],[169,\"&copy;\"],[174,\"&reg;\"]]),t.safeCharCodes=function(){const e=new Set;for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&e.add(t);return e}()},6064:e=>{\"use strict\";e.exports=function(e){return e.replace(/[\\^\\$\\.\\*\\+\\-\\?\\=\\!\\:\\|\\\\\\/\\(\\)\\[\\]\\{\\}\\,]/g,\"\\\\$&\")}},738:e=>{\"use strict\";e.exports=function(){}},1687:(e,t,r)=>{\"use strict\";const s=r(375),n=r(8571),a=r(7043),i={};e.exports=i.merge=function(e,t,r){if(s(e&&\"object\"==typeof e,\"Invalid target value: must be an object\"),s(null==t||\"object\"==typeof t,\"Invalid source value: must be null, undefined, or an object\"),!t)return e;if(r=Object.assign({nullOverride:!0,mergeArrays:!0},r),Array.isArray(t)){s(Array.isArray(e),\"Cannot merge array onto an object\"),r.mergeArrays||(e.length=0);for(let s=0;s<t.length;++s)e.push(n(t[s],{symbols:r.symbols}));return e}const o=a.keys(t,r);for(let s=0;s<o.length;++s){const a=o[s];if(\"__proto__\"===a||!Object.prototype.propertyIsEnumerable.call(t,a))continue;const l=t[a];if(l&&\"object\"==typeof l){if(e[a]===l)continue;!e[a]||\"object\"!=typeof e[a]||Array.isArray(e[a])!==Array.isArray(l)||l instanceof Date||l instanceof RegExp?e[a]=n(l,{symbols:r.symbols}):i.merge(e[a],l,r)}else(null!=l||r.nullOverride)&&(e[a]=l)}return e}},9621:(e,t,r)=>{\"use strict\";const s=r(375),n={};e.exports=function(e,t,r){if(!1===t||null==t)return e;\"string\"==typeof(r=r||{})&&(r={separator:r});const a=Array.isArray(t);s(!a||!r.separator,\"Separator option is not valid for array-based chain\");const i=a?t:t.split(r.separator||\".\");let o=e;for(let e=0;e<i.length;++e){let a=i[e];const l=r.iterables&&n.iterables(o);if(Array.isArray(o)||\"set\"===l){const e=Number(a);Number.isInteger(e)&&(a=e<0?o.length+e:e)}if(!o||\"function\"==typeof o&&!1===r.functions||!l&&void 0===o[a]){s(!r.strict||e+1===i.length,\"Missing segment\",a,\"in reach path \",t),s(\"object\"==typeof o||!0===r.functions||\"function\"!=typeof o,\"Invalid segment\",a,\"in reach path \",t),o=r.default;break}o=l?\"set\"===l?[...o][a]:o.get(a):o[a]}return o},n.iterables=function(e){return e instanceof Set?\"set\":e instanceof Map?\"map\":void 0}},8761:e=>{\"use strict\";e.exports=function(...e){try{return JSON.stringify(...e)}catch(e){return\"[Cannot display object: \"+e.message+\"]\"}}},4277:(e,t)=>{\"use strict\";const r={};t=e.exports={array:Array.prototype,buffer:!1,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},r.typeMap=new Map([[\"[object Error]\",t.error],[\"[object Map]\",t.map],[\"[object Promise]\",t.promise],[\"[object Set]\",t.set],[\"[object WeakMap]\",t.weakMap],[\"[object WeakSet]\",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const s=Object.prototype.toString.call(e);return r.typeMap.get(s)||t.generic}},7043:(e,t)=>{\"use strict\";t.keys=function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)}},3652:(e,t,r)=>{\"use strict\";const s=r(375),n={};t.Sorter=class{constructor(){this._items=[],this.nodes=[]}add(e,t){const r=[].concat((t=t||{}).before||[]),n=[].concat(t.after||[]),a=t.group||\"?\",i=t.sort||0;s(!r.includes(a),`Item cannot come before itself: ${a}`),s(!r.includes(\"?\"),\"Item cannot come before unassociated items\"),s(!n.includes(a),`Item cannot come after itself: ${a}`),s(!n.includes(\"?\"),\"Item cannot come after unassociated items\"),Array.isArray(e)||(e=[e]);for(const t of e){const e={seq:this._items.length,sort:i,before:r,after:n,group:a,node:t};this._items.push(e)}if(!t.manual){const e=this._sort();s(e,\"item\",\"?\"!==a?`added into group ${a}`:\"\",\"created a dependencies error\")}return this.nodes}merge(e){Array.isArray(e)||(e=[e]);for(const t of e)if(t)for(const e of t._items)this._items.push(Object.assign({},e));this._items.sort(n.mergeSort);for(let e=0;e<this._items.length;++e)this._items[e].seq=e;const t=this._sort();return s(t,\"merge created a dependencies error\"),this.nodes}sort(){const e=this._sort();return s(e,\"sort created a dependencies error\"),this.nodes}_sort(){const e={},t=Object.create(null),r=Object.create(null);for(const s of this._items){const n=s.seq,a=s.group;r[a]=r[a]||[],r[a].push(n),e[n]=s.before;for(const e of s.after)t[e]=t[e]||[],t[e].push(n)}for(const t in e){const s=[];for(const n in e[t]){const a=e[t][n];r[a]=r[a]||[],s.push(...r[a])}e[t]=s}for(const s in t)if(r[s])for(const n of r[s])e[n].push(...t[s]);const s={};for(const t in e){const r=e[t];for(const e of r)s[e]=s[e]||[],s[e].push(t)}const n={},a=[];for(let e=0;e<this._items.length;++e){let t=e;if(s[e]){t=null;for(let e=0;e<this._items.length;++e){if(!0===n[e])continue;s[e]||(s[e]=[]);const r=s[e].length;let a=0;for(let t=0;t<r;++t)n[s[e][t]]&&++a;if(a===r){t=e;break}}}null!==t&&(n[t]=!0,a.push(t))}if(a.length!==this._items.length)return!1;const i={};for(const e of this._items)i[e.seq]=e;this._items=[],this.nodes=[];for(const e of a){const t=i[e];this.nodes.push(t.node),this._items.push(t)}return!0}},n.mergeSort=(e,t)=>e.sort===t.sort?0:e.sort<t.sort?-1:1},5380:(e,t,r)=>{\"use strict\";const s=r(443),n=r(2178),a={minDomainSegments:2,nonAsciiRx:/[^\\x00-\\x7f]/,domainControlRx:/[\\x00-\\x20@\\:\\/\\\\#!\\$&\\'\\(\\)\\*\\+,;=\\?]/,tldSegmentRx:/^[a-zA-Z](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,domainSegmentRx:/^[a-zA-Z0-9](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,URL:s.URL||URL};t.analyze=function(e,t={}){if(!e)return n.code(\"DOMAIN_NON_EMPTY_STRING\");if(\"string\"!=typeof e)throw new Error(\"Invalid input: domain must be a string\");if(e.length>256)return n.code(\"DOMAIN_TOO_LONG\");if(a.nonAsciiRx.test(e)){if(!1===t.allowUnicode)return n.code(\"DOMAIN_INVALID_UNICODE_CHARS\");e=e.normalize(\"NFC\")}if(a.domainControlRx.test(e))return n.code(\"DOMAIN_INVALID_CHARS\");e=a.punycode(e),t.allowFullyQualified&&\".\"===e[e.length-1]&&(e=e.slice(0,-1));const r=t.minDomainSegments||a.minDomainSegments,s=e.split(\".\");if(s.length<r)return n.code(\"DOMAIN_SEGMENTS_COUNT\");if(t.maxDomainSegments&&s.length>t.maxDomainSegments)return n.code(\"DOMAIN_SEGMENTS_COUNT_MAX\");const i=t.tlds;if(i){const e=s[s.length-1].toLowerCase();if(i.deny&&i.deny.has(e)||i.allow&&!i.allow.has(e))return n.code(\"DOMAIN_FORBIDDEN_TLDS\")}for(let e=0;e<s.length;++e){const t=s[e];if(!t.length)return n.code(\"DOMAIN_EMPTY_SEGMENT\");if(t.length>63)return n.code(\"DOMAIN_LONG_SEGMENT\");if(e<s.length-1){if(!a.domainSegmentRx.test(t))return n.code(\"DOMAIN_INVALID_CHARS\")}else if(!a.tldSegmentRx.test(t))return n.code(\"DOMAIN_INVALID_TLDS_CHARS\")}return null},t.isValid=function(e,r){return!t.analyze(e,r)},a.punycode=function(e){e.includes(\"%\")&&(e=e.replace(/%/g,\"%25\"));try{return new a.URL(`http://${e}`).host}catch(t){return e}}},1745:(e,t,r)=>{\"use strict\";const s=r(9848),n=r(5380),a=r(2178),i={nonAsciiRx:/[^\\x00-\\x7f]/,encoder:new(s.TextEncoder||TextEncoder)};t.analyze=function(e,t){return i.email(e,t)},t.isValid=function(e,t){return!i.email(e,t)},i.email=function(e,t={}){if(\"string\"!=typeof e)throw new Error(\"Invalid input: email must be a string\");if(!e)return a.code(\"EMPTY_STRING\");const r=!i.nonAsciiRx.test(e);if(!r){if(!1===t.allowUnicode)return a.code(\"FORBIDDEN_UNICODE\");e=e.normalize(\"NFC\")}const s=e.split(\"@\");if(2!==s.length)return s.length>2?a.code(\"MULTIPLE_AT_CHAR\"):a.code(\"MISSING_AT_CHAR\");const[o,l]=s;if(!o)return a.code(\"EMPTY_LOCAL\");if(!t.ignoreLength){if(e.length>254)return a.code(\"ADDRESS_TOO_LONG\");if(i.encoder.encode(o).length>64)return a.code(\"LOCAL_TOO_LONG\")}return i.local(o,r)||n.analyze(l,t)},i.local=function(e,t){const r=e.split(\".\");for(const e of r){if(!e.length)return a.code(\"EMPTY_LOCAL_SEGMENT\");if(t){if(!i.atextRx.test(e))return a.code(\"INVALID_LOCAL_CHARS\")}else for(const t of e){if(i.atextRx.test(t))continue;const e=i.binary(t);if(!i.atomRx.test(e))return a.code(\"INVALID_LOCAL_CHARS\")}}},i.binary=function(e){return Array.from(i.encoder.encode(e)).map((e=>String.fromCharCode(e))).join(\"\")},i.atextRx=/^[\\w!#\\$%&'\\*\\+\\-/=\\?\\^`\\{\\|\\}~]+$/,i.atomRx=new RegExp([\"(?:[\\\\xc2-\\\\xdf][\\\\x80-\\\\xbf])\",\"(?:\\\\xe0[\\\\xa0-\\\\xbf][\\\\x80-\\\\xbf])|(?:[\\\\xe1-\\\\xec][\\\\x80-\\\\xbf]{2})|(?:\\\\xed[\\\\x80-\\\\x9f][\\\\x80-\\\\xbf])|(?:[\\\\xee-\\\\xef][\\\\x80-\\\\xbf]{2})\",\"(?:\\\\xf0[\\\\x90-\\\\xbf][\\\\x80-\\\\xbf]{2})|(?:[\\\\xf1-\\\\xf3][\\\\x80-\\\\xbf]{3})|(?:\\\\xf4[\\\\x80-\\\\x8f][\\\\x80-\\\\xbf]{2})\"].join(\"|\"))},2178:(e,t)=>{\"use strict\";t.codes={EMPTY_STRING:\"Address must be a non-empty string\",FORBIDDEN_UNICODE:\"Address contains forbidden Unicode characters\",MULTIPLE_AT_CHAR:\"Address cannot contain more than one @ character\",MISSING_AT_CHAR:\"Address must contain one @ character\",EMPTY_LOCAL:\"Address local part cannot be empty\",ADDRESS_TOO_LONG:\"Address too long\",LOCAL_TOO_LONG:\"Address local part too long\",EMPTY_LOCAL_SEGMENT:\"Address local part contains empty dot-separated segment\",INVALID_LOCAL_CHARS:\"Address local part contains invalid character\",DOMAIN_NON_EMPTY_STRING:\"Domain must be a non-empty string\",DOMAIN_TOO_LONG:\"Domain too long\",DOMAIN_INVALID_UNICODE_CHARS:\"Domain contains forbidden Unicode characters\",DOMAIN_INVALID_CHARS:\"Domain contains invalid character\",DOMAIN_INVALID_TLDS_CHARS:\"Domain contains invalid tld character\",DOMAIN_SEGMENTS_COUNT:\"Domain lacks the minimum required number of segments\",DOMAIN_SEGMENTS_COUNT_MAX:\"Domain contains too many segments\",DOMAIN_FORBIDDEN_TLDS:\"Domain uses forbidden TLD\",DOMAIN_EMPTY_SEGMENT:\"Domain contains empty dot-separated segment\",DOMAIN_LONG_SEGMENT:\"Domain contains dot-separated segment that is too long\"},t.code=function(e){return{code:e,error:t.codes[e]}}},9959:(e,t,r)=>{\"use strict\";const s=r(375),n=r(5752);t.regex=function(e={}){s(void 0===e.cidr||\"string\"==typeof e.cidr,\"options.cidr must be a string\");const t=e.cidr?e.cidr.toLowerCase():\"optional\";s([\"required\",\"optional\",\"forbidden\"].includes(t),\"options.cidr must be one of required, optional, forbidden\"),s(void 0===e.version||\"string\"==typeof e.version||Array.isArray(e.version),\"options.version must be a string or an array of string\");let r=e.version||[\"ipv4\",\"ipv6\",\"ipvfuture\"];Array.isArray(r)||(r=[r]),s(r.length>=1,\"options.version must have at least 1 version specified\");for(let e=0;e<r.length;++e)s(\"string\"==typeof r[e],\"options.version must only contain strings\"),r[e]=r[e].toLowerCase(),s([\"ipv4\",\"ipv6\",\"ipvfuture\"].includes(r[e]),\"options.version contains unknown version \"+r[e]+\" - must be one of ipv4, ipv6, ipvfuture\");r=Array.from(new Set(r));const a=`(?:${r.map((e=>{if(\"forbidden\"===t)return n.ip[e];const r=`\\\\/${\"ipv4\"===e?n.ip.v4Cidr:n.ip.v6Cidr}`;return\"required\"===t?`${n.ip[e]}${r}`:`${n.ip[e]}(?:${r})?`})).join(\"|\")})`,i=new RegExp(`^${a}$`);return{cidr:t,versions:r,regex:i,raw:a}}},5752:(e,t,r)=>{\"use strict\";const s=r(375),n=r(6064),a={generate:function(){const e={},t=\"\\\\dA-Fa-f\",r=\"[\"+t+\"]\",s=\"\\\\w-\\\\.~\",n=\"!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=\",a=\"%\"+t,i=s+a+n+\":@\",o=\"[\"+i+\"]\",l=\"(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\";e.ipv4address=\"(?:\"+l+\"\\\\.){3}\"+l;const c=r+\"{1,4}\",u=\"(?:\"+c+\":\"+c+\"|\"+e.ipv4address+\")\",f=\"(?:\"+c+\":){6}\"+u,m=\"::(?:\"+c+\":){5}\"+u,h=\"(?:\"+c+\")?::(?:\"+c+\":){4}\"+u,d=\"(?:(?:\"+c+\":){0,1}\"+c+\")?::(?:\"+c+\":){3}\"+u,p=\"(?:(?:\"+c+\":){0,2}\"+c+\")?::(?:\"+c+\":){2}\"+u,g=\"(?:(?:\"+c+\":){0,3}\"+c+\")?::\"+c+\":\"+u,y=\"(?:(?:\"+c+\":){0,4}\"+c+\")?::\"+u,b=\"(?:(?:\"+c+\":){0,5}\"+c+\")?::\"+c,v=\"(?:(?:\"+c+\":){0,6}\"+c+\")?::\";e.ipv4Cidr=\"(?:\\\\d|[1-2]\\\\d|3[0-2])\",e.ipv6Cidr=\"(?:0{0,2}\\\\d|0?[1-9]\\\\d|1[01]\\\\d|12[0-8])\",e.ipv6address=\"(?:\"+f+\"|\"+m+\"|\"+h+\"|\"+d+\"|\"+p+\"|\"+g+\"|\"+y+\"|\"+b+\"|\"+v+\")\",e.ipvFuture=\"v\"+r+\"+\\\\.[\"+s+n+\":]+\",e.scheme=\"[a-zA-Z][a-zA-Z\\\\d+-\\\\.]*\",e.schemeRegex=new RegExp(e.scheme);const _=\"[\"+s+a+n+\":]*\",w=\"[\"+s+a+n+\"]{1,255}\",$=\"(?:\\\\[(?:\"+e.ipv6address+\"|\"+e.ipvFuture+\")\\\\]|\"+e.ipv4address+\"|\"+w+\")\",x=\"(?:\"+_+\"@)?\"+$+\"(?::\\\\d*)?\",j=\"(?:\"+_+\"@)?(\"+$+\")(?::\\\\d*)?\",k=o+\"*\",R=o+\"+\",S=\"(?:\\\\/\"+k+\")*\",A=\"\\\\/(?:\"+R+S+\")?\",O=R+S,E=\"[\"+s+a+n+\"@]+\"+S,D=\"(?:\\\\/\\\\/\\\\/\"+k+S+\")\";return e.hierPart=\"(?:(?:\\\\/\\\\/\"+x+S+\")|\"+A+\"|\"+O+\"|\"+D+\")\",e.hierPartCapture=\"(?:(?:\\\\/\\\\/\"+j+S+\")|\"+A+\"|\"+O+\")\",e.relativeRef=\"(?:(?:\\\\/\\\\/\"+x+S+\")|\"+A+\"|\"+E+\"|)\",e.relativeRefCapture=\"(?:(?:\\\\/\\\\/\"+j+S+\")|\"+A+\"|\"+E+\"|)\",e.query=\"[\"+i+\"\\\\/\\\\?]*(?=#|$)\",e.queryWithSquareBrackets=\"[\"+i+\"\\\\[\\\\]\\\\/\\\\?]*(?=#|$)\",e.fragment=\"[\"+i+\"\\\\/\\\\?]*\",e}};a.rfc3986=a.generate(),t.ip={v4Cidr:a.rfc3986.ipv4Cidr,v6Cidr:a.rfc3986.ipv6Cidr,ipv4:a.rfc3986.ipv4address,ipv6:a.rfc3986.ipv6address,ipvfuture:a.rfc3986.ipvFuture},a.createRegex=function(e){const t=a.rfc3986,r=\"(?:\\\\?\"+(e.allowQuerySquareBrackets?t.queryWithSquareBrackets:t.query)+\")?(?:#\"+t.fragment+\")?\",i=e.domain?t.relativeRefCapture:t.relativeRef;if(e.relativeOnly)return a.wrap(i+r);let o=\"\";if(e.scheme){s(e.scheme instanceof RegExp||\"string\"==typeof e.scheme||Array.isArray(e.scheme),\"scheme must be a RegExp, String, or Array\");const r=[].concat(e.scheme);s(r.length>=1,\"scheme must have at least 1 scheme specified\");const a=[];for(let e=0;e<r.length;++e){const i=r[e];s(i instanceof RegExp||\"string\"==typeof i,\"scheme at position \"+e+\" must be a RegExp or String\"),i instanceof RegExp?a.push(i.source.toString()):(s(t.schemeRegex.test(i),\"scheme at position \"+e+\" must be a valid scheme\"),a.push(n(i)))}o=a.join(\"|\")}const l=\"(?:\"+(o?\"(?:\"+o+\")\":t.scheme)+\":\"+(e.domain?t.hierPartCapture:t.hierPart)+\")\",c=e.allowRelative?\"(?:\"+l+\"|\"+i+\")\":l;return a.wrap(c+r,o)},a.wrap=function(e,t){return{raw:e=`(?=.)(?!https?:/(?:$|[^/]))(?!https?:///)(?!https?:[^/])${e}`,regex:new RegExp(`^${e}$`),scheme:t}},a.uriRegex=a.createRegex({}),t.regex=function(e={}){return e.scheme||e.allowRelative||e.relativeOnly||e.allowQuerySquareBrackets||e.domain?a.createRegex(e):a.uriRegex}},1447:(e,t)=>{\"use strict\";const r={operators:[\"!\",\"^\",\"*\",\"/\",\"%\",\"+\",\"-\",\"<\",\"<=\",\">\",\">=\",\"==\",\"!=\",\"&&\",\"||\",\"??\"],operatorCharacters:[\"!\",\"^\",\"*\",\"/\",\"%\",\"+\",\"-\",\"<\",\"=\",\">\",\"&\",\"|\",\"?\"],operatorsOrder:[[\"^\"],[\"*\",\"/\",\"%\"],[\"+\",\"-\"],[\"<\",\"<=\",\">\",\">=\"],[\"==\",\"!=\"],[\"&&\"],[\"||\",\"??\"]],operatorsPrefix:[\"!\",\"n\"],literals:{'\"':'\"',\"`\":\"`\",\"'\":\"'\",\"[\":\"]\"},numberRx:/^(?:[0-9]*(\\.[0-9]*)?){1}$/,tokenRx:/^[\\w\\$\\#\\.\\@\\:\\{\\}]+$/,symbol:Symbol(\"formula\"),settings:Symbol(\"settings\")};t.Parser=class{constructor(e,t={}){if(!t[r.settings]&&t.constants)for(const e in t.constants){const r=t.constants[e];if(null!==r&&![\"boolean\",\"number\",\"string\"].includes(typeof r))throw new Error(`Formula constant ${e} contains invalid ${typeof r} value type`)}this.settings=t[r.settings]?t:Object.assign({[r.settings]:!0,constants:{},functions:{}},t),this.single=null,this._parts=null,this._parse(e)}_parse(e){let s=[],n=\"\",a=0,i=!1;const o=e=>{if(a)throw new Error(\"Formula missing closing parenthesis\");const o=s.length?s[s.length-1]:null;if(i||n||e){if(o&&\"reference\"===o.type&&\")\"===e)return o.type=\"function\",o.value=this._subFormula(n,o.value),void(n=\"\");if(\")\"===e){const e=new t.Parser(n,this.settings);s.push({type:\"segment\",value:e})}else if(i){if(\"]\"===i)return s.push({type:\"reference\",value:n}),void(n=\"\");s.push({type:\"literal\",value:n})}else if(r.operatorCharacters.includes(n))o&&\"operator\"===o.type&&r.operators.includes(o.value+n)?o.value+=n:s.push({type:\"operator\",value:n});else if(n.match(r.numberRx))s.push({type:\"constant\",value:parseFloat(n)});else if(void 0!==this.settings.constants[n])s.push({type:\"constant\",value:this.settings.constants[n]});else{if(!n.match(r.tokenRx))throw new Error(`Formula contains invalid token: ${n}`);s.push({type:\"reference\",value:n})}n=\"\"}};for(const t of e)i?t===i?(o(),i=!1):n+=t:a?\"(\"===t?(n+=t,++a):\")\"===t?(--a,a?n+=t:o(t)):n+=t:t in r.literals?i=r.literals[t]:\"(\"===t?(o(),++a):r.operatorCharacters.includes(t)?(o(),n=t,o()):\" \"!==t?n+=t:o();o(),s=s.map(((e,t)=>\"operator\"!==e.type||\"-\"!==e.value||t&&\"operator\"!==s[t-1].type?e:{type:\"operator\",value:\"n\"}));let l=!1;for(const e of s){if(\"operator\"===e.type){if(r.operatorsPrefix.includes(e.value))continue;if(!l)throw new Error(\"Formula contains an operator in invalid position\");if(!r.operators.includes(e.value))throw new Error(`Formula contains an unknown operator ${e.value}`)}else if(l)throw new Error(\"Formula missing expected operator\");l=!l}if(!l)throw new Error(\"Formula contains invalid trailing operator\");1===s.length&&[\"reference\",\"literal\",\"constant\"].includes(s[0].type)&&(this.single={type:\"reference\"===s[0].type?\"reference\":\"value\",value:s[0].value}),this._parts=s.map((e=>{if(\"operator\"===e.type)return r.operatorsPrefix.includes(e.value)?e:e.value;if(\"reference\"!==e.type)return e.value;if(this.settings.tokenRx&&!this.settings.tokenRx.test(e.value))throw new Error(`Formula contains invalid reference ${e.value}`);return this.settings.reference?this.settings.reference(e.value):r.reference(e.value)}))}_subFormula(e,s){const n=this.settings.functions[s];if(\"function\"!=typeof n)throw new Error(`Formula contains unknown function ${s}`);let a=[];if(e){let t=\"\",n=0,i=!1;const o=()=>{if(!t)throw new Error(`Formula contains function ${s} with invalid arguments ${e}`);a.push(t),t=\"\"};for(let s=0;s<e.length;++s){const a=e[s];i?(t+=a,a===i&&(i=!1)):a in r.literals&&!n?(t+=a,i=r.literals[a]):\",\"!==a||n?(t+=a,\"(\"===a?++n:\")\"===a&&--n):o()}o()}return a=a.map((e=>new t.Parser(e,this.settings))),function(e){const t=[];for(const r of a)t.push(r.evaluate(e));return n.call(e,...t)}}evaluate(e){const t=this._parts.slice();for(let s=t.length-2;s>=0;--s){const n=t[s];if(n&&\"operator\"===n.type){const a=t[s+1];t.splice(s+1,1);const i=r.evaluate(a,e);t[s]=r.single(n.value,i)}}return r.operatorsOrder.forEach((s=>{for(let n=1;n<t.length-1;)if(s.includes(t[n])){const s=t[n],a=r.evaluate(t[n-1],e),i=r.evaluate(t[n+1],e);t.splice(n,2);const o=r.calculate(s,a,i);t[n-1]=0===o?0:o}else n+=2})),r.evaluate(t[0],e)}},t.Parser.prototype[r.symbol]=!0,r.reference=function(e){return function(t){return t&&void 0!==t[e]?t[e]:null}},r.evaluate=function(e,t){return null===e?null:\"function\"==typeof e?e(t):e[r.symbol]?e.evaluate(t):e},r.single=function(e,t){if(\"!\"===e)return!t;const r=-t;return 0===r?0:r},r.calculate=function(e,t,s){if(\"??\"===e)return r.exists(t)?t:s;if(\"string\"==typeof t||\"string\"==typeof s){if(\"+\"===e)return(t=r.exists(t)?t:\"\")+(r.exists(s)?s:\"\")}else switch(e){case\"^\":return Math.pow(t,s);case\"*\":return t*s;case\"/\":return t/s;case\"%\":return t%s;case\"+\":return t+s;case\"-\":return t-s}switch(e){case\"<\":return t<s;case\"<=\":return t<=s;case\">\":return t>s;case\">=\":return t>=s;case\"==\":return t===s;case\"!=\":return t!==s;case\"&&\":return t&&s;case\"||\":return t||s}return null},r.exists=function(e){return null!=e}},9926:()=>{},5688:()=>{},9708:()=>{},1152:()=>{},443:()=>{},9848:()=>{},5934:e=>{\"use strict\";e.exports=JSON.parse('{\"version\":\"17.12.0\"}')}},t={},function r(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}(5107);var e,t}));","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n// these aren't really private, but nor are they really useful to document\n\n/**\n * @private\n */\nclass LuxonError extends Error {}\n\n/**\n * @private\n */\nclass InvalidDateTimeError extends LuxonError {\n  constructor(reason) {\n    super(`Invalid DateTime: ${reason.toMessage()}`);\n  }\n}\n\n/**\n * @private\n */\nclass InvalidIntervalError extends LuxonError {\n  constructor(reason) {\n    super(`Invalid Interval: ${reason.toMessage()}`);\n  }\n}\n\n/**\n * @private\n */\nclass InvalidDurationError extends LuxonError {\n  constructor(reason) {\n    super(`Invalid Duration: ${reason.toMessage()}`);\n  }\n}\n\n/**\n * @private\n */\nclass ConflictingSpecificationError extends LuxonError {}\n\n/**\n * @private\n */\nclass InvalidUnitError extends LuxonError {\n  constructor(unit) {\n    super(`Invalid unit ${unit}`);\n  }\n}\n\n/**\n * @private\n */\nclass InvalidArgumentError extends LuxonError {}\n\n/**\n * @private\n */\nclass ZoneIsAbstractError extends LuxonError {\n  constructor() {\n    super(\"Zone is an abstract class\");\n  }\n}\n\n/**\n * @private\n */\n\nconst n = \"numeric\",\n  s = \"short\",\n  l = \"long\";\nconst DATE_SHORT = {\n  year: n,\n  month: n,\n  day: n\n};\nconst DATE_MED = {\n  year: n,\n  month: s,\n  day: n\n};\nconst DATE_MED_WITH_WEEKDAY = {\n  year: n,\n  month: s,\n  day: n,\n  weekday: s\n};\nconst DATE_FULL = {\n  year: n,\n  month: l,\n  day: n\n};\nconst DATE_HUGE = {\n  year: n,\n  month: l,\n  day: n,\n  weekday: l\n};\nconst TIME_SIMPLE = {\n  hour: n,\n  minute: n\n};\nconst TIME_WITH_SECONDS = {\n  hour: n,\n  minute: n,\n  second: n\n};\nconst TIME_WITH_SHORT_OFFSET = {\n  hour: n,\n  minute: n,\n  second: n,\n  timeZoneName: s\n};\nconst TIME_WITH_LONG_OFFSET = {\n  hour: n,\n  minute: n,\n  second: n,\n  timeZoneName: l\n};\nconst TIME_24_SIMPLE = {\n  hour: n,\n  minute: n,\n  hourCycle: \"h23\"\n};\nconst TIME_24_WITH_SECONDS = {\n  hour: n,\n  minute: n,\n  second: n,\n  hourCycle: \"h23\"\n};\nconst TIME_24_WITH_SHORT_OFFSET = {\n  hour: n,\n  minute: n,\n  second: n,\n  hourCycle: \"h23\",\n  timeZoneName: s\n};\nconst TIME_24_WITH_LONG_OFFSET = {\n  hour: n,\n  minute: n,\n  second: n,\n  hourCycle: \"h23\",\n  timeZoneName: l\n};\nconst DATETIME_SHORT = {\n  year: n,\n  month: n,\n  day: n,\n  hour: n,\n  minute: n\n};\nconst DATETIME_SHORT_WITH_SECONDS = {\n  year: n,\n  month: n,\n  day: n,\n  hour: n,\n  minute: n,\n  second: n\n};\nconst DATETIME_MED = {\n  year: n,\n  month: s,\n  day: n,\n  hour: n,\n  minute: n\n};\nconst DATETIME_MED_WITH_SECONDS = {\n  year: n,\n  month: s,\n  day: n,\n  hour: n,\n  minute: n,\n  second: n\n};\nconst DATETIME_MED_WITH_WEEKDAY = {\n  year: n,\n  month: s,\n  day: n,\n  weekday: s,\n  hour: n,\n  minute: n\n};\nconst DATETIME_FULL = {\n  year: n,\n  month: l,\n  day: n,\n  hour: n,\n  minute: n,\n  timeZoneName: s\n};\nconst DATETIME_FULL_WITH_SECONDS = {\n  year: n,\n  month: l,\n  day: n,\n  hour: n,\n  minute: n,\n  second: n,\n  timeZoneName: s\n};\nconst DATETIME_HUGE = {\n  year: n,\n  month: l,\n  day: n,\n  weekday: l,\n  hour: n,\n  minute: n,\n  timeZoneName: l\n};\nconst DATETIME_HUGE_WITH_SECONDS = {\n  year: n,\n  month: l,\n  day: n,\n  weekday: l,\n  hour: n,\n  minute: n,\n  second: n,\n  timeZoneName: l\n};\n\n/**\n * @interface\n */\nclass Zone {\n  /**\n   * The type of zone\n   * @abstract\n   * @type {string}\n   */\n  get type() {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * The name of this zone.\n   * @abstract\n   * @type {string}\n   */\n  get name() {\n    throw new ZoneIsAbstractError();\n  }\n  get ianaName() {\n    return this.name;\n  }\n\n  /**\n   * Returns whether the offset is known to be fixed for the whole year.\n   * @abstract\n   * @type {boolean}\n   */\n  get isUniversal() {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * Returns the offset's common name (such as EST) at the specified timestamp\n   * @abstract\n   * @param {number} ts - Epoch milliseconds for which to get the name\n   * @param {Object} opts - Options to affect the format\n   * @param {string} opts.format - What style of offset to return. Accepts 'long' or 'short'.\n   * @param {string} opts.locale - What locale to return the offset name in.\n   * @return {string}\n   */\n  offsetName(ts, opts) {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * Returns the offset's value as a string\n   * @abstract\n   * @param {number} ts - Epoch milliseconds for which to get the offset\n   * @param {string} format - What style of offset to return.\n   *                          Accepts 'narrow', 'short', or 'techie'. Returning '+6', '+06:00', or '+0600' respectively\n   * @return {string}\n   */\n  formatOffset(ts, format) {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * Return the offset in minutes for this zone at the specified timestamp.\n   * @abstract\n   * @param {number} ts - Epoch milliseconds for which to compute the offset\n   * @return {number}\n   */\n  offset(ts) {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * Return whether this Zone is equal to another zone\n   * @abstract\n   * @param {Zone} otherZone - the zone to compare\n   * @return {boolean}\n   */\n  equals(otherZone) {\n    throw new ZoneIsAbstractError();\n  }\n\n  /**\n   * Return whether this Zone is valid.\n   * @abstract\n   * @type {boolean}\n   */\n  get isValid() {\n    throw new ZoneIsAbstractError();\n  }\n}\n\nlet singleton$1 = null;\n\n/**\n * Represents the local zone for this JavaScript environment.\n * @implements {Zone}\n */\nclass SystemZone extends Zone {\n  /**\n   * Get a singleton instance of the local zone\n   * @return {SystemZone}\n   */\n  static get instance() {\n    if (singleton$1 === null) {\n      singleton$1 = new SystemZone();\n    }\n    return singleton$1;\n  }\n\n  /** @override **/\n  get type() {\n    return \"system\";\n  }\n\n  /** @override **/\n  get name() {\n    return new Intl.DateTimeFormat().resolvedOptions().timeZone;\n  }\n\n  /** @override **/\n  get isUniversal() {\n    return false;\n  }\n\n  /** @override **/\n  offsetName(ts, {\n    format,\n    locale\n  }) {\n    return parseZoneInfo(ts, format, locale);\n  }\n\n  /** @override **/\n  formatOffset(ts, format) {\n    return formatOffset(this.offset(ts), format);\n  }\n\n  /** @override **/\n  offset(ts) {\n    return -new Date(ts).getTimezoneOffset();\n  }\n\n  /** @override **/\n  equals(otherZone) {\n    return otherZone.type === \"system\";\n  }\n\n  /** @override **/\n  get isValid() {\n    return true;\n  }\n}\n\nlet dtfCache = {};\nfunction makeDTF(zone) {\n  if (!dtfCache[zone]) {\n    dtfCache[zone] = new Intl.DateTimeFormat(\"en-US\", {\n      hour12: false,\n      timeZone: zone,\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n      era: \"short\"\n    });\n  }\n  return dtfCache[zone];\n}\nconst typeToPos = {\n  year: 0,\n  month: 1,\n  day: 2,\n  era: 3,\n  hour: 4,\n  minute: 5,\n  second: 6\n};\nfunction hackyOffset(dtf, date) {\n  const formatted = dtf.format(date).replace(/\\u200E/g, \"\"),\n    parsed = /(\\d+)\\/(\\d+)\\/(\\d+) (AD|BC),? (\\d+):(\\d+):(\\d+)/.exec(formatted),\n    [, fMonth, fDay, fYear, fadOrBc, fHour, fMinute, fSecond] = parsed;\n  return [fYear, fMonth, fDay, fadOrBc, fHour, fMinute, fSecond];\n}\nfunction partsOffset(dtf, date) {\n  const formatted = dtf.formatToParts(date);\n  const filled = [];\n  for (let i = 0; i < formatted.length; i++) {\n    const {\n      type,\n      value\n    } = formatted[i];\n    const pos = typeToPos[type];\n    if (type === \"era\") {\n      filled[pos] = value;\n    } else if (!isUndefined(pos)) {\n      filled[pos] = parseInt(value, 10);\n    }\n  }\n  return filled;\n}\nlet ianaZoneCache = {};\n/**\n * A zone identified by an IANA identifier, like America/New_York\n * @implements {Zone}\n */\nclass IANAZone extends Zone {\n  /**\n   * @param {string} name - Zone name\n   * @return {IANAZone}\n   */\n  static create(name) {\n    if (!ianaZoneCache[name]) {\n      ianaZoneCache[name] = new IANAZone(name);\n    }\n    return ianaZoneCache[name];\n  }\n\n  /**\n   * Reset local caches. Should only be necessary in testing scenarios.\n   * @return {void}\n   */\n  static resetCache() {\n    ianaZoneCache = {};\n    dtfCache = {};\n  }\n\n  /**\n   * Returns whether the provided string is a valid specifier. This only checks the string's format, not that the specifier identifies a known zone; see isValidZone for that.\n   * @param {string} s - The string to check validity on\n   * @example IANAZone.isValidSpecifier(\"America/New_York\") //=> true\n   * @example IANAZone.isValidSpecifier(\"Sport~~blorp\") //=> false\n   * @deprecated This method returns false for some valid IANA names. Use isValidZone instead.\n   * @return {boolean}\n   */\n  static isValidSpecifier(s) {\n    return this.isValidZone(s);\n  }\n\n  /**\n   * Returns whether the provided string identifies a real zone\n   * @param {string} zone - The string to check\n   * @example IANAZone.isValidZone(\"America/New_York\") //=> true\n   * @example IANAZone.isValidZone(\"Fantasia/Castle\") //=> false\n   * @example IANAZone.isValidZone(\"Sport~~blorp\") //=> false\n   * @return {boolean}\n   */\n  static isValidZone(zone) {\n    if (!zone) {\n      return false;\n    }\n    try {\n      new Intl.DateTimeFormat(\"en-US\", {\n        timeZone: zone\n      }).format();\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  constructor(name) {\n    super();\n    /** @private **/\n    this.zoneName = name;\n    /** @private **/\n    this.valid = IANAZone.isValidZone(name);\n  }\n\n  /** @override **/\n  get type() {\n    return \"iana\";\n  }\n\n  /** @override **/\n  get name() {\n    return this.zoneName;\n  }\n\n  /** @override **/\n  get isUniversal() {\n    return false;\n  }\n\n  /** @override **/\n  offsetName(ts, {\n    format,\n    locale\n  }) {\n    return parseZoneInfo(ts, format, locale, this.name);\n  }\n\n  /** @override **/\n  formatOffset(ts, format) {\n    return formatOffset(this.offset(ts), format);\n  }\n\n  /** @override **/\n  offset(ts) {\n    const date = new Date(ts);\n    if (isNaN(date)) return NaN;\n    const dtf = makeDTF(this.name);\n    let [year, month, day, adOrBc, hour, minute, second] = dtf.formatToParts ? partsOffset(dtf, date) : hackyOffset(dtf, date);\n    if (adOrBc === \"BC\") {\n      year = -Math.abs(year) + 1;\n    }\n\n    // because we're using hour12 and https://bugs.chromium.org/p/chromium/issues/detail?id=1025564&can=2&q=%2224%3A00%22%20datetimeformat\n    const adjustedHour = hour === 24 ? 0 : hour;\n    const asUTC = objToLocalTS({\n      year,\n      month,\n      day,\n      hour: adjustedHour,\n      minute,\n      second,\n      millisecond: 0\n    });\n    let asTS = +date;\n    const over = asTS % 1000;\n    asTS -= over >= 0 ? over : 1000 + over;\n    return (asUTC - asTS) / (60 * 1000);\n  }\n\n  /** @override **/\n  equals(otherZone) {\n    return otherZone.type === \"iana\" && otherZone.name === this.name;\n  }\n\n  /** @override **/\n  get isValid() {\n    return this.valid;\n  }\n}\n\n// todo - remap caching\n\nlet intlLFCache = {};\nfunction getCachedLF(locString, opts = {}) {\n  const key = JSON.stringify([locString, opts]);\n  let dtf = intlLFCache[key];\n  if (!dtf) {\n    dtf = new Intl.ListFormat(locString, opts);\n    intlLFCache[key] = dtf;\n  }\n  return dtf;\n}\nlet intlDTCache = {};\nfunction getCachedDTF(locString, opts = {}) {\n  const key = JSON.stringify([locString, opts]);\n  let dtf = intlDTCache[key];\n  if (!dtf) {\n    dtf = new Intl.DateTimeFormat(locString, opts);\n    intlDTCache[key] = dtf;\n  }\n  return dtf;\n}\nlet intlNumCache = {};\nfunction getCachedINF(locString, opts = {}) {\n  const key = JSON.stringify([locString, opts]);\n  let inf = intlNumCache[key];\n  if (!inf) {\n    inf = new Intl.NumberFormat(locString, opts);\n    intlNumCache[key] = inf;\n  }\n  return inf;\n}\nlet intlRelCache = {};\nfunction getCachedRTF(locString, opts = {}) {\n  const {\n    base,\n    ...cacheKeyOpts\n  } = opts; // exclude `base` from the options\n  const key = JSON.stringify([locString, cacheKeyOpts]);\n  let inf = intlRelCache[key];\n  if (!inf) {\n    inf = new Intl.RelativeTimeFormat(locString, opts);\n    intlRelCache[key] = inf;\n  }\n  return inf;\n}\nlet sysLocaleCache = null;\nfunction systemLocale() {\n  if (sysLocaleCache) {\n    return sysLocaleCache;\n  } else {\n    sysLocaleCache = new Intl.DateTimeFormat().resolvedOptions().locale;\n    return sysLocaleCache;\n  }\n}\nlet weekInfoCache = {};\nfunction getCachedWeekInfo(locString) {\n  let data = weekInfoCache[locString];\n  if (!data) {\n    const locale = new Intl.Locale(locString);\n    // browsers currently implement this as a property, but spec says it should be a getter function\n    data = \"getWeekInfo\" in locale ? locale.getWeekInfo() : locale.weekInfo;\n    weekInfoCache[locString] = data;\n  }\n  return data;\n}\nfunction parseLocaleString(localeStr) {\n  // I really want to avoid writing a BCP 47 parser\n  // see, e.g. https://github.com/wooorm/bcp-47\n  // Instead, we'll do this:\n\n  // a) if the string has no -u extensions, just leave it alone\n  // b) if it does, use Intl to resolve everything\n  // c) if Intl fails, try again without the -u\n\n  // private subtags and unicode subtags have ordering requirements,\n  // and we're not properly parsing this, so just strip out the\n  // private ones if they exist.\n  const xIndex = localeStr.indexOf(\"-x-\");\n  if (xIndex !== -1) {\n    localeStr = localeStr.substring(0, xIndex);\n  }\n  const uIndex = localeStr.indexOf(\"-u-\");\n  if (uIndex === -1) {\n    return [localeStr];\n  } else {\n    let options;\n    let selectedStr;\n    try {\n      options = getCachedDTF(localeStr).resolvedOptions();\n      selectedStr = localeStr;\n    } catch (e) {\n      const smaller = localeStr.substring(0, uIndex);\n      options = getCachedDTF(smaller).resolvedOptions();\n      selectedStr = smaller;\n    }\n    const {\n      numberingSystem,\n      calendar\n    } = options;\n    return [selectedStr, numberingSystem, calendar];\n  }\n}\nfunction intlConfigString(localeStr, numberingSystem, outputCalendar) {\n  if (outputCalendar || numberingSystem) {\n    if (!localeStr.includes(\"-u-\")) {\n      localeStr += \"-u\";\n    }\n    if (outputCalendar) {\n      localeStr += `-ca-${outputCalendar}`;\n    }\n    if (numberingSystem) {\n      localeStr += `-nu-${numberingSystem}`;\n    }\n    return localeStr;\n  } else {\n    return localeStr;\n  }\n}\nfunction mapMonths(f) {\n  const ms = [];\n  for (let i = 1; i <= 12; i++) {\n    const dt = DateTime.utc(2009, i, 1);\n    ms.push(f(dt));\n  }\n  return ms;\n}\nfunction mapWeekdays(f) {\n  const ms = [];\n  for (let i = 1; i <= 7; i++) {\n    const dt = DateTime.utc(2016, 11, 13 + i);\n    ms.push(f(dt));\n  }\n  return ms;\n}\nfunction listStuff(loc, length, englishFn, intlFn) {\n  const mode = loc.listingMode();\n  if (mode === \"error\") {\n    return null;\n  } else if (mode === \"en\") {\n    return englishFn(length);\n  } else {\n    return intlFn(length);\n  }\n}\nfunction supportsFastNumbers(loc) {\n  if (loc.numberingSystem && loc.numberingSystem !== \"latn\") {\n    return false;\n  } else {\n    return loc.numberingSystem === \"latn\" || !loc.locale || loc.locale.startsWith(\"en\") || new Intl.DateTimeFormat(loc.intl).resolvedOptions().numberingSystem === \"latn\";\n  }\n}\n\n/**\n * @private\n */\n\nclass PolyNumberFormatter {\n  constructor(intl, forceSimple, opts) {\n    this.padTo = opts.padTo || 0;\n    this.floor = opts.floor || false;\n    const {\n      padTo,\n      floor,\n      ...otherOpts\n    } = opts;\n    if (!forceSimple || Object.keys(otherOpts).length > 0) {\n      const intlOpts = {\n        useGrouping: false,\n        ...opts\n      };\n      if (opts.padTo > 0) intlOpts.minimumIntegerDigits = opts.padTo;\n      this.inf = getCachedINF(intl, intlOpts);\n    }\n  }\n  format(i) {\n    if (this.inf) {\n      const fixed = this.floor ? Math.floor(i) : i;\n      return this.inf.format(fixed);\n    } else {\n      // to match the browser's numberformatter defaults\n      const fixed = this.floor ? Math.floor(i) : roundTo(i, 3);\n      return padStart(fixed, this.padTo);\n    }\n  }\n}\n\n/**\n * @private\n */\n\nclass PolyDateFormatter {\n  constructor(dt, intl, opts) {\n    this.opts = opts;\n    this.originalZone = undefined;\n    let z = undefined;\n    if (this.opts.timeZone) {\n      // Don't apply any workarounds if a timeZone is explicitly provided in opts\n      this.dt = dt;\n    } else if (dt.zone.type === \"fixed\") {\n      // UTC-8 or Etc/UTC-8 are not part of tzdata, only Etc/GMT+8 and the like.\n      // That is why fixed-offset TZ is set to that unless it is:\n      // 1. Representing offset 0 when UTC is used to maintain previous behavior and does not become GMT.\n      // 2. Unsupported by the browser:\n      //    - some do not support Etc/\n      //    - < Etc/GMT-14, > Etc/GMT+12, and 30-minute or 45-minute offsets are not part of tzdata\n      const gmtOffset = -1 * (dt.offset / 60);\n      const offsetZ = gmtOffset >= 0 ? `Etc/GMT+${gmtOffset}` : `Etc/GMT${gmtOffset}`;\n      if (dt.offset !== 0 && IANAZone.create(offsetZ).valid) {\n        z = offsetZ;\n        this.dt = dt;\n      } else {\n        // Not all fixed-offset zones like Etc/+4:30 are present in tzdata so\n        // we manually apply the offset and substitute the zone as needed.\n        z = \"UTC\";\n        this.dt = dt.offset === 0 ? dt : dt.setZone(\"UTC\").plus({\n          minutes: dt.offset\n        });\n        this.originalZone = dt.zone;\n      }\n    } else if (dt.zone.type === \"system\") {\n      this.dt = dt;\n    } else if (dt.zone.type === \"iana\") {\n      this.dt = dt;\n      z = dt.zone.name;\n    } else {\n      // Custom zones can have any offset / offsetName so we just manually\n      // apply the offset and substitute the zone as needed.\n      z = \"UTC\";\n      this.dt = dt.setZone(\"UTC\").plus({\n        minutes: dt.offset\n      });\n      this.originalZone = dt.zone;\n    }\n    const intlOpts = {\n      ...this.opts\n    };\n    intlOpts.timeZone = intlOpts.timeZone || z;\n    this.dtf = getCachedDTF(intl, intlOpts);\n  }\n  format() {\n    if (this.originalZone) {\n      // If we have to substitute in the actual zone name, we have to use\n      // formatToParts so that the timezone can be replaced.\n      return this.formatToParts().map(({\n        value\n      }) => value).join(\"\");\n    }\n    return this.dtf.format(this.dt.toJSDate());\n  }\n  formatToParts() {\n    const parts = this.dtf.formatToParts(this.dt.toJSDate());\n    if (this.originalZone) {\n      return parts.map(part => {\n        if (part.type === \"timeZoneName\") {\n          const offsetName = this.originalZone.offsetName(this.dt.ts, {\n            locale: this.dt.locale,\n            format: this.opts.timeZoneName\n          });\n          return {\n            ...part,\n            value: offsetName\n          };\n        } else {\n          return part;\n        }\n      });\n    }\n    return parts;\n  }\n  resolvedOptions() {\n    return this.dtf.resolvedOptions();\n  }\n}\n\n/**\n * @private\n */\nclass PolyRelFormatter {\n  constructor(intl, isEnglish, opts) {\n    this.opts = {\n      style: \"long\",\n      ...opts\n    };\n    if (!isEnglish && hasRelative()) {\n      this.rtf = getCachedRTF(intl, opts);\n    }\n  }\n  format(count, unit) {\n    if (this.rtf) {\n      return this.rtf.format(count, unit);\n    } else {\n      return formatRelativeTime(unit, count, this.opts.numeric, this.opts.style !== \"long\");\n    }\n  }\n  formatToParts(count, unit) {\n    if (this.rtf) {\n      return this.rtf.formatToParts(count, unit);\n    } else {\n      return [];\n    }\n  }\n}\nconst fallbackWeekSettings = {\n  firstDay: 1,\n  minimalDays: 4,\n  weekend: [6, 7]\n};\n\n/**\n * @private\n */\n\nclass Locale {\n  static fromOpts(opts) {\n    return Locale.create(opts.locale, opts.numberingSystem, opts.outputCalendar, opts.weekSettings, opts.defaultToEN);\n  }\n  static create(locale, numberingSystem, outputCalendar, weekSettings, defaultToEN = false) {\n    const specifiedLocale = locale || Settings.defaultLocale;\n    // the system locale is useful for human readable strings but annoying for parsing/formatting known formats\n    const localeR = specifiedLocale || (defaultToEN ? \"en-US\" : systemLocale());\n    const numberingSystemR = numberingSystem || Settings.defaultNumberingSystem;\n    const outputCalendarR = outputCalendar || Settings.defaultOutputCalendar;\n    const weekSettingsR = validateWeekSettings(weekSettings) || Settings.defaultWeekSettings;\n    return new Locale(localeR, numberingSystemR, outputCalendarR, weekSettingsR, specifiedLocale);\n  }\n  static resetCache() {\n    sysLocaleCache = null;\n    intlDTCache = {};\n    intlNumCache = {};\n    intlRelCache = {};\n  }\n  static fromObject({\n    locale,\n    numberingSystem,\n    outputCalendar,\n    weekSettings\n  } = {}) {\n    return Locale.create(locale, numberingSystem, outputCalendar, weekSettings);\n  }\n  constructor(locale, numbering, outputCalendar, weekSettings, specifiedLocale) {\n    const [parsedLocale, parsedNumberingSystem, parsedOutputCalendar] = parseLocaleString(locale);\n    this.locale = parsedLocale;\n    this.numberingSystem = numbering || parsedNumberingSystem || null;\n    this.outputCalendar = outputCalendar || parsedOutputCalendar || null;\n    this.weekSettings = weekSettings;\n    this.intl = intlConfigString(this.locale, this.numberingSystem, this.outputCalendar);\n    this.weekdaysCache = {\n      format: {},\n      standalone: {}\n    };\n    this.monthsCache = {\n      format: {},\n      standalone: {}\n    };\n    this.meridiemCache = null;\n    this.eraCache = {};\n    this.specifiedLocale = specifiedLocale;\n    this.fastNumbersCached = null;\n  }\n  get fastNumbers() {\n    if (this.fastNumbersCached == null) {\n      this.fastNumbersCached = supportsFastNumbers(this);\n    }\n    return this.fastNumbersCached;\n  }\n  listingMode() {\n    const isActuallyEn = this.isEnglish();\n    const hasNoWeirdness = (this.numberingSystem === null || this.numberingSystem === \"latn\") && (this.outputCalendar === null || this.outputCalendar === \"gregory\");\n    return isActuallyEn && hasNoWeirdness ? \"en\" : \"intl\";\n  }\n  clone(alts) {\n    if (!alts || Object.getOwnPropertyNames(alts).length === 0) {\n      return this;\n    } else {\n      return Locale.create(alts.locale || this.specifiedLocale, alts.numberingSystem || this.numberingSystem, alts.outputCalendar || this.outputCalendar, validateWeekSettings(alts.weekSettings) || this.weekSettings, alts.defaultToEN || false);\n    }\n  }\n  redefaultToEN(alts = {}) {\n    return this.clone({\n      ...alts,\n      defaultToEN: true\n    });\n  }\n  redefaultToSystem(alts = {}) {\n    return this.clone({\n      ...alts,\n      defaultToEN: false\n    });\n  }\n  months(length, format = false) {\n    return listStuff(this, length, months, () => {\n      const intl = format ? {\n          month: length,\n          day: \"numeric\"\n        } : {\n          month: length\n        },\n        formatStr = format ? \"format\" : \"standalone\";\n      if (!this.monthsCache[formatStr][length]) {\n        this.monthsCache[formatStr][length] = mapMonths(dt => this.extract(dt, intl, \"month\"));\n      }\n      return this.monthsCache[formatStr][length];\n    });\n  }\n  weekdays(length, format = false) {\n    return listStuff(this, length, weekdays, () => {\n      const intl = format ? {\n          weekday: length,\n          year: \"numeric\",\n          month: \"long\",\n          day: \"numeric\"\n        } : {\n          weekday: length\n        },\n        formatStr = format ? \"format\" : \"standalone\";\n      if (!this.weekdaysCache[formatStr][length]) {\n        this.weekdaysCache[formatStr][length] = mapWeekdays(dt => this.extract(dt, intl, \"weekday\"));\n      }\n      return this.weekdaysCache[formatStr][length];\n    });\n  }\n  meridiems() {\n    return listStuff(this, undefined, () => meridiems, () => {\n      // In theory there could be aribitrary day periods. We're gonna assume there are exactly two\n      // for AM and PM. This is probably wrong, but it's makes parsing way easier.\n      if (!this.meridiemCache) {\n        const intl = {\n          hour: \"numeric\",\n          hourCycle: \"h12\"\n        };\n        this.meridiemCache = [DateTime.utc(2016, 11, 13, 9), DateTime.utc(2016, 11, 13, 19)].map(dt => this.extract(dt, intl, \"dayperiod\"));\n      }\n      return this.meridiemCache;\n    });\n  }\n  eras(length) {\n    return listStuff(this, length, eras, () => {\n      const intl = {\n        era: length\n      };\n\n      // This is problematic. Different calendars are going to define eras totally differently. What I need is the minimum set of dates\n      // to definitely enumerate them.\n      if (!this.eraCache[length]) {\n        this.eraCache[length] = [DateTime.utc(-40, 1, 1), DateTime.utc(2017, 1, 1)].map(dt => this.extract(dt, intl, \"era\"));\n      }\n      return this.eraCache[length];\n    });\n  }\n  extract(dt, intlOpts, field) {\n    const df = this.dtFormatter(dt, intlOpts),\n      results = df.formatToParts(),\n      matching = results.find(m => m.type.toLowerCase() === field);\n    return matching ? matching.value : null;\n  }\n  numberFormatter(opts = {}) {\n    // this forcesimple option is never used (the only caller short-circuits on it, but it seems safer to leave)\n    // (in contrast, the rest of the condition is used heavily)\n    return new PolyNumberFormatter(this.intl, opts.forceSimple || this.fastNumbers, opts);\n  }\n  dtFormatter(dt, intlOpts = {}) {\n    return new PolyDateFormatter(dt, this.intl, intlOpts);\n  }\n  relFormatter(opts = {}) {\n    return new PolyRelFormatter(this.intl, this.isEnglish(), opts);\n  }\n  listFormatter(opts = {}) {\n    return getCachedLF(this.intl, opts);\n  }\n  isEnglish() {\n    return this.locale === \"en\" || this.locale.toLowerCase() === \"en-us\" || new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith(\"en-us\");\n  }\n  getWeekSettings() {\n    if (this.weekSettings) {\n      return this.weekSettings;\n    } else if (!hasLocaleWeekInfo()) {\n      return fallbackWeekSettings;\n    } else {\n      return getCachedWeekInfo(this.locale);\n    }\n  }\n  getStartOfWeek() {\n    return this.getWeekSettings().firstDay;\n  }\n  getMinDaysInFirstWeek() {\n    return this.getWeekSettings().minimalDays;\n  }\n  getWeekendDays() {\n    return this.getWeekSettings().weekend;\n  }\n  equals(other) {\n    return this.locale === other.locale && this.numberingSystem === other.numberingSystem && this.outputCalendar === other.outputCalendar;\n  }\n}\n\nlet singleton = null;\n\n/**\n * A zone with a fixed offset (meaning no DST)\n * @implements {Zone}\n */\nclass FixedOffsetZone extends Zone {\n  /**\n   * Get a singleton instance of UTC\n   * @return {FixedOffsetZone}\n   */\n  static get utcInstance() {\n    if (singleton === null) {\n      singleton = new FixedOffsetZone(0);\n    }\n    return singleton;\n  }\n\n  /**\n   * Get an instance with a specified offset\n   * @param {number} offset - The offset in minutes\n   * @return {FixedOffsetZone}\n   */\n  static instance(offset) {\n    return offset === 0 ? FixedOffsetZone.utcInstance : new FixedOffsetZone(offset);\n  }\n\n  /**\n   * Get an instance of FixedOffsetZone from a UTC offset string, like \"UTC+6\"\n   * @param {string} s - The offset string to parse\n   * @example FixedOffsetZone.parseSpecifier(\"UTC+6\")\n   * @example FixedOffsetZone.parseSpecifier(\"UTC+06\")\n   * @example FixedOffsetZone.parseSpecifier(\"UTC-6:00\")\n   * @return {FixedOffsetZone}\n   */\n  static parseSpecifier(s) {\n    if (s) {\n      const r = s.match(/^utc(?:([+-]\\d{1,2})(?::(\\d{2}))?)?$/i);\n      if (r) {\n        return new FixedOffsetZone(signedOffset(r[1], r[2]));\n      }\n    }\n    return null;\n  }\n  constructor(offset) {\n    super();\n    /** @private **/\n    this.fixed = offset;\n  }\n\n  /** @override **/\n  get type() {\n    return \"fixed\";\n  }\n\n  /** @override **/\n  get name() {\n    return this.fixed === 0 ? \"UTC\" : `UTC${formatOffset(this.fixed, \"narrow\")}`;\n  }\n  get ianaName() {\n    if (this.fixed === 0) {\n      return \"Etc/UTC\";\n    } else {\n      return `Etc/GMT${formatOffset(-this.fixed, \"narrow\")}`;\n    }\n  }\n\n  /** @override **/\n  offsetName() {\n    return this.name;\n  }\n\n  /** @override **/\n  formatOffset(ts, format) {\n    return formatOffset(this.fixed, format);\n  }\n\n  /** @override **/\n  get isUniversal() {\n    return true;\n  }\n\n  /** @override **/\n  offset() {\n    return this.fixed;\n  }\n\n  /** @override **/\n  equals(otherZone) {\n    return otherZone.type === \"fixed\" && otherZone.fixed === this.fixed;\n  }\n\n  /** @override **/\n  get isValid() {\n    return true;\n  }\n}\n\n/**\n * A zone that failed to parse. You should never need to instantiate this.\n * @implements {Zone}\n */\nclass InvalidZone extends Zone {\n  constructor(zoneName) {\n    super();\n    /**  @private */\n    this.zoneName = zoneName;\n  }\n\n  /** @override **/\n  get type() {\n    return \"invalid\";\n  }\n\n  /** @override **/\n  get name() {\n    return this.zoneName;\n  }\n\n  /** @override **/\n  get isUniversal() {\n    return false;\n  }\n\n  /** @override **/\n  offsetName() {\n    return null;\n  }\n\n  /** @override **/\n  formatOffset() {\n    return \"\";\n  }\n\n  /** @override **/\n  offset() {\n    return NaN;\n  }\n\n  /** @override **/\n  equals() {\n    return false;\n  }\n\n  /** @override **/\n  get isValid() {\n    return false;\n  }\n}\n\n/**\n * @private\n */\nfunction normalizeZone(input, defaultZone) {\n  if (isUndefined(input) || input === null) {\n    return defaultZone;\n  } else if (input instanceof Zone) {\n    return input;\n  } else if (isString(input)) {\n    const lowered = input.toLowerCase();\n    if (lowered === \"default\") return defaultZone;else if (lowered === \"local\" || lowered === \"system\") return SystemZone.instance;else if (lowered === \"utc\" || lowered === \"gmt\") return FixedOffsetZone.utcInstance;else return FixedOffsetZone.parseSpecifier(lowered) || IANAZone.create(input);\n  } else if (isNumber(input)) {\n    return FixedOffsetZone.instance(input);\n  } else if (typeof input === \"object\" && \"offset\" in input && typeof input.offset === \"function\") {\n    // This is dumb, but the instanceof check above doesn't seem to really work\n    // so we're duck checking it\n    return input;\n  } else {\n    return new InvalidZone(input);\n  }\n}\n\nlet now = () => Date.now(),\n  defaultZone = \"system\",\n  defaultLocale = null,\n  defaultNumberingSystem = null,\n  defaultOutputCalendar = null,\n  twoDigitCutoffYear = 60,\n  throwOnInvalid,\n  defaultWeekSettings = null;\n\n/**\n * Settings contains static getters and setters that control Luxon's overall behavior. Luxon is a simple library with few options, but the ones it does have live here.\n */\nclass Settings {\n  /**\n   * Get the callback for returning the current timestamp.\n   * @type {function}\n   */\n  static get now() {\n    return now;\n  }\n\n  /**\n   * Set the callback for returning the current timestamp.\n   * The function should return a number, which will be interpreted as an Epoch millisecond count\n   * @type {function}\n   * @example Settings.now = () => Date.now() + 3000 // pretend it is 3 seconds in the future\n   * @example Settings.now = () => 0 // always pretend it's Jan 1, 1970 at midnight in UTC time\n   */\n  static set now(n) {\n    now = n;\n  }\n\n  /**\n   * Set the default time zone to create DateTimes in. Does not affect existing instances.\n   * Use the value \"system\" to reset this value to the system's time zone.\n   * @type {string}\n   */\n  static set defaultZone(zone) {\n    defaultZone = zone;\n  }\n\n  /**\n   * Get the default time zone object currently used to create DateTimes. Does not affect existing instances.\n   * The default value is the system's time zone (the one set on the machine that runs this code).\n   * @type {Zone}\n   */\n  static get defaultZone() {\n    return normalizeZone(defaultZone, SystemZone.instance);\n  }\n\n  /**\n   * Get the default locale to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static get defaultLocale() {\n    return defaultLocale;\n  }\n\n  /**\n   * Set the default locale to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static set defaultLocale(locale) {\n    defaultLocale = locale;\n  }\n\n  /**\n   * Get the default numbering system to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static get defaultNumberingSystem() {\n    return defaultNumberingSystem;\n  }\n\n  /**\n   * Set the default numbering system to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static set defaultNumberingSystem(numberingSystem) {\n    defaultNumberingSystem = numberingSystem;\n  }\n\n  /**\n   * Get the default output calendar to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static get defaultOutputCalendar() {\n    return defaultOutputCalendar;\n  }\n\n  /**\n   * Set the default output calendar to create DateTimes with. Does not affect existing instances.\n   * @type {string}\n   */\n  static set defaultOutputCalendar(outputCalendar) {\n    defaultOutputCalendar = outputCalendar;\n  }\n\n  /**\n   * @typedef {Object} WeekSettings\n   * @property {number} firstDay\n   * @property {number} minimalDays\n   * @property {number[]} weekend\n   */\n\n  /**\n   * @return {WeekSettings|null}\n   */\n  static get defaultWeekSettings() {\n    return defaultWeekSettings;\n  }\n\n  /**\n   * Allows overriding the default locale week settings, i.e. the start of the week, the weekend and\n   * how many days are required in the first week of a year.\n   * Does not affect existing instances.\n   *\n   * @param {WeekSettings|null} weekSettings\n   */\n  static set defaultWeekSettings(weekSettings) {\n    defaultWeekSettings = validateWeekSettings(weekSettings);\n  }\n\n  /**\n   * Get the cutoff year after which a string encoding a year as two digits is interpreted to occur in the current century.\n   * @type {number}\n   */\n  static get twoDigitCutoffYear() {\n    return twoDigitCutoffYear;\n  }\n\n  /**\n   * Set the cutoff year after which a string encoding a year as two digits is interpreted to occur in the current century.\n   * @type {number}\n   * @example Settings.twoDigitCutoffYear = 0 // cut-off year is 0, so all 'yy' are interpreted as current century\n   * @example Settings.twoDigitCutoffYear = 50 // '49' -> 1949; '50' -> 2050\n   * @example Settings.twoDigitCutoffYear = 1950 // interpreted as 50\n   * @example Settings.twoDigitCutoffYear = 2050 // ALSO interpreted as 50\n   */\n  static set twoDigitCutoffYear(cutoffYear) {\n    twoDigitCutoffYear = cutoffYear % 100;\n  }\n\n  /**\n   * Get whether Luxon will throw when it encounters invalid DateTimes, Durations, or Intervals\n   * @type {boolean}\n   */\n  static get throwOnInvalid() {\n    return throwOnInvalid;\n  }\n\n  /**\n   * Set whether Luxon will throw when it encounters invalid DateTimes, Durations, or Intervals\n   * @type {boolean}\n   */\n  static set throwOnInvalid(t) {\n    throwOnInvalid = t;\n  }\n\n  /**\n   * Reset Luxon's global caches. Should only be necessary in testing scenarios.\n   * @return {void}\n   */\n  static resetCaches() {\n    Locale.resetCache();\n    IANAZone.resetCache();\n  }\n}\n\nclass Invalid {\n  constructor(reason, explanation) {\n    this.reason = reason;\n    this.explanation = explanation;\n  }\n  toMessage() {\n    if (this.explanation) {\n      return `${this.reason}: ${this.explanation}`;\n    } else {\n      return this.reason;\n    }\n  }\n}\n\nconst nonLeapLadder = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334],\n  leapLadder = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];\nfunction unitOutOfRange(unit, value) {\n  return new Invalid(\"unit out of range\", `you specified ${value} (of type ${typeof value}) as a ${unit}, which is invalid`);\n}\nfunction dayOfWeek(year, month, day) {\n  const d = new Date(Date.UTC(year, month - 1, day));\n  if (year < 100 && year >= 0) {\n    d.setUTCFullYear(d.getUTCFullYear() - 1900);\n  }\n  const js = d.getUTCDay();\n  return js === 0 ? 7 : js;\n}\nfunction computeOrdinal(year, month, day) {\n  return day + (isLeapYear(year) ? leapLadder : nonLeapLadder)[month - 1];\n}\nfunction uncomputeOrdinal(year, ordinal) {\n  const table = isLeapYear(year) ? leapLadder : nonLeapLadder,\n    month0 = table.findIndex(i => i < ordinal),\n    day = ordinal - table[month0];\n  return {\n    month: month0 + 1,\n    day\n  };\n}\nfunction isoWeekdayToLocal(isoWeekday, startOfWeek) {\n  return (isoWeekday - startOfWeek + 7) % 7 + 1;\n}\n\n/**\n * @private\n */\n\nfunction gregorianToWeek(gregObj, minDaysInFirstWeek = 4, startOfWeek = 1) {\n  const {\n      year,\n      month,\n      day\n    } = gregObj,\n    ordinal = computeOrdinal(year, month, day),\n    weekday = isoWeekdayToLocal(dayOfWeek(year, month, day), startOfWeek);\n  let weekNumber = Math.floor((ordinal - weekday + 14 - minDaysInFirstWeek) / 7),\n    weekYear;\n  if (weekNumber < 1) {\n    weekYear = year - 1;\n    weekNumber = weeksInWeekYear(weekYear, minDaysInFirstWeek, startOfWeek);\n  } else if (weekNumber > weeksInWeekYear(year, minDaysInFirstWeek, startOfWeek)) {\n    weekYear = year + 1;\n    weekNumber = 1;\n  } else {\n    weekYear = year;\n  }\n  return {\n    weekYear,\n    weekNumber,\n    weekday,\n    ...timeObject(gregObj)\n  };\n}\nfunction weekToGregorian(weekData, minDaysInFirstWeek = 4, startOfWeek = 1) {\n  const {\n      weekYear,\n      weekNumber,\n      weekday\n    } = weekData,\n    weekdayOfJan4 = isoWeekdayToLocal(dayOfWeek(weekYear, 1, minDaysInFirstWeek), startOfWeek),\n    yearInDays = daysInYear(weekYear);\n  let ordinal = weekNumber * 7 + weekday - weekdayOfJan4 - 7 + minDaysInFirstWeek,\n    year;\n  if (ordinal < 1) {\n    year = weekYear - 1;\n    ordinal += daysInYear(year);\n  } else if (ordinal > yearInDays) {\n    year = weekYear + 1;\n    ordinal -= daysInYear(weekYear);\n  } else {\n    year = weekYear;\n  }\n  const {\n    month,\n    day\n  } = uncomputeOrdinal(year, ordinal);\n  return {\n    year,\n    month,\n    day,\n    ...timeObject(weekData)\n  };\n}\nfunction gregorianToOrdinal(gregData) {\n  const {\n    year,\n    month,\n    day\n  } = gregData;\n  const ordinal = computeOrdinal(year, month, day);\n  return {\n    year,\n    ordinal,\n    ...timeObject(gregData)\n  };\n}\nfunction ordinalToGregorian(ordinalData) {\n  const {\n    year,\n    ordinal\n  } = ordinalData;\n  const {\n    month,\n    day\n  } = uncomputeOrdinal(year, ordinal);\n  return {\n    year,\n    month,\n    day,\n    ...timeObject(ordinalData)\n  };\n}\n\n/**\n * Check if local week units like localWeekday are used in obj.\n * If so, validates that they are not mixed with ISO week units and then copies them to the normal week unit properties.\n * Modifies obj in-place!\n * @param obj the object values\n */\nfunction usesLocalWeekValues(obj, loc) {\n  const hasLocaleWeekData = !isUndefined(obj.localWeekday) || !isUndefined(obj.localWeekNumber) || !isUndefined(obj.localWeekYear);\n  if (hasLocaleWeekData) {\n    const hasIsoWeekData = !isUndefined(obj.weekday) || !isUndefined(obj.weekNumber) || !isUndefined(obj.weekYear);\n    if (hasIsoWeekData) {\n      throw new ConflictingSpecificationError(\"Cannot mix locale-based week fields with ISO-based week fields\");\n    }\n    if (!isUndefined(obj.localWeekday)) obj.weekday = obj.localWeekday;\n    if (!isUndefined(obj.localWeekNumber)) obj.weekNumber = obj.localWeekNumber;\n    if (!isUndefined(obj.localWeekYear)) obj.weekYear = obj.localWeekYear;\n    delete obj.localWeekday;\n    delete obj.localWeekNumber;\n    delete obj.localWeekYear;\n    return {\n      minDaysInFirstWeek: loc.getMinDaysInFirstWeek(),\n      startOfWeek: loc.getStartOfWeek()\n    };\n  } else {\n    return {\n      minDaysInFirstWeek: 4,\n      startOfWeek: 1\n    };\n  }\n}\nfunction hasInvalidWeekData(obj, minDaysInFirstWeek = 4, startOfWeek = 1) {\n  const validYear = isInteger(obj.weekYear),\n    validWeek = integerBetween(obj.weekNumber, 1, weeksInWeekYear(obj.weekYear, minDaysInFirstWeek, startOfWeek)),\n    validWeekday = integerBetween(obj.weekday, 1, 7);\n  if (!validYear) {\n    return unitOutOfRange(\"weekYear\", obj.weekYear);\n  } else if (!validWeek) {\n    return unitOutOfRange(\"week\", obj.weekNumber);\n  } else if (!validWeekday) {\n    return unitOutOfRange(\"weekday\", obj.weekday);\n  } else return false;\n}\nfunction hasInvalidOrdinalData(obj) {\n  const validYear = isInteger(obj.year),\n    validOrdinal = integerBetween(obj.ordinal, 1, daysInYear(obj.year));\n  if (!validYear) {\n    return unitOutOfRange(\"year\", obj.year);\n  } else if (!validOrdinal) {\n    return unitOutOfRange(\"ordinal\", obj.ordinal);\n  } else return false;\n}\nfunction hasInvalidGregorianData(obj) {\n  const validYear = isInteger(obj.year),\n    validMonth = integerBetween(obj.month, 1, 12),\n    validDay = integerBetween(obj.day, 1, daysInMonth(obj.year, obj.month));\n  if (!validYear) {\n    return unitOutOfRange(\"year\", obj.year);\n  } else if (!validMonth) {\n    return unitOutOfRange(\"month\", obj.month);\n  } else if (!validDay) {\n    return unitOutOfRange(\"day\", obj.day);\n  } else return false;\n}\nfunction hasInvalidTimeData(obj) {\n  const {\n    hour,\n    minute,\n    second,\n    millisecond\n  } = obj;\n  const validHour = integerBetween(hour, 0, 23) || hour === 24 && minute === 0 && second === 0 && millisecond === 0,\n    validMinute = integerBetween(minute, 0, 59),\n    validSecond = integerBetween(second, 0, 59),\n    validMillisecond = integerBetween(millisecond, 0, 999);\n  if (!validHour) {\n    return unitOutOfRange(\"hour\", hour);\n  } else if (!validMinute) {\n    return unitOutOfRange(\"minute\", minute);\n  } else if (!validSecond) {\n    return unitOutOfRange(\"second\", second);\n  } else if (!validMillisecond) {\n    return unitOutOfRange(\"millisecond\", millisecond);\n  } else return false;\n}\n\n/*\n  This is just a junk drawer, containing anything used across multiple classes.\n  Because Luxon is small(ish), this should stay small and we won't worry about splitting\n  it up into, say, parsingUtil.js and basicUtil.js and so on. But they are divided up by feature area.\n*/\n\n/**\n * @private\n */\n\n// TYPES\n\nfunction isUndefined(o) {\n  return typeof o === \"undefined\";\n}\nfunction isNumber(o) {\n  return typeof o === \"number\";\n}\nfunction isInteger(o) {\n  return typeof o === \"number\" && o % 1 === 0;\n}\nfunction isString(o) {\n  return typeof o === \"string\";\n}\nfunction isDate(o) {\n  return Object.prototype.toString.call(o) === \"[object Date]\";\n}\n\n// CAPABILITIES\n\nfunction hasRelative() {\n  try {\n    return typeof Intl !== \"undefined\" && !!Intl.RelativeTimeFormat;\n  } catch (e) {\n    return false;\n  }\n}\nfunction hasLocaleWeekInfo() {\n  try {\n    return typeof Intl !== \"undefined\" && !!Intl.Locale && (\"weekInfo\" in Intl.Locale.prototype || \"getWeekInfo\" in Intl.Locale.prototype);\n  } catch (e) {\n    return false;\n  }\n}\n\n// OBJECTS AND ARRAYS\n\nfunction maybeArray(thing) {\n  return Array.isArray(thing) ? thing : [thing];\n}\nfunction bestBy(arr, by, compare) {\n  if (arr.length === 0) {\n    return undefined;\n  }\n  return arr.reduce((best, next) => {\n    const pair = [by(next), next];\n    if (!best) {\n      return pair;\n    } else if (compare(best[0], pair[0]) === best[0]) {\n      return best;\n    } else {\n      return pair;\n    }\n  }, null)[1];\n}\nfunction pick(obj, keys) {\n  return keys.reduce((a, k) => {\n    a[k] = obj[k];\n    return a;\n  }, {});\n}\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\nfunction validateWeekSettings(settings) {\n  if (settings == null) {\n    return null;\n  } else if (typeof settings !== \"object\") {\n    throw new InvalidArgumentError(\"Week settings must be an object\");\n  } else {\n    if (!integerBetween(settings.firstDay, 1, 7) || !integerBetween(settings.minimalDays, 1, 7) || !Array.isArray(settings.weekend) || settings.weekend.some(v => !integerBetween(v, 1, 7))) {\n      throw new InvalidArgumentError(\"Invalid week settings\");\n    }\n    return {\n      firstDay: settings.firstDay,\n      minimalDays: settings.minimalDays,\n      weekend: Array.from(settings.weekend)\n    };\n  }\n}\n\n// NUMBERS AND STRINGS\n\nfunction integerBetween(thing, bottom, top) {\n  return isInteger(thing) && thing >= bottom && thing <= top;\n}\n\n// x % n but takes the sign of n instead of x\nfunction floorMod(x, n) {\n  return x - n * Math.floor(x / n);\n}\nfunction padStart(input, n = 2) {\n  const isNeg = input < 0;\n  let padded;\n  if (isNeg) {\n    padded = \"-\" + (\"\" + -input).padStart(n, \"0\");\n  } else {\n    padded = (\"\" + input).padStart(n, \"0\");\n  }\n  return padded;\n}\nfunction parseInteger(string) {\n  if (isUndefined(string) || string === null || string === \"\") {\n    return undefined;\n  } else {\n    return parseInt(string, 10);\n  }\n}\nfunction parseFloating(string) {\n  if (isUndefined(string) || string === null || string === \"\") {\n    return undefined;\n  } else {\n    return parseFloat(string);\n  }\n}\nfunction parseMillis(fraction) {\n  // Return undefined (instead of 0) in these cases, where fraction is not set\n  if (isUndefined(fraction) || fraction === null || fraction === \"\") {\n    return undefined;\n  } else {\n    const f = parseFloat(\"0.\" + fraction) * 1000;\n    return Math.floor(f);\n  }\n}\nfunction roundTo(number, digits, towardZero = false) {\n  const factor = 10 ** digits,\n    rounder = towardZero ? Math.trunc : Math.round;\n  return rounder(number * factor) / factor;\n}\n\n// DATE BASICS\n\nfunction isLeapYear(year) {\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0);\n}\nfunction daysInYear(year) {\n  return isLeapYear(year) ? 366 : 365;\n}\nfunction daysInMonth(year, month) {\n  const modMonth = floorMod(month - 1, 12) + 1,\n    modYear = year + (month - modMonth) / 12;\n  if (modMonth === 2) {\n    return isLeapYear(modYear) ? 29 : 28;\n  } else {\n    return [31, null, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][modMonth - 1];\n  }\n}\n\n// convert a calendar object to a local timestamp (epoch, but with the offset baked in)\nfunction objToLocalTS(obj) {\n  let d = Date.UTC(obj.year, obj.month - 1, obj.day, obj.hour, obj.minute, obj.second, obj.millisecond);\n\n  // for legacy reasons, years between 0 and 99 are interpreted as 19XX; revert that\n  if (obj.year < 100 && obj.year >= 0) {\n    d = new Date(d);\n    // set the month and day again, this is necessary because year 2000 is a leap year, but year 100 is not\n    // so if obj.year is in 99, but obj.day makes it roll over into year 100,\n    // the calculations done by Date.UTC are using year 2000 - which is incorrect\n    d.setUTCFullYear(obj.year, obj.month - 1, obj.day);\n  }\n  return +d;\n}\n\n// adapted from moment.js: https://github.com/moment/moment/blob/000ac1800e620f770f4eb31b5ae908f6167b0ab2/src/lib/units/week-calendar-utils.js\nfunction firstWeekOffset(year, minDaysInFirstWeek, startOfWeek) {\n  const fwdlw = isoWeekdayToLocal(dayOfWeek(year, 1, minDaysInFirstWeek), startOfWeek);\n  return -fwdlw + minDaysInFirstWeek - 1;\n}\nfunction weeksInWeekYear(weekYear, minDaysInFirstWeek = 4, startOfWeek = 1) {\n  const weekOffset = firstWeekOffset(weekYear, minDaysInFirstWeek, startOfWeek);\n  const weekOffsetNext = firstWeekOffset(weekYear + 1, minDaysInFirstWeek, startOfWeek);\n  return (daysInYear(weekYear) - weekOffset + weekOffsetNext) / 7;\n}\nfunction untruncateYear(year) {\n  if (year > 99) {\n    return year;\n  } else return year > Settings.twoDigitCutoffYear ? 1900 + year : 2000 + year;\n}\n\n// PARSING\n\nfunction parseZoneInfo(ts, offsetFormat, locale, timeZone = null) {\n  const date = new Date(ts),\n    intlOpts = {\n      hourCycle: \"h23\",\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    };\n  if (timeZone) {\n    intlOpts.timeZone = timeZone;\n  }\n  const modified = {\n    timeZoneName: offsetFormat,\n    ...intlOpts\n  };\n  const parsed = new Intl.DateTimeFormat(locale, modified).formatToParts(date).find(m => m.type.toLowerCase() === \"timezonename\");\n  return parsed ? parsed.value : null;\n}\n\n// signedOffset('-5', '30') -> -330\nfunction signedOffset(offHourStr, offMinuteStr) {\n  let offHour = parseInt(offHourStr, 10);\n\n  // don't || this because we want to preserve -0\n  if (Number.isNaN(offHour)) {\n    offHour = 0;\n  }\n  const offMin = parseInt(offMinuteStr, 10) || 0,\n    offMinSigned = offHour < 0 || Object.is(offHour, -0) ? -offMin : offMin;\n  return offHour * 60 + offMinSigned;\n}\n\n// COERCION\n\nfunction asNumber(value) {\n  const numericValue = Number(value);\n  if (typeof value === \"boolean\" || value === \"\" || Number.isNaN(numericValue)) throw new InvalidArgumentError(`Invalid unit value ${value}`);\n  return numericValue;\n}\nfunction normalizeObject(obj, normalizer) {\n  const normalized = {};\n  for (const u in obj) {\n    if (hasOwnProperty(obj, u)) {\n      const v = obj[u];\n      if (v === undefined || v === null) continue;\n      normalized[normalizer(u)] = asNumber(v);\n    }\n  }\n  return normalized;\n}\nfunction formatOffset(offset, format) {\n  const hours = Math.trunc(Math.abs(offset / 60)),\n    minutes = Math.trunc(Math.abs(offset % 60)),\n    sign = offset >= 0 ? \"+\" : \"-\";\n  switch (format) {\n    case \"short\":\n      return `${sign}${padStart(hours, 2)}:${padStart(minutes, 2)}`;\n    case \"narrow\":\n      return `${sign}${hours}${minutes > 0 ? `:${minutes}` : \"\"}`;\n    case \"techie\":\n      return `${sign}${padStart(hours, 2)}${padStart(minutes, 2)}`;\n    default:\n      throw new RangeError(`Value format ${format} is out of range for property format`);\n  }\n}\nfunction timeObject(obj) {\n  return pick(obj, [\"hour\", \"minute\", \"second\", \"millisecond\"]);\n}\n\n/**\n * @private\n */\n\nconst monthsLong = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\nconst monthsShort = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\nconst monthsNarrow = [\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"];\nfunction months(length) {\n  switch (length) {\n    case \"narrow\":\n      return [...monthsNarrow];\n    case \"short\":\n      return [...monthsShort];\n    case \"long\":\n      return [...monthsLong];\n    case \"numeric\":\n      return [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\n    case \"2-digit\":\n      return [\"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"12\"];\n    default:\n      return null;\n  }\n}\nconst weekdaysLong = [\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"];\nconst weekdaysShort = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\nconst weekdaysNarrow = [\"M\", \"T\", \"W\", \"T\", \"F\", \"S\", \"S\"];\nfunction weekdays(length) {\n  switch (length) {\n    case \"narrow\":\n      return [...weekdaysNarrow];\n    case \"short\":\n      return [...weekdaysShort];\n    case \"long\":\n      return [...weekdaysLong];\n    case \"numeric\":\n      return [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"];\n    default:\n      return null;\n  }\n}\nconst meridiems = [\"AM\", \"PM\"];\nconst erasLong = [\"Before Christ\", \"Anno Domini\"];\nconst erasShort = [\"BC\", \"AD\"];\nconst erasNarrow = [\"B\", \"A\"];\nfunction eras(length) {\n  switch (length) {\n    case \"narrow\":\n      return [...erasNarrow];\n    case \"short\":\n      return [...erasShort];\n    case \"long\":\n      return [...erasLong];\n    default:\n      return null;\n  }\n}\nfunction meridiemForDateTime(dt) {\n  return meridiems[dt.hour < 12 ? 0 : 1];\n}\nfunction weekdayForDateTime(dt, length) {\n  return weekdays(length)[dt.weekday - 1];\n}\nfunction monthForDateTime(dt, length) {\n  return months(length)[dt.month - 1];\n}\nfunction eraForDateTime(dt, length) {\n  return eras(length)[dt.year < 0 ? 0 : 1];\n}\nfunction formatRelativeTime(unit, count, numeric = \"always\", narrow = false) {\n  const units = {\n    years: [\"year\", \"yr.\"],\n    quarters: [\"quarter\", \"qtr.\"],\n    months: [\"month\", \"mo.\"],\n    weeks: [\"week\", \"wk.\"],\n    days: [\"day\", \"day\", \"days\"],\n    hours: [\"hour\", \"hr.\"],\n    minutes: [\"minute\", \"min.\"],\n    seconds: [\"second\", \"sec.\"]\n  };\n  const lastable = [\"hours\", \"minutes\", \"seconds\"].indexOf(unit) === -1;\n  if (numeric === \"auto\" && lastable) {\n    const isDay = unit === \"days\";\n    switch (count) {\n      case 1:\n        return isDay ? \"tomorrow\" : `next ${units[unit][0]}`;\n      case -1:\n        return isDay ? \"yesterday\" : `last ${units[unit][0]}`;\n      case 0:\n        return isDay ? \"today\" : `this ${units[unit][0]}`;\n    }\n  }\n\n  const isInPast = Object.is(count, -0) || count < 0,\n    fmtValue = Math.abs(count),\n    singular = fmtValue === 1,\n    lilUnits = units[unit],\n    fmtUnit = narrow ? singular ? lilUnits[1] : lilUnits[2] || lilUnits[1] : singular ? units[unit][0] : unit;\n  return isInPast ? `${fmtValue} ${fmtUnit} ago` : `in ${fmtValue} ${fmtUnit}`;\n}\n\nfunction stringifyTokens(splits, tokenToString) {\n  let s = \"\";\n  for (const token of splits) {\n    if (token.literal) {\n      s += token.val;\n    } else {\n      s += tokenToString(token.val);\n    }\n  }\n  return s;\n}\nconst macroTokenToFormatOpts = {\n  D: DATE_SHORT,\n  DD: DATE_MED,\n  DDD: DATE_FULL,\n  DDDD: DATE_HUGE,\n  t: TIME_SIMPLE,\n  tt: TIME_WITH_SECONDS,\n  ttt: TIME_WITH_SHORT_OFFSET,\n  tttt: TIME_WITH_LONG_OFFSET,\n  T: TIME_24_SIMPLE,\n  TT: TIME_24_WITH_SECONDS,\n  TTT: TIME_24_WITH_SHORT_OFFSET,\n  TTTT: TIME_24_WITH_LONG_OFFSET,\n  f: DATETIME_SHORT,\n  ff: DATETIME_MED,\n  fff: DATETIME_FULL,\n  ffff: DATETIME_HUGE,\n  F: DATETIME_SHORT_WITH_SECONDS,\n  FF: DATETIME_MED_WITH_SECONDS,\n  FFF: DATETIME_FULL_WITH_SECONDS,\n  FFFF: DATETIME_HUGE_WITH_SECONDS\n};\n\n/**\n * @private\n */\n\nclass Formatter {\n  static create(locale, opts = {}) {\n    return new Formatter(locale, opts);\n  }\n  static parseFormat(fmt) {\n    // white-space is always considered a literal in user-provided formats\n    // the \" \" token has a special meaning (see unitForToken)\n\n    let current = null,\n      currentFull = \"\",\n      bracketed = false;\n    const splits = [];\n    for (let i = 0; i < fmt.length; i++) {\n      const c = fmt.charAt(i);\n      if (c === \"'\") {\n        if (currentFull.length > 0) {\n          splits.push({\n            literal: bracketed || /^\\s+$/.test(currentFull),\n            val: currentFull\n          });\n        }\n        current = null;\n        currentFull = \"\";\n        bracketed = !bracketed;\n      } else if (bracketed) {\n        currentFull += c;\n      } else if (c === current) {\n        currentFull += c;\n      } else {\n        if (currentFull.length > 0) {\n          splits.push({\n            literal: /^\\s+$/.test(currentFull),\n            val: currentFull\n          });\n        }\n        currentFull = c;\n        current = c;\n      }\n    }\n    if (currentFull.length > 0) {\n      splits.push({\n        literal: bracketed || /^\\s+$/.test(currentFull),\n        val: currentFull\n      });\n    }\n    return splits;\n  }\n  static macroTokenToFormatOpts(token) {\n    return macroTokenToFormatOpts[token];\n  }\n  constructor(locale, formatOpts) {\n    this.opts = formatOpts;\n    this.loc = locale;\n    this.systemLoc = null;\n  }\n  formatWithSystemDefault(dt, opts) {\n    if (this.systemLoc === null) {\n      this.systemLoc = this.loc.redefaultToSystem();\n    }\n    const df = this.systemLoc.dtFormatter(dt, {\n      ...this.opts,\n      ...opts\n    });\n    return df.format();\n  }\n  dtFormatter(dt, opts = {}) {\n    return this.loc.dtFormatter(dt, {\n      ...this.opts,\n      ...opts\n    });\n  }\n  formatDateTime(dt, opts) {\n    return this.dtFormatter(dt, opts).format();\n  }\n  formatDateTimeParts(dt, opts) {\n    return this.dtFormatter(dt, opts).formatToParts();\n  }\n  formatInterval(interval, opts) {\n    const df = this.dtFormatter(interval.start, opts);\n    return df.dtf.formatRange(interval.start.toJSDate(), interval.end.toJSDate());\n  }\n  resolvedOptions(dt, opts) {\n    return this.dtFormatter(dt, opts).resolvedOptions();\n  }\n  num(n, p = 0) {\n    // we get some perf out of doing this here, annoyingly\n    if (this.opts.forceSimple) {\n      return padStart(n, p);\n    }\n    const opts = {\n      ...this.opts\n    };\n    if (p > 0) {\n      opts.padTo = p;\n    }\n    return this.loc.numberFormatter(opts).format(n);\n  }\n  formatDateTimeFromString(dt, fmt) {\n    const knownEnglish = this.loc.listingMode() === \"en\",\n      useDateTimeFormatter = this.loc.outputCalendar && this.loc.outputCalendar !== \"gregory\",\n      string = (opts, extract) => this.loc.extract(dt, opts, extract),\n      formatOffset = opts => {\n        if (dt.isOffsetFixed && dt.offset === 0 && opts.allowZ) {\n          return \"Z\";\n        }\n        return dt.isValid ? dt.zone.formatOffset(dt.ts, opts.format) : \"\";\n      },\n      meridiem = () => knownEnglish ? meridiemForDateTime(dt) : string({\n        hour: \"numeric\",\n        hourCycle: \"h12\"\n      }, \"dayperiod\"),\n      month = (length, standalone) => knownEnglish ? monthForDateTime(dt, length) : string(standalone ? {\n        month: length\n      } : {\n        month: length,\n        day: \"numeric\"\n      }, \"month\"),\n      weekday = (length, standalone) => knownEnglish ? weekdayForDateTime(dt, length) : string(standalone ? {\n        weekday: length\n      } : {\n        weekday: length,\n        month: \"long\",\n        day: \"numeric\"\n      }, \"weekday\"),\n      maybeMacro = token => {\n        const formatOpts = Formatter.macroTokenToFormatOpts(token);\n        if (formatOpts) {\n          return this.formatWithSystemDefault(dt, formatOpts);\n        } else {\n          return token;\n        }\n      },\n      era = length => knownEnglish ? eraForDateTime(dt, length) : string({\n        era: length\n      }, \"era\"),\n      tokenToString = token => {\n        // Where possible: https://cldr.unicode.org/translation/date-time/date-time-symbols\n        switch (token) {\n          // ms\n          case \"S\":\n            return this.num(dt.millisecond);\n          case \"u\":\n          // falls through\n          case \"SSS\":\n            return this.num(dt.millisecond, 3);\n          // seconds\n          case \"s\":\n            return this.num(dt.second);\n          case \"ss\":\n            return this.num(dt.second, 2);\n          // fractional seconds\n          case \"uu\":\n            return this.num(Math.floor(dt.millisecond / 10), 2);\n          case \"uuu\":\n            return this.num(Math.floor(dt.millisecond / 100));\n          // minutes\n          case \"m\":\n            return this.num(dt.minute);\n          case \"mm\":\n            return this.num(dt.minute, 2);\n          // hours\n          case \"h\":\n            return this.num(dt.hour % 12 === 0 ? 12 : dt.hour % 12);\n          case \"hh\":\n            return this.num(dt.hour % 12 === 0 ? 12 : dt.hour % 12, 2);\n          case \"H\":\n            return this.num(dt.hour);\n          case \"HH\":\n            return this.num(dt.hour, 2);\n          // offset\n          case \"Z\":\n            // like +6\n            return formatOffset({\n              format: \"narrow\",\n              allowZ: this.opts.allowZ\n            });\n          case \"ZZ\":\n            // like +06:00\n            return formatOffset({\n              format: \"short\",\n              allowZ: this.opts.allowZ\n            });\n          case \"ZZZ\":\n            // like +0600\n            return formatOffset({\n              format: \"techie\",\n              allowZ: this.opts.allowZ\n            });\n          case \"ZZZZ\":\n            // like EST\n            return dt.zone.offsetName(dt.ts, {\n              format: \"short\",\n              locale: this.loc.locale\n            });\n          case \"ZZZZZ\":\n            // like Eastern Standard Time\n            return dt.zone.offsetName(dt.ts, {\n              format: \"long\",\n              locale: this.loc.locale\n            });\n          // zone\n          case \"z\":\n            // like America/New_York\n            return dt.zoneName;\n          // meridiems\n          case \"a\":\n            return meridiem();\n          // dates\n          case \"d\":\n            return useDateTimeFormatter ? string({\n              day: \"numeric\"\n            }, \"day\") : this.num(dt.day);\n          case \"dd\":\n            return useDateTimeFormatter ? string({\n              day: \"2-digit\"\n            }, \"day\") : this.num(dt.day, 2);\n          // weekdays - standalone\n          case \"c\":\n            // like 1\n            return this.num(dt.weekday);\n          case \"ccc\":\n            // like 'Tues'\n            return weekday(\"short\", true);\n          case \"cccc\":\n            // like 'Tuesday'\n            return weekday(\"long\", true);\n          case \"ccccc\":\n            // like 'T'\n            return weekday(\"narrow\", true);\n          // weekdays - format\n          case \"E\":\n            // like 1\n            return this.num(dt.weekday);\n          case \"EEE\":\n            // like 'Tues'\n            return weekday(\"short\", false);\n          case \"EEEE\":\n            // like 'Tuesday'\n            return weekday(\"long\", false);\n          case \"EEEEE\":\n            // like 'T'\n            return weekday(\"narrow\", false);\n          // months - standalone\n          case \"L\":\n            // like 1\n            return useDateTimeFormatter ? string({\n              month: \"numeric\",\n              day: \"numeric\"\n            }, \"month\") : this.num(dt.month);\n          case \"LL\":\n            // like 01, doesn't seem to work\n            return useDateTimeFormatter ? string({\n              month: \"2-digit\",\n              day: \"numeric\"\n            }, \"month\") : this.num(dt.month, 2);\n          case \"LLL\":\n            // like Jan\n            return month(\"short\", true);\n          case \"LLLL\":\n            // like January\n            return month(\"long\", true);\n          case \"LLLLL\":\n            // like J\n            return month(\"narrow\", true);\n          // months - format\n          case \"M\":\n            // like 1\n            return useDateTimeFormatter ? string({\n              month: \"numeric\"\n            }, \"month\") : this.num(dt.month);\n          case \"MM\":\n            // like 01\n            return useDateTimeFormatter ? string({\n              month: \"2-digit\"\n            }, \"month\") : this.num(dt.month, 2);\n          case \"MMM\":\n            // like Jan\n            return month(\"short\", false);\n          case \"MMMM\":\n            // like January\n            return month(\"long\", false);\n          case \"MMMMM\":\n            // like J\n            return month(\"narrow\", false);\n          // years\n          case \"y\":\n            // like 2014\n            return useDateTimeFormatter ? string({\n              year: \"numeric\"\n            }, \"year\") : this.num(dt.year);\n          case \"yy\":\n            // like 14\n            return useDateTimeFormatter ? string({\n              year: \"2-digit\"\n            }, \"year\") : this.num(dt.year.toString().slice(-2), 2);\n          case \"yyyy\":\n            // like 0012\n            return useDateTimeFormatter ? string({\n              year: \"numeric\"\n            }, \"year\") : this.num(dt.year, 4);\n          case \"yyyyyy\":\n            // like 000012\n            return useDateTimeFormatter ? string({\n              year: \"numeric\"\n            }, \"year\") : this.num(dt.year, 6);\n          // eras\n          case \"G\":\n            // like AD\n            return era(\"short\");\n          case \"GG\":\n            // like Anno Domini\n            return era(\"long\");\n          case \"GGGGG\":\n            return era(\"narrow\");\n          case \"kk\":\n            return this.num(dt.weekYear.toString().slice(-2), 2);\n          case \"kkkk\":\n            return this.num(dt.weekYear, 4);\n          case \"W\":\n            return this.num(dt.weekNumber);\n          case \"WW\":\n            return this.num(dt.weekNumber, 2);\n          case \"n\":\n            return this.num(dt.localWeekNumber);\n          case \"nn\":\n            return this.num(dt.localWeekNumber, 2);\n          case \"ii\":\n            return this.num(dt.localWeekYear.toString().slice(-2), 2);\n          case \"iiii\":\n            return this.num(dt.localWeekYear, 4);\n          case \"o\":\n            return this.num(dt.ordinal);\n          case \"ooo\":\n            return this.num(dt.ordinal, 3);\n          case \"q\":\n            // like 1\n            return this.num(dt.quarter);\n          case \"qq\":\n            // like 01\n            return this.num(dt.quarter, 2);\n          case \"X\":\n            return this.num(Math.floor(dt.ts / 1000));\n          case \"x\":\n            return this.num(dt.ts);\n          default:\n            return maybeMacro(token);\n        }\n      };\n    return stringifyTokens(Formatter.parseFormat(fmt), tokenToString);\n  }\n  formatDurationFromString(dur, fmt) {\n    const tokenToField = token => {\n        switch (token[0]) {\n          case \"S\":\n            return \"millisecond\";\n          case \"s\":\n            return \"second\";\n          case \"m\":\n            return \"minute\";\n          case \"h\":\n            return \"hour\";\n          case \"d\":\n            return \"day\";\n          case \"w\":\n            return \"week\";\n          case \"M\":\n            return \"month\";\n          case \"y\":\n            return \"year\";\n          default:\n            return null;\n        }\n      },\n      tokenToString = lildur => token => {\n        const mapped = tokenToField(token);\n        if (mapped) {\n          return this.num(lildur.get(mapped), token.length);\n        } else {\n          return token;\n        }\n      },\n      tokens = Formatter.parseFormat(fmt),\n      realTokens = tokens.reduce((found, {\n        literal,\n        val\n      }) => literal ? found : found.concat(val), []),\n      collapsed = dur.shiftTo(...realTokens.map(tokenToField).filter(t => t));\n    return stringifyTokens(tokens, tokenToString(collapsed));\n  }\n}\n\n/*\n * This file handles parsing for well-specified formats. Here's how it works:\n * Two things go into parsing: a regex to match with and an extractor to take apart the groups in the match.\n * An extractor is just a function that takes a regex match array and returns a { year: ..., month: ... } object\n * parse() does the work of executing the regex and applying the extractor. It takes multiple regex/extractor pairs to try in sequence.\n * Extractors can take a \"cursor\" representing the offset in the match to look at. This makes it easy to combine extractors.\n * combineExtractors() does the work of combining them, keeping track of the cursor through multiple extractions.\n * Some extractions are super dumb and simpleParse and fromStrings help DRY them.\n */\n\nconst ianaRegex = /[A-Za-z_+-]{1,256}(?::?\\/[A-Za-z0-9_+-]{1,256}(?:\\/[A-Za-z0-9_+-]{1,256})?)?/;\nfunction combineRegexes(...regexes) {\n  const full = regexes.reduce((f, r) => f + r.source, \"\");\n  return RegExp(`^${full}$`);\n}\nfunction combineExtractors(...extractors) {\n  return m => extractors.reduce(([mergedVals, mergedZone, cursor], ex) => {\n    const [val, zone, next] = ex(m, cursor);\n    return [{\n      ...mergedVals,\n      ...val\n    }, zone || mergedZone, next];\n  }, [{}, null, 1]).slice(0, 2);\n}\nfunction parse(s, ...patterns) {\n  if (s == null) {\n    return [null, null];\n  }\n  for (const [regex, extractor] of patterns) {\n    const m = regex.exec(s);\n    if (m) {\n      return extractor(m);\n    }\n  }\n  return [null, null];\n}\nfunction simpleParse(...keys) {\n  return (match, cursor) => {\n    const ret = {};\n    let i;\n    for (i = 0; i < keys.length; i++) {\n      ret[keys[i]] = parseInteger(match[cursor + i]);\n    }\n    return [ret, null, cursor + i];\n  };\n}\n\n// ISO and SQL parsing\nconst offsetRegex = /(?:(Z)|([+-]\\d\\d)(?::?(\\d\\d))?)/;\nconst isoExtendedZone = `(?:${offsetRegex.source}?(?:\\\\[(${ianaRegex.source})\\\\])?)?`;\nconst isoTimeBaseRegex = /(\\d\\d)(?::?(\\d\\d)(?::?(\\d\\d)(?:[.,](\\d{1,30}))?)?)?/;\nconst isoTimeRegex = RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`);\nconst isoTimeExtensionRegex = RegExp(`(?:T${isoTimeRegex.source})?`);\nconst isoYmdRegex = /([+-]\\d{6}|\\d{4})(?:-?(\\d\\d)(?:-?(\\d\\d))?)?/;\nconst isoWeekRegex = /(\\d{4})-?W(\\d\\d)(?:-?(\\d))?/;\nconst isoOrdinalRegex = /(\\d{4})-?(\\d{3})/;\nconst extractISOWeekData = simpleParse(\"weekYear\", \"weekNumber\", \"weekDay\");\nconst extractISOOrdinalData = simpleParse(\"year\", \"ordinal\");\nconst sqlYmdRegex = /(\\d{4})-(\\d\\d)-(\\d\\d)/; // dumbed-down version of the ISO one\nconst sqlTimeRegex = RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`);\nconst sqlTimeExtensionRegex = RegExp(`(?: ${sqlTimeRegex.source})?`);\nfunction int(match, pos, fallback) {\n  const m = match[pos];\n  return isUndefined(m) ? fallback : parseInteger(m);\n}\nfunction extractISOYmd(match, cursor) {\n  const item = {\n    year: int(match, cursor),\n    month: int(match, cursor + 1, 1),\n    day: int(match, cursor + 2, 1)\n  };\n  return [item, null, cursor + 3];\n}\nfunction extractISOTime(match, cursor) {\n  const item = {\n    hours: int(match, cursor, 0),\n    minutes: int(match, cursor + 1, 0),\n    seconds: int(match, cursor + 2, 0),\n    milliseconds: parseMillis(match[cursor + 3])\n  };\n  return [item, null, cursor + 4];\n}\nfunction extractISOOffset(match, cursor) {\n  const local = !match[cursor] && !match[cursor + 1],\n    fullOffset = signedOffset(match[cursor + 1], match[cursor + 2]),\n    zone = local ? null : FixedOffsetZone.instance(fullOffset);\n  return [{}, zone, cursor + 3];\n}\nfunction extractIANAZone(match, cursor) {\n  const zone = match[cursor] ? IANAZone.create(match[cursor]) : null;\n  return [{}, zone, cursor + 1];\n}\n\n// ISO time parsing\n\nconst isoTimeOnly = RegExp(`^T?${isoTimeBaseRegex.source}$`);\n\n// ISO duration parsing\n\nconst isoDuration = /^-?P(?:(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)Y)?(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)M)?(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)W)?(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)D)?(?:T(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)H)?(?:(-?\\d{1,20}(?:\\.\\d{1,20})?)M)?(?:(-?\\d{1,20})(?:[.,](-?\\d{1,20}))?S)?)?)$/;\nfunction extractISODuration(match) {\n  const [s, yearStr, monthStr, weekStr, dayStr, hourStr, minuteStr, secondStr, millisecondsStr] = match;\n  const hasNegativePrefix = s[0] === \"-\";\n  const negativeSeconds = secondStr && secondStr[0] === \"-\";\n  const maybeNegate = (num, force = false) => num !== undefined && (force || num && hasNegativePrefix) ? -num : num;\n  return [{\n    years: maybeNegate(parseFloating(yearStr)),\n    months: maybeNegate(parseFloating(monthStr)),\n    weeks: maybeNegate(parseFloating(weekStr)),\n    days: maybeNegate(parseFloating(dayStr)),\n    hours: maybeNegate(parseFloating(hourStr)),\n    minutes: maybeNegate(parseFloating(minuteStr)),\n    seconds: maybeNegate(parseFloating(secondStr), secondStr === \"-0\"),\n    milliseconds: maybeNegate(parseMillis(millisecondsStr), negativeSeconds)\n  }];\n}\n\n// These are a little braindead. EDT *should* tell us that we're in, say, America/New_York\n// and not just that we're in -240 *right now*. But since I don't think these are used that often\n// I'm just going to ignore that\nconst obsOffsets = {\n  GMT: 0,\n  EDT: -4 * 60,\n  EST: -5 * 60,\n  CDT: -5 * 60,\n  CST: -6 * 60,\n  MDT: -6 * 60,\n  MST: -7 * 60,\n  PDT: -7 * 60,\n  PST: -8 * 60\n};\nfunction fromStrings(weekdayStr, yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr) {\n  const result = {\n    year: yearStr.length === 2 ? untruncateYear(parseInteger(yearStr)) : parseInteger(yearStr),\n    month: monthsShort.indexOf(monthStr) + 1,\n    day: parseInteger(dayStr),\n    hour: parseInteger(hourStr),\n    minute: parseInteger(minuteStr)\n  };\n  if (secondStr) result.second = parseInteger(secondStr);\n  if (weekdayStr) {\n    result.weekday = weekdayStr.length > 3 ? weekdaysLong.indexOf(weekdayStr) + 1 : weekdaysShort.indexOf(weekdayStr) + 1;\n  }\n  return result;\n}\n\n// RFC 2822/5322\nconst rfc2822 = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\\s)?(\\d{1,2})\\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s(\\d{2,4})\\s(\\d\\d):(\\d\\d)(?::(\\d\\d))?\\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\\d\\d)(\\d\\d)))$/;\nfunction extractRFC2822(match) {\n  const [, weekdayStr, dayStr, monthStr, yearStr, hourStr, minuteStr, secondStr, obsOffset, milOffset, offHourStr, offMinuteStr] = match,\n    result = fromStrings(weekdayStr, yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr);\n  let offset;\n  if (obsOffset) {\n    offset = obsOffsets[obsOffset];\n  } else if (milOffset) {\n    offset = 0;\n  } else {\n    offset = signedOffset(offHourStr, offMinuteStr);\n  }\n  return [result, new FixedOffsetZone(offset)];\n}\nfunction preprocessRFC2822(s) {\n  // Remove comments and folding whitespace and replace multiple-spaces with a single space\n  return s.replace(/\\([^()]*\\)|[\\n\\t]/g, \" \").replace(/(\\s\\s+)/g, \" \").trim();\n}\n\n// http date\n\nconst rfc1123 = /^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\\d\\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\\d{4}) (\\d\\d):(\\d\\d):(\\d\\d) GMT$/,\n  rfc850 = /^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\\d\\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\\d\\d) (\\d\\d):(\\d\\d):(\\d\\d) GMT$/,\n  ascii = /^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \\d|\\d\\d) (\\d\\d):(\\d\\d):(\\d\\d) (\\d{4})$/;\nfunction extractRFC1123Or850(match) {\n  const [, weekdayStr, dayStr, monthStr, yearStr, hourStr, minuteStr, secondStr] = match,\n    result = fromStrings(weekdayStr, yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr);\n  return [result, FixedOffsetZone.utcInstance];\n}\nfunction extractASCII(match) {\n  const [, weekdayStr, monthStr, dayStr, hourStr, minuteStr, secondStr, yearStr] = match,\n    result = fromStrings(weekdayStr, yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr);\n  return [result, FixedOffsetZone.utcInstance];\n}\nconst isoYmdWithTimeExtensionRegex = combineRegexes(isoYmdRegex, isoTimeExtensionRegex);\nconst isoWeekWithTimeExtensionRegex = combineRegexes(isoWeekRegex, isoTimeExtensionRegex);\nconst isoOrdinalWithTimeExtensionRegex = combineRegexes(isoOrdinalRegex, isoTimeExtensionRegex);\nconst isoTimeCombinedRegex = combineRegexes(isoTimeRegex);\nconst extractISOYmdTimeAndOffset = combineExtractors(extractISOYmd, extractISOTime, extractISOOffset, extractIANAZone);\nconst extractISOWeekTimeAndOffset = combineExtractors(extractISOWeekData, extractISOTime, extractISOOffset, extractIANAZone);\nconst extractISOOrdinalDateAndTime = combineExtractors(extractISOOrdinalData, extractISOTime, extractISOOffset, extractIANAZone);\nconst extractISOTimeAndOffset = combineExtractors(extractISOTime, extractISOOffset, extractIANAZone);\n\n/*\n * @private\n */\n\nfunction parseISODate(s) {\n  return parse(s, [isoYmdWithTimeExtensionRegex, extractISOYmdTimeAndOffset], [isoWeekWithTimeExtensionRegex, extractISOWeekTimeAndOffset], [isoOrdinalWithTimeExtensionRegex, extractISOOrdinalDateAndTime], [isoTimeCombinedRegex, extractISOTimeAndOffset]);\n}\nfunction parseRFC2822Date(s) {\n  return parse(preprocessRFC2822(s), [rfc2822, extractRFC2822]);\n}\nfunction parseHTTPDate(s) {\n  return parse(s, [rfc1123, extractRFC1123Or850], [rfc850, extractRFC1123Or850], [ascii, extractASCII]);\n}\nfunction parseISODuration(s) {\n  return parse(s, [isoDuration, extractISODuration]);\n}\nconst extractISOTimeOnly = combineExtractors(extractISOTime);\nfunction parseISOTimeOnly(s) {\n  return parse(s, [isoTimeOnly, extractISOTimeOnly]);\n}\nconst sqlYmdWithTimeExtensionRegex = combineRegexes(sqlYmdRegex, sqlTimeExtensionRegex);\nconst sqlTimeCombinedRegex = combineRegexes(sqlTimeRegex);\nconst extractISOTimeOffsetAndIANAZone = combineExtractors(extractISOTime, extractISOOffset, extractIANAZone);\nfunction parseSQL(s) {\n  return parse(s, [sqlYmdWithTimeExtensionRegex, extractISOYmdTimeAndOffset], [sqlTimeCombinedRegex, extractISOTimeOffsetAndIANAZone]);\n}\n\nconst INVALID$2 = \"Invalid Duration\";\n\n// unit conversion constants\nconst lowOrderMatrix = {\n    weeks: {\n      days: 7,\n      hours: 7 * 24,\n      minutes: 7 * 24 * 60,\n      seconds: 7 * 24 * 60 * 60,\n      milliseconds: 7 * 24 * 60 * 60 * 1000\n    },\n    days: {\n      hours: 24,\n      minutes: 24 * 60,\n      seconds: 24 * 60 * 60,\n      milliseconds: 24 * 60 * 60 * 1000\n    },\n    hours: {\n      minutes: 60,\n      seconds: 60 * 60,\n      milliseconds: 60 * 60 * 1000\n    },\n    minutes: {\n      seconds: 60,\n      milliseconds: 60 * 1000\n    },\n    seconds: {\n      milliseconds: 1000\n    }\n  },\n  casualMatrix = {\n    years: {\n      quarters: 4,\n      months: 12,\n      weeks: 52,\n      days: 365,\n      hours: 365 * 24,\n      minutes: 365 * 24 * 60,\n      seconds: 365 * 24 * 60 * 60,\n      milliseconds: 365 * 24 * 60 * 60 * 1000\n    },\n    quarters: {\n      months: 3,\n      weeks: 13,\n      days: 91,\n      hours: 91 * 24,\n      minutes: 91 * 24 * 60,\n      seconds: 91 * 24 * 60 * 60,\n      milliseconds: 91 * 24 * 60 * 60 * 1000\n    },\n    months: {\n      weeks: 4,\n      days: 30,\n      hours: 30 * 24,\n      minutes: 30 * 24 * 60,\n      seconds: 30 * 24 * 60 * 60,\n      milliseconds: 30 * 24 * 60 * 60 * 1000\n    },\n    ...lowOrderMatrix\n  },\n  daysInYearAccurate = 146097.0 / 400,\n  daysInMonthAccurate = 146097.0 / 4800,\n  accurateMatrix = {\n    years: {\n      quarters: 4,\n      months: 12,\n      weeks: daysInYearAccurate / 7,\n      days: daysInYearAccurate,\n      hours: daysInYearAccurate * 24,\n      minutes: daysInYearAccurate * 24 * 60,\n      seconds: daysInYearAccurate * 24 * 60 * 60,\n      milliseconds: daysInYearAccurate * 24 * 60 * 60 * 1000\n    },\n    quarters: {\n      months: 3,\n      weeks: daysInYearAccurate / 28,\n      days: daysInYearAccurate / 4,\n      hours: daysInYearAccurate * 24 / 4,\n      minutes: daysInYearAccurate * 24 * 60 / 4,\n      seconds: daysInYearAccurate * 24 * 60 * 60 / 4,\n      milliseconds: daysInYearAccurate * 24 * 60 * 60 * 1000 / 4\n    },\n    months: {\n      weeks: daysInMonthAccurate / 7,\n      days: daysInMonthAccurate,\n      hours: daysInMonthAccurate * 24,\n      minutes: daysInMonthAccurate * 24 * 60,\n      seconds: daysInMonthAccurate * 24 * 60 * 60,\n      milliseconds: daysInMonthAccurate * 24 * 60 * 60 * 1000\n    },\n    ...lowOrderMatrix\n  };\n\n// units ordered by size\nconst orderedUnits$1 = [\"years\", \"quarters\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\", \"seconds\", \"milliseconds\"];\nconst reverseUnits = orderedUnits$1.slice(0).reverse();\n\n// clone really means \"create another instance just like this one, but with these changes\"\nfunction clone$1(dur, alts, clear = false) {\n  // deep merge for vals\n  const conf = {\n    values: clear ? alts.values : {\n      ...dur.values,\n      ...(alts.values || {})\n    },\n    loc: dur.loc.clone(alts.loc),\n    conversionAccuracy: alts.conversionAccuracy || dur.conversionAccuracy,\n    matrix: alts.matrix || dur.matrix\n  };\n  return new Duration(conf);\n}\nfunction durationToMillis(matrix, vals) {\n  var _vals$milliseconds;\n  let sum = (_vals$milliseconds = vals.milliseconds) != null ? _vals$milliseconds : 0;\n  for (const unit of reverseUnits.slice(1)) {\n    if (vals[unit]) {\n      sum += vals[unit] * matrix[unit][\"milliseconds\"];\n    }\n  }\n  return sum;\n}\n\n// NB: mutates parameters\nfunction normalizeValues(matrix, vals) {\n  // the logic below assumes the overall value of the duration is positive\n  // if this is not the case, factor is used to make it so\n  const factor = durationToMillis(matrix, vals) < 0 ? -1 : 1;\n  orderedUnits$1.reduceRight((previous, current) => {\n    if (!isUndefined(vals[current])) {\n      if (previous) {\n        const previousVal = vals[previous] * factor;\n        const conv = matrix[current][previous];\n\n        // if (previousVal < 0):\n        // lower order unit is negative (e.g. { years: 2, days: -2 })\n        // normalize this by reducing the higher order unit by the appropriate amount\n        // and increasing the lower order unit\n        // this can never make the higher order unit negative, because this function only operates\n        // on positive durations, so the amount of time represented by the lower order unit cannot\n        // be larger than the higher order unit\n        // else:\n        // lower order unit is positive (e.g. { years: 2, days: 450 } or { years: -2, days: 450 })\n        // in this case we attempt to convert as much as possible from the lower order unit into\n        // the higher order one\n        //\n        // Math.floor takes care of both of these cases, rounding away from 0\n        // if previousVal < 0 it makes the absolute value larger\n        // if previousVal >= it makes the absolute value smaller\n        const rollUp = Math.floor(previousVal / conv);\n        vals[current] += rollUp * factor;\n        vals[previous] -= rollUp * conv * factor;\n      }\n      return current;\n    } else {\n      return previous;\n    }\n  }, null);\n\n  // try to convert any decimals into smaller units if possible\n  // for example for { years: 2.5, days: 0, seconds: 0 } we want to get { years: 2, days: 182, hours: 12 }\n  orderedUnits$1.reduce((previous, current) => {\n    if (!isUndefined(vals[current])) {\n      if (previous) {\n        const fraction = vals[previous] % 1;\n        vals[previous] -= fraction;\n        vals[current] += fraction * matrix[previous][current];\n      }\n      return current;\n    } else {\n      return previous;\n    }\n  }, null);\n}\n\n// Remove all properties with a value of 0 from an object\nfunction removeZeroes(vals) {\n  const newVals = {};\n  for (const [key, value] of Object.entries(vals)) {\n    if (value !== 0) {\n      newVals[key] = value;\n    }\n  }\n  return newVals;\n}\n\n/**\n * A Duration object represents a period of time, like \"2 months\" or \"1 day, 1 hour\". Conceptually, it's just a map of units to their quantities, accompanied by some additional configuration and methods for creating, parsing, interrogating, transforming, and formatting them. They can be used on their own or in conjunction with other Luxon types; for example, you can use {@link DateTime#plus} to add a Duration object to a DateTime, producing another DateTime.\n *\n * Here is a brief overview of commonly used methods and getters in Duration:\n *\n * * **Creation** To create a Duration, use {@link Duration.fromMillis}, {@link Duration.fromObject}, or {@link Duration.fromISO}.\n * * **Unit values** See the {@link Duration#years}, {@link Duration#months}, {@link Duration#weeks}, {@link Duration#days}, {@link Duration#hours}, {@link Duration#minutes}, {@link Duration#seconds}, {@link Duration#milliseconds} accessors.\n * * **Configuration** See  {@link Duration#locale} and {@link Duration#numberingSystem} accessors.\n * * **Transformation** To create new Durations out of old ones use {@link Duration#plus}, {@link Duration#minus}, {@link Duration#normalize}, {@link Duration#set}, {@link Duration#reconfigure}, {@link Duration#shiftTo}, and {@link Duration#negate}.\n * * **Output** To convert the Duration into other representations, see {@link Duration#as}, {@link Duration#toISO}, {@link Duration#toFormat}, and {@link Duration#toJSON}\n *\n * There's are more methods documented below. In addition, for more information on subtler topics like internationalization and validity, see the external documentation.\n */\nclass Duration {\n  /**\n   * @private\n   */\n  constructor(config) {\n    const accurate = config.conversionAccuracy === \"longterm\" || false;\n    let matrix = accurate ? accurateMatrix : casualMatrix;\n    if (config.matrix) {\n      matrix = config.matrix;\n    }\n\n    /**\n     * @access private\n     */\n    this.values = config.values;\n    /**\n     * @access private\n     */\n    this.loc = config.loc || Locale.create();\n    /**\n     * @access private\n     */\n    this.conversionAccuracy = accurate ? \"longterm\" : \"casual\";\n    /**\n     * @access private\n     */\n    this.invalid = config.invalid || null;\n    /**\n     * @access private\n     */\n    this.matrix = matrix;\n    /**\n     * @access private\n     */\n    this.isLuxonDuration = true;\n  }\n\n  /**\n   * Create Duration from a number of milliseconds.\n   * @param {number} count of milliseconds\n   * @param {Object} opts - options for parsing\n   * @param {string} [opts.locale='en-US'] - the locale to use\n   * @param {string} opts.numberingSystem - the numbering system to use\n   * @param {string} [opts.conversionAccuracy='casual'] - the conversion system to use\n   * @return {Duration}\n   */\n  static fromMillis(count, opts) {\n    return Duration.fromObject({\n      milliseconds: count\n    }, opts);\n  }\n\n  /**\n   * Create a Duration from a JavaScript object with keys like 'years' and 'hours'.\n   * If this object is empty then a zero milliseconds duration is returned.\n   * @param {Object} obj - the object to create the DateTime from\n   * @param {number} obj.years\n   * @param {number} obj.quarters\n   * @param {number} obj.months\n   * @param {number} obj.weeks\n   * @param {number} obj.days\n   * @param {number} obj.hours\n   * @param {number} obj.minutes\n   * @param {number} obj.seconds\n   * @param {number} obj.milliseconds\n   * @param {Object} [opts=[]] - options for creating this Duration\n   * @param {string} [opts.locale='en-US'] - the locale to use\n   * @param {string} opts.numberingSystem - the numbering system to use\n   * @param {string} [opts.conversionAccuracy='casual'] - the preset conversion system to use\n   * @param {string} [opts.matrix=Object] - the custom conversion system to use\n   * @return {Duration}\n   */\n  static fromObject(obj, opts = {}) {\n    if (obj == null || typeof obj !== \"object\") {\n      throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${obj === null ? \"null\" : typeof obj}`);\n    }\n    return new Duration({\n      values: normalizeObject(obj, Duration.normalizeUnit),\n      loc: Locale.fromObject(opts),\n      conversionAccuracy: opts.conversionAccuracy,\n      matrix: opts.matrix\n    });\n  }\n\n  /**\n   * Create a Duration from DurationLike.\n   *\n   * @param {Object | number | Duration} durationLike\n   * One of:\n   * - object with keys like 'years' and 'hours'.\n   * - number representing milliseconds\n   * - Duration instance\n   * @return {Duration}\n   */\n  static fromDurationLike(durationLike) {\n    if (isNumber(durationLike)) {\n      return Duration.fromMillis(durationLike);\n    } else if (Duration.isDuration(durationLike)) {\n      return durationLike;\n    } else if (typeof durationLike === \"object\") {\n      return Duration.fromObject(durationLike);\n    } else {\n      throw new InvalidArgumentError(`Unknown duration argument ${durationLike} of type ${typeof durationLike}`);\n    }\n  }\n\n  /**\n   * Create a Duration from an ISO 8601 duration string.\n   * @param {string} text - text to parse\n   * @param {Object} opts - options for parsing\n   * @param {string} [opts.locale='en-US'] - the locale to use\n   * @param {string} opts.numberingSystem - the numbering system to use\n   * @param {string} [opts.conversionAccuracy='casual'] - the preset conversion system to use\n   * @param {string} [opts.matrix=Object] - the preset conversion system to use\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Durations\n   * @example Duration.fromISO('P3Y6M1W4DT12H30M5S').toObject() //=> { years: 3, months: 6, weeks: 1, days: 4, hours: 12, minutes: 30, seconds: 5 }\n   * @example Duration.fromISO('PT23H').toObject() //=> { hours: 23 }\n   * @example Duration.fromISO('P5Y3M').toObject() //=> { years: 5, months: 3 }\n   * @return {Duration}\n   */\n  static fromISO(text, opts) {\n    const [parsed] = parseISODuration(text);\n    if (parsed) {\n      return Duration.fromObject(parsed, opts);\n    } else {\n      return Duration.invalid(\"unparsable\", `the input \"${text}\" can't be parsed as ISO 8601`);\n    }\n  }\n\n  /**\n   * Create a Duration from an ISO 8601 time string.\n   * @param {string} text - text to parse\n   * @param {Object} opts - options for parsing\n   * @param {string} [opts.locale='en-US'] - the locale to use\n   * @param {string} opts.numberingSystem - the numbering system to use\n   * @param {string} [opts.conversionAccuracy='casual'] - the preset conversion system to use\n   * @param {string} [opts.matrix=Object] - the conversion system to use\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Times\n   * @example Duration.fromISOTime('11:22:33.444').toObject() //=> { hours: 11, minutes: 22, seconds: 33, milliseconds: 444 }\n   * @example Duration.fromISOTime('11:00').toObject() //=> { hours: 11, minutes: 0, seconds: 0 }\n   * @example Duration.fromISOTime('T11:00').toObject() //=> { hours: 11, minutes: 0, seconds: 0 }\n   * @example Duration.fromISOTime('1100').toObject() //=> { hours: 11, minutes: 0, seconds: 0 }\n   * @example Duration.fromISOTime('T1100').toObject() //=> { hours: 11, minutes: 0, seconds: 0 }\n   * @return {Duration}\n   */\n  static fromISOTime(text, opts) {\n    const [parsed] = parseISOTimeOnly(text);\n    if (parsed) {\n      return Duration.fromObject(parsed, opts);\n    } else {\n      return Duration.invalid(\"unparsable\", `the input \"${text}\" can't be parsed as ISO 8601`);\n    }\n  }\n\n  /**\n   * Create an invalid Duration.\n   * @param {string} reason - simple string of why this datetime is invalid. Should not contain parameters or anything else data-dependent\n   * @param {string} [explanation=null] - longer explanation, may include parameters and other useful debugging information\n   * @return {Duration}\n   */\n  static invalid(reason, explanation = null) {\n    if (!reason) {\n      throw new InvalidArgumentError(\"need to specify a reason the Duration is invalid\");\n    }\n    const invalid = reason instanceof Invalid ? reason : new Invalid(reason, explanation);\n    if (Settings.throwOnInvalid) {\n      throw new InvalidDurationError(invalid);\n    } else {\n      return new Duration({\n        invalid\n      });\n    }\n  }\n\n  /**\n   * @private\n   */\n  static normalizeUnit(unit) {\n    const normalized = {\n      year: \"years\",\n      years: \"years\",\n      quarter: \"quarters\",\n      quarters: \"quarters\",\n      month: \"months\",\n      months: \"months\",\n      week: \"weeks\",\n      weeks: \"weeks\",\n      day: \"days\",\n      days: \"days\",\n      hour: \"hours\",\n      hours: \"hours\",\n      minute: \"minutes\",\n      minutes: \"minutes\",\n      second: \"seconds\",\n      seconds: \"seconds\",\n      millisecond: \"milliseconds\",\n      milliseconds: \"milliseconds\"\n    }[unit ? unit.toLowerCase() : unit];\n    if (!normalized) throw new InvalidUnitError(unit);\n    return normalized;\n  }\n\n  /**\n   * Check if an object is a Duration. Works across context boundaries\n   * @param {object} o\n   * @return {boolean}\n   */\n  static isDuration(o) {\n    return o && o.isLuxonDuration || false;\n  }\n\n  /**\n   * Get  the locale of a Duration, such 'en-GB'\n   * @type {string}\n   */\n  get locale() {\n    return this.isValid ? this.loc.locale : null;\n  }\n\n  /**\n   * Get the numbering system of a Duration, such 'beng'. The numbering system is used when formatting the Duration\n   *\n   * @type {string}\n   */\n  get numberingSystem() {\n    return this.isValid ? this.loc.numberingSystem : null;\n  }\n\n  /**\n   * Returns a string representation of this Duration formatted according to the specified format string. You may use these tokens:\n   * * `S` for milliseconds\n   * * `s` for seconds\n   * * `m` for minutes\n   * * `h` for hours\n   * * `d` for days\n   * * `w` for weeks\n   * * `M` for months\n   * * `y` for years\n   * Notes:\n   * * Add padding by repeating the token, e.g. \"yy\" pads the years to two digits, \"hhhh\" pads the hours out to four digits\n   * * Tokens can be escaped by wrapping with single quotes.\n   * * The duration will be converted to the set of units in the format string using {@link Duration#shiftTo} and the Durations's conversion accuracy setting.\n   * @param {string} fmt - the format string\n   * @param {Object} opts - options\n   * @param {boolean} [opts.floor=true] - floor numerical values\n   * @example Duration.fromObject({ years: 1, days: 6, seconds: 2 }).toFormat(\"y d s\") //=> \"1 6 2\"\n   * @example Duration.fromObject({ years: 1, days: 6, seconds: 2 }).toFormat(\"yy dd sss\") //=> \"01 06 002\"\n   * @example Duration.fromObject({ years: 1, days: 6, seconds: 2 }).toFormat(\"M S\") //=> \"12 518402000\"\n   * @return {string}\n   */\n  toFormat(fmt, opts = {}) {\n    // reverse-compat since 1.2; we always round down now, never up, and we do it by default\n    const fmtOpts = {\n      ...opts,\n      floor: opts.round !== false && opts.floor !== false\n    };\n    return this.isValid ? Formatter.create(this.loc, fmtOpts).formatDurationFromString(this, fmt) : INVALID$2;\n  }\n\n  /**\n   * Returns a string representation of a Duration with all units included.\n   * To modify its behavior, use `listStyle` and any Intl.NumberFormat option, though `unitDisplay` is especially relevant.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\n   * @param {Object} opts - Formatting options. Accepts the same keys as the options parameter of the native `Intl.NumberFormat` constructor, as well as `listStyle`.\n   * @param {string} [opts.listStyle='narrow'] - How to format the merged list. Corresponds to the `style` property of the options parameter of the native `Intl.ListFormat` constructor.\n   * @example\n   * ```js\n   * var dur = Duration.fromObject({ days: 1, hours: 5, minutes: 6 })\n   * dur.toHuman() //=> '1 day, 5 hours, 6 minutes'\n   * dur.toHuman({ listStyle: \"long\" }) //=> '1 day, 5 hours, and 6 minutes'\n   * dur.toHuman({ unitDisplay: \"short\" }) //=> '1 day, 5 hr, 6 min'\n   * ```\n   */\n  toHuman(opts = {}) {\n    if (!this.isValid) return INVALID$2;\n    const l = orderedUnits$1.map(unit => {\n      const val = this.values[unit];\n      if (isUndefined(val)) {\n        return null;\n      }\n      return this.loc.numberFormatter({\n        style: \"unit\",\n        unitDisplay: \"long\",\n        ...opts,\n        unit: unit.slice(0, -1)\n      }).format(val);\n    }).filter(n => n);\n    return this.loc.listFormatter({\n      type: \"conjunction\",\n      style: opts.listStyle || \"narrow\",\n      ...opts\n    }).format(l);\n  }\n\n  /**\n   * Returns a JavaScript object with this Duration's values.\n   * @example Duration.fromObject({ years: 1, days: 6, seconds: 2 }).toObject() //=> { years: 1, days: 6, seconds: 2 }\n   * @return {Object}\n   */\n  toObject() {\n    if (!this.isValid) return {};\n    return {\n      ...this.values\n    };\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this Duration.\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Durations\n   * @example Duration.fromObject({ years: 3, seconds: 45 }).toISO() //=> 'P3YT45S'\n   * @example Duration.fromObject({ months: 4, seconds: 45 }).toISO() //=> 'P4MT45S'\n   * @example Duration.fromObject({ months: 5 }).toISO() //=> 'P5M'\n   * @example Duration.fromObject({ minutes: 5 }).toISO() //=> 'PT5M'\n   * @example Duration.fromObject({ milliseconds: 6 }).toISO() //=> 'PT0.006S'\n   * @return {string}\n   */\n  toISO() {\n    // we could use the formatter, but this is an easier way to get the minimum string\n    if (!this.isValid) return null;\n    let s = \"P\";\n    if (this.years !== 0) s += this.years + \"Y\";\n    if (this.months !== 0 || this.quarters !== 0) s += this.months + this.quarters * 3 + \"M\";\n    if (this.weeks !== 0) s += this.weeks + \"W\";\n    if (this.days !== 0) s += this.days + \"D\";\n    if (this.hours !== 0 || this.minutes !== 0 || this.seconds !== 0 || this.milliseconds !== 0) s += \"T\";\n    if (this.hours !== 0) s += this.hours + \"H\";\n    if (this.minutes !== 0) s += this.minutes + \"M\";\n    if (this.seconds !== 0 || this.milliseconds !== 0)\n      // this will handle \"floating point madness\" by removing extra decimal places\n      // https://stackoverflow.com/questions/588004/is-floating-point-math-broken\n      s += roundTo(this.seconds + this.milliseconds / 1000, 3) + \"S\";\n    if (s === \"P\") s += \"T0S\";\n    return s;\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this Duration, formatted as a time of day.\n   * Note that this will return null if the duration is invalid, negative, or equal to or greater than 24 hours.\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Times\n   * @param {Object} opts - options\n   * @param {boolean} [opts.suppressMilliseconds=false] - exclude milliseconds from the format if they're 0\n   * @param {boolean} [opts.suppressSeconds=false] - exclude seconds from the format if they're 0\n   * @param {boolean} [opts.includePrefix=false] - include the `T` prefix\n   * @param {string} [opts.format='extended'] - choose between the basic and extended format\n   * @example Duration.fromObject({ hours: 11 }).toISOTime() //=> '11:00:00.000'\n   * @example Duration.fromObject({ hours: 11 }).toISOTime({ suppressMilliseconds: true }) //=> '11:00:00'\n   * @example Duration.fromObject({ hours: 11 }).toISOTime({ suppressSeconds: true }) //=> '11:00'\n   * @example Duration.fromObject({ hours: 11 }).toISOTime({ includePrefix: true }) //=> 'T11:00:00.000'\n   * @example Duration.fromObject({ hours: 11 }).toISOTime({ format: 'basic' }) //=> '110000.000'\n   * @return {string}\n   */\n  toISOTime(opts = {}) {\n    if (!this.isValid) return null;\n    const millis = this.toMillis();\n    if (millis < 0 || millis >= 86400000) return null;\n    opts = {\n      suppressMilliseconds: false,\n      suppressSeconds: false,\n      includePrefix: false,\n      format: \"extended\",\n      ...opts,\n      includeOffset: false\n    };\n    const dateTime = DateTime.fromMillis(millis, {\n      zone: \"UTC\"\n    });\n    return dateTime.toISOTime(opts);\n  }\n\n  /**\n   * Returns an ISO 8601 representation of this Duration appropriate for use in JSON.\n   * @return {string}\n   */\n  toJSON() {\n    return this.toISO();\n  }\n\n  /**\n   * Returns an ISO 8601 representation of this Duration appropriate for use in debugging.\n   * @return {string}\n   */\n  toString() {\n    return this.toISO();\n  }\n\n  /**\n   * Returns a string representation of this Duration appropriate for the REPL.\n   * @return {string}\n   */\n  [Symbol.for(\"nodejs.util.inspect.custom\")]() {\n    if (this.isValid) {\n      return `Duration { values: ${JSON.stringify(this.values)} }`;\n    } else {\n      return `Duration { Invalid, reason: ${this.invalidReason} }`;\n    }\n  }\n\n  /**\n   * Returns an milliseconds value of this Duration.\n   * @return {number}\n   */\n  toMillis() {\n    if (!this.isValid) return NaN;\n    return durationToMillis(this.matrix, this.values);\n  }\n\n  /**\n   * Returns an milliseconds value of this Duration. Alias of {@link toMillis}\n   * @return {number}\n   */\n  valueOf() {\n    return this.toMillis();\n  }\n\n  /**\n   * Make this Duration longer by the specified amount. Return a newly-constructed Duration.\n   * @param {Duration|Object|number} duration - The amount to add. Either a Luxon Duration, a number of milliseconds, the object argument to Duration.fromObject()\n   * @return {Duration}\n   */\n  plus(duration) {\n    if (!this.isValid) return this;\n    const dur = Duration.fromDurationLike(duration),\n      result = {};\n    for (const k of orderedUnits$1) {\n      if (hasOwnProperty(dur.values, k) || hasOwnProperty(this.values, k)) {\n        result[k] = dur.get(k) + this.get(k);\n      }\n    }\n    return clone$1(this, {\n      values: result\n    }, true);\n  }\n\n  /**\n   * Make this Duration shorter by the specified amount. Return a newly-constructed Duration.\n   * @param {Duration|Object|number} duration - The amount to subtract. Either a Luxon Duration, a number of milliseconds, the object argument to Duration.fromObject()\n   * @return {Duration}\n   */\n  minus(duration) {\n    if (!this.isValid) return this;\n    const dur = Duration.fromDurationLike(duration);\n    return this.plus(dur.negate());\n  }\n\n  /**\n   * Scale this Duration by the specified amount. Return a newly-constructed Duration.\n   * @param {function} fn - The function to apply to each unit. Arity is 1 or 2: the value of the unit and, optionally, the unit name. Must return a number.\n   * @example Duration.fromObject({ hours: 1, minutes: 30 }).mapUnits(x => x * 2) //=> { hours: 2, minutes: 60 }\n   * @example Duration.fromObject({ hours: 1, minutes: 30 }).mapUnits((x, u) => u === \"hours\" ? x * 2 : x) //=> { hours: 2, minutes: 30 }\n   * @return {Duration}\n   */\n  mapUnits(fn) {\n    if (!this.isValid) return this;\n    const result = {};\n    for (const k of Object.keys(this.values)) {\n      result[k] = asNumber(fn(this.values[k], k));\n    }\n    return clone$1(this, {\n      values: result\n    }, true);\n  }\n\n  /**\n   * Get the value of unit.\n   * @param {string} unit - a unit such as 'minute' or 'day'\n   * @example Duration.fromObject({years: 2, days: 3}).get('years') //=> 2\n   * @example Duration.fromObject({years: 2, days: 3}).get('months') //=> 0\n   * @example Duration.fromObject({years: 2, days: 3}).get('days') //=> 3\n   * @return {number}\n   */\n  get(unit) {\n    return this[Duration.normalizeUnit(unit)];\n  }\n\n  /**\n   * \"Set\" the values of specified units. Return a newly-constructed Duration.\n   * @param {Object} values - a mapping of units to numbers\n   * @example dur.set({ years: 2017 })\n   * @example dur.set({ hours: 8, minutes: 30 })\n   * @return {Duration}\n   */\n  set(values) {\n    if (!this.isValid) return this;\n    const mixed = {\n      ...this.values,\n      ...normalizeObject(values, Duration.normalizeUnit)\n    };\n    return clone$1(this, {\n      values: mixed\n    });\n  }\n\n  /**\n   * \"Set\" the locale and/or numberingSystem.  Returns a newly-constructed Duration.\n   * @example dur.reconfigure({ locale: 'en-GB' })\n   * @return {Duration}\n   */\n  reconfigure({\n    locale,\n    numberingSystem,\n    conversionAccuracy,\n    matrix\n  } = {}) {\n    const loc = this.loc.clone({\n      locale,\n      numberingSystem\n    });\n    const opts = {\n      loc,\n      matrix,\n      conversionAccuracy\n    };\n    return clone$1(this, opts);\n  }\n\n  /**\n   * Return the length of the duration in the specified unit.\n   * @param {string} unit - a unit such as 'minutes' or 'days'\n   * @example Duration.fromObject({years: 1}).as('days') //=> 365\n   * @example Duration.fromObject({years: 1}).as('months') //=> 12\n   * @example Duration.fromObject({hours: 60}).as('days') //=> 2.5\n   * @return {number}\n   */\n  as(unit) {\n    return this.isValid ? this.shiftTo(unit).get(unit) : NaN;\n  }\n\n  /**\n   * Reduce this Duration to its canonical representation in its current units.\n   * Assuming the overall value of the Duration is positive, this means:\n   * - excessive values for lower-order units are converted to higher-order units (if possible, see first and second example)\n   * - negative lower-order units are converted to higher order units (there must be such a higher order unit, otherwise\n   *   the overall value would be negative, see third example)\n   * - fractional values for higher-order units are converted to lower-order units (if possible, see fourth example)\n   *\n   * If the overall value is negative, the result of this method is equivalent to `this.negate().normalize().negate()`.\n   * @example Duration.fromObject({ years: 2, days: 5000 }).normalize().toObject() //=> { years: 15, days: 255 }\n   * @example Duration.fromObject({ days: 5000 }).normalize().toObject() //=> { days: 5000 }\n   * @example Duration.fromObject({ hours: 12, minutes: -45 }).normalize().toObject() //=> { hours: 11, minutes: 15 }\n   * @example Duration.fromObject({ years: 2.5, days: 0, hours: 0 }).normalize().toObject() //=> { years: 2, days: 182, hours: 12 }\n   * @return {Duration}\n   */\n  normalize() {\n    if (!this.isValid) return this;\n    const vals = this.toObject();\n    normalizeValues(this.matrix, vals);\n    return clone$1(this, {\n      values: vals\n    }, true);\n  }\n\n  /**\n   * Rescale units to its largest representation\n   * @example Duration.fromObject({ milliseconds: 90000 }).rescale().toObject() //=> { minutes: 1, seconds: 30 }\n   * @return {Duration}\n   */\n  rescale() {\n    if (!this.isValid) return this;\n    const vals = removeZeroes(this.normalize().shiftToAll().toObject());\n    return clone$1(this, {\n      values: vals\n    }, true);\n  }\n\n  /**\n   * Convert this Duration into its representation in a different set of units.\n   * @example Duration.fromObject({ hours: 1, seconds: 30 }).shiftTo('minutes', 'milliseconds').toObject() //=> { minutes: 60, milliseconds: 30000 }\n   * @return {Duration}\n   */\n  shiftTo(...units) {\n    if (!this.isValid) return this;\n    if (units.length === 0) {\n      return this;\n    }\n    units = units.map(u => Duration.normalizeUnit(u));\n    const built = {},\n      accumulated = {},\n      vals = this.toObject();\n    let lastUnit;\n    for (const k of orderedUnits$1) {\n      if (units.indexOf(k) >= 0) {\n        lastUnit = k;\n        let own = 0;\n\n        // anything we haven't boiled down yet should get boiled to this unit\n        for (const ak in accumulated) {\n          own += this.matrix[ak][k] * accumulated[ak];\n          accumulated[ak] = 0;\n        }\n\n        // plus anything that's already in this unit\n        if (isNumber(vals[k])) {\n          own += vals[k];\n        }\n\n        // only keep the integer part for now in the hopes of putting any decimal part\n        // into a smaller unit later\n        const i = Math.trunc(own);\n        built[k] = i;\n        accumulated[k] = (own * 1000 - i * 1000) / 1000;\n\n        // otherwise, keep it in the wings to boil it later\n      } else if (isNumber(vals[k])) {\n        accumulated[k] = vals[k];\n      }\n    }\n\n    // anything leftover becomes the decimal for the last unit\n    // lastUnit must be defined since units is not empty\n    for (const key in accumulated) {\n      if (accumulated[key] !== 0) {\n        built[lastUnit] += key === lastUnit ? accumulated[key] : accumulated[key] / this.matrix[lastUnit][key];\n      }\n    }\n    normalizeValues(this.matrix, built);\n    return clone$1(this, {\n      values: built\n    }, true);\n  }\n\n  /**\n   * Shift this Duration to all available units.\n   * Same as shiftTo(\"years\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\", \"seconds\", \"milliseconds\")\n   * @return {Duration}\n   */\n  shiftToAll() {\n    if (!this.isValid) return this;\n    return this.shiftTo(\"years\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\", \"seconds\", \"milliseconds\");\n  }\n\n  /**\n   * Return the negative of this Duration.\n   * @example Duration.fromObject({ hours: 1, seconds: 30 }).negate().toObject() //=> { hours: -1, seconds: -30 }\n   * @return {Duration}\n   */\n  negate() {\n    if (!this.isValid) return this;\n    const negated = {};\n    for (const k of Object.keys(this.values)) {\n      negated[k] = this.values[k] === 0 ? 0 : -this.values[k];\n    }\n    return clone$1(this, {\n      values: negated\n    }, true);\n  }\n\n  /**\n   * Get the years.\n   * @type {number}\n   */\n  get years() {\n    return this.isValid ? this.values.years || 0 : NaN;\n  }\n\n  /**\n   * Get the quarters.\n   * @type {number}\n   */\n  get quarters() {\n    return this.isValid ? this.values.quarters || 0 : NaN;\n  }\n\n  /**\n   * Get the months.\n   * @type {number}\n   */\n  get months() {\n    return this.isValid ? this.values.months || 0 : NaN;\n  }\n\n  /**\n   * Get the weeks\n   * @type {number}\n   */\n  get weeks() {\n    return this.isValid ? this.values.weeks || 0 : NaN;\n  }\n\n  /**\n   * Get the days.\n   * @type {number}\n   */\n  get days() {\n    return this.isValid ? this.values.days || 0 : NaN;\n  }\n\n  /**\n   * Get the hours.\n   * @type {number}\n   */\n  get hours() {\n    return this.isValid ? this.values.hours || 0 : NaN;\n  }\n\n  /**\n   * Get the minutes.\n   * @type {number}\n   */\n  get minutes() {\n    return this.isValid ? this.values.minutes || 0 : NaN;\n  }\n\n  /**\n   * Get the seconds.\n   * @return {number}\n   */\n  get seconds() {\n    return this.isValid ? this.values.seconds || 0 : NaN;\n  }\n\n  /**\n   * Get the milliseconds.\n   * @return {number}\n   */\n  get milliseconds() {\n    return this.isValid ? this.values.milliseconds || 0 : NaN;\n  }\n\n  /**\n   * Returns whether the Duration is invalid. Invalid durations are returned by diff operations\n   * on invalid DateTimes or Intervals.\n   * @return {boolean}\n   */\n  get isValid() {\n    return this.invalid === null;\n  }\n\n  /**\n   * Returns an error code if this Duration became invalid, or null if the Duration is valid\n   * @return {string}\n   */\n  get invalidReason() {\n    return this.invalid ? this.invalid.reason : null;\n  }\n\n  /**\n   * Returns an explanation of why this Duration became invalid, or null if the Duration is valid\n   * @type {string}\n   */\n  get invalidExplanation() {\n    return this.invalid ? this.invalid.explanation : null;\n  }\n\n  /**\n   * Equality check\n   * Two Durations are equal iff they have the same units and the same values for each unit.\n   * @param {Duration} other\n   * @return {boolean}\n   */\n  equals(other) {\n    if (!this.isValid || !other.isValid) {\n      return false;\n    }\n    if (!this.loc.equals(other.loc)) {\n      return false;\n    }\n    function eq(v1, v2) {\n      // Consider 0 and undefined as equal\n      if (v1 === undefined || v1 === 0) return v2 === undefined || v2 === 0;\n      return v1 === v2;\n    }\n    for (const u of orderedUnits$1) {\n      if (!eq(this.values[u], other.values[u])) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nconst INVALID$1 = \"Invalid Interval\";\n\n// checks if the start is equal to or before the end\nfunction validateStartEnd(start, end) {\n  if (!start || !start.isValid) {\n    return Interval.invalid(\"missing or invalid start\");\n  } else if (!end || !end.isValid) {\n    return Interval.invalid(\"missing or invalid end\");\n  } else if (end < start) {\n    return Interval.invalid(\"end before start\", `The end of an interval must be after its start, but you had start=${start.toISO()} and end=${end.toISO()}`);\n  } else {\n    return null;\n  }\n}\n\n/**\n * An Interval object represents a half-open interval of time, where each endpoint is a {@link DateTime}. Conceptually, it's a container for those two endpoints, accompanied by methods for creating, parsing, interrogating, comparing, transforming, and formatting them.\n *\n * Here is a brief overview of the most commonly used methods and getters in Interval:\n *\n * * **Creation** To create an Interval, use {@link Interval.fromDateTimes}, {@link Interval.after}, {@link Interval.before}, or {@link Interval.fromISO}.\n * * **Accessors** Use {@link Interval#start} and {@link Interval#end} to get the start and end.\n * * **Interrogation** To analyze the Interval, use {@link Interval#count}, {@link Interval#length}, {@link Interval#hasSame}, {@link Interval#contains}, {@link Interval#isAfter}, or {@link Interval#isBefore}.\n * * **Transformation** To create other Intervals out of this one, use {@link Interval#set}, {@link Interval#splitAt}, {@link Interval#splitBy}, {@link Interval#divideEqually}, {@link Interval.merge}, {@link Interval.xor}, {@link Interval#union}, {@link Interval#intersection}, or {@link Interval#difference}.\n * * **Comparison** To compare this Interval to another one, use {@link Interval#equals}, {@link Interval#overlaps}, {@link Interval#abutsStart}, {@link Interval#abutsEnd}, {@link Interval#engulfs}\n * * **Output** To convert the Interval into other representations, see {@link Interval#toString}, {@link Interval#toLocaleString}, {@link Interval#toISO}, {@link Interval#toISODate}, {@link Interval#toISOTime}, {@link Interval#toFormat}, and {@link Interval#toDuration}.\n */\nclass Interval {\n  /**\n   * @private\n   */\n  constructor(config) {\n    /**\n     * @access private\n     */\n    this.s = config.start;\n    /**\n     * @access private\n     */\n    this.e = config.end;\n    /**\n     * @access private\n     */\n    this.invalid = config.invalid || null;\n    /**\n     * @access private\n     */\n    this.isLuxonInterval = true;\n  }\n\n  /**\n   * Create an invalid Interval.\n   * @param {string} reason - simple string of why this Interval is invalid. Should not contain parameters or anything else data-dependent\n   * @param {string} [explanation=null] - longer explanation, may include parameters and other useful debugging information\n   * @return {Interval}\n   */\n  static invalid(reason, explanation = null) {\n    if (!reason) {\n      throw new InvalidArgumentError(\"need to specify a reason the Interval is invalid\");\n    }\n    const invalid = reason instanceof Invalid ? reason : new Invalid(reason, explanation);\n    if (Settings.throwOnInvalid) {\n      throw new InvalidIntervalError(invalid);\n    } else {\n      return new Interval({\n        invalid\n      });\n    }\n  }\n\n  /**\n   * Create an Interval from a start DateTime and an end DateTime. Inclusive of the start but not the end.\n   * @param {DateTime|Date|Object} start\n   * @param {DateTime|Date|Object} end\n   * @return {Interval}\n   */\n  static fromDateTimes(start, end) {\n    const builtStart = friendlyDateTime(start),\n      builtEnd = friendlyDateTime(end);\n    const validateError = validateStartEnd(builtStart, builtEnd);\n    if (validateError == null) {\n      return new Interval({\n        start: builtStart,\n        end: builtEnd\n      });\n    } else {\n      return validateError;\n    }\n  }\n\n  /**\n   * Create an Interval from a start DateTime and a Duration to extend to.\n   * @param {DateTime|Date|Object} start\n   * @param {Duration|Object|number} duration - the length of the Interval.\n   * @return {Interval}\n   */\n  static after(start, duration) {\n    const dur = Duration.fromDurationLike(duration),\n      dt = friendlyDateTime(start);\n    return Interval.fromDateTimes(dt, dt.plus(dur));\n  }\n\n  /**\n   * Create an Interval from an end DateTime and a Duration to extend backwards to.\n   * @param {DateTime|Date|Object} end\n   * @param {Duration|Object|number} duration - the length of the Interval.\n   * @return {Interval}\n   */\n  static before(end, duration) {\n    const dur = Duration.fromDurationLike(duration),\n      dt = friendlyDateTime(end);\n    return Interval.fromDateTimes(dt.minus(dur), dt);\n  }\n\n  /**\n   * Create an Interval from an ISO 8601 string.\n   * Accepts `<start>/<end>`, `<start>/<duration>`, and `<duration>/<end>` formats.\n   * @param {string} text - the ISO string to parse\n   * @param {Object} [opts] - options to pass {@link DateTime#fromISO} and optionally {@link Duration#fromISO}\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Time_intervals\n   * @return {Interval}\n   */\n  static fromISO(text, opts) {\n    const [s, e] = (text || \"\").split(\"/\", 2);\n    if (s && e) {\n      let start, startIsValid;\n      try {\n        start = DateTime.fromISO(s, opts);\n        startIsValid = start.isValid;\n      } catch (e) {\n        startIsValid = false;\n      }\n      let end, endIsValid;\n      try {\n        end = DateTime.fromISO(e, opts);\n        endIsValid = end.isValid;\n      } catch (e) {\n        endIsValid = false;\n      }\n      if (startIsValid && endIsValid) {\n        return Interval.fromDateTimes(start, end);\n      }\n      if (startIsValid) {\n        const dur = Duration.fromISO(e, opts);\n        if (dur.isValid) {\n          return Interval.after(start, dur);\n        }\n      } else if (endIsValid) {\n        const dur = Duration.fromISO(s, opts);\n        if (dur.isValid) {\n          return Interval.before(end, dur);\n        }\n      }\n    }\n    return Interval.invalid(\"unparsable\", `the input \"${text}\" can't be parsed as ISO 8601`);\n  }\n\n  /**\n   * Check if an object is an Interval. Works across context boundaries\n   * @param {object} o\n   * @return {boolean}\n   */\n  static isInterval(o) {\n    return o && o.isLuxonInterval || false;\n  }\n\n  /**\n   * Returns the start of the Interval\n   * @type {DateTime}\n   */\n  get start() {\n    return this.isValid ? this.s : null;\n  }\n\n  /**\n   * Returns the end of the Interval\n   * @type {DateTime}\n   */\n  get end() {\n    return this.isValid ? this.e : null;\n  }\n\n  /**\n   * Returns whether this Interval's end is at least its start, meaning that the Interval isn't 'backwards'.\n   * @type {boolean}\n   */\n  get isValid() {\n    return this.invalidReason === null;\n  }\n\n  /**\n   * Returns an error code if this Interval is invalid, or null if the Interval is valid\n   * @type {string}\n   */\n  get invalidReason() {\n    return this.invalid ? this.invalid.reason : null;\n  }\n\n  /**\n   * Returns an explanation of why this Interval became invalid, or null if the Interval is valid\n   * @type {string}\n   */\n  get invalidExplanation() {\n    return this.invalid ? this.invalid.explanation : null;\n  }\n\n  /**\n   * Returns the length of the Interval in the specified unit.\n   * @param {string} unit - the unit (such as 'hours' or 'days') to return the length in.\n   * @return {number}\n   */\n  length(unit = \"milliseconds\") {\n    return this.isValid ? this.toDuration(...[unit]).get(unit) : NaN;\n  }\n\n  /**\n   * Returns the count of minutes, hours, days, months, or years included in the Interval, even in part.\n   * Unlike {@link Interval#length} this counts sections of the calendar, not periods of time, e.g. specifying 'day'\n   * asks 'what dates are included in this interval?', not 'how many days long is this interval?'\n   * @param {string} [unit='milliseconds'] - the unit of time to count.\n   * @param {Object} opts - options\n   * @param {boolean} [opts.useLocaleWeeks=false] - If true, use weeks based on the locale, i.e. use the locale-dependent start of the week; this operation will always use the locale of the start DateTime\n   * @return {number}\n   */\n  count(unit = \"milliseconds\", opts) {\n    if (!this.isValid) return NaN;\n    const start = this.start.startOf(unit, opts);\n    let end;\n    if (opts != null && opts.useLocaleWeeks) {\n      end = this.end.reconfigure({\n        locale: start.locale\n      });\n    } else {\n      end = this.end;\n    }\n    end = end.startOf(unit, opts);\n    return Math.floor(end.diff(start, unit).get(unit)) + (end.valueOf() !== this.end.valueOf());\n  }\n\n  /**\n   * Returns whether this Interval's start and end are both in the same unit of time\n   * @param {string} unit - the unit of time to check sameness on\n   * @return {boolean}\n   */\n  hasSame(unit) {\n    return this.isValid ? this.isEmpty() || this.e.minus(1).hasSame(this.s, unit) : false;\n  }\n\n  /**\n   * Return whether this Interval has the same start and end DateTimes.\n   * @return {boolean}\n   */\n  isEmpty() {\n    return this.s.valueOf() === this.e.valueOf();\n  }\n\n  /**\n   * Return whether this Interval's start is after the specified DateTime.\n   * @param {DateTime} dateTime\n   * @return {boolean}\n   */\n  isAfter(dateTime) {\n    if (!this.isValid) return false;\n    return this.s > dateTime;\n  }\n\n  /**\n   * Return whether this Interval's end is before the specified DateTime.\n   * @param {DateTime} dateTime\n   * @return {boolean}\n   */\n  isBefore(dateTime) {\n    if (!this.isValid) return false;\n    return this.e <= dateTime;\n  }\n\n  /**\n   * Return whether this Interval contains the specified DateTime.\n   * @param {DateTime} dateTime\n   * @return {boolean}\n   */\n  contains(dateTime) {\n    if (!this.isValid) return false;\n    return this.s <= dateTime && this.e > dateTime;\n  }\n\n  /**\n   * \"Sets\" the start and/or end dates. Returns a newly-constructed Interval.\n   * @param {Object} values - the values to set\n   * @param {DateTime} values.start - the starting DateTime\n   * @param {DateTime} values.end - the ending DateTime\n   * @return {Interval}\n   */\n  set({\n    start,\n    end\n  } = {}) {\n    if (!this.isValid) return this;\n    return Interval.fromDateTimes(start || this.s, end || this.e);\n  }\n\n  /**\n   * Split this Interval at each of the specified DateTimes\n   * @param {...DateTime} dateTimes - the unit of time to count.\n   * @return {Array}\n   */\n  splitAt(...dateTimes) {\n    if (!this.isValid) return [];\n    const sorted = dateTimes.map(friendlyDateTime).filter(d => this.contains(d)).sort((a, b) => a.toMillis() - b.toMillis()),\n      results = [];\n    let {\n        s\n      } = this,\n      i = 0;\n    while (s < this.e) {\n      const added = sorted[i] || this.e,\n        next = +added > +this.e ? this.e : added;\n      results.push(Interval.fromDateTimes(s, next));\n      s = next;\n      i += 1;\n    }\n    return results;\n  }\n\n  /**\n   * Split this Interval into smaller Intervals, each of the specified length.\n   * Left over time is grouped into a smaller interval\n   * @param {Duration|Object|number} duration - The length of each resulting interval.\n   * @return {Array}\n   */\n  splitBy(duration) {\n    const dur = Duration.fromDurationLike(duration);\n    if (!this.isValid || !dur.isValid || dur.as(\"milliseconds\") === 0) {\n      return [];\n    }\n    let {\n        s\n      } = this,\n      idx = 1,\n      next;\n    const results = [];\n    while (s < this.e) {\n      const added = this.start.plus(dur.mapUnits(x => x * idx));\n      next = +added > +this.e ? this.e : added;\n      results.push(Interval.fromDateTimes(s, next));\n      s = next;\n      idx += 1;\n    }\n    return results;\n  }\n\n  /**\n   * Split this Interval into the specified number of smaller intervals.\n   * @param {number} numberOfParts - The number of Intervals to divide the Interval into.\n   * @return {Array}\n   */\n  divideEqually(numberOfParts) {\n    if (!this.isValid) return [];\n    return this.splitBy(this.length() / numberOfParts).slice(0, numberOfParts);\n  }\n\n  /**\n   * Return whether this Interval overlaps with the specified Interval\n   * @param {Interval} other\n   * @return {boolean}\n   */\n  overlaps(other) {\n    return this.e > other.s && this.s < other.e;\n  }\n\n  /**\n   * Return whether this Interval's end is adjacent to the specified Interval's start.\n   * @param {Interval} other\n   * @return {boolean}\n   */\n  abutsStart(other) {\n    if (!this.isValid) return false;\n    return +this.e === +other.s;\n  }\n\n  /**\n   * Return whether this Interval's start is adjacent to the specified Interval's end.\n   * @param {Interval} other\n   * @return {boolean}\n   */\n  abutsEnd(other) {\n    if (!this.isValid) return false;\n    return +other.e === +this.s;\n  }\n\n  /**\n   * Return whether this Interval engulfs the start and end of the specified Interval.\n   * @param {Interval} other\n   * @return {boolean}\n   */\n  engulfs(other) {\n    if (!this.isValid) return false;\n    return this.s <= other.s && this.e >= other.e;\n  }\n\n  /**\n   * Return whether this Interval has the same start and end as the specified Interval.\n   * @param {Interval} other\n   * @return {boolean}\n   */\n  equals(other) {\n    if (!this.isValid || !other.isValid) {\n      return false;\n    }\n    return this.s.equals(other.s) && this.e.equals(other.e);\n  }\n\n  /**\n   * Return an Interval representing the intersection of this Interval and the specified Interval.\n   * Specifically, the resulting Interval has the maximum start time and the minimum end time of the two Intervals.\n   * Returns null if the intersection is empty, meaning, the intervals don't intersect.\n   * @param {Interval} other\n   * @return {Interval}\n   */\n  intersection(other) {\n    if (!this.isValid) return this;\n    const s = this.s > other.s ? this.s : other.s,\n      e = this.e < other.e ? this.e : other.e;\n    if (s >= e) {\n      return null;\n    } else {\n      return Interval.fromDateTimes(s, e);\n    }\n  }\n\n  /**\n   * Return an Interval representing the union of this Interval and the specified Interval.\n   * Specifically, the resulting Interval has the minimum start time and the maximum end time of the two Intervals.\n   * @param {Interval} other\n   * @return {Interval}\n   */\n  union(other) {\n    if (!this.isValid) return this;\n    const s = this.s < other.s ? this.s : other.s,\n      e = this.e > other.e ? this.e : other.e;\n    return Interval.fromDateTimes(s, e);\n  }\n\n  /**\n   * Merge an array of Intervals into a equivalent minimal set of Intervals.\n   * Combines overlapping and adjacent Intervals.\n   * @param {Array} intervals\n   * @return {Array}\n   */\n  static merge(intervals) {\n    const [found, final] = intervals.sort((a, b) => a.s - b.s).reduce(([sofar, current], item) => {\n      if (!current) {\n        return [sofar, item];\n      } else if (current.overlaps(item) || current.abutsStart(item)) {\n        return [sofar, current.union(item)];\n      } else {\n        return [sofar.concat([current]), item];\n      }\n    }, [[], null]);\n    if (final) {\n      found.push(final);\n    }\n    return found;\n  }\n\n  /**\n   * Return an array of Intervals representing the spans of time that only appear in one of the specified Intervals.\n   * @param {Array} intervals\n   * @return {Array}\n   */\n  static xor(intervals) {\n    let start = null,\n      currentCount = 0;\n    const results = [],\n      ends = intervals.map(i => [{\n        time: i.s,\n        type: \"s\"\n      }, {\n        time: i.e,\n        type: \"e\"\n      }]),\n      flattened = Array.prototype.concat(...ends),\n      arr = flattened.sort((a, b) => a.time - b.time);\n    for (const i of arr) {\n      currentCount += i.type === \"s\" ? 1 : -1;\n      if (currentCount === 1) {\n        start = i.time;\n      } else {\n        if (start && +start !== +i.time) {\n          results.push(Interval.fromDateTimes(start, i.time));\n        }\n        start = null;\n      }\n    }\n    return Interval.merge(results);\n  }\n\n  /**\n   * Return an Interval representing the span of time in this Interval that doesn't overlap with any of the specified Intervals.\n   * @param {...Interval} intervals\n   * @return {Array}\n   */\n  difference(...intervals) {\n    return Interval.xor([this].concat(intervals)).map(i => this.intersection(i)).filter(i => i && !i.isEmpty());\n  }\n\n  /**\n   * Returns a string representation of this Interval appropriate for debugging.\n   * @return {string}\n   */\n  toString() {\n    if (!this.isValid) return INVALID$1;\n    return `[${this.s.toISO()}  ${this.e.toISO()})`;\n  }\n\n  /**\n   * Returns a string representation of this Interval appropriate for the REPL.\n   * @return {string}\n   */\n  [Symbol.for(\"nodejs.util.inspect.custom\")]() {\n    if (this.isValid) {\n      return `Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`;\n    } else {\n      return `Interval { Invalid, reason: ${this.invalidReason} }`;\n    }\n  }\n\n  /**\n   * Returns a localized string representing this Interval. Accepts the same options as the\n   * Intl.DateTimeFormat constructor and any presets defined by Luxon, such as\n   * {@link DateTime.DATE_FULL} or {@link DateTime.TIME_SIMPLE}. The exact behavior of this method\n   * is browser-specific, but in general it will return an appropriate representation of the\n   * Interval in the assigned locale. Defaults to the system's locale if no locale has been\n   * specified.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat\n   * @param {Object} [formatOpts=DateTime.DATE_SHORT] - Either a DateTime preset or\n   * Intl.DateTimeFormat constructor options.\n   * @param {Object} opts - Options to override the configuration of the start DateTime.\n   * @example Interval.fromISO('2022-11-07T09:00Z/2022-11-08T09:00Z').toLocaleString(); //=> 11/7/2022  11/8/2022\n   * @example Interval.fromISO('2022-11-07T09:00Z/2022-11-08T09:00Z').toLocaleString(DateTime.DATE_FULL); //=> November 7  8, 2022\n   * @example Interval.fromISO('2022-11-07T09:00Z/2022-11-08T09:00Z').toLocaleString(DateTime.DATE_FULL, { locale: 'fr-FR' }); //=> 78 novembre 2022\n   * @example Interval.fromISO('2022-11-07T17:00Z/2022-11-07T19:00Z').toLocaleString(DateTime.TIME_SIMPLE); //=> 6:00  8:00 PM\n   * @example Interval.fromISO('2022-11-07T17:00Z/2022-11-07T19:00Z').toLocaleString({ weekday: 'short', month: 'short', day: '2-digit', hour: '2-digit', minute: '2-digit' }); //=> Mon, Nov 07, 6:00  8:00 p\n   * @return {string}\n   */\n  toLocaleString(formatOpts = DATE_SHORT, opts = {}) {\n    return this.isValid ? Formatter.create(this.s.loc.clone(opts), formatOpts).formatInterval(this) : INVALID$1;\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this Interval.\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Time_intervals\n   * @param {Object} opts - The same options as {@link DateTime#toISO}\n   * @return {string}\n   */\n  toISO(opts) {\n    if (!this.isValid) return INVALID$1;\n    return `${this.s.toISO(opts)}/${this.e.toISO(opts)}`;\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of date of this Interval.\n   * The time components are ignored.\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Time_intervals\n   * @return {string}\n   */\n  toISODate() {\n    if (!this.isValid) return INVALID$1;\n    return `${this.s.toISODate()}/${this.e.toISODate()}`;\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of time of this Interval.\n   * The date components are ignored.\n   * @see https://en.wikipedia.org/wiki/ISO_8601#Time_intervals\n   * @param {Object} opts - The same options as {@link DateTime#toISO}\n   * @return {string}\n   */\n  toISOTime(opts) {\n    if (!this.isValid) return INVALID$1;\n    return `${this.s.toISOTime(opts)}/${this.e.toISOTime(opts)}`;\n  }\n\n  /**\n   * Returns a string representation of this Interval formatted according to the specified format\n   * string. **You may not want this.** See {@link Interval#toLocaleString} for a more flexible\n   * formatting tool.\n   * @param {string} dateFormat - The format string. This string formats the start and end time.\n   * See {@link DateTime#toFormat} for details.\n   * @param {Object} opts - Options.\n   * @param {string} [opts.separator =  '  '] - A separator to place between the start and end\n   * representations.\n   * @return {string}\n   */\n  toFormat(dateFormat, {\n    separator = \"  \"\n  } = {}) {\n    if (!this.isValid) return INVALID$1;\n    return `${this.s.toFormat(dateFormat)}${separator}${this.e.toFormat(dateFormat)}`;\n  }\n\n  /**\n   * Return a Duration representing the time spanned by this interval.\n   * @param {string|string[]} [unit=['milliseconds']] - the unit or units (such as 'hours' or 'days') to include in the duration.\n   * @param {Object} opts - options that affect the creation of the Duration\n   * @param {string} [opts.conversionAccuracy='casual'] - the conversion system to use\n   * @example Interval.fromDateTimes(dt1, dt2).toDuration().toObject() //=> { milliseconds: 88489257 }\n   * @example Interval.fromDateTimes(dt1, dt2).toDuration('days').toObject() //=> { days: 1.0241812152777778 }\n   * @example Interval.fromDateTimes(dt1, dt2).toDuration(['hours', 'minutes']).toObject() //=> { hours: 24, minutes: 34.82095 }\n   * @example Interval.fromDateTimes(dt1, dt2).toDuration(['hours', 'minutes', 'seconds']).toObject() //=> { hours: 24, minutes: 34, seconds: 49.257 }\n   * @example Interval.fromDateTimes(dt1, dt2).toDuration('seconds').toObject() //=> { seconds: 88489.257 }\n   * @return {Duration}\n   */\n  toDuration(unit, opts) {\n    if (!this.isValid) {\n      return Duration.invalid(this.invalidReason);\n    }\n    return this.e.diff(this.s, unit, opts);\n  }\n\n  /**\n   * Run mapFn on the interval start and end, returning a new Interval from the resulting DateTimes\n   * @param {function} mapFn\n   * @return {Interval}\n   * @example Interval.fromDateTimes(dt1, dt2).mapEndpoints(endpoint => endpoint.toUTC())\n   * @example Interval.fromDateTimes(dt1, dt2).mapEndpoints(endpoint => endpoint.plus({ hours: 2 }))\n   */\n  mapEndpoints(mapFn) {\n    return Interval.fromDateTimes(mapFn(this.s), mapFn(this.e));\n  }\n}\n\n/**\n * The Info class contains static methods for retrieving general time and date related data. For example, it has methods for finding out if a time zone has a DST, for listing the months in any supported locale, and for discovering which of Luxon features are available in the current environment.\n */\nclass Info {\n  /**\n   * Return whether the specified zone contains a DST.\n   * @param {string|Zone} [zone='local'] - Zone to check. Defaults to the environment's local zone.\n   * @return {boolean}\n   */\n  static hasDST(zone = Settings.defaultZone) {\n    const proto = DateTime.now().setZone(zone).set({\n      month: 12\n    });\n    return !zone.isUniversal && proto.offset !== proto.set({\n      month: 6\n    }).offset;\n  }\n\n  /**\n   * Return whether the specified zone is a valid IANA specifier.\n   * @param {string} zone - Zone to check\n   * @return {boolean}\n   */\n  static isValidIANAZone(zone) {\n    return IANAZone.isValidZone(zone);\n  }\n\n  /**\n   * Converts the input into a {@link Zone} instance.\n   *\n   * * If `input` is already a Zone instance, it is returned unchanged.\n   * * If `input` is a string containing a valid time zone name, a Zone instance\n   *   with that name is returned.\n   * * If `input` is a string that doesn't refer to a known time zone, a Zone\n   *   instance with {@link Zone#isValid} == false is returned.\n   * * If `input is a number, a Zone instance with the specified fixed offset\n   *   in minutes is returned.\n   * * If `input` is `null` or `undefined`, the default zone is returned.\n   * @param {string|Zone|number} [input] - the value to be converted\n   * @return {Zone}\n   */\n  static normalizeZone(input) {\n    return normalizeZone(input, Settings.defaultZone);\n  }\n\n  /**\n   * Get the weekday on which the week starts according to the given locale.\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @returns {number} the start of the week, 1 for Monday through 7 for Sunday\n   */\n  static getStartOfWeek({\n    locale = null,\n    locObj = null\n  } = {}) {\n    return (locObj || Locale.create(locale)).getStartOfWeek();\n  }\n\n  /**\n   * Get the minimum number of days necessary in a week before it is considered part of the next year according\n   * to the given locale.\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @returns {number}\n   */\n  static getMinimumDaysInFirstWeek({\n    locale = null,\n    locObj = null\n  } = {}) {\n    return (locObj || Locale.create(locale)).getMinDaysInFirstWeek();\n  }\n\n  /**\n   * Get the weekdays, which are considered the weekend according to the given locale\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @returns {number[]} an array of weekdays, 1 for Monday through 7 for Sunday\n   */\n  static getWeekendWeekdays({\n    locale = null,\n    locObj = null\n  } = {}) {\n    // copy the array, because we cache it internally\n    return (locObj || Locale.create(locale)).getWeekendDays().slice();\n  }\n\n  /**\n   * Return an array of standalone month names.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat\n   * @param {string} [length='long'] - the length of the month representation, such as \"numeric\", \"2-digit\", \"narrow\", \"short\", \"long\"\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.numberingSystem=null] - the numbering system\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @param {string} [opts.outputCalendar='gregory'] - the calendar\n   * @example Info.months()[0] //=> 'January'\n   * @example Info.months('short')[0] //=> 'Jan'\n   * @example Info.months('numeric')[0] //=> '1'\n   * @example Info.months('short', { locale: 'fr-CA' } )[0] //=> 'janv.'\n   * @example Info.months('numeric', { locale: 'ar' })[0] //=> ''\n   * @example Info.months('long', { outputCalendar: 'islamic' })[0] //=> 'Rabi I'\n   * @return {Array}\n   */\n  static months(length = \"long\", {\n    locale = null,\n    numberingSystem = null,\n    locObj = null,\n    outputCalendar = \"gregory\"\n  } = {}) {\n    return (locObj || Locale.create(locale, numberingSystem, outputCalendar)).months(length);\n  }\n\n  /**\n   * Return an array of format month names.\n   * Format months differ from standalone months in that they're meant to appear next to the day of the month. In some languages, that\n   * changes the string.\n   * See {@link Info#months}\n   * @param {string} [length='long'] - the length of the month representation, such as \"numeric\", \"2-digit\", \"narrow\", \"short\", \"long\"\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.numberingSystem=null] - the numbering system\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @param {string} [opts.outputCalendar='gregory'] - the calendar\n   * @return {Array}\n   */\n  static monthsFormat(length = \"long\", {\n    locale = null,\n    numberingSystem = null,\n    locObj = null,\n    outputCalendar = \"gregory\"\n  } = {}) {\n    return (locObj || Locale.create(locale, numberingSystem, outputCalendar)).months(length, true);\n  }\n\n  /**\n   * Return an array of standalone week names.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat\n   * @param {string} [length='long'] - the length of the weekday representation, such as \"narrow\", \"short\", \"long\".\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @param {string} [opts.numberingSystem=null] - the numbering system\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @example Info.weekdays()[0] //=> 'Monday'\n   * @example Info.weekdays('short')[0] //=> 'Mon'\n   * @example Info.weekdays('short', { locale: 'fr-CA' })[0] //=> 'lun.'\n   * @example Info.weekdays('short', { locale: 'ar' })[0] //=> ''\n   * @return {Array}\n   */\n  static weekdays(length = \"long\", {\n    locale = null,\n    numberingSystem = null,\n    locObj = null\n  } = {}) {\n    return (locObj || Locale.create(locale, numberingSystem, null)).weekdays(length);\n  }\n\n  /**\n   * Return an array of format week names.\n   * Format weekdays differ from standalone weekdays in that they're meant to appear next to more date information. In some languages, that\n   * changes the string.\n   * See {@link Info#weekdays}\n   * @param {string} [length='long'] - the length of the month representation, such as \"narrow\", \"short\", \"long\".\n   * @param {Object} opts - options\n   * @param {string} [opts.locale=null] - the locale code\n   * @param {string} [opts.numberingSystem=null] - the numbering system\n   * @param {string} [opts.locObj=null] - an existing locale object to use\n   * @return {Array}\n   */\n  static weekdaysFormat(length = \"long\", {\n    locale = null,\n    numberingSystem = null,\n    locObj = null\n  } = {}) {\n    return (locObj || Locale.create(locale, numberingSystem, null)).weekdays(length, true);\n  }\n\n  /**\n   * Return an array of meridiems.\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @example Info.meridiems() //=> [ 'AM', 'PM' ]\n   * @example Info.meridiems({ locale: 'my' }) //=> [ '', '' ]\n   * @return {Array}\n   */\n  static meridiems({\n    locale = null\n  } = {}) {\n    return Locale.create(locale).meridiems();\n  }\n\n  /**\n   * Return an array of eras, such as ['BC', 'AD']. The locale can be specified, but the calendar system is always Gregorian.\n   * @param {string} [length='short'] - the length of the era representation, such as \"short\" or \"long\".\n   * @param {Object} opts - options\n   * @param {string} [opts.locale] - the locale code\n   * @example Info.eras() //=> [ 'BC', 'AD' ]\n   * @example Info.eras('long') //=> [ 'Before Christ', 'Anno Domini' ]\n   * @example Info.eras('long', { locale: 'fr' }) //=> [ 'avant Jsus-Christ', 'aprs Jsus-Christ' ]\n   * @return {Array}\n   */\n  static eras(length = \"short\", {\n    locale = null\n  } = {}) {\n    return Locale.create(locale, null, \"gregory\").eras(length);\n  }\n\n  /**\n   * Return the set of available features in this environment.\n   * Some features of Luxon are not available in all environments. For example, on older browsers, relative time formatting support is not available. Use this function to figure out if that's the case.\n   * Keys:\n   * * `relative`: whether this environment supports relative time formatting\n   * * `localeWeek`: whether this environment supports different weekdays for the start of the week based on the locale\n   * @example Info.features() //=> { relative: false, localeWeek: true }\n   * @return {Object}\n   */\n  static features() {\n    return {\n      relative: hasRelative(),\n      localeWeek: hasLocaleWeekInfo()\n    };\n  }\n}\n\nfunction dayDiff(earlier, later) {\n  const utcDayStart = dt => dt.toUTC(0, {\n      keepLocalTime: true\n    }).startOf(\"day\").valueOf(),\n    ms = utcDayStart(later) - utcDayStart(earlier);\n  return Math.floor(Duration.fromMillis(ms).as(\"days\"));\n}\nfunction highOrderDiffs(cursor, later, units) {\n  const differs = [[\"years\", (a, b) => b.year - a.year], [\"quarters\", (a, b) => b.quarter - a.quarter + (b.year - a.year) * 4], [\"months\", (a, b) => b.month - a.month + (b.year - a.year) * 12], [\"weeks\", (a, b) => {\n    const days = dayDiff(a, b);\n    return (days - days % 7) / 7;\n  }], [\"days\", dayDiff]];\n  const results = {};\n  const earlier = cursor;\n  let lowestOrder, highWater;\n\n  /* This loop tries to diff using larger units first.\n     If we overshoot, we backtrack and try the next smaller unit.\n     \"cursor\" starts out at the earlier timestamp and moves closer and closer to \"later\"\n     as we use smaller and smaller units.\n     highWater keeps track of where we would be if we added one more of the smallest unit,\n     this is used later to potentially convert any difference smaller than the smallest higher order unit\n     into a fraction of that smallest higher order unit\n  */\n  for (const [unit, differ] of differs) {\n    if (units.indexOf(unit) >= 0) {\n      lowestOrder = unit;\n      results[unit] = differ(cursor, later);\n      highWater = earlier.plus(results);\n      if (highWater > later) {\n        // we overshot the end point, backtrack cursor by 1\n        results[unit]--;\n        cursor = earlier.plus(results);\n\n        // if we are still overshooting now, we need to backtrack again\n        // this happens in certain situations when diffing times in different zones,\n        // because this calculation ignores time zones\n        if (cursor > later) {\n          // keep the \"overshot by 1\" around as highWater\n          highWater = cursor;\n          // backtrack cursor by 1\n          results[unit]--;\n          cursor = earlier.plus(results);\n        }\n      } else {\n        cursor = highWater;\n      }\n    }\n  }\n  return [cursor, results, highWater, lowestOrder];\n}\nfunction diff (earlier, later, units, opts) {\n  let [cursor, results, highWater, lowestOrder] = highOrderDiffs(earlier, later, units);\n  const remainingMillis = later - cursor;\n  const lowerOrderUnits = units.filter(u => [\"hours\", \"minutes\", \"seconds\", \"milliseconds\"].indexOf(u) >= 0);\n  if (lowerOrderUnits.length === 0) {\n    if (highWater < later) {\n      highWater = cursor.plus({\n        [lowestOrder]: 1\n      });\n    }\n    if (highWater !== cursor) {\n      results[lowestOrder] = (results[lowestOrder] || 0) + remainingMillis / (highWater - cursor);\n    }\n  }\n  const duration = Duration.fromObject(results, opts);\n  if (lowerOrderUnits.length > 0) {\n    return Duration.fromMillis(remainingMillis, opts).shiftTo(...lowerOrderUnits).plus(duration);\n  } else {\n    return duration;\n  }\n}\n\nconst numberingSystems = {\n  arab: \"[\\u0660-\\u0669]\",\n  arabext: \"[\\u06F0-\\u06F9]\",\n  bali: \"[\\u1B50-\\u1B59]\",\n  beng: \"[\\u09E6-\\u09EF]\",\n  deva: \"[\\u0966-\\u096F]\",\n  fullwide: \"[\\uFF10-\\uFF19]\",\n  gujr: \"[\\u0AE6-\\u0AEF]\",\n  hanidec: \"[|||||||||]\",\n  khmr: \"[\\u17E0-\\u17E9]\",\n  knda: \"[\\u0CE6-\\u0CEF]\",\n  laoo: \"[\\u0ED0-\\u0ED9]\",\n  limb: \"[\\u1946-\\u194F]\",\n  mlym: \"[\\u0D66-\\u0D6F]\",\n  mong: \"[\\u1810-\\u1819]\",\n  mymr: \"[\\u1040-\\u1049]\",\n  orya: \"[\\u0B66-\\u0B6F]\",\n  tamldec: \"[\\u0BE6-\\u0BEF]\",\n  telu: \"[\\u0C66-\\u0C6F]\",\n  thai: \"[\\u0E50-\\u0E59]\",\n  tibt: \"[\\u0F20-\\u0F29]\",\n  latn: \"\\\\d\"\n};\nconst numberingSystemsUTF16 = {\n  arab: [1632, 1641],\n  arabext: [1776, 1785],\n  bali: [6992, 7001],\n  beng: [2534, 2543],\n  deva: [2406, 2415],\n  fullwide: [65296, 65303],\n  gujr: [2790, 2799],\n  khmr: [6112, 6121],\n  knda: [3302, 3311],\n  laoo: [3792, 3801],\n  limb: [6470, 6479],\n  mlym: [3430, 3439],\n  mong: [6160, 6169],\n  mymr: [4160, 4169],\n  orya: [2918, 2927],\n  tamldec: [3046, 3055],\n  telu: [3174, 3183],\n  thai: [3664, 3673],\n  tibt: [3872, 3881]\n};\nconst hanidecChars = numberingSystems.hanidec.replace(/[\\[|\\]]/g, \"\").split(\"\");\nfunction parseDigits(str) {\n  let value = parseInt(str, 10);\n  if (isNaN(value)) {\n    value = \"\";\n    for (let i = 0; i < str.length; i++) {\n      const code = str.charCodeAt(i);\n      if (str[i].search(numberingSystems.hanidec) !== -1) {\n        value += hanidecChars.indexOf(str[i]);\n      } else {\n        for (const key in numberingSystemsUTF16) {\n          const [min, max] = numberingSystemsUTF16[key];\n          if (code >= min && code <= max) {\n            value += code - min;\n          }\n        }\n      }\n    }\n    return parseInt(value, 10);\n  } else {\n    return value;\n  }\n}\nfunction digitRegex({\n  numberingSystem\n}, append = \"\") {\n  return new RegExp(`${numberingSystems[numberingSystem || \"latn\"]}${append}`);\n}\n\nconst MISSING_FTP = \"missing Intl.DateTimeFormat.formatToParts support\";\nfunction intUnit(regex, post = i => i) {\n  return {\n    regex,\n    deser: ([s]) => post(parseDigits(s))\n  };\n}\nconst NBSP = String.fromCharCode(160);\nconst spaceOrNBSP = `[ ${NBSP}]`;\nconst spaceOrNBSPRegExp = new RegExp(spaceOrNBSP, \"g\");\nfunction fixListRegex(s) {\n  // make dots optional and also make them literal\n  // make space and non breakable space characters interchangeable\n  return s.replace(/\\./g, \"\\\\.?\").replace(spaceOrNBSPRegExp, spaceOrNBSP);\n}\nfunction stripInsensitivities(s) {\n  return s.replace(/\\./g, \"\") // ignore dots that were made optional\n  .replace(spaceOrNBSPRegExp, \" \") // interchange space and nbsp\n  .toLowerCase();\n}\nfunction oneOf(strings, startIndex) {\n  if (strings === null) {\n    return null;\n  } else {\n    return {\n      regex: RegExp(strings.map(fixListRegex).join(\"|\")),\n      deser: ([s]) => strings.findIndex(i => stripInsensitivities(s) === stripInsensitivities(i)) + startIndex\n    };\n  }\n}\nfunction offset(regex, groups) {\n  return {\n    regex,\n    deser: ([, h, m]) => signedOffset(h, m),\n    groups\n  };\n}\nfunction simple(regex) {\n  return {\n    regex,\n    deser: ([s]) => s\n  };\n}\nfunction escapeToken(value) {\n  return value.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\n}\n\n/**\n * @param token\n * @param {Locale} loc\n */\nfunction unitForToken(token, loc) {\n  const one = digitRegex(loc),\n    two = digitRegex(loc, \"{2}\"),\n    three = digitRegex(loc, \"{3}\"),\n    four = digitRegex(loc, \"{4}\"),\n    six = digitRegex(loc, \"{6}\"),\n    oneOrTwo = digitRegex(loc, \"{1,2}\"),\n    oneToThree = digitRegex(loc, \"{1,3}\"),\n    oneToSix = digitRegex(loc, \"{1,6}\"),\n    oneToNine = digitRegex(loc, \"{1,9}\"),\n    twoToFour = digitRegex(loc, \"{2,4}\"),\n    fourToSix = digitRegex(loc, \"{4,6}\"),\n    literal = t => ({\n      regex: RegExp(escapeToken(t.val)),\n      deser: ([s]) => s,\n      literal: true\n    }),\n    unitate = t => {\n      if (token.literal) {\n        return literal(t);\n      }\n      switch (t.val) {\n        // era\n        case \"G\":\n          return oneOf(loc.eras(\"short\"), 0);\n        case \"GG\":\n          return oneOf(loc.eras(\"long\"), 0);\n        // years\n        case \"y\":\n          return intUnit(oneToSix);\n        case \"yy\":\n          return intUnit(twoToFour, untruncateYear);\n        case \"yyyy\":\n          return intUnit(four);\n        case \"yyyyy\":\n          return intUnit(fourToSix);\n        case \"yyyyyy\":\n          return intUnit(six);\n        // months\n        case \"M\":\n          return intUnit(oneOrTwo);\n        case \"MM\":\n          return intUnit(two);\n        case \"MMM\":\n          return oneOf(loc.months(\"short\", true), 1);\n        case \"MMMM\":\n          return oneOf(loc.months(\"long\", true), 1);\n        case \"L\":\n          return intUnit(oneOrTwo);\n        case \"LL\":\n          return intUnit(two);\n        case \"LLL\":\n          return oneOf(loc.months(\"short\", false), 1);\n        case \"LLLL\":\n          return oneOf(loc.months(\"long\", false), 1);\n        // dates\n        case \"d\":\n          return intUnit(oneOrTwo);\n        case \"dd\":\n          return intUnit(two);\n        // ordinals\n        case \"o\":\n          return intUnit(oneToThree);\n        case \"ooo\":\n          return intUnit(three);\n        // time\n        case \"HH\":\n          return intUnit(two);\n        case \"H\":\n          return intUnit(oneOrTwo);\n        case \"hh\":\n          return intUnit(two);\n        case \"h\":\n          return intUnit(oneOrTwo);\n        case \"mm\":\n          return intUnit(two);\n        case \"m\":\n          return intUnit(oneOrTwo);\n        case \"q\":\n          return intUnit(oneOrTwo);\n        case \"qq\":\n          return intUnit(two);\n        case \"s\":\n          return intUnit(oneOrTwo);\n        case \"ss\":\n          return intUnit(two);\n        case \"S\":\n          return intUnit(oneToThree);\n        case \"SSS\":\n          return intUnit(three);\n        case \"u\":\n          return simple(oneToNine);\n        case \"uu\":\n          return simple(oneOrTwo);\n        case \"uuu\":\n          return intUnit(one);\n        // meridiem\n        case \"a\":\n          return oneOf(loc.meridiems(), 0);\n        // weekYear (k)\n        case \"kkkk\":\n          return intUnit(four);\n        case \"kk\":\n          return intUnit(twoToFour, untruncateYear);\n        // weekNumber (W)\n        case \"W\":\n          return intUnit(oneOrTwo);\n        case \"WW\":\n          return intUnit(two);\n        // weekdays\n        case \"E\":\n        case \"c\":\n          return intUnit(one);\n        case \"EEE\":\n          return oneOf(loc.weekdays(\"short\", false), 1);\n        case \"EEEE\":\n          return oneOf(loc.weekdays(\"long\", false), 1);\n        case \"ccc\":\n          return oneOf(loc.weekdays(\"short\", true), 1);\n        case \"cccc\":\n          return oneOf(loc.weekdays(\"long\", true), 1);\n        // offset/zone\n        case \"Z\":\n        case \"ZZ\":\n          return offset(new RegExp(`([+-]${oneOrTwo.source})(?::(${two.source}))?`), 2);\n        case \"ZZZ\":\n          return offset(new RegExp(`([+-]${oneOrTwo.source})(${two.source})?`), 2);\n        // we don't support ZZZZ (PST) or ZZZZZ (Pacific Standard Time) in parsing\n        // because we don't have any way to figure out what they are\n        case \"z\":\n          return simple(/[a-z_+-/]{1,256}?/i);\n        // this special-case \"token\" represents a place where a macro-token expanded into a white-space literal\n        // in this case we accept any non-newline white-space\n        case \" \":\n          return simple(/[^\\S\\n\\r]/);\n        default:\n          return literal(t);\n      }\n    };\n  const unit = unitate(token) || {\n    invalidReason: MISSING_FTP\n  };\n  unit.token = token;\n  return unit;\n}\nconst partTypeStyleToTokenVal = {\n  year: {\n    \"2-digit\": \"yy\",\n    numeric: \"yyyyy\"\n  },\n  month: {\n    numeric: \"M\",\n    \"2-digit\": \"MM\",\n    short: \"MMM\",\n    long: \"MMMM\"\n  },\n  day: {\n    numeric: \"d\",\n    \"2-digit\": \"dd\"\n  },\n  weekday: {\n    short: \"EEE\",\n    long: \"EEEE\"\n  },\n  dayperiod: \"a\",\n  dayPeriod: \"a\",\n  hour12: {\n    numeric: \"h\",\n    \"2-digit\": \"hh\"\n  },\n  hour24: {\n    numeric: \"H\",\n    \"2-digit\": \"HH\"\n  },\n  minute: {\n    numeric: \"m\",\n    \"2-digit\": \"mm\"\n  },\n  second: {\n    numeric: \"s\",\n    \"2-digit\": \"ss\"\n  },\n  timeZoneName: {\n    long: \"ZZZZZ\",\n    short: \"ZZZ\"\n  }\n};\nfunction tokenForPart(part, formatOpts, resolvedOpts) {\n  const {\n    type,\n    value\n  } = part;\n  if (type === \"literal\") {\n    const isSpace = /^\\s+$/.test(value);\n    return {\n      literal: !isSpace,\n      val: isSpace ? \" \" : value\n    };\n  }\n  const style = formatOpts[type];\n\n  // The user might have explicitly specified hour12 or hourCycle\n  // if so, respect their decision\n  // if not, refer back to the resolvedOpts, which are based on the locale\n  let actualType = type;\n  if (type === \"hour\") {\n    if (formatOpts.hour12 != null) {\n      actualType = formatOpts.hour12 ? \"hour12\" : \"hour24\";\n    } else if (formatOpts.hourCycle != null) {\n      if (formatOpts.hourCycle === \"h11\" || formatOpts.hourCycle === \"h12\") {\n        actualType = \"hour12\";\n      } else {\n        actualType = \"hour24\";\n      }\n    } else {\n      // tokens only differentiate between 24 hours or not,\n      // so we do not need to check hourCycle here, which is less supported anyways\n      actualType = resolvedOpts.hour12 ? \"hour12\" : \"hour24\";\n    }\n  }\n  let val = partTypeStyleToTokenVal[actualType];\n  if (typeof val === \"object\") {\n    val = val[style];\n  }\n  if (val) {\n    return {\n      literal: false,\n      val\n    };\n  }\n  return undefined;\n}\nfunction buildRegex(units) {\n  const re = units.map(u => u.regex).reduce((f, r) => `${f}(${r.source})`, \"\");\n  return [`^${re}$`, units];\n}\nfunction match(input, regex, handlers) {\n  const matches = input.match(regex);\n  if (matches) {\n    const all = {};\n    let matchIndex = 1;\n    for (const i in handlers) {\n      if (hasOwnProperty(handlers, i)) {\n        const h = handlers[i],\n          groups = h.groups ? h.groups + 1 : 1;\n        if (!h.literal && h.token) {\n          all[h.token.val[0]] = h.deser(matches.slice(matchIndex, matchIndex + groups));\n        }\n        matchIndex += groups;\n      }\n    }\n    return [matches, all];\n  } else {\n    return [matches, {}];\n  }\n}\nfunction dateTimeFromMatches(matches) {\n  const toField = token => {\n    switch (token) {\n      case \"S\":\n        return \"millisecond\";\n      case \"s\":\n        return \"second\";\n      case \"m\":\n        return \"minute\";\n      case \"h\":\n      case \"H\":\n        return \"hour\";\n      case \"d\":\n        return \"day\";\n      case \"o\":\n        return \"ordinal\";\n      case \"L\":\n      case \"M\":\n        return \"month\";\n      case \"y\":\n        return \"year\";\n      case \"E\":\n      case \"c\":\n        return \"weekday\";\n      case \"W\":\n        return \"weekNumber\";\n      case \"k\":\n        return \"weekYear\";\n      case \"q\":\n        return \"quarter\";\n      default:\n        return null;\n    }\n  };\n  let zone = null;\n  let specificOffset;\n  if (!isUndefined(matches.z)) {\n    zone = IANAZone.create(matches.z);\n  }\n  if (!isUndefined(matches.Z)) {\n    if (!zone) {\n      zone = new FixedOffsetZone(matches.Z);\n    }\n    specificOffset = matches.Z;\n  }\n  if (!isUndefined(matches.q)) {\n    matches.M = (matches.q - 1) * 3 + 1;\n  }\n  if (!isUndefined(matches.h)) {\n    if (matches.h < 12 && matches.a === 1) {\n      matches.h += 12;\n    } else if (matches.h === 12 && matches.a === 0) {\n      matches.h = 0;\n    }\n  }\n  if (matches.G === 0 && matches.y) {\n    matches.y = -matches.y;\n  }\n  if (!isUndefined(matches.u)) {\n    matches.S = parseMillis(matches.u);\n  }\n  const vals = Object.keys(matches).reduce((r, k) => {\n    const f = toField(k);\n    if (f) {\n      r[f] = matches[k];\n    }\n    return r;\n  }, {});\n  return [vals, zone, specificOffset];\n}\nlet dummyDateTimeCache = null;\nfunction getDummyDateTime() {\n  if (!dummyDateTimeCache) {\n    dummyDateTimeCache = DateTime.fromMillis(1555555555555);\n  }\n  return dummyDateTimeCache;\n}\nfunction maybeExpandMacroToken(token, locale) {\n  if (token.literal) {\n    return token;\n  }\n  const formatOpts = Formatter.macroTokenToFormatOpts(token.val);\n  const tokens = formatOptsToTokens(formatOpts, locale);\n  if (tokens == null || tokens.includes(undefined)) {\n    return token;\n  }\n  return tokens;\n}\nfunction expandMacroTokens(tokens, locale) {\n  return Array.prototype.concat(...tokens.map(t => maybeExpandMacroToken(t, locale)));\n}\n\n/**\n * @private\n */\n\nfunction explainFromTokens(locale, input, format) {\n  const tokens = expandMacroTokens(Formatter.parseFormat(format), locale),\n    units = tokens.map(t => unitForToken(t, locale)),\n    disqualifyingUnit = units.find(t => t.invalidReason);\n  if (disqualifyingUnit) {\n    return {\n      input,\n      tokens,\n      invalidReason: disqualifyingUnit.invalidReason\n    };\n  } else {\n    const [regexString, handlers] = buildRegex(units),\n      regex = RegExp(regexString, \"i\"),\n      [rawMatches, matches] = match(input, regex, handlers),\n      [result, zone, specificOffset] = matches ? dateTimeFromMatches(matches) : [null, null, undefined];\n    if (hasOwnProperty(matches, \"a\") && hasOwnProperty(matches, \"H\")) {\n      throw new ConflictingSpecificationError(\"Can't include meridiem when specifying 24-hour format\");\n    }\n    return {\n      input,\n      tokens,\n      regex,\n      rawMatches,\n      matches,\n      result,\n      zone,\n      specificOffset\n    };\n  }\n}\nfunction parseFromTokens(locale, input, format) {\n  const {\n    result,\n    zone,\n    specificOffset,\n    invalidReason\n  } = explainFromTokens(locale, input, format);\n  return [result, zone, specificOffset, invalidReason];\n}\nfunction formatOptsToTokens(formatOpts, locale) {\n  if (!formatOpts) {\n    return null;\n  }\n  const formatter = Formatter.create(locale, formatOpts);\n  const df = formatter.dtFormatter(getDummyDateTime());\n  const parts = df.formatToParts();\n  const resolvedOpts = df.resolvedOptions();\n  return parts.map(p => tokenForPart(p, formatOpts, resolvedOpts));\n}\n\nconst INVALID = \"Invalid DateTime\";\nconst MAX_DATE = 8.64e15;\nfunction unsupportedZone(zone) {\n  return new Invalid(\"unsupported zone\", `the zone \"${zone.name}\" is not supported`);\n}\n\n// we cache week data on the DT object and this intermediates the cache\n/**\n * @param {DateTime} dt\n */\nfunction possiblyCachedWeekData(dt) {\n  if (dt.weekData === null) {\n    dt.weekData = gregorianToWeek(dt.c);\n  }\n  return dt.weekData;\n}\n\n/**\n * @param {DateTime} dt\n */\nfunction possiblyCachedLocalWeekData(dt) {\n  if (dt.localWeekData === null) {\n    dt.localWeekData = gregorianToWeek(dt.c, dt.loc.getMinDaysInFirstWeek(), dt.loc.getStartOfWeek());\n  }\n  return dt.localWeekData;\n}\n\n// clone really means, \"make a new object with these modifications\". all \"setters\" really use this\n// to create a new object while only changing some of the properties\nfunction clone(inst, alts) {\n  const current = {\n    ts: inst.ts,\n    zone: inst.zone,\n    c: inst.c,\n    o: inst.o,\n    loc: inst.loc,\n    invalid: inst.invalid\n  };\n  return new DateTime({\n    ...current,\n    ...alts,\n    old: current\n  });\n}\n\n// find the right offset a given local time. The o input is our guess, which determines which\n// offset we'll pick in ambiguous cases (e.g. there are two 3 AMs b/c Fallback DST)\nfunction fixOffset(localTS, o, tz) {\n  // Our UTC time is just a guess because our offset is just a guess\n  let utcGuess = localTS - o * 60 * 1000;\n\n  // Test whether the zone matches the offset for this ts\n  const o2 = tz.offset(utcGuess);\n\n  // If so, offset didn't change and we're done\n  if (o === o2) {\n    return [utcGuess, o];\n  }\n\n  // If not, change the ts by the difference in the offset\n  utcGuess -= (o2 - o) * 60 * 1000;\n\n  // If that gives us the local time we want, we're done\n  const o3 = tz.offset(utcGuess);\n  if (o2 === o3) {\n    return [utcGuess, o2];\n  }\n\n  // If it's different, we're in a hole time. The offset has changed, but the we don't adjust the time\n  return [localTS - Math.min(o2, o3) * 60 * 1000, Math.max(o2, o3)];\n}\n\n// convert an epoch timestamp into a calendar object with the given offset\nfunction tsToObj(ts, offset) {\n  ts += offset * 60 * 1000;\n  const d = new Date(ts);\n  return {\n    year: d.getUTCFullYear(),\n    month: d.getUTCMonth() + 1,\n    day: d.getUTCDate(),\n    hour: d.getUTCHours(),\n    minute: d.getUTCMinutes(),\n    second: d.getUTCSeconds(),\n    millisecond: d.getUTCMilliseconds()\n  };\n}\n\n// convert a calendar object to a epoch timestamp\nfunction objToTS(obj, offset, zone) {\n  return fixOffset(objToLocalTS(obj), offset, zone);\n}\n\n// create a new DT instance by adding a duration, adjusting for DSTs\nfunction adjustTime(inst, dur) {\n  const oPre = inst.o,\n    year = inst.c.year + Math.trunc(dur.years),\n    month = inst.c.month + Math.trunc(dur.months) + Math.trunc(dur.quarters) * 3,\n    c = {\n      ...inst.c,\n      year,\n      month,\n      day: Math.min(inst.c.day, daysInMonth(year, month)) + Math.trunc(dur.days) + Math.trunc(dur.weeks) * 7\n    },\n    millisToAdd = Duration.fromObject({\n      years: dur.years - Math.trunc(dur.years),\n      quarters: dur.quarters - Math.trunc(dur.quarters),\n      months: dur.months - Math.trunc(dur.months),\n      weeks: dur.weeks - Math.trunc(dur.weeks),\n      days: dur.days - Math.trunc(dur.days),\n      hours: dur.hours,\n      minutes: dur.minutes,\n      seconds: dur.seconds,\n      milliseconds: dur.milliseconds\n    }).as(\"milliseconds\"),\n    localTS = objToLocalTS(c);\n  let [ts, o] = fixOffset(localTS, oPre, inst.zone);\n  if (millisToAdd !== 0) {\n    ts += millisToAdd;\n    // that could have changed the offset by going over a DST, but we want to keep the ts the same\n    o = inst.zone.offset(ts);\n  }\n  return {\n    ts,\n    o\n  };\n}\n\n// helper useful in turning the results of parsing into real dates\n// by handling the zone options\nfunction parseDataToDateTime(parsed, parsedZone, opts, format, text, specificOffset) {\n  const {\n    setZone,\n    zone\n  } = opts;\n  if (parsed && Object.keys(parsed).length !== 0 || parsedZone) {\n    const interpretationZone = parsedZone || zone,\n      inst = DateTime.fromObject(parsed, {\n        ...opts,\n        zone: interpretationZone,\n        specificOffset\n      });\n    return setZone ? inst : inst.setZone(zone);\n  } else {\n    return DateTime.invalid(new Invalid(\"unparsable\", `the input \"${text}\" can't be parsed as ${format}`));\n  }\n}\n\n// if you want to output a technical format (e.g. RFC 2822), this helper\n// helps handle the details\nfunction toTechFormat(dt, format, allowZ = true) {\n  return dt.isValid ? Formatter.create(Locale.create(\"en-US\"), {\n    allowZ,\n    forceSimple: true\n  }).formatDateTimeFromString(dt, format) : null;\n}\nfunction toISODate(o, extended) {\n  const longFormat = o.c.year > 9999 || o.c.year < 0;\n  let c = \"\";\n  if (longFormat && o.c.year >= 0) c += \"+\";\n  c += padStart(o.c.year, longFormat ? 6 : 4);\n  if (extended) {\n    c += \"-\";\n    c += padStart(o.c.month);\n    c += \"-\";\n    c += padStart(o.c.day);\n  } else {\n    c += padStart(o.c.month);\n    c += padStart(o.c.day);\n  }\n  return c;\n}\nfunction toISOTime(o, extended, suppressSeconds, suppressMilliseconds, includeOffset, extendedZone) {\n  let c = padStart(o.c.hour);\n  if (extended) {\n    c += \":\";\n    c += padStart(o.c.minute);\n    if (o.c.millisecond !== 0 || o.c.second !== 0 || !suppressSeconds) {\n      c += \":\";\n    }\n  } else {\n    c += padStart(o.c.minute);\n  }\n  if (o.c.millisecond !== 0 || o.c.second !== 0 || !suppressSeconds) {\n    c += padStart(o.c.second);\n    if (o.c.millisecond !== 0 || !suppressMilliseconds) {\n      c += \".\";\n      c += padStart(o.c.millisecond, 3);\n    }\n  }\n  if (includeOffset) {\n    if (o.isOffsetFixed && o.offset === 0 && !extendedZone) {\n      c += \"Z\";\n    } else if (o.o < 0) {\n      c += \"-\";\n      c += padStart(Math.trunc(-o.o / 60));\n      c += \":\";\n      c += padStart(Math.trunc(-o.o % 60));\n    } else {\n      c += \"+\";\n      c += padStart(Math.trunc(o.o / 60));\n      c += \":\";\n      c += padStart(Math.trunc(o.o % 60));\n    }\n  }\n  if (extendedZone) {\n    c += \"[\" + o.zone.ianaName + \"]\";\n  }\n  return c;\n}\n\n// defaults for unspecified units in the supported calendars\nconst defaultUnitValues = {\n    month: 1,\n    day: 1,\n    hour: 0,\n    minute: 0,\n    second: 0,\n    millisecond: 0\n  },\n  defaultWeekUnitValues = {\n    weekNumber: 1,\n    weekday: 1,\n    hour: 0,\n    minute: 0,\n    second: 0,\n    millisecond: 0\n  },\n  defaultOrdinalUnitValues = {\n    ordinal: 1,\n    hour: 0,\n    minute: 0,\n    second: 0,\n    millisecond: 0\n  };\n\n// Units in the supported calendars, sorted by bigness\nconst orderedUnits = [\"year\", \"month\", \"day\", \"hour\", \"minute\", \"second\", \"millisecond\"],\n  orderedWeekUnits = [\"weekYear\", \"weekNumber\", \"weekday\", \"hour\", \"minute\", \"second\", \"millisecond\"],\n  orderedOrdinalUnits = [\"year\", \"ordinal\", \"hour\", \"minute\", \"second\", \"millisecond\"];\n\n// standardize case and plurality in units\nfunction normalizeUnit(unit) {\n  const normalized = {\n    year: \"year\",\n    years: \"year\",\n    month: \"month\",\n    months: \"month\",\n    day: \"day\",\n    days: \"day\",\n    hour: \"hour\",\n    hours: \"hour\",\n    minute: \"minute\",\n    minutes: \"minute\",\n    quarter: \"quarter\",\n    quarters: \"quarter\",\n    second: \"second\",\n    seconds: \"second\",\n    millisecond: \"millisecond\",\n    milliseconds: \"millisecond\",\n    weekday: \"weekday\",\n    weekdays: \"weekday\",\n    weeknumber: \"weekNumber\",\n    weeksnumber: \"weekNumber\",\n    weeknumbers: \"weekNumber\",\n    weekyear: \"weekYear\",\n    weekyears: \"weekYear\",\n    ordinal: \"ordinal\"\n  }[unit.toLowerCase()];\n  if (!normalized) throw new InvalidUnitError(unit);\n  return normalized;\n}\nfunction normalizeUnitWithLocalWeeks(unit) {\n  switch (unit.toLowerCase()) {\n    case \"localweekday\":\n    case \"localweekdays\":\n      return \"localWeekday\";\n    case \"localweeknumber\":\n    case \"localweeknumbers\":\n      return \"localWeekNumber\";\n    case \"localweekyear\":\n    case \"localweekyears\":\n      return \"localWeekYear\";\n    default:\n      return normalizeUnit(unit);\n  }\n}\n\n// this is a dumbed down version of fromObject() that runs about 60% faster\n// but doesn't do any validation, makes a bunch of assumptions about what units\n// are present, and so on.\nfunction quickDT(obj, opts) {\n  const zone = normalizeZone(opts.zone, Settings.defaultZone),\n    loc = Locale.fromObject(opts),\n    tsNow = Settings.now();\n  let ts, o;\n\n  // assume we have the higher-order units\n  if (!isUndefined(obj.year)) {\n    for (const u of orderedUnits) {\n      if (isUndefined(obj[u])) {\n        obj[u] = defaultUnitValues[u];\n      }\n    }\n    const invalid = hasInvalidGregorianData(obj) || hasInvalidTimeData(obj);\n    if (invalid) {\n      return DateTime.invalid(invalid);\n    }\n    const offsetProvis = zone.offset(tsNow);\n    [ts, o] = objToTS(obj, offsetProvis, zone);\n  } else {\n    ts = tsNow;\n  }\n  return new DateTime({\n    ts,\n    zone,\n    loc,\n    o\n  });\n}\nfunction diffRelative(start, end, opts) {\n  const round = isUndefined(opts.round) ? true : opts.round,\n    format = (c, unit) => {\n      c = roundTo(c, round || opts.calendary ? 0 : 2, true);\n      const formatter = end.loc.clone(opts).relFormatter(opts);\n      return formatter.format(c, unit);\n    },\n    differ = unit => {\n      if (opts.calendary) {\n        if (!end.hasSame(start, unit)) {\n          return end.startOf(unit).diff(start.startOf(unit), unit).get(unit);\n        } else return 0;\n      } else {\n        return end.diff(start, unit).get(unit);\n      }\n    };\n  if (opts.unit) {\n    return format(differ(opts.unit), opts.unit);\n  }\n  for (const unit of opts.units) {\n    const count = differ(unit);\n    if (Math.abs(count) >= 1) {\n      return format(count, unit);\n    }\n  }\n  return format(start > end ? -0 : 0, opts.units[opts.units.length - 1]);\n}\nfunction lastOpts(argList) {\n  let opts = {},\n    args;\n  if (argList.length > 0 && typeof argList[argList.length - 1] === \"object\") {\n    opts = argList[argList.length - 1];\n    args = Array.from(argList).slice(0, argList.length - 1);\n  } else {\n    args = Array.from(argList);\n  }\n  return [opts, args];\n}\n\n/**\n * A DateTime is an immutable data structure representing a specific date and time and accompanying methods. It contains class and instance methods for creating, parsing, interrogating, transforming, and formatting them.\n *\n * A DateTime comprises of:\n * * A timestamp. Each DateTime instance refers to a specific millisecond of the Unix epoch.\n * * A time zone. Each instance is considered in the context of a specific zone (by default the local system's zone).\n * * Configuration properties that effect how output strings are formatted, such as `locale`, `numberingSystem`, and `outputCalendar`.\n *\n * Here is a brief overview of the most commonly used functionality it provides:\n *\n * * **Creation**: To create a DateTime from its components, use one of its factory class methods: {@link DateTime.local}, {@link DateTime.utc}, and (most flexibly) {@link DateTime.fromObject}. To create one from a standard string format, use {@link DateTime.fromISO}, {@link DateTime.fromHTTP}, and {@link DateTime.fromRFC2822}. To create one from a custom string format, use {@link DateTime.fromFormat}. To create one from a native JS date, use {@link DateTime.fromJSDate}.\n * * **Gregorian calendar and time**: To examine the Gregorian properties of a DateTime individually (i.e as opposed to collectively through {@link DateTime#toObject}), use the {@link DateTime#year}, {@link DateTime#month},\n * {@link DateTime#day}, {@link DateTime#hour}, {@link DateTime#minute}, {@link DateTime#second}, {@link DateTime#millisecond} accessors.\n * * **Week calendar**: For ISO week calendar attributes, see the {@link DateTime#weekYear}, {@link DateTime#weekNumber}, and {@link DateTime#weekday} accessors.\n * * **Configuration** See the {@link DateTime#locale} and {@link DateTime#numberingSystem} accessors.\n * * **Transformation**: To transform the DateTime into other DateTimes, use {@link DateTime#set}, {@link DateTime#reconfigure}, {@link DateTime#setZone}, {@link DateTime#setLocale}, {@link DateTime.plus}, {@link DateTime#minus}, {@link DateTime#endOf}, {@link DateTime#startOf}, {@link DateTime#toUTC}, and {@link DateTime#toLocal}.\n * * **Output**: To convert the DateTime to other representations, use the {@link DateTime#toRelative}, {@link DateTime#toRelativeCalendar}, {@link DateTime#toJSON}, {@link DateTime#toISO}, {@link DateTime#toHTTP}, {@link DateTime#toObject}, {@link DateTime#toRFC2822}, {@link DateTime#toString}, {@link DateTime#toLocaleString}, {@link DateTime#toFormat}, {@link DateTime#toMillis} and {@link DateTime#toJSDate}.\n *\n * There's plenty others documented below. In addition, for more information on subtler topics like internationalization, time zones, alternative calendars, validity, and so on, see the external documentation.\n */\nclass DateTime {\n  /**\n   * @access private\n   */\n  constructor(config) {\n    const zone = config.zone || Settings.defaultZone;\n    let invalid = config.invalid || (Number.isNaN(config.ts) ? new Invalid(\"invalid input\") : null) || (!zone.isValid ? unsupportedZone(zone) : null);\n    /**\n     * @access private\n     */\n    this.ts = isUndefined(config.ts) ? Settings.now() : config.ts;\n    let c = null,\n      o = null;\n    if (!invalid) {\n      const unchanged = config.old && config.old.ts === this.ts && config.old.zone.equals(zone);\n      if (unchanged) {\n        [c, o] = [config.old.c, config.old.o];\n      } else {\n        const ot = zone.offset(this.ts);\n        c = tsToObj(this.ts, ot);\n        invalid = Number.isNaN(c.year) ? new Invalid(\"invalid input\") : null;\n        c = invalid ? null : c;\n        o = invalid ? null : ot;\n      }\n    }\n\n    /**\n     * @access private\n     */\n    this._zone = zone;\n    /**\n     * @access private\n     */\n    this.loc = config.loc || Locale.create();\n    /**\n     * @access private\n     */\n    this.invalid = invalid;\n    /**\n     * @access private\n     */\n    this.weekData = null;\n    /**\n     * @access private\n     */\n    this.localWeekData = null;\n    /**\n     * @access private\n     */\n    this.c = c;\n    /**\n     * @access private\n     */\n    this.o = o;\n    /**\n     * @access private\n     */\n    this.isLuxonDateTime = true;\n  }\n\n  // CONSTRUCT\n\n  /**\n   * Create a DateTime for the current instant, in the system's time zone.\n   *\n   * Use Settings to override these default values if needed.\n   * @example DateTime.now().toISO() //~> now in the ISO format\n   * @return {DateTime}\n   */\n  static now() {\n    return new DateTime({});\n  }\n\n  /**\n   * Create a local DateTime\n   * @param {number} [year] - The calendar year. If omitted (as in, call `local()` with no arguments), the current time will be used\n   * @param {number} [month=1] - The month, 1-indexed\n   * @param {number} [day=1] - The day of the month, 1-indexed\n   * @param {number} [hour=0] - The hour of the day, in 24-hour time\n   * @param {number} [minute=0] - The minute of the hour, meaning a number between 0 and 59\n   * @param {number} [second=0] - The second of the minute, meaning a number between 0 and 59\n   * @param {number} [millisecond=0] - The millisecond of the second, meaning a number between 0 and 999\n   * @example DateTime.local()                                  //~> now\n   * @example DateTime.local({ zone: \"America/New_York\" })      //~> now, in US east coast time\n   * @example DateTime.local(2017)                              //~> 2017-01-01T00:00:00\n   * @example DateTime.local(2017, 3)                           //~> 2017-03-01T00:00:00\n   * @example DateTime.local(2017, 3, 12, { locale: \"fr\" })     //~> 2017-03-12T00:00:00, with a French locale\n   * @example DateTime.local(2017, 3, 12, 5)                    //~> 2017-03-12T05:00:00\n   * @example DateTime.local(2017, 3, 12, 5, { zone: \"utc\" })   //~> 2017-03-12T05:00:00, in UTC\n   * @example DateTime.local(2017, 3, 12, 5, 45)                //~> 2017-03-12T05:45:00\n   * @example DateTime.local(2017, 3, 12, 5, 45, 10)            //~> 2017-03-12T05:45:10\n   * @example DateTime.local(2017, 3, 12, 5, 45, 10, 765)       //~> 2017-03-12T05:45:10.765\n   * @return {DateTime}\n   */\n  static local() {\n    const [opts, args] = lastOpts(arguments),\n      [year, month, day, hour, minute, second, millisecond] = args;\n    return quickDT({\n      year,\n      month,\n      day,\n      hour,\n      minute,\n      second,\n      millisecond\n    }, opts);\n  }\n\n  /**\n   * Create a DateTime in UTC\n   * @param {number} [year] - The calendar year. If omitted (as in, call `utc()` with no arguments), the current time will be used\n   * @param {number} [month=1] - The month, 1-indexed\n   * @param {number} [day=1] - The day of the month\n   * @param {number} [hour=0] - The hour of the day, in 24-hour time\n   * @param {number} [minute=0] - The minute of the hour, meaning a number between 0 and 59\n   * @param {number} [second=0] - The second of the minute, meaning a number between 0 and 59\n   * @param {number} [millisecond=0] - The millisecond of the second, meaning a number between 0 and 999\n   * @param {Object} options - configuration options for the DateTime\n   * @param {string} [options.locale] - a locale to set on the resulting DateTime instance\n   * @param {string} [options.outputCalendar] - the output calendar to set on the resulting DateTime instance\n   * @param {string} [options.numberingSystem] - the numbering system to set on the resulting DateTime instance\n   * @example DateTime.utc()                                              //~> now\n   * @example DateTime.utc(2017)                                          //~> 2017-01-01T00:00:00Z\n   * @example DateTime.utc(2017, 3)                                       //~> 2017-03-01T00:00:00Z\n   * @example DateTime.utc(2017, 3, 12)                                   //~> 2017-03-12T00:00:00Z\n   * @example DateTime.utc(2017, 3, 12, 5)                                //~> 2017-03-12T05:00:00Z\n   * @example DateTime.utc(2017, 3, 12, 5, 45)                            //~> 2017-03-12T05:45:00Z\n   * @example DateTime.utc(2017, 3, 12, 5, 45, { locale: \"fr\" })          //~> 2017-03-12T05:45:00Z with a French locale\n   * @example DateTime.utc(2017, 3, 12, 5, 45, 10)                        //~> 2017-03-12T05:45:10Z\n   * @example DateTime.utc(2017, 3, 12, 5, 45, 10, 765, { locale: \"fr\" }) //~> 2017-03-12T05:45:10.765Z with a French locale\n   * @return {DateTime}\n   */\n  static utc() {\n    const [opts, args] = lastOpts(arguments),\n      [year, month, day, hour, minute, second, millisecond] = args;\n    opts.zone = FixedOffsetZone.utcInstance;\n    return quickDT({\n      year,\n      month,\n      day,\n      hour,\n      minute,\n      second,\n      millisecond\n    }, opts);\n  }\n\n  /**\n   * Create a DateTime from a JavaScript Date object. Uses the default zone.\n   * @param {Date} date - a JavaScript Date object\n   * @param {Object} options - configuration options for the DateTime\n   * @param {string|Zone} [options.zone='local'] - the zone to place the DateTime into\n   * @return {DateTime}\n   */\n  static fromJSDate(date, options = {}) {\n    const ts = isDate(date) ? date.valueOf() : NaN;\n    if (Number.isNaN(ts)) {\n      return DateTime.invalid(\"invalid input\");\n    }\n    const zoneToUse = normalizeZone(options.zone, Settings.defaultZone);\n    if (!zoneToUse.isValid) {\n      return DateTime.invalid(unsupportedZone(zoneToUse));\n    }\n    return new DateTime({\n      ts: ts,\n      zone: zoneToUse,\n      loc: Locale.fromObject(options)\n    });\n  }\n\n  /**\n   * Create a DateTime from a number of milliseconds since the epoch (meaning since 1 January 1970 00:00:00 UTC). Uses the default zone.\n   * @param {number} milliseconds - a number of milliseconds since 1970 UTC\n   * @param {Object} options - configuration options for the DateTime\n   * @param {string|Zone} [options.zone='local'] - the zone to place the DateTime into\n   * @param {string} [options.locale] - a locale to set on the resulting DateTime instance\n   * @param {string} options.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @param {string} options.numberingSystem - the numbering system to set on the resulting DateTime instance\n   * @return {DateTime}\n   */\n  static fromMillis(milliseconds, options = {}) {\n    if (!isNumber(milliseconds)) {\n      throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof milliseconds} with value ${milliseconds}`);\n    } else if (milliseconds < -MAX_DATE || milliseconds > MAX_DATE) {\n      // this isn't perfect because because we can still end up out of range because of additional shifting, but it's a start\n      return DateTime.invalid(\"Timestamp out of range\");\n    } else {\n      return new DateTime({\n        ts: milliseconds,\n        zone: normalizeZone(options.zone, Settings.defaultZone),\n        loc: Locale.fromObject(options)\n      });\n    }\n  }\n\n  /**\n   * Create a DateTime from a number of seconds since the epoch (meaning since 1 January 1970 00:00:00 UTC). Uses the default zone.\n   * @param {number} seconds - a number of seconds since 1970 UTC\n   * @param {Object} options - configuration options for the DateTime\n   * @param {string|Zone} [options.zone='local'] - the zone to place the DateTime into\n   * @param {string} [options.locale] - a locale to set on the resulting DateTime instance\n   * @param {string} options.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @param {string} options.numberingSystem - the numbering system to set on the resulting DateTime instance\n   * @return {DateTime}\n   */\n  static fromSeconds(seconds, options = {}) {\n    if (!isNumber(seconds)) {\n      throw new InvalidArgumentError(\"fromSeconds requires a numerical input\");\n    } else {\n      return new DateTime({\n        ts: seconds * 1000,\n        zone: normalizeZone(options.zone, Settings.defaultZone),\n        loc: Locale.fromObject(options)\n      });\n    }\n  }\n\n  /**\n   * Create a DateTime from a JavaScript object with keys like 'year' and 'hour' with reasonable defaults.\n   * @param {Object} obj - the object to create the DateTime from\n   * @param {number} obj.year - a year, such as 1987\n   * @param {number} obj.month - a month, 1-12\n   * @param {number} obj.day - a day of the month, 1-31, depending on the month\n   * @param {number} obj.ordinal - day of the year, 1-365 or 366\n   * @param {number} obj.weekYear - an ISO week year\n   * @param {number} obj.weekNumber - an ISO week number, between 1 and 52 or 53, depending on the year\n   * @param {number} obj.weekday - an ISO weekday, 1-7, where 1 is Monday and 7 is Sunday\n   * @param {number} obj.localWeekYear - a week year, according to the locale\n   * @param {number} obj.localWeekNumber - a week number, between 1 and 52 or 53, depending on the year, according to the locale\n   * @param {number} obj.localWeekday - a weekday, 1-7, where 1 is the first and 7 is the last day of the week, according to the locale\n   * @param {number} obj.hour - hour of the day, 0-23\n   * @param {number} obj.minute - minute of the hour, 0-59\n   * @param {number} obj.second - second of the minute, 0-59\n   * @param {number} obj.millisecond - millisecond of the second, 0-999\n   * @param {Object} opts - options for creating this DateTime\n   * @param {string|Zone} [opts.zone='local'] - interpret the numbers in the context of a particular zone. Can take any value taken as the first argument to setZone()\n   * @param {string} [opts.locale='system\\'s locale'] - a locale to set on the resulting DateTime instance\n   * @param {string} opts.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @param {string} opts.numberingSystem - the numbering system to set on the resulting DateTime instance\n   * @example DateTime.fromObject({ year: 1982, month: 5, day: 25}).toISODate() //=> '1982-05-25'\n   * @example DateTime.fromObject({ year: 1982 }).toISODate() //=> '1982-01-01'\n   * @example DateTime.fromObject({ hour: 10, minute: 26, second: 6 }) //~> today at 10:26:06\n   * @example DateTime.fromObject({ hour: 10, minute: 26, second: 6 }, { zone: 'utc' }),\n   * @example DateTime.fromObject({ hour: 10, minute: 26, second: 6 }, { zone: 'local' })\n   * @example DateTime.fromObject({ hour: 10, minute: 26, second: 6 }, { zone: 'America/New_York' })\n   * @example DateTime.fromObject({ weekYear: 2016, weekNumber: 2, weekday: 3 }).toISODate() //=> '2016-01-13'\n   * @example DateTime.fromObject({ localWeekYear: 2022, localWeekNumber: 1, localWeekday: 1 }, { locale: \"en-US\" }).toISODate() //=> '2021-12-26'\n   * @return {DateTime}\n   */\n  static fromObject(obj, opts = {}) {\n    obj = obj || {};\n    const zoneToUse = normalizeZone(opts.zone, Settings.defaultZone);\n    if (!zoneToUse.isValid) {\n      return DateTime.invalid(unsupportedZone(zoneToUse));\n    }\n    const loc = Locale.fromObject(opts);\n    const normalized = normalizeObject(obj, normalizeUnitWithLocalWeeks);\n    const {\n      minDaysInFirstWeek,\n      startOfWeek\n    } = usesLocalWeekValues(normalized, loc);\n    const tsNow = Settings.now(),\n      offsetProvis = !isUndefined(opts.specificOffset) ? opts.specificOffset : zoneToUse.offset(tsNow),\n      containsOrdinal = !isUndefined(normalized.ordinal),\n      containsGregorYear = !isUndefined(normalized.year),\n      containsGregorMD = !isUndefined(normalized.month) || !isUndefined(normalized.day),\n      containsGregor = containsGregorYear || containsGregorMD,\n      definiteWeekDef = normalized.weekYear || normalized.weekNumber;\n\n    // cases:\n    // just a weekday -> this week's instance of that weekday, no worries\n    // (gregorian data or ordinal) + (weekYear or weekNumber) -> error\n    // (gregorian month or day) + ordinal -> error\n    // otherwise just use weeks or ordinals or gregorian, depending on what's specified\n\n    if ((containsGregor || containsOrdinal) && definiteWeekDef) {\n      throw new ConflictingSpecificationError(\"Can't mix weekYear/weekNumber units with year/month/day or ordinals\");\n    }\n    if (containsGregorMD && containsOrdinal) {\n      throw new ConflictingSpecificationError(\"Can't mix ordinal dates with month/day\");\n    }\n    const useWeekData = definiteWeekDef || normalized.weekday && !containsGregor;\n\n    // configure ourselves to deal with gregorian dates or week stuff\n    let units,\n      defaultValues,\n      objNow = tsToObj(tsNow, offsetProvis);\n    if (useWeekData) {\n      units = orderedWeekUnits;\n      defaultValues = defaultWeekUnitValues;\n      objNow = gregorianToWeek(objNow, minDaysInFirstWeek, startOfWeek);\n    } else if (containsOrdinal) {\n      units = orderedOrdinalUnits;\n      defaultValues = defaultOrdinalUnitValues;\n      objNow = gregorianToOrdinal(objNow);\n    } else {\n      units = orderedUnits;\n      defaultValues = defaultUnitValues;\n    }\n\n    // set default values for missing stuff\n    let foundFirst = false;\n    for (const u of units) {\n      const v = normalized[u];\n      if (!isUndefined(v)) {\n        foundFirst = true;\n      } else if (foundFirst) {\n        normalized[u] = defaultValues[u];\n      } else {\n        normalized[u] = objNow[u];\n      }\n    }\n\n    // make sure the values we have are in range\n    const higherOrderInvalid = useWeekData ? hasInvalidWeekData(normalized, minDaysInFirstWeek, startOfWeek) : containsOrdinal ? hasInvalidOrdinalData(normalized) : hasInvalidGregorianData(normalized),\n      invalid = higherOrderInvalid || hasInvalidTimeData(normalized);\n    if (invalid) {\n      return DateTime.invalid(invalid);\n    }\n\n    // compute the actual time\n    const gregorian = useWeekData ? weekToGregorian(normalized, minDaysInFirstWeek, startOfWeek) : containsOrdinal ? ordinalToGregorian(normalized) : normalized,\n      [tsFinal, offsetFinal] = objToTS(gregorian, offsetProvis, zoneToUse),\n      inst = new DateTime({\n        ts: tsFinal,\n        zone: zoneToUse,\n        o: offsetFinal,\n        loc\n      });\n\n    // gregorian data + weekday serves only to validate\n    if (normalized.weekday && containsGregor && obj.weekday !== inst.weekday) {\n      return DateTime.invalid(\"mismatched weekday\", `you can't specify both a weekday of ${normalized.weekday} and a date of ${inst.toISO()}`);\n    }\n    return inst;\n  }\n\n  /**\n   * Create a DateTime from an ISO 8601 string\n   * @param {string} text - the ISO string\n   * @param {Object} opts - options to affect the creation\n   * @param {string|Zone} [opts.zone='local'] - use this zone if no offset is specified in the input string itself. Will also convert the time to this zone\n   * @param {boolean} [opts.setZone=false] - override the zone with a fixed-offset zone specified in the string itself, if it specifies one\n   * @param {string} [opts.locale='system's locale'] - a locale to set on the resulting DateTime instance\n   * @param {string} [opts.outputCalendar] - the output calendar to set on the resulting DateTime instance\n   * @param {string} [opts.numberingSystem] - the numbering system to set on the resulting DateTime instance\n   * @example DateTime.fromISO('2016-05-25T09:08:34.123')\n   * @example DateTime.fromISO('2016-05-25T09:08:34.123+06:00')\n   * @example DateTime.fromISO('2016-05-25T09:08:34.123+06:00', {setZone: true})\n   * @example DateTime.fromISO('2016-05-25T09:08:34.123', {zone: 'utc'})\n   * @example DateTime.fromISO('2016-W05-4')\n   * @return {DateTime}\n   */\n  static fromISO(text, opts = {}) {\n    const [vals, parsedZone] = parseISODate(text);\n    return parseDataToDateTime(vals, parsedZone, opts, \"ISO 8601\", text);\n  }\n\n  /**\n   * Create a DateTime from an RFC 2822 string\n   * @param {string} text - the RFC 2822 string\n   * @param {Object} opts - options to affect the creation\n   * @param {string|Zone} [opts.zone='local'] - convert the time to this zone. Since the offset is always specified in the string itself, this has no effect on the interpretation of string, merely the zone the resulting DateTime is expressed in.\n   * @param {boolean} [opts.setZone=false] - override the zone with a fixed-offset zone specified in the string itself, if it specifies one\n   * @param {string} [opts.locale='system's locale'] - a locale to set on the resulting DateTime instance\n   * @param {string} opts.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @param {string} opts.numberingSystem - the numbering system to set on the resulting DateTime instance\n   * @example DateTime.fromRFC2822('25 Nov 2016 13:23:12 GMT')\n   * @example DateTime.fromRFC2822('Fri, 25 Nov 2016 13:23:12 +0600')\n   * @example DateTime.fromRFC2822('25 Nov 2016 13:23 Z')\n   * @return {DateTime}\n   */\n  static fromRFC2822(text, opts = {}) {\n    const [vals, parsedZone] = parseRFC2822Date(text);\n    return parseDataToDateTime(vals, parsedZone, opts, \"RFC 2822\", text);\n  }\n\n  /**\n   * Create a DateTime from an HTTP header date\n   * @see https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.3.1\n   * @param {string} text - the HTTP header date\n   * @param {Object} opts - options to affect the creation\n   * @param {string|Zone} [opts.zone='local'] - convert the time to this zone. Since HTTP dates are always in UTC, this has no effect on the interpretation of string, merely the zone the resulting DateTime is expressed in.\n   * @param {boolean} [opts.setZone=false] - override the zone with the fixed-offset zone specified in the string. For HTTP dates, this is always UTC, so this option is equivalent to setting the `zone` option to 'utc', but this option is included for consistency with similar methods.\n   * @param {string} [opts.locale='system's locale'] - a locale to set on the resulting DateTime instance\n   * @param {string} opts.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @param {string} opts.numberingSystem - the numbering system to set on the resulting DateTime instance\n   * @example DateTime.fromHTTP('Sun, 06 Nov 1994 08:49:37 GMT')\n   * @example DateTime.fromHTTP('Sunday, 06-Nov-94 08:49:37 GMT')\n   * @example DateTime.fromHTTP('Sun Nov  6 08:49:37 1994')\n   * @return {DateTime}\n   */\n  static fromHTTP(text, opts = {}) {\n    const [vals, parsedZone] = parseHTTPDate(text);\n    return parseDataToDateTime(vals, parsedZone, opts, \"HTTP\", opts);\n  }\n\n  /**\n   * Create a DateTime from an input string and format string.\n   * Defaults to en-US if no locale has been specified, regardless of the system's locale. For a table of tokens and their interpretations, see [here](https://moment.github.io/luxon/#/parsing?id=table-of-tokens).\n   * @param {string} text - the string to parse\n   * @param {string} fmt - the format the string is expected to be in (see the link below for the formats)\n   * @param {Object} opts - options to affect the creation\n   * @param {string|Zone} [opts.zone='local'] - use this zone if no offset is specified in the input string itself. Will also convert the DateTime to this zone\n   * @param {boolean} [opts.setZone=false] - override the zone with a zone specified in the string itself, if it specifies one\n   * @param {string} [opts.locale='en-US'] - a locale string to use when parsing. Will also set the DateTime to this locale\n   * @param {string} opts.numberingSystem - the numbering system to use when parsing. Will also set the resulting DateTime to this numbering system\n   * @param {string} opts.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @return {DateTime}\n   */\n  static fromFormat(text, fmt, opts = {}) {\n    if (isUndefined(text) || isUndefined(fmt)) {\n      throw new InvalidArgumentError(\"fromFormat requires an input string and a format\");\n    }\n    const {\n        locale = null,\n        numberingSystem = null\n      } = opts,\n      localeToUse = Locale.fromOpts({\n        locale,\n        numberingSystem,\n        defaultToEN: true\n      }),\n      [vals, parsedZone, specificOffset, invalid] = parseFromTokens(localeToUse, text, fmt);\n    if (invalid) {\n      return DateTime.invalid(invalid);\n    } else {\n      return parseDataToDateTime(vals, parsedZone, opts, `format ${fmt}`, text, specificOffset);\n    }\n  }\n\n  /**\n   * @deprecated use fromFormat instead\n   */\n  static fromString(text, fmt, opts = {}) {\n    return DateTime.fromFormat(text, fmt, opts);\n  }\n\n  /**\n   * Create a DateTime from a SQL date, time, or datetime\n   * Defaults to en-US if no locale has been specified, regardless of the system's locale\n   * @param {string} text - the string to parse\n   * @param {Object} opts - options to affect the creation\n   * @param {string|Zone} [opts.zone='local'] - use this zone if no offset is specified in the input string itself. Will also convert the DateTime to this zone\n   * @param {boolean} [opts.setZone=false] - override the zone with a zone specified in the string itself, if it specifies one\n   * @param {string} [opts.locale='en-US'] - a locale string to use when parsing. Will also set the DateTime to this locale\n   * @param {string} opts.numberingSystem - the numbering system to use when parsing. Will also set the resulting DateTime to this numbering system\n   * @param {string} opts.outputCalendar - the output calendar to set on the resulting DateTime instance\n   * @example DateTime.fromSQL('2017-05-15')\n   * @example DateTime.fromSQL('2017-05-15 09:12:34')\n   * @example DateTime.fromSQL('2017-05-15 09:12:34.342')\n   * @example DateTime.fromSQL('2017-05-15 09:12:34.342+06:00')\n   * @example DateTime.fromSQL('2017-05-15 09:12:34.342 America/Los_Angeles')\n   * @example DateTime.fromSQL('2017-05-15 09:12:34.342 America/Los_Angeles', { setZone: true })\n   * @example DateTime.fromSQL('2017-05-15 09:12:34.342', { zone: 'America/Los_Angeles' })\n   * @example DateTime.fromSQL('09:12:34.342')\n   * @return {DateTime}\n   */\n  static fromSQL(text, opts = {}) {\n    const [vals, parsedZone] = parseSQL(text);\n    return parseDataToDateTime(vals, parsedZone, opts, \"SQL\", text);\n  }\n\n  /**\n   * Create an invalid DateTime.\n   * @param {string} reason - simple string of why this DateTime is invalid. Should not contain parameters or anything else data-dependent.\n   * @param {string} [explanation=null] - longer explanation, may include parameters and other useful debugging information\n   * @return {DateTime}\n   */\n  static invalid(reason, explanation = null) {\n    if (!reason) {\n      throw new InvalidArgumentError(\"need to specify a reason the DateTime is invalid\");\n    }\n    const invalid = reason instanceof Invalid ? reason : new Invalid(reason, explanation);\n    if (Settings.throwOnInvalid) {\n      throw new InvalidDateTimeError(invalid);\n    } else {\n      return new DateTime({\n        invalid\n      });\n    }\n  }\n\n  /**\n   * Check if an object is an instance of DateTime. Works across context boundaries\n   * @param {object} o\n   * @return {boolean}\n   */\n  static isDateTime(o) {\n    return o && o.isLuxonDateTime || false;\n  }\n\n  /**\n   * Produce the format string for a set of options\n   * @param formatOpts\n   * @param localeOpts\n   * @returns {string}\n   */\n  static parseFormatForOpts(formatOpts, localeOpts = {}) {\n    const tokenList = formatOptsToTokens(formatOpts, Locale.fromObject(localeOpts));\n    return !tokenList ? null : tokenList.map(t => t ? t.val : null).join(\"\");\n  }\n\n  /**\n   * Produce the the fully expanded format token for the locale\n   * Does NOT quote characters, so quoted tokens will not round trip correctly\n   * @param fmt\n   * @param localeOpts\n   * @returns {string}\n   */\n  static expandFormat(fmt, localeOpts = {}) {\n    const expanded = expandMacroTokens(Formatter.parseFormat(fmt), Locale.fromObject(localeOpts));\n    return expanded.map(t => t.val).join(\"\");\n  }\n\n  // INFO\n\n  /**\n   * Get the value of unit.\n   * @param {string} unit - a unit such as 'minute' or 'day'\n   * @example DateTime.local(2017, 7, 4).get('month'); //=> 7\n   * @example DateTime.local(2017, 7, 4).get('day'); //=> 4\n   * @return {number}\n   */\n  get(unit) {\n    return this[unit];\n  }\n\n  /**\n   * Returns whether the DateTime is valid. Invalid DateTimes occur when:\n   * * The DateTime was created from invalid calendar information, such as the 13th month or February 30\n   * * The DateTime was created by an operation on another invalid date\n   * @type {boolean}\n   */\n  get isValid() {\n    return this.invalid === null;\n  }\n\n  /**\n   * Returns an error code if this DateTime is invalid, or null if the DateTime is valid\n   * @type {string}\n   */\n  get invalidReason() {\n    return this.invalid ? this.invalid.reason : null;\n  }\n\n  /**\n   * Returns an explanation of why this DateTime became invalid, or null if the DateTime is valid\n   * @type {string}\n   */\n  get invalidExplanation() {\n    return this.invalid ? this.invalid.explanation : null;\n  }\n\n  /**\n   * Get the locale of a DateTime, such 'en-GB'. The locale is used when formatting the DateTime\n   *\n   * @type {string}\n   */\n  get locale() {\n    return this.isValid ? this.loc.locale : null;\n  }\n\n  /**\n   * Get the numbering system of a DateTime, such 'beng'. The numbering system is used when formatting the DateTime\n   *\n   * @type {string}\n   */\n  get numberingSystem() {\n    return this.isValid ? this.loc.numberingSystem : null;\n  }\n\n  /**\n   * Get the output calendar of a DateTime, such 'islamic'. The output calendar is used when formatting the DateTime\n   *\n   * @type {string}\n   */\n  get outputCalendar() {\n    return this.isValid ? this.loc.outputCalendar : null;\n  }\n\n  /**\n   * Get the time zone associated with this DateTime.\n   * @type {Zone}\n   */\n  get zone() {\n    return this._zone;\n  }\n\n  /**\n   * Get the name of the time zone.\n   * @type {string}\n   */\n  get zoneName() {\n    return this.isValid ? this.zone.name : null;\n  }\n\n  /**\n   * Get the year\n   * @example DateTime.local(2017, 5, 25).year //=> 2017\n   * @type {number}\n   */\n  get year() {\n    return this.isValid ? this.c.year : NaN;\n  }\n\n  /**\n   * Get the quarter\n   * @example DateTime.local(2017, 5, 25).quarter //=> 2\n   * @type {number}\n   */\n  get quarter() {\n    return this.isValid ? Math.ceil(this.c.month / 3) : NaN;\n  }\n\n  /**\n   * Get the month (1-12).\n   * @example DateTime.local(2017, 5, 25).month //=> 5\n   * @type {number}\n   */\n  get month() {\n    return this.isValid ? this.c.month : NaN;\n  }\n\n  /**\n   * Get the day of the month (1-30ish).\n   * @example DateTime.local(2017, 5, 25).day //=> 25\n   * @type {number}\n   */\n  get day() {\n    return this.isValid ? this.c.day : NaN;\n  }\n\n  /**\n   * Get the hour of the day (0-23).\n   * @example DateTime.local(2017, 5, 25, 9).hour //=> 9\n   * @type {number}\n   */\n  get hour() {\n    return this.isValid ? this.c.hour : NaN;\n  }\n\n  /**\n   * Get the minute of the hour (0-59).\n   * @example DateTime.local(2017, 5, 25, 9, 30).minute //=> 30\n   * @type {number}\n   */\n  get minute() {\n    return this.isValid ? this.c.minute : NaN;\n  }\n\n  /**\n   * Get the second of the minute (0-59).\n   * @example DateTime.local(2017, 5, 25, 9, 30, 52).second //=> 52\n   * @type {number}\n   */\n  get second() {\n    return this.isValid ? this.c.second : NaN;\n  }\n\n  /**\n   * Get the millisecond of the second (0-999).\n   * @example DateTime.local(2017, 5, 25, 9, 30, 52, 654).millisecond //=> 654\n   * @type {number}\n   */\n  get millisecond() {\n    return this.isValid ? this.c.millisecond : NaN;\n  }\n\n  /**\n   * Get the week year\n   * @see https://en.wikipedia.org/wiki/ISO_week_date\n   * @example DateTime.local(2014, 12, 31).weekYear //=> 2015\n   * @type {number}\n   */\n  get weekYear() {\n    return this.isValid ? possiblyCachedWeekData(this).weekYear : NaN;\n  }\n\n  /**\n   * Get the week number of the week year (1-52ish).\n   * @see https://en.wikipedia.org/wiki/ISO_week_date\n   * @example DateTime.local(2017, 5, 25).weekNumber //=> 21\n   * @type {number}\n   */\n  get weekNumber() {\n    return this.isValid ? possiblyCachedWeekData(this).weekNumber : NaN;\n  }\n\n  /**\n   * Get the day of the week.\n   * 1 is Monday and 7 is Sunday\n   * @see https://en.wikipedia.org/wiki/ISO_week_date\n   * @example DateTime.local(2014, 11, 31).weekday //=> 4\n   * @type {number}\n   */\n  get weekday() {\n    return this.isValid ? possiblyCachedWeekData(this).weekday : NaN;\n  }\n\n  /**\n   * Returns true if this date is on a weekend according to the locale, false otherwise\n   * @returns {boolean}\n   */\n  get isWeekend() {\n    return this.isValid && this.loc.getWeekendDays().includes(this.weekday);\n  }\n\n  /**\n   * Get the day of the week according to the locale.\n   * 1 is the first day of the week and 7 is the last day of the week.\n   * If the locale assigns Sunday as the first day of the week, then a date which is a Sunday will return 1,\n   * @returns {number}\n   */\n  get localWeekday() {\n    return this.isValid ? possiblyCachedLocalWeekData(this).weekday : NaN;\n  }\n\n  /**\n   * Get the week number of the week year according to the locale. Different locales assign week numbers differently,\n   * because the week can start on different days of the week (see localWeekday) and because a different number of days\n   * is required for a week to count as the first week of a year.\n   * @returns {number}\n   */\n  get localWeekNumber() {\n    return this.isValid ? possiblyCachedLocalWeekData(this).weekNumber : NaN;\n  }\n\n  /**\n   * Get the week year according to the locale. Different locales assign week numbers (and therefor week years)\n   * differently, see localWeekNumber.\n   * @returns {number}\n   */\n  get localWeekYear() {\n    return this.isValid ? possiblyCachedLocalWeekData(this).weekYear : NaN;\n  }\n\n  /**\n   * Get the ordinal (meaning the day of the year)\n   * @example DateTime.local(2017, 5, 25).ordinal //=> 145\n   * @type {number|DateTime}\n   */\n  get ordinal() {\n    return this.isValid ? gregorianToOrdinal(this.c).ordinal : NaN;\n  }\n\n  /**\n   * Get the human readable short month name, such as 'Oct'.\n   * Defaults to the system's locale if no locale has been specified\n   * @example DateTime.local(2017, 10, 30).monthShort //=> Oct\n   * @type {string}\n   */\n  get monthShort() {\n    return this.isValid ? Info.months(\"short\", {\n      locObj: this.loc\n    })[this.month - 1] : null;\n  }\n\n  /**\n   * Get the human readable long month name, such as 'October'.\n   * Defaults to the system's locale if no locale has been specified\n   * @example DateTime.local(2017, 10, 30).monthLong //=> October\n   * @type {string}\n   */\n  get monthLong() {\n    return this.isValid ? Info.months(\"long\", {\n      locObj: this.loc\n    })[this.month - 1] : null;\n  }\n\n  /**\n   * Get the human readable short weekday, such as 'Mon'.\n   * Defaults to the system's locale if no locale has been specified\n   * @example DateTime.local(2017, 10, 30).weekdayShort //=> Mon\n   * @type {string}\n   */\n  get weekdayShort() {\n    return this.isValid ? Info.weekdays(\"short\", {\n      locObj: this.loc\n    })[this.weekday - 1] : null;\n  }\n\n  /**\n   * Get the human readable long weekday, such as 'Monday'.\n   * Defaults to the system's locale if no locale has been specified\n   * @example DateTime.local(2017, 10, 30).weekdayLong //=> Monday\n   * @type {string}\n   */\n  get weekdayLong() {\n    return this.isValid ? Info.weekdays(\"long\", {\n      locObj: this.loc\n    })[this.weekday - 1] : null;\n  }\n\n  /**\n   * Get the UTC offset of this DateTime in minutes\n   * @example DateTime.now().offset //=> -240\n   * @example DateTime.utc().offset //=> 0\n   * @type {number}\n   */\n  get offset() {\n    return this.isValid ? +this.o : NaN;\n  }\n\n  /**\n   * Get the short human name for the zone's current offset, for example \"EST\" or \"EDT\".\n   * Defaults to the system's locale if no locale has been specified\n   * @type {string}\n   */\n  get offsetNameShort() {\n    if (this.isValid) {\n      return this.zone.offsetName(this.ts, {\n        format: \"short\",\n        locale: this.locale\n      });\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Get the long human name for the zone's current offset, for example \"Eastern Standard Time\" or \"Eastern Daylight Time\".\n   * Defaults to the system's locale if no locale has been specified\n   * @type {string}\n   */\n  get offsetNameLong() {\n    if (this.isValid) {\n      return this.zone.offsetName(this.ts, {\n        format: \"long\",\n        locale: this.locale\n      });\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Get whether this zone's offset ever changes, as in a DST.\n   * @type {boolean}\n   */\n  get isOffsetFixed() {\n    return this.isValid ? this.zone.isUniversal : null;\n  }\n\n  /**\n   * Get whether the DateTime is in a DST.\n   * @type {boolean}\n   */\n  get isInDST() {\n    if (this.isOffsetFixed) {\n      return false;\n    } else {\n      return this.offset > this.set({\n        month: 1,\n        day: 1\n      }).offset || this.offset > this.set({\n        month: 5\n      }).offset;\n    }\n  }\n\n  /**\n   * Get those DateTimes which have the same local time as this DateTime, but a different offset from UTC\n   * in this DateTime's zone. During DST changes local time can be ambiguous, for example\n   * `2023-10-29T02:30:00` in `Europe/Berlin` can have offset `+01:00` or `+02:00`.\n   * This method will return both possible DateTimes if this DateTime's local time is ambiguous.\n   * @returns {DateTime[]}\n   */\n  getPossibleOffsets() {\n    if (!this.isValid || this.isOffsetFixed) {\n      return [this];\n    }\n    const dayMs = 86400000;\n    const minuteMs = 60000;\n    const localTS = objToLocalTS(this.c);\n    const oEarlier = this.zone.offset(localTS - dayMs);\n    const oLater = this.zone.offset(localTS + dayMs);\n    const o1 = this.zone.offset(localTS - oEarlier * minuteMs);\n    const o2 = this.zone.offset(localTS - oLater * minuteMs);\n    if (o1 === o2) {\n      return [this];\n    }\n    const ts1 = localTS - o1 * minuteMs;\n    const ts2 = localTS - o2 * minuteMs;\n    const c1 = tsToObj(ts1, o1);\n    const c2 = tsToObj(ts2, o2);\n    if (c1.hour === c2.hour && c1.minute === c2.minute && c1.second === c2.second && c1.millisecond === c2.millisecond) {\n      return [clone(this, {\n        ts: ts1\n      }), clone(this, {\n        ts: ts2\n      })];\n    }\n    return [this];\n  }\n\n  /**\n   * Returns true if this DateTime is in a leap year, false otherwise\n   * @example DateTime.local(2016).isInLeapYear //=> true\n   * @example DateTime.local(2013).isInLeapYear //=> false\n   * @type {boolean}\n   */\n  get isInLeapYear() {\n    return isLeapYear(this.year);\n  }\n\n  /**\n   * Returns the number of days in this DateTime's month\n   * @example DateTime.local(2016, 2).daysInMonth //=> 29\n   * @example DateTime.local(2016, 3).daysInMonth //=> 31\n   * @type {number}\n   */\n  get daysInMonth() {\n    return daysInMonth(this.year, this.month);\n  }\n\n  /**\n   * Returns the number of days in this DateTime's year\n   * @example DateTime.local(2016).daysInYear //=> 366\n   * @example DateTime.local(2013).daysInYear //=> 365\n   * @type {number}\n   */\n  get daysInYear() {\n    return this.isValid ? daysInYear(this.year) : NaN;\n  }\n\n  /**\n   * Returns the number of weeks in this DateTime's year\n   * @see https://en.wikipedia.org/wiki/ISO_week_date\n   * @example DateTime.local(2004).weeksInWeekYear //=> 53\n   * @example DateTime.local(2013).weeksInWeekYear //=> 52\n   * @type {number}\n   */\n  get weeksInWeekYear() {\n    return this.isValid ? weeksInWeekYear(this.weekYear) : NaN;\n  }\n\n  /**\n   * Returns the number of weeks in this DateTime's local week year\n   * @example DateTime.local(2020, 6, {locale: 'en-US'}).weeksInLocalWeekYear //=> 52\n   * @example DateTime.local(2020, 6, {locale: 'de-DE'}).weeksInLocalWeekYear //=> 53\n   * @type {number}\n   */\n  get weeksInLocalWeekYear() {\n    return this.isValid ? weeksInWeekYear(this.localWeekYear, this.loc.getMinDaysInFirstWeek(), this.loc.getStartOfWeek()) : NaN;\n  }\n\n  /**\n   * Returns the resolved Intl options for this DateTime.\n   * This is useful in understanding the behavior of formatting methods\n   * @param {Object} opts - the same options as toLocaleString\n   * @return {Object}\n   */\n  resolvedLocaleOptions(opts = {}) {\n    const {\n      locale,\n      numberingSystem,\n      calendar\n    } = Formatter.create(this.loc.clone(opts), opts).resolvedOptions(this);\n    return {\n      locale,\n      numberingSystem,\n      outputCalendar: calendar\n    };\n  }\n\n  // TRANSFORM\n\n  /**\n   * \"Set\" the DateTime's zone to UTC. Returns a newly-constructed DateTime.\n   *\n   * Equivalent to {@link DateTime#setZone}('utc')\n   * @param {number} [offset=0] - optionally, an offset from UTC in minutes\n   * @param {Object} [opts={}] - options to pass to `setZone()`\n   * @return {DateTime}\n   */\n  toUTC(offset = 0, opts = {}) {\n    return this.setZone(FixedOffsetZone.instance(offset), opts);\n  }\n\n  /**\n   * \"Set\" the DateTime's zone to the host's local zone. Returns a newly-constructed DateTime.\n   *\n   * Equivalent to `setZone('local')`\n   * @return {DateTime}\n   */\n  toLocal() {\n    return this.setZone(Settings.defaultZone);\n  }\n\n  /**\n   * \"Set\" the DateTime's zone to specified zone. Returns a newly-constructed DateTime.\n   *\n   * By default, the setter keeps the underlying time the same (as in, the same timestamp), but the new instance will report different local times and consider DSTs when making computations, as with {@link DateTime#plus}. You may wish to use {@link DateTime#toLocal} and {@link DateTime#toUTC} which provide simple convenience wrappers for commonly used zones.\n   * @param {string|Zone} [zone='local'] - a zone identifier. As a string, that can be any IANA zone supported by the host environment, or a fixed-offset name of the form 'UTC+3', or the strings 'local' or 'utc'. You may also supply an instance of a {@link DateTime#Zone} class.\n   * @param {Object} opts - options\n   * @param {boolean} [opts.keepLocalTime=false] - If true, adjust the underlying time so that the local time stays the same, but in the target zone. You should rarely need this.\n   * @return {DateTime}\n   */\n  setZone(zone, {\n    keepLocalTime = false,\n    keepCalendarTime = false\n  } = {}) {\n    zone = normalizeZone(zone, Settings.defaultZone);\n    if (zone.equals(this.zone)) {\n      return this;\n    } else if (!zone.isValid) {\n      return DateTime.invalid(unsupportedZone(zone));\n    } else {\n      let newTS = this.ts;\n      if (keepLocalTime || keepCalendarTime) {\n        const offsetGuess = zone.offset(this.ts);\n        const asObj = this.toObject();\n        [newTS] = objToTS(asObj, offsetGuess, zone);\n      }\n      return clone(this, {\n        ts: newTS,\n        zone\n      });\n    }\n  }\n\n  /**\n   * \"Set\" the locale, numberingSystem, or outputCalendar. Returns a newly-constructed DateTime.\n   * @param {Object} properties - the properties to set\n   * @example DateTime.local(2017, 5, 25).reconfigure({ locale: 'en-GB' })\n   * @return {DateTime}\n   */\n  reconfigure({\n    locale,\n    numberingSystem,\n    outputCalendar\n  } = {}) {\n    const loc = this.loc.clone({\n      locale,\n      numberingSystem,\n      outputCalendar\n    });\n    return clone(this, {\n      loc\n    });\n  }\n\n  /**\n   * \"Set\" the locale. Returns a newly-constructed DateTime.\n   * Just a convenient alias for reconfigure({ locale })\n   * @example DateTime.local(2017, 5, 25).setLocale('en-GB')\n   * @return {DateTime}\n   */\n  setLocale(locale) {\n    return this.reconfigure({\n      locale\n    });\n  }\n\n  /**\n   * \"Set\" the values of specified units. Returns a newly-constructed DateTime.\n   * You can only set units with this method; for \"setting\" metadata, see {@link DateTime#reconfigure} and {@link DateTime#setZone}.\n   *\n   * This method also supports setting locale-based week units, i.e. `localWeekday`, `localWeekNumber` and `localWeekYear`.\n   * They cannot be mixed with ISO-week units like `weekday`.\n   * @param {Object} values - a mapping of units to numbers\n   * @example dt.set({ year: 2017 })\n   * @example dt.set({ hour: 8, minute: 30 })\n   * @example dt.set({ weekday: 5 })\n   * @example dt.set({ year: 2005, ordinal: 234 })\n   * @return {DateTime}\n   */\n  set(values) {\n    if (!this.isValid) return this;\n    const normalized = normalizeObject(values, normalizeUnitWithLocalWeeks);\n    const {\n      minDaysInFirstWeek,\n      startOfWeek\n    } = usesLocalWeekValues(normalized, this.loc);\n    const settingWeekStuff = !isUndefined(normalized.weekYear) || !isUndefined(normalized.weekNumber) || !isUndefined(normalized.weekday),\n      containsOrdinal = !isUndefined(normalized.ordinal),\n      containsGregorYear = !isUndefined(normalized.year),\n      containsGregorMD = !isUndefined(normalized.month) || !isUndefined(normalized.day),\n      containsGregor = containsGregorYear || containsGregorMD,\n      definiteWeekDef = normalized.weekYear || normalized.weekNumber;\n    if ((containsGregor || containsOrdinal) && definiteWeekDef) {\n      throw new ConflictingSpecificationError(\"Can't mix weekYear/weekNumber units with year/month/day or ordinals\");\n    }\n    if (containsGregorMD && containsOrdinal) {\n      throw new ConflictingSpecificationError(\"Can't mix ordinal dates with month/day\");\n    }\n    let mixed;\n    if (settingWeekStuff) {\n      mixed = weekToGregorian({\n        ...gregorianToWeek(this.c, minDaysInFirstWeek, startOfWeek),\n        ...normalized\n      }, minDaysInFirstWeek, startOfWeek);\n    } else if (!isUndefined(normalized.ordinal)) {\n      mixed = ordinalToGregorian({\n        ...gregorianToOrdinal(this.c),\n        ...normalized\n      });\n    } else {\n      mixed = {\n        ...this.toObject(),\n        ...normalized\n      };\n\n      // if we didn't set the day but we ended up on an overflow date,\n      // use the last day of the right month\n      if (isUndefined(normalized.day)) {\n        mixed.day = Math.min(daysInMonth(mixed.year, mixed.month), mixed.day);\n      }\n    }\n    const [ts, o] = objToTS(mixed, this.o, this.zone);\n    return clone(this, {\n      ts,\n      o\n    });\n  }\n\n  /**\n   * Add a period of time to this DateTime and return the resulting DateTime\n   *\n   * Adding hours, minutes, seconds, or milliseconds increases the timestamp by the right number of milliseconds. Adding days, months, or years shifts the calendar, accounting for DSTs and leap years along the way. Thus, `dt.plus({ hours: 24 })` may result in a different time than `dt.plus({ days: 1 })` if there's a DST shift in between.\n   * @param {Duration|Object|number} duration - The amount to add. Either a Luxon Duration, a number of milliseconds, the object argument to Duration.fromObject()\n   * @example DateTime.now().plus(123) //~> in 123 milliseconds\n   * @example DateTime.now().plus({ minutes: 15 }) //~> in 15 minutes\n   * @example DateTime.now().plus({ days: 1 }) //~> this time tomorrow\n   * @example DateTime.now().plus({ days: -1 }) //~> this time yesterday\n   * @example DateTime.now().plus({ hours: 3, minutes: 13 }) //~> in 3 hr, 13 min\n   * @example DateTime.now().plus(Duration.fromObject({ hours: 3, minutes: 13 })) //~> in 3 hr, 13 min\n   * @return {DateTime}\n   */\n  plus(duration) {\n    if (!this.isValid) return this;\n    const dur = Duration.fromDurationLike(duration);\n    return clone(this, adjustTime(this, dur));\n  }\n\n  /**\n   * Subtract a period of time to this DateTime and return the resulting DateTime\n   * See {@link DateTime#plus}\n   * @param {Duration|Object|number} duration - The amount to subtract. Either a Luxon Duration, a number of milliseconds, the object argument to Duration.fromObject()\n   @return {DateTime}\n   */\n  minus(duration) {\n    if (!this.isValid) return this;\n    const dur = Duration.fromDurationLike(duration).negate();\n    return clone(this, adjustTime(this, dur));\n  }\n\n  /**\n   * \"Set\" this DateTime to the beginning of a unit of time.\n   * @param {string} unit - The unit to go to the beginning of. Can be 'year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', or 'millisecond'.\n   * @param {Object} opts - options\n   * @param {boolean} [opts.useLocaleWeeks=false] - If true, use weeks based on the locale, i.e. use the locale-dependent start of the week\n   * @example DateTime.local(2014, 3, 3).startOf('month').toISODate(); //=> '2014-03-01'\n   * @example DateTime.local(2014, 3, 3).startOf('year').toISODate(); //=> '2014-01-01'\n   * @example DateTime.local(2014, 3, 3).startOf('week').toISODate(); //=> '2014-03-03', weeks always start on Mondays\n   * @example DateTime.local(2014, 3, 3, 5, 30).startOf('day').toISOTime(); //=> '00:00.000-05:00'\n   * @example DateTime.local(2014, 3, 3, 5, 30).startOf('hour').toISOTime(); //=> '05:00:00.000-05:00'\n   * @return {DateTime}\n   */\n  startOf(unit, {\n    useLocaleWeeks = false\n  } = {}) {\n    if (!this.isValid) return this;\n    const o = {},\n      normalizedUnit = Duration.normalizeUnit(unit);\n    switch (normalizedUnit) {\n      case \"years\":\n        o.month = 1;\n      // falls through\n      case \"quarters\":\n      case \"months\":\n        o.day = 1;\n      // falls through\n      case \"weeks\":\n      case \"days\":\n        o.hour = 0;\n      // falls through\n      case \"hours\":\n        o.minute = 0;\n      // falls through\n      case \"minutes\":\n        o.second = 0;\n      // falls through\n      case \"seconds\":\n        o.millisecond = 0;\n        break;\n      // no default, invalid units throw in normalizeUnit()\n    }\n\n    if (normalizedUnit === \"weeks\") {\n      if (useLocaleWeeks) {\n        const startOfWeek = this.loc.getStartOfWeek();\n        const {\n          weekday\n        } = this;\n        if (weekday < startOfWeek) {\n          o.weekNumber = this.weekNumber - 1;\n        }\n        o.weekday = startOfWeek;\n      } else {\n        o.weekday = 1;\n      }\n    }\n    if (normalizedUnit === \"quarters\") {\n      const q = Math.ceil(this.month / 3);\n      o.month = (q - 1) * 3 + 1;\n    }\n    return this.set(o);\n  }\n\n  /**\n   * \"Set\" this DateTime to the end (meaning the last millisecond) of a unit of time\n   * @param {string} unit - The unit to go to the end of. Can be 'year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', or 'millisecond'.\n   * @param {Object} opts - options\n   * @param {boolean} [opts.useLocaleWeeks=false] - If true, use weeks based on the locale, i.e. use the locale-dependent start of the week\n   * @example DateTime.local(2014, 3, 3).endOf('month').toISO(); //=> '2014-03-31T23:59:59.999-05:00'\n   * @example DateTime.local(2014, 3, 3).endOf('year').toISO(); //=> '2014-12-31T23:59:59.999-05:00'\n   * @example DateTime.local(2014, 3, 3).endOf('week').toISO(); // => '2014-03-09T23:59:59.999-05:00', weeks start on Mondays\n   * @example DateTime.local(2014, 3, 3, 5, 30).endOf('day').toISO(); //=> '2014-03-03T23:59:59.999-05:00'\n   * @example DateTime.local(2014, 3, 3, 5, 30).endOf('hour').toISO(); //=> '2014-03-03T05:59:59.999-05:00'\n   * @return {DateTime}\n   */\n  endOf(unit, opts) {\n    return this.isValid ? this.plus({\n      [unit]: 1\n    }).startOf(unit, opts).minus(1) : this;\n  }\n\n  // OUTPUT\n\n  /**\n   * Returns a string representation of this DateTime formatted according to the specified format string.\n   * **You may not want this.** See {@link DateTime#toLocaleString} for a more flexible formatting tool. For a table of tokens and their interpretations, see [here](https://moment.github.io/luxon/#/formatting?id=table-of-tokens).\n   * Defaults to en-US if no locale has been specified, regardless of the system's locale.\n   * @param {string} fmt - the format string\n   * @param {Object} opts - opts to override the configuration options on this DateTime\n   * @example DateTime.now().toFormat('yyyy LLL dd') //=> '2017 Apr 22'\n   * @example DateTime.now().setLocale('fr').toFormat('yyyy LLL dd') //=> '2017 avr. 22'\n   * @example DateTime.now().toFormat('yyyy LLL dd', { locale: \"fr\" }) //=> '2017 avr. 22'\n   * @example DateTime.now().toFormat(\"HH 'hours and' mm 'minutes'\") //=> '20 hours and 55 minutes'\n   * @return {string}\n   */\n  toFormat(fmt, opts = {}) {\n    return this.isValid ? Formatter.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this, fmt) : INVALID;\n  }\n\n  /**\n   * Returns a localized string representing this date. Accepts the same options as the Intl.DateTimeFormat constructor and any presets defined by Luxon, such as `DateTime.DATE_FULL` or `DateTime.TIME_SIMPLE`.\n   * The exact behavior of this method is browser-specific, but in general it will return an appropriate representation\n   * of the DateTime in the assigned locale.\n   * Defaults to the system's locale if no locale has been specified\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat\n   * @param formatOpts {Object} - Intl.DateTimeFormat constructor options and configuration options\n   * @param {Object} opts - opts to override the configuration options on this DateTime\n   * @example DateTime.now().toLocaleString(); //=> 4/20/2017\n   * @example DateTime.now().setLocale('en-gb').toLocaleString(); //=> '20/04/2017'\n   * @example DateTime.now().toLocaleString(DateTime.DATE_FULL); //=> 'April 20, 2017'\n   * @example DateTime.now().toLocaleString(DateTime.DATE_FULL, { locale: 'fr' }); //=> '28 aot 2022'\n   * @example DateTime.now().toLocaleString(DateTime.TIME_SIMPLE); //=> '11:32 AM'\n   * @example DateTime.now().toLocaleString(DateTime.DATETIME_SHORT); //=> '4/20/2017, 11:32 AM'\n   * @example DateTime.now().toLocaleString({ weekday: 'long', month: 'long', day: '2-digit' }); //=> 'Thursday, April 20'\n   * @example DateTime.now().toLocaleString({ weekday: 'short', month: 'short', day: '2-digit', hour: '2-digit', minute: '2-digit' }); //=> 'Thu, Apr 20, 11:27 AM'\n   * @example DateTime.now().toLocaleString({ hour: '2-digit', minute: '2-digit', hourCycle: 'h23' }); //=> '11:32'\n   * @return {string}\n   */\n  toLocaleString(formatOpts = DATE_SHORT, opts = {}) {\n    return this.isValid ? Formatter.create(this.loc.clone(opts), formatOpts).formatDateTime(this) : INVALID;\n  }\n\n  /**\n   * Returns an array of format \"parts\", meaning individual tokens along with metadata. This is allows callers to post-process individual sections of the formatted output.\n   * Defaults to the system's locale if no locale has been specified\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat/formatToParts\n   * @param opts {Object} - Intl.DateTimeFormat constructor options, same as `toLocaleString`.\n   * @example DateTime.now().toLocaleParts(); //=> [\n   *                                   //=>   { type: 'day', value: '25' },\n   *                                   //=>   { type: 'literal', value: '/' },\n   *                                   //=>   { type: 'month', value: '05' },\n   *                                   //=>   { type: 'literal', value: '/' },\n   *                                   //=>   { type: 'year', value: '1982' }\n   *                                   //=> ]\n   */\n  toLocaleParts(opts = {}) {\n    return this.isValid ? Formatter.create(this.loc.clone(opts), opts).formatDateTimeParts(this) : [];\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this DateTime\n   * @param {Object} opts - options\n   * @param {boolean} [opts.suppressMilliseconds=false] - exclude milliseconds from the format if they're 0\n   * @param {boolean} [opts.suppressSeconds=false] - exclude seconds from the format if they're 0\n   * @param {boolean} [opts.includeOffset=true] - include the offset, such as 'Z' or '-04:00'\n   * @param {boolean} [opts.extendedZone=false] - add the time zone format extension\n   * @param {string} [opts.format='extended'] - choose between the basic and extended format\n   * @example DateTime.utc(1983, 5, 25).toISO() //=> '1982-05-25T00:00:00.000Z'\n   * @example DateTime.now().toISO() //=> '2017-04-22T20:47:05.335-04:00'\n   * @example DateTime.now().toISO({ includeOffset: false }) //=> '2017-04-22T20:47:05.335'\n   * @example DateTime.now().toISO({ format: 'basic' }) //=> '20170422T204705.335-0400'\n   * @return {string}\n   */\n  toISO({\n    format = \"extended\",\n    suppressSeconds = false,\n    suppressMilliseconds = false,\n    includeOffset = true,\n    extendedZone = false\n  } = {}) {\n    if (!this.isValid) {\n      return null;\n    }\n    const ext = format === \"extended\";\n    let c = toISODate(this, ext);\n    c += \"T\";\n    c += toISOTime(this, ext, suppressSeconds, suppressMilliseconds, includeOffset, extendedZone);\n    return c;\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this DateTime's date component\n   * @param {Object} opts - options\n   * @param {string} [opts.format='extended'] - choose between the basic and extended format\n   * @example DateTime.utc(1982, 5, 25).toISODate() //=> '1982-05-25'\n   * @example DateTime.utc(1982, 5, 25).toISODate({ format: 'basic' }) //=> '19820525'\n   * @return {string}\n   */\n  toISODate({\n    format = \"extended\"\n  } = {}) {\n    if (!this.isValid) {\n      return null;\n    }\n    return toISODate(this, format === \"extended\");\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this DateTime's week date\n   * @example DateTime.utc(1982, 5, 25).toISOWeekDate() //=> '1982-W21-2'\n   * @return {string}\n   */\n  toISOWeekDate() {\n    return toTechFormat(this, \"kkkk-'W'WW-c\");\n  }\n\n  /**\n   * Returns an ISO 8601-compliant string representation of this DateTime's time component\n   * @param {Object} opts - options\n   * @param {boolean} [opts.suppressMilliseconds=false] - exclude milliseconds from the format if they're 0\n   * @param {boolean} [opts.suppressSeconds=false] - exclude seconds from the format if they're 0\n   * @param {boolean} [opts.includeOffset=true] - include the offset, such as 'Z' or '-04:00'\n   * @param {boolean} [opts.extendedZone=true] - add the time zone format extension\n   * @param {boolean} [opts.includePrefix=false] - include the `T` prefix\n   * @param {string} [opts.format='extended'] - choose between the basic and extended format\n   * @example DateTime.utc().set({ hour: 7, minute: 34 }).toISOTime() //=> '07:34:19.361Z'\n   * @example DateTime.utc().set({ hour: 7, minute: 34, seconds: 0, milliseconds: 0 }).toISOTime({ suppressSeconds: true }) //=> '07:34Z'\n   * @example DateTime.utc().set({ hour: 7, minute: 34 }).toISOTime({ format: 'basic' }) //=> '073419.361Z'\n   * @example DateTime.utc().set({ hour: 7, minute: 34 }).toISOTime({ includePrefix: true }) //=> 'T07:34:19.361Z'\n   * @return {string}\n   */\n  toISOTime({\n    suppressMilliseconds = false,\n    suppressSeconds = false,\n    includeOffset = true,\n    includePrefix = false,\n    extendedZone = false,\n    format = \"extended\"\n  } = {}) {\n    if (!this.isValid) {\n      return null;\n    }\n    let c = includePrefix ? \"T\" : \"\";\n    return c + toISOTime(this, format === \"extended\", suppressSeconds, suppressMilliseconds, includeOffset, extendedZone);\n  }\n\n  /**\n   * Returns an RFC 2822-compatible string representation of this DateTime\n   * @example DateTime.utc(2014, 7, 13).toRFC2822() //=> 'Sun, 13 Jul 2014 00:00:00 +0000'\n   * @example DateTime.local(2014, 7, 13).toRFC2822() //=> 'Sun, 13 Jul 2014 00:00:00 -0400'\n   * @return {string}\n   */\n  toRFC2822() {\n    return toTechFormat(this, \"EEE, dd LLL yyyy HH:mm:ss ZZZ\", false);\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for use in HTTP headers. The output is always expressed in GMT.\n   * Specifically, the string conforms to RFC 1123.\n   * @see https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.3.1\n   * @example DateTime.utc(2014, 7, 13).toHTTP() //=> 'Sun, 13 Jul 2014 00:00:00 GMT'\n   * @example DateTime.utc(2014, 7, 13, 19).toHTTP() //=> 'Sun, 13 Jul 2014 19:00:00 GMT'\n   * @return {string}\n   */\n  toHTTP() {\n    return toTechFormat(this.toUTC(), \"EEE, dd LLL yyyy HH:mm:ss 'GMT'\");\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for use in SQL Date\n   * @example DateTime.utc(2014, 7, 13).toSQLDate() //=> '2014-07-13'\n   * @return {string}\n   */\n  toSQLDate() {\n    if (!this.isValid) {\n      return null;\n    }\n    return toISODate(this, true);\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for use in SQL Time\n   * @param {Object} opts - options\n   * @param {boolean} [opts.includeZone=false] - include the zone, such as 'America/New_York'. Overrides includeOffset.\n   * @param {boolean} [opts.includeOffset=true] - include the offset, such as 'Z' or '-04:00'\n   * @param {boolean} [opts.includeOffsetSpace=true] - include the space between the time and the offset, such as '05:15:16.345 -04:00'\n   * @example DateTime.utc().toSQL() //=> '05:15:16.345'\n   * @example DateTime.now().toSQL() //=> '05:15:16.345 -04:00'\n   * @example DateTime.now().toSQL({ includeOffset: false }) //=> '05:15:16.345'\n   * @example DateTime.now().toSQL({ includeZone: false }) //=> '05:15:16.345 America/New_York'\n   * @return {string}\n   */\n  toSQLTime({\n    includeOffset = true,\n    includeZone = false,\n    includeOffsetSpace = true\n  } = {}) {\n    let fmt = \"HH:mm:ss.SSS\";\n    if (includeZone || includeOffset) {\n      if (includeOffsetSpace) {\n        fmt += \" \";\n      }\n      if (includeZone) {\n        fmt += \"z\";\n      } else if (includeOffset) {\n        fmt += \"ZZ\";\n      }\n    }\n    return toTechFormat(this, fmt, true);\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for use in SQL DateTime\n   * @param {Object} opts - options\n   * @param {boolean} [opts.includeZone=false] - include the zone, such as 'America/New_York'. Overrides includeOffset.\n   * @param {boolean} [opts.includeOffset=true] - include the offset, such as 'Z' or '-04:00'\n   * @param {boolean} [opts.includeOffsetSpace=true] - include the space between the time and the offset, such as '05:15:16.345 -04:00'\n   * @example DateTime.utc(2014, 7, 13).toSQL() //=> '2014-07-13 00:00:00.000 Z'\n   * @example DateTime.local(2014, 7, 13).toSQL() //=> '2014-07-13 00:00:00.000 -04:00'\n   * @example DateTime.local(2014, 7, 13).toSQL({ includeOffset: false }) //=> '2014-07-13 00:00:00.000'\n   * @example DateTime.local(2014, 7, 13).toSQL({ includeZone: true }) //=> '2014-07-13 00:00:00.000 America/New_York'\n   * @return {string}\n   */\n  toSQL(opts = {}) {\n    if (!this.isValid) {\n      return null;\n    }\n    return `${this.toSQLDate()} ${this.toSQLTime(opts)}`;\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for debugging\n   * @return {string}\n   */\n  toString() {\n    return this.isValid ? this.toISO() : INVALID;\n  }\n\n  /**\n   * Returns a string representation of this DateTime appropriate for the REPL.\n   * @return {string}\n   */\n  [Symbol.for(\"nodejs.util.inspect.custom\")]() {\n    if (this.isValid) {\n      return `DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`;\n    } else {\n      return `DateTime { Invalid, reason: ${this.invalidReason} }`;\n    }\n  }\n\n  /**\n   * Returns the epoch milliseconds of this DateTime. Alias of {@link DateTime#toMillis}\n   * @return {number}\n   */\n  valueOf() {\n    return this.toMillis();\n  }\n\n  /**\n   * Returns the epoch milliseconds of this DateTime.\n   * @return {number}\n   */\n  toMillis() {\n    return this.isValid ? this.ts : NaN;\n  }\n\n  /**\n   * Returns the epoch seconds of this DateTime.\n   * @return {number}\n   */\n  toSeconds() {\n    return this.isValid ? this.ts / 1000 : NaN;\n  }\n\n  /**\n   * Returns the epoch seconds (as a whole number) of this DateTime.\n   * @return {number}\n   */\n  toUnixInteger() {\n    return this.isValid ? Math.floor(this.ts / 1000) : NaN;\n  }\n\n  /**\n   * Returns an ISO 8601 representation of this DateTime appropriate for use in JSON.\n   * @return {string}\n   */\n  toJSON() {\n    return this.toISO();\n  }\n\n  /**\n   * Returns a BSON serializable equivalent to this DateTime.\n   * @return {Date}\n   */\n  toBSON() {\n    return this.toJSDate();\n  }\n\n  /**\n   * Returns a JavaScript object with this DateTime's year, month, day, and so on.\n   * @param opts - options for generating the object\n   * @param {boolean} [opts.includeConfig=false] - include configuration attributes in the output\n   * @example DateTime.now().toObject() //=> { year: 2017, month: 4, day: 22, hour: 20, minute: 49, second: 42, millisecond: 268 }\n   * @return {Object}\n   */\n  toObject(opts = {}) {\n    if (!this.isValid) return {};\n    const base = {\n      ...this.c\n    };\n    if (opts.includeConfig) {\n      base.outputCalendar = this.outputCalendar;\n      base.numberingSystem = this.loc.numberingSystem;\n      base.locale = this.loc.locale;\n    }\n    return base;\n  }\n\n  /**\n   * Returns a JavaScript Date equivalent to this DateTime.\n   * @return {Date}\n   */\n  toJSDate() {\n    return new Date(this.isValid ? this.ts : NaN);\n  }\n\n  // COMPARE\n\n  /**\n   * Return the difference between two DateTimes as a Duration.\n   * @param {DateTime} otherDateTime - the DateTime to compare this one to\n   * @param {string|string[]} [unit=['milliseconds']] - the unit or array of units (such as 'hours' or 'days') to include in the duration.\n   * @param {Object} opts - options that affect the creation of the Duration\n   * @param {string} [opts.conversionAccuracy='casual'] - the conversion system to use\n   * @example\n   * var i1 = DateTime.fromISO('1982-05-25T09:45'),\n   *     i2 = DateTime.fromISO('1983-10-14T10:30');\n   * i2.diff(i1).toObject() //=> { milliseconds: 43807500000 }\n   * i2.diff(i1, 'hours').toObject() //=> { hours: 12168.75 }\n   * i2.diff(i1, ['months', 'days']).toObject() //=> { months: 16, days: 19.03125 }\n   * i2.diff(i1, ['months', 'days', 'hours']).toObject() //=> { months: 16, days: 19, hours: 0.75 }\n   * @return {Duration}\n   */\n  diff(otherDateTime, unit = \"milliseconds\", opts = {}) {\n    if (!this.isValid || !otherDateTime.isValid) {\n      return Duration.invalid(\"created by diffing an invalid DateTime\");\n    }\n    const durOpts = {\n      locale: this.locale,\n      numberingSystem: this.numberingSystem,\n      ...opts\n    };\n    const units = maybeArray(unit).map(Duration.normalizeUnit),\n      otherIsLater = otherDateTime.valueOf() > this.valueOf(),\n      earlier = otherIsLater ? this : otherDateTime,\n      later = otherIsLater ? otherDateTime : this,\n      diffed = diff(earlier, later, units, durOpts);\n    return otherIsLater ? diffed.negate() : diffed;\n  }\n\n  /**\n   * Return the difference between this DateTime and right now.\n   * See {@link DateTime#diff}\n   * @param {string|string[]} [unit=['milliseconds']] - the unit or units units (such as 'hours' or 'days') to include in the duration\n   * @param {Object} opts - options that affect the creation of the Duration\n   * @param {string} [opts.conversionAccuracy='casual'] - the conversion system to use\n   * @return {Duration}\n   */\n  diffNow(unit = \"milliseconds\", opts = {}) {\n    return this.diff(DateTime.now(), unit, opts);\n  }\n\n  /**\n   * Return an Interval spanning between this DateTime and another DateTime\n   * @param {DateTime} otherDateTime - the other end point of the Interval\n   * @return {Interval}\n   */\n  until(otherDateTime) {\n    return this.isValid ? Interval.fromDateTimes(this, otherDateTime) : this;\n  }\n\n  /**\n   * Return whether this DateTime is in the same unit of time as another DateTime.\n   * Higher-order units must also be identical for this function to return `true`.\n   * Note that time zones are **ignored** in this comparison, which compares the **local** calendar time. Use {@link DateTime#setZone} to convert one of the dates if needed.\n   * @param {DateTime} otherDateTime - the other DateTime\n   * @param {string} unit - the unit of time to check sameness on\n   * @param {Object} opts - options\n   * @param {boolean} [opts.useLocaleWeeks=false] - If true, use weeks based on the locale, i.e. use the locale-dependent start of the week; only the locale of this DateTime is used\n   * @example DateTime.now().hasSame(otherDT, 'day'); //~> true if otherDT is in the same current calendar day\n   * @return {boolean}\n   */\n  hasSame(otherDateTime, unit, opts) {\n    if (!this.isValid) return false;\n    const inputMs = otherDateTime.valueOf();\n    const adjustedToZone = this.setZone(otherDateTime.zone, {\n      keepLocalTime: true\n    });\n    return adjustedToZone.startOf(unit, opts) <= inputMs && inputMs <= adjustedToZone.endOf(unit, opts);\n  }\n\n  /**\n   * Equality check\n   * Two DateTimes are equal if and only if they represent the same millisecond, have the same zone and location, and are both valid.\n   * To compare just the millisecond values, use `+dt1 === +dt2`.\n   * @param {DateTime} other - the other DateTime\n   * @return {boolean}\n   */\n  equals(other) {\n    return this.isValid && other.isValid && this.valueOf() === other.valueOf() && this.zone.equals(other.zone) && this.loc.equals(other.loc);\n  }\n\n  /**\n   * Returns a string representation of a this time relative to now, such as \"in two days\". Can only internationalize if your\n   * platform supports Intl.RelativeTimeFormat. Rounds down by default.\n   * @param {Object} options - options that affect the output\n   * @param {DateTime} [options.base=DateTime.now()] - the DateTime to use as the basis to which this time is compared. Defaults to now.\n   * @param {string} [options.style=\"long\"] - the style of units, must be \"long\", \"short\", or \"narrow\"\n   * @param {string|string[]} options.unit - use a specific unit or array of units; if omitted, or an array, the method will pick the best unit. Use an array or one of \"years\", \"quarters\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\", or \"seconds\"\n   * @param {boolean} [options.round=true] - whether to round the numbers in the output.\n   * @param {number} [options.padding=0] - padding in milliseconds. This allows you to round up the result if it fits inside the threshold. Don't use in combination with {round: false} because the decimal output will include the padding.\n   * @param {string} options.locale - override the locale of this DateTime\n   * @param {string} options.numberingSystem - override the numberingSystem of this DateTime. The Intl system may choose not to honor this\n   * @example DateTime.now().plus({ days: 1 }).toRelative() //=> \"in 1 day\"\n   * @example DateTime.now().setLocale(\"es\").toRelative({ days: 1 }) //=> \"dentro de 1 da\"\n   * @example DateTime.now().plus({ days: 1 }).toRelative({ locale: \"fr\" }) //=> \"dans 23 heures\"\n   * @example DateTime.now().minus({ days: 2 }).toRelative() //=> \"2 days ago\"\n   * @example DateTime.now().minus({ days: 2 }).toRelative({ unit: \"hours\" }) //=> \"48 hours ago\"\n   * @example DateTime.now().minus({ hours: 36 }).toRelative({ round: false }) //=> \"1.5 days ago\"\n   */\n  toRelative(options = {}) {\n    if (!this.isValid) return null;\n    const base = options.base || DateTime.fromObject({}, {\n        zone: this.zone\n      }),\n      padding = options.padding ? this < base ? -options.padding : options.padding : 0;\n    let units = [\"years\", \"months\", \"days\", \"hours\", \"minutes\", \"seconds\"];\n    let unit = options.unit;\n    if (Array.isArray(options.unit)) {\n      units = options.unit;\n      unit = undefined;\n    }\n    return diffRelative(base, this.plus(padding), {\n      ...options,\n      numeric: \"always\",\n      units,\n      unit\n    });\n  }\n\n  /**\n   * Returns a string representation of this date relative to today, such as \"yesterday\" or \"next month\".\n   * Only internationalizes on platforms that supports Intl.RelativeTimeFormat.\n   * @param {Object} options - options that affect the output\n   * @param {DateTime} [options.base=DateTime.now()] - the DateTime to use as the basis to which this time is compared. Defaults to now.\n   * @param {string} options.locale - override the locale of this DateTime\n   * @param {string} options.unit - use a specific unit; if omitted, the method will pick the unit. Use one of \"years\", \"quarters\", \"months\", \"weeks\", or \"days\"\n   * @param {string} options.numberingSystem - override the numberingSystem of this DateTime. The Intl system may choose not to honor this\n   * @example DateTime.now().plus({ days: 1 }).toRelativeCalendar() //=> \"tomorrow\"\n   * @example DateTime.now().setLocale(\"es\").plus({ days: 1 }).toRelative() //=> \"\"maana\"\n   * @example DateTime.now().plus({ days: 1 }).toRelativeCalendar({ locale: \"fr\" }) //=> \"demain\"\n   * @example DateTime.now().minus({ days: 2 }).toRelativeCalendar() //=> \"2 days ago\"\n   */\n  toRelativeCalendar(options = {}) {\n    if (!this.isValid) return null;\n    return diffRelative(options.base || DateTime.fromObject({}, {\n      zone: this.zone\n    }), this, {\n      ...options,\n      numeric: \"auto\",\n      units: [\"years\", \"months\", \"days\"],\n      calendary: true\n    });\n  }\n\n  /**\n   * Return the min of several date times\n   * @param {...DateTime} dateTimes - the DateTimes from which to choose the minimum\n   * @return {DateTime} the min DateTime, or undefined if called with no argument\n   */\n  static min(...dateTimes) {\n    if (!dateTimes.every(DateTime.isDateTime)) {\n      throw new InvalidArgumentError(\"min requires all arguments be DateTimes\");\n    }\n    return bestBy(dateTimes, i => i.valueOf(), Math.min);\n  }\n\n  /**\n   * Return the max of several date times\n   * @param {...DateTime} dateTimes - the DateTimes from which to choose the maximum\n   * @return {DateTime} the max DateTime, or undefined if called with no argument\n   */\n  static max(...dateTimes) {\n    if (!dateTimes.every(DateTime.isDateTime)) {\n      throw new InvalidArgumentError(\"max requires all arguments be DateTimes\");\n    }\n    return bestBy(dateTimes, i => i.valueOf(), Math.max);\n  }\n\n  // MISC\n\n  /**\n   * Explain how a string would be parsed by fromFormat()\n   * @param {string} text - the string to parse\n   * @param {string} fmt - the format the string is expected to be in (see description)\n   * @param {Object} options - options taken by fromFormat()\n   * @return {Object}\n   */\n  static fromFormatExplain(text, fmt, options = {}) {\n    const {\n        locale = null,\n        numberingSystem = null\n      } = options,\n      localeToUse = Locale.fromOpts({\n        locale,\n        numberingSystem,\n        defaultToEN: true\n      });\n    return explainFromTokens(localeToUse, text, fmt);\n  }\n\n  /**\n   * @deprecated use fromFormatExplain instead\n   */\n  static fromStringExplain(text, fmt, options = {}) {\n    return DateTime.fromFormatExplain(text, fmt, options);\n  }\n\n  // FORMAT PRESETS\n\n  /**\n   * {@link DateTime#toLocaleString} format like 10/14/1983\n   * @type {Object}\n   */\n  static get DATE_SHORT() {\n    return DATE_SHORT;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Oct 14, 1983'\n   * @type {Object}\n   */\n  static get DATE_MED() {\n    return DATE_MED;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Fri, Oct 14, 1983'\n   * @type {Object}\n   */\n  static get DATE_MED_WITH_WEEKDAY() {\n    return DATE_MED_WITH_WEEKDAY;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'October 14, 1983'\n   * @type {Object}\n   */\n  static get DATE_FULL() {\n    return DATE_FULL;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Tuesday, October 14, 1983'\n   * @type {Object}\n   */\n  static get DATE_HUGE() {\n    return DATE_HUGE;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get TIME_SIMPLE() {\n    return TIME_SIMPLE;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get TIME_WITH_SECONDS() {\n    return TIME_WITH_SECONDS;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23 AM EDT'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get TIME_WITH_SHORT_OFFSET() {\n    return TIME_WITH_SHORT_OFFSET;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23 AM Eastern Daylight Time'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get TIME_WITH_LONG_OFFSET() {\n    return TIME_WITH_LONG_OFFSET;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30', always 24-hour.\n   * @type {Object}\n   */\n  static get TIME_24_SIMPLE() {\n    return TIME_24_SIMPLE;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23', always 24-hour.\n   * @type {Object}\n   */\n  static get TIME_24_WITH_SECONDS() {\n    return TIME_24_WITH_SECONDS;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23 EDT', always 24-hour.\n   * @type {Object}\n   */\n  static get TIME_24_WITH_SHORT_OFFSET() {\n    return TIME_24_WITH_SHORT_OFFSET;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '09:30:23 Eastern Daylight Time', always 24-hour.\n   * @type {Object}\n   */\n  static get TIME_24_WITH_LONG_OFFSET() {\n    return TIME_24_WITH_LONG_OFFSET;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '10/14/1983, 9:30 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_SHORT() {\n    return DATETIME_SHORT;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like '10/14/1983, 9:30:33 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_SHORT_WITH_SECONDS() {\n    return DATETIME_SHORT_WITH_SECONDS;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Oct 14, 1983, 9:30 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_MED() {\n    return DATETIME_MED;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Oct 14, 1983, 9:30:33 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_MED_WITH_SECONDS() {\n    return DATETIME_MED_WITH_SECONDS;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Fri, 14 Oct 1983, 9:30 AM'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_MED_WITH_WEEKDAY() {\n    return DATETIME_MED_WITH_WEEKDAY;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'October 14, 1983, 9:30 AM EDT'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_FULL() {\n    return DATETIME_FULL;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'October 14, 1983, 9:30:33 AM EDT'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_FULL_WITH_SECONDS() {\n    return DATETIME_FULL_WITH_SECONDS;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Friday, October 14, 1983, 9:30 AM Eastern Daylight Time'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_HUGE() {\n    return DATETIME_HUGE;\n  }\n\n  /**\n   * {@link DateTime#toLocaleString} format like 'Friday, October 14, 1983, 9:30:33 AM Eastern Daylight Time'. Only 12-hour if the locale is.\n   * @type {Object}\n   */\n  static get DATETIME_HUGE_WITH_SECONDS() {\n    return DATETIME_HUGE_WITH_SECONDS;\n  }\n}\n\n/**\n * @private\n */\nfunction friendlyDateTime(dateTimeish) {\n  if (DateTime.isDateTime(dateTimeish)) {\n    return dateTimeish;\n  } else if (dateTimeish && dateTimeish.valueOf && isNumber(dateTimeish.valueOf())) {\n    return DateTime.fromJSDate(dateTimeish);\n  } else if (dateTimeish && typeof dateTimeish === \"object\") {\n    return DateTime.fromObject(dateTimeish);\n  } else {\n    throw new InvalidArgumentError(`Unknown datetime argument: ${dateTimeish}, of type ${typeof dateTimeish}`);\n  }\n}\n\nconst VERSION = \"3.4.4\";\n\nexports.DateTime = DateTime;\nexports.Duration = Duration;\nexports.FixedOffsetZone = FixedOffsetZone;\nexports.IANAZone = IANAZone;\nexports.Info = Info;\nexports.Interval = Interval;\nexports.InvalidZone = InvalidZone;\nexports.Settings = Settings;\nexports.SystemZone = SystemZone;\nexports.VERSION = VERSION;\nexports.Zone = Zone;\n//# sourceMappingURL=luxon.js.map\n","export interface ArmyStatistic {\n    level: number;\n    scouting: number;\n    standardDC: number;\n    ac: number;\n    highSave: number;\n    lowSave: number;\n    attack: number;\n    maximumTactics: number;\n}\n\nconst allArmyStatistics: ArmyStatistic[] = [\n    {level: 1, scouting: 7, standardDC: 15, ac: 16, highSave: 10, lowSave: 4, attack: 9, maximumTactics: 1},\n    {level: 2, scouting: 8, standardDC: 16, ac: 18, highSave: 11, lowSave: 5, attack: 11, maximumTactics: 1},\n    {level: 3, scouting: 9, standardDC: 18, ac: 19, highSave: 12, lowSave: 6, attack: 12, maximumTactics: 1},\n    {level: 4, scouting: 11, standardDC: 19, ac: 21, highSave: 14, lowSave: 8, attack: 14, maximumTactics: 2},\n    {level: 5, scouting: 12, standardDC: 20, ac: 22, highSave: 15, lowSave: 9, attack: 15, maximumTactics: 2},\n    {level: 6, scouting: 14, standardDC: 22, ac: 24, highSave: 17, lowSave: 11, attack: 17, maximumTactics: 2},\n    {level: 7, scouting: 15, standardDC: 23, ac: 25, highSave: 18, lowSave: 12, attack: 18, maximumTactics: 2},\n    {level: 8, scouting: 16, standardDC: 24, ac: 27, highSave: 19, lowSave: 13, attack: 20, maximumTactics: 3},\n    {level: 9, scouting: 18, standardDC: 26, ac: 28, highSave: 21, lowSave: 15, attack: 21, maximumTactics: 3},\n    {level: 10, scouting: 19, standardDC: 27, ac: 30, highSave: 22, lowSave: 16, attack: 23, maximumTactics: 3},\n    {level: 11, scouting: 21, standardDC: 28, ac: 31, highSave: 24, lowSave: 18, attack: 24, maximumTactics: 3},\n    {level: 12, scouting: 22, standardDC: 30, ac: 33, highSave: 25, lowSave: 19, attack: 26, maximumTactics: 4},\n    {level: 13, scouting: 23, standardDC: 31, ac: 34, highSave: 26, lowSave: 20, attack: 27, maximumTactics: 4},\n    {level: 14, scouting: 25, standardDC: 32, ac: 36, highSave: 28, lowSave: 22, attack: 29, maximumTactics: 4},\n    {level: 15, scouting: 26, standardDC: 34, ac: 37, highSave: 29, lowSave: 23, attack: 30, maximumTactics: 4},\n    {level: 16, scouting: 28, standardDC: 35, ac: 39, highSave: 30, lowSave: 25, attack: 32, maximumTactics: 5},\n    {level: 17, scouting: 29, standardDC: 36, ac: 40, highSave: 32, lowSave: 26, attack: 33, maximumTactics: 5},\n    {level: 18, scouting: 30, standardDC: 38, ac: 42, highSave: 33, lowSave: 27, attack: 35, maximumTactics: 5},\n    {level: 19, scouting: 32, standardDC: 39, ac: 43, highSave: 35, lowSave: 29, attack: 36, maximumTactics: 5},\n    {level: 20, scouting: 33, standardDC: 40, ac: 45, highSave: 36, lowSave: 30, attack: 38, maximumTactics: 6},\n];\n\nexport const armyStatisticsByLevel: Map<number, ArmyStatistic> = new Map<number, ArmyStatistic>();\nallArmyStatistics.forEach(army => armyStatisticsByLevel.set(army.level, army));\n\nexport interface ArmyAdjustments {\n    scouting: number;\n    recruitmentDC: number;\n    ac: number;\n    melee: number;\n    ranged: number;\n    morale: number;\n    maneuver: number;\n    highSave: 'maneuver' | 'morale';\n    ammunition: number;\n}\n\n","import {parseCheckbox, parseSelect} from '../../utils';\n\nexport interface ArmySetupOptions {\n    actor: Actor;\n    onConfirm: (additionalUuids: string[], type: string) => Promise<void>;\n}\n\nexport function armySetupDialog(options: ArmySetupOptions): void {\n    new Dialog({\n        title: `Enable Army: ${options.actor.name}`,\n        content: `\n        <p>Do you want to turn actor ${options.actor.name} into an army? If so, you need \n        to manually create its attacks. After this dialog, change into its inventory and click on the \n        <i class=\"fa-solid fa-bolt fa-fw\"></i> next to its weapon.</p>\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-army-type\">Army Type:</label>\n                <select name=\"type\" id=\"km-army-type\">\n                    <option value=\"Infantry\">Infantry</option>\n                    <option value=\"Skirmisher\">Skirmisher</option>\n                    <option value=\"Cavalry\">Cavalry</option>\n                    <option value=\"Siege\">Siege</option>\n                </select>\n            </div>\n            <div>\n                <label for=\"km-army-weapon-type-melee\">Melee Weapons?</label>\n                <input type=\"checkbox\" name=\"weapon-type-melee\" id=\"km-army-weapon-type-melee\">\n            </div>\n            <div>\n                <label for=\"km-army-weapon-type-ranged\">Ranged Weapons?</label>\n                <input type=\"checkbox\" name=\"weapon-type-ranged\" id=\"km-army-weapon-type-ranged\">\n            </div>\n        </form>\n        `,\n        buttons: {\n            no: {\n                icon: '<i class=\"fa-solid fa-cancel\"></i>',\n                label: 'No',\n                callback: async (): Promise<void> => {\n                },\n            },\n            yes: {\n                icon: '<i class=\"fa-solid fa-check\"></i>',\n                label: 'Yes',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const type = parseSelect($html, 'type');\n                    const weaponTypeMelee = parseCheckbox($html, 'weapon-type-melee');\n                    const weaponTypeRanged = parseCheckbox($html, 'weapon-type-ranged');\n                    const uuids = [\n                        ...(weaponTypeRanged ? [\n                            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-gear.Item.osC5Z0FdEU47WAqp',\n                            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-gear.Item.UAYsXm698g1iyC2v',\n                        ] : []),\n                        ...(weaponTypeMelee ? ['Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-gear.Item.hIjD8V24RKLlIV2N'] : []),\n                    ];\n                    await options.onConfirm(uuids, type);\n                },\n            },\n        },\n        default: 'no',\n    }, {\n        jQuery: false,\n        width: 250,\n    }).render(true);\n}\n","export interface DisableArmyOptions {\n    actor: Actor;\n    onYes: () => Promise<void>;\n}\n\nexport function disableArmyDialog(options: DisableArmyOptions): void {\n    new Dialog({\n        title: `Disable Army: ${options.actor.name}`,\n        content: `\n        <p>Do you want to delete all army data and remove army sync from actor ${options.actor.name}?</p>\n        `,\n        buttons: {\n            no: {\n                icon: '<i class=\"fa-solid fa-cancel\"></i>',\n                label: 'No',\n                callback: async (): Promise<void> => {\n                },\n            },\n            yes: {\n                icon: '<i class=\"fa-solid fa-trash\"></i>',\n                label: 'Yes',\n                callback: async (): Promise<void> => {\n                    await options.onYes();\n                },\n            },\n        },\n        default: 'no',\n    }, {\n        jQuery: false,\n        width: 250,\n    }).render(true);\n}\n","import {ArmyAdjustments} from './data';\nimport {getArmyAdjustment} from './storage';\nimport {isFirstGm} from '../utils';\nimport {addArmyStats, addAttackModifiers, calculateArmyAdjustments, syncAttackModifiers} from './utils';\nimport {CombatUpdate} from '../camping/combat-tracks';\n\nfunction onUpdateArmyLevel<T>(\n    {\n        data,\n        actor,\n        game,\n        callback,\n    }: {\n        data: Partial<Actor>;\n        actor: Actor;\n        game: Game;\n        callback: (actor: Actor, data: Partial<Actor>, level: number, adjustments: ArmyAdjustments) => T;\n    }): T | null {\n    // we're updating level so calculate new statistics\n    const level = data?.system?.details?.level?.value;\n    const adjustments = getArmyAdjustment(actor);\n    if (isFirstGm(game)\n        && actor.type === 'npc'\n        && adjustments !== undefined\n        && level !== undefined\n        && level >= 1 && level <= 20) {\n        return callback(actor, data, level, adjustments);\n    }\n    return null;\n}\n\nexport async function onPreUpdateArmy(game: Game, actor: Actor, data: Partial<Actor>): Promise<void> {\n    onUpdateArmyLevel({\n        data,\n        actor,\n        game,\n        callback: (_, data, level, adjustments): void => {\n            addArmyStats(actor, data, level, adjustments);\n        },\n    });\n}\n\nexport async function onCreateArmyItem(game: Game, item: Item): Promise<void> {\n    const actor = item.actor!;\n    const actorData = {system: {details: {level: {value: actor.system.details.level.value}}}} as Partial<Actor>;\n    onUpdateArmyLevel({\n        data: actorData,\n        actor,\n        game,\n        callback: async (actor, _, level, adjustments): Promise<void> => {\n            await addAttackModifiers(actor, item, level, adjustments);\n        },\n    });\n}\n\nexport async function onPostUpdateArmy(game: Game, actor: Actor, data: Partial<Actor>): Promise<void> {\n    await onUpdateArmyLevel({\n        data,\n        actor,\n        game,\n        callback: async (actor, _, level, adjustments): Promise<void> => {\n            await syncAttackModifiers(actor, level, adjustments);\n        },\n    });\n}\n\nexport async function updateAmmunition(game: Game, combat: StoredDocument<Combat>, update: CombatUpdate): Promise<void> {\n    if (combat.round === 0 && update.round === 1 && isFirstGm(game)) {\n        const actors = combat.combatants\n            .map(a => a.actor)\n            .filter(a => a !== null && a.type === 'npc') as Actor[];\n        for (const actor of actors) {\n            const adjustments = getArmyAdjustment(actor);\n            if (adjustments !== undefined) {\n                const ammunition = actor.itemTypes.equipment\n                    .find(item => item.name === 'Ammunition');\n                const ammunitionQuantity = calculateArmyAdjustments(actor, actor.level, adjustments).ammunition;\n                if (ammunition) {\n                    await ammunition.update({'system.quantity': ammunitionQuantity});\n                }\n            }\n        }\n    }\n}","import {calculateArmyAdjustments, getDefaultArmyAdjustment} from './utils';\nimport {getArmyAdjustment, saveArmyAdjustment} from './storage';\nimport {ArmyAdjustments} from './data';\nimport {disableArmyDialog} from './dialogs/disable';\nimport {armySetupDialog} from './dialogs/army-setup';\nimport {openJournal} from '../foundry-utils';\n\ninterface ArmyOptions {\n    game: Game;\n    actor: Actor;\n}\n\ninterface ArmyData {\n    adjustments: ArmyAdjustments;\n    actorLevel: number,\n    calculated: ArmyAdjustments;\n}\n\nclass ArmySheet extends FormApplication<FormApplicationOptions & ArmyOptions, object, null> {\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'army-app';\n        options.title = 'Army';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/army/sheet.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = ['kingmaker-tools-app', 'army-app'];\n        options.width = 450;\n        options.height = 'auto';\n        options.scrollY = ['.km-content', '.km-sidebar'];\n        return options;\n    }\n\n    private actor: Actor;\n    private readonly game: Game;\n\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & ArmyOptions) {\n        super(object, options);\n        this.game = options.game;\n        this.actor = options.actor;\n        this.actor.apps[this.appId] = this;\n    }\n\n    override async getData(): Promise<ArmyData> {\n        const adjustments = getArmyAdjustment(this.actor)!;\n        const actorLevel = this.actor.system.details.level.value;\n        return {\n            adjustments,\n            actorLevel,\n            calculated: calculateArmyAdjustments(this.actor, actorLevel, adjustments),\n        };\n    }\n\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    override async _updateObject(event: Event, formData: any): Promise<void> {\n        const data = expandObject(formData);\n        console.log('form', formData);\n        const update = {\n            melee: data.adjustments?.melee ?? 0,\n            ac: data.adjustments?.ac ?? 0,\n            maneuver: data.adjustments?.maneuver ?? 0,\n            morale: data.adjustments?.morale ?? 0,\n            scouting: data.adjustments?.scouting ?? 0,\n            ranged: data.adjustments?.ranged ?? 0,\n            recruitmentDC: data.adjustments?.recruitmentDC ?? 0,\n            ammunition: data.adjustments?.ammunition ?? 0,\n            highSave: data.adjustments?.highSave ?? 'maneuver',\n        };\n        await saveArmyAdjustment(this.actor, update);\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n    }\n\n    protected _getHeaderButtons(): Application.HeaderButton[] {\n        const buttons = super._getHeaderButtons();\n        if (this.game.user?.isGM ?? false) {\n            buttons.unshift({\n                label: 'Help',\n                class: 'something-made-up-help',\n                icon: 'fas fa-question',\n                onclick: () => openJournal('Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.iAQCUYEAq4Dy8uCY.JournalEntryPage.5lizPMtMY3ZILDK6'),\n            });\n            buttons.unshift({\n                label: 'Disable',\n                class: 'something-made-up-disable',\n                icon: 'fas fa-trash',\n                onclick: () => disableArmyDialog({\n                    actor: this.actor,\n                    onYes: async (): Promise<void> => {\n                        await this.close();\n                        await this.actor.unsetFlag('pf2e-kingmaker-tools', 'army-adjustment');\n                    },\n                }),\n            });\n        }\n        return buttons;\n    }\n}\n\n\nasync function initArmy(actor: Actor, additionalUuids: string[], type: string): Promise<ArmyAdjustments> {\n    const defaultItems = await Promise.all([\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.59vwuUVFAEs0yfKt', // advance\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.qNxyZfS4Ald098Gy', // battle\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.21aSK6Dh0FpcdWbb', // disengage\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.wfy7fmnnhlJ66Gfz', // guard\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.kKnpTt39LwP8uUvf', // rally\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.D680ctCFIpsmz82i', // retreat\n            'Compendium.pf2e-kingmaker-tools.kingmaker-tools-army-actions.Item.SfLoAnZ1O19OTLQo', // notes and rules\n            ...additionalUuids,\n        ].map(uuid => fromUuid(uuid) as Promise<Item>),\n    );\n    const data = defaultItems.map(i => i.toObject());\n    await actor.createEmbeddedDocuments('Item', data);\n    await actor.update({'system.details.blurb': type});\n    await saveArmyAdjustment(actor, getDefaultArmyAdjustment());\n    return getArmyAdjustment(actor)!;\n}\n\nexport async function editArmyStatistics(game: Game, actor: Actor): Promise<void> {\n    if (actor && actor.type === 'npc') {\n        if (getArmyAdjustment(actor) === undefined) {\n            armySetupDialog({\n                actor,\n                onConfirm: async (additionalUuids, type): Promise<void> => {\n                    await initArmy(actor, additionalUuids, type);\n                    await editArmyStatistics(game, actor);\n                },\n            });\n        } else {\n            new ArmySheet(null, {game, actor}).render(true);\n        }\n    } else {\n        ui.notifications?.error('Please select an NPC token');\n    }\n}\n","import {ArmyAdjustments} from './data';\nimport {addArmyStats, syncAttackModifiers} from './utils';\n\nexport async function saveArmyAdjustment(actor: Actor, update: Partial<ArmyAdjustments>): Promise<void> {\n    console.info('Saving', update);\n    await actor.setFlag('pf2e-kingmaker-tools', 'army-adjustment', update);\n    const adjustments = getArmyAdjustment(actor)!;\n    const level = actor.system.details.level.value;\n    const syncedActorUpdates = {};\n    addArmyStats(actor, syncedActorUpdates, level, adjustments);\n    await actor.update(syncedActorUpdates);\n    await syncAttackModifiers(actor, level, adjustments);\n}\n\nexport function getArmyAdjustment(sheetActor: Actor): ArmyAdjustments | undefined {\n    return sheetActor.getFlag('pf2e-kingmaker-tools', 'army-adjustment') as ArmyAdjustments | undefined;\n}","import {ArmyAdjustments, armyStatisticsByLevel} from './data';\nimport {getArmyAdjustment} from './storage';\nimport {Kingdom} from '../kingdom/data/kingdom';\nimport {saveKingdom} from '../kingdom/storage';\nimport {getBooleanSetting} from '../settings';\nimport {distinctBy, sum} from '../utils';\n\nexport function getDefaultArmyAdjustment(): ArmyAdjustments {\n    return {\n        ac: 0,\n        melee: 0,\n        morale: 0,\n        maneuver: 0,\n        scouting: 0,\n        recruitmentDC: 0,\n        ranged: 0,\n        highSave: 'maneuver',\n        ammunition: 0,\n    };\n}\n\nfunction isRanged(item: Item): boolean {\n    return item.system?.weaponType?.value === 'ranged';\n}\n\nexport async function addAttackModifiers(actor: Actor, item: Item, level: number, adjustments: ArmyAdjustments): Promise<void> {\n    if (item.type === 'melee') { // true for both melee and ranged\n        const calculated = calculateArmyAdjustments(actor, level, adjustments);\n        const attackModifier = isRanged(item) ? calculated.ranged : calculated.melee;\n        const calculatedUpdate = {system: {bonus: {value: attackModifier}}};\n        await item.update(calculatedUpdate);\n    }\n}\n\n\nexport async function syncAttackModifiers(actor: Actor, level: number, adjustments: ArmyAdjustments): Promise<void> {\n    const calculated = calculateArmyAdjustments(actor, level, adjustments);\n    const updates = actor.items\n        .filter(item => item.type === 'melee')\n        .map(item => {\n            const attackModifier = isRanged(item) ? calculated.ranged : calculated.melee;\n            return {'_id': item.id, 'system.bonus.value': attackModifier};\n        });\n    console.log('onactorupdate', updates);\n    await actor.updateEmbeddedDocuments('Item', updates);\n}\n\n\nexport function addArmyStats(actor: Actor, update: Partial<Actor>, level: number, adjustments: ArmyAdjustments): void {\n    const calculated = calculateArmyAdjustments(actor, level, adjustments);\n    const calculatedUpdate = {\n        system: {\n            saves: {\n                reflex: {value: calculated.maneuver},\n                will: {value: calculated.morale},\n                fortitude: {value: calculated.recruitmentDC},\n            },\n            attributes: {\n                ac: {value: calculated.ac},\n            },\n            perception: {mod: calculated.scouting},\n        },\n    };\n    foundry.utils.mergeObject(update, calculatedUpdate);\n}\n\nexport function calculateArmyAdjustments(actor: Actor, level: number, adjustments: ArmyAdjustments): ArmyAdjustments {\n    const data = armyStatisticsByLevel.get(level) ?? armyStatisticsByLevel.get(1)!;\n    const maneuver = adjustments.highSave === 'maneuver' ? data.highSave : data.lowSave;\n    const morale = adjustments.highSave === 'morale' ? data.highSave : data.lowSave;\n    const increasedAmmunitionCount = actor.itemTypes.action\n        .filter(i => i.name.startsWith('Increased Ammunition'))\n        .length;\n    return {\n        ac: data.ac + adjustments.ac,\n        recruitmentDC: data.standardDC + adjustments.recruitmentDC,\n        melee: data.attack + adjustments.melee,\n        ranged: data.attack + adjustments.ranged,\n        maneuver: maneuver + adjustments.maneuver,\n        scouting: data.scouting + adjustments.scouting,\n        morale: morale + adjustments.morale,\n        highSave: adjustments.highSave,\n        ammunition: 5 + adjustments.ammunition + 2 * increasedAmmunitionCount,\n    };\n}\n\n\nfunction isArmyActor(actor: Actor | null | undefined): boolean {\n    return (actor?.type === 'npc' && getArmyAdjustment(actor) !== undefined) ||\n        actor?.type === 'army';\n}\n\nexport async function updateKingdomArmyConsumption(\n    {\n        actor = null,\n        kingdomActor,\n        game,\n        forceUpdate = false,\n    }: {\n        actor?: Actor | null | undefined,\n        kingdomActor: Actor | null | undefined,\n        game: Game,\n        forceUpdate?: boolean,\n    },\n): Promise<void> {\n    const autoCalculationEnabled = getBooleanSetting(game, 'autoCalculateArmyConsumption');\n    if (autoCalculationEnabled && kingdomActor && (forceUpdate || isArmyActor(actor))) {\n        await saveKingdom(kingdomActor, {\n            consumption: {\n                armies: Math.max(calculateTotalArmyConsumption(game), 0),\n            },\n        } as Partial<Kingdom>);\n    }\n}\n\n\nexport function calculateTotalArmyConsumption(game: Game): number {\n    const consumption: number[] = [];\n    // fucking foundry collection APIs :/\n    const actors: Actor[] = [];\n    game?.scenes?.map(s => s.tokens)\n        ?.forEach(tokenCollection => {\n            tokenCollection.forEach(token => {\n                const actor = token.actor;\n                if (actor && !token.hidden && actor.hasPlayerOwner) {\n                    actors.push(actor);\n                }\n            });\n        });\n    distinctBy(actors, (a) => a.uuid)\n        .forEach(actor => {\n            if (actor.type === 'army') {\n                consumption.push((actor as unknown as ArmyActor).system.consumption);\n            } else if (getArmyAdjustment(actor) !== undefined) {\n                consumption.push(actor.abilities.con.mod);\n            }\n        });\n    return sum(consumption);\n}","import {DegreeOfSuccess} from '../degree-of-success';\nimport {roll} from '../utils';\nimport {basicIngredientUuid, DcType, Proficiency, rationUuid, specialIngredientUuid} from './data';\nimport {getRegionInfo} from './regions';\nimport {FoodAmount} from './eating';\nimport {isConsumableItem} from './actor';\n\nexport const allCampingActivityNames = [\n    'Prepare Campsite',\n    'Camouflage Campsite',\n    'Cook Meal',\n    'Discover Special Meal',\n    'Hunt and Gather',\n    'Learn from a Companion',\n    'Organize Watch',\n    'Tell Campfire Story',\n    'Blend Into The Night',\n    'Bolster Confidence',\n    'Camp Management',\n    'Dawnflower\\'s Blessing',\n    'Enhance Campfire',\n    'Enhance Weapons',\n    'Intimidating Posture',\n    'Maintain Armor',\n    'Set Alarms',\n    'Set Traps',\n    'Undead Guardians',\n    'Water Hazards',\n    'Wilderness Survival',\n    'Influence Amiri',\n    'Discover Amiri',\n    'Influence Ekundayo',\n    'Discover Ekundayo',\n    'Influence Jubilost',\n    'Discover Jubilost',\n    'Influence Linzi',\n    'Discover Linzi',\n    'Influence Nok-Nok',\n    'Discover Nok-Nok',\n    'Influence Tristian',\n    'Discover Tristian',\n    'Influence Valerie',\n    'Discover Valerie',\n    'Influence Harrim',\n    'Discover Harrim',\n    'Influence Jaethal',\n    'Discover Jaethal',\n    'Influence Kalikke',\n    'Discover Kalikke',\n    'Influence Kanerah',\n    'Discover Kanerah',\n    'Influence Octavia',\n    'Discover Octavia',\n    'Influence Regongar',\n    'Discover Regongar',\n] as const;\n\nexport type CampingActivityName = typeof allCampingActivityNames[number];\n\nexport const allCompanionNames = [\n    'Amiri',\n    'Ekundayo',\n    'Jubilost',\n    'Linzi',\n    'Nok-Nok',\n    'Tristian',\n    'Valerie',\n    'Harrim',\n    'Jaethal',\n    'Kalikke',\n    'Kanerah',\n    'Octavia',\n    'Regongar',\n] as const;\n\nexport type CompanionNames = typeof allCompanionNames[number];\n\nexport type EffectTarget = 'all' | 'self' | 'allies';\n\nexport interface ActivityEffect {\n    uuid: string;\n    target?: EffectTarget;\n}\n\nexport interface ActivityOutcome {\n    message: string;\n    effectUuids?: ActivityEffect[];\n    modifyRandomEncounterDc?: {\n        day: number;\n        night: number;\n    };\n    checkRandomEncounter?: boolean;\n}\n\nexport interface SkillRequirement {\n    skill: string;\n    proficiency: Proficiency;\n}\n\nexport interface CampingActivityData {\n    name: CampingActivityName;\n    journalUuid?: string;\n    skillRequirements: SkillRequirement[];\n    dc?: DcType;\n    skills: string[] | 'any';\n    modifyRandomEncounterDc?: {\n        day: number;\n        night: number;\n    },\n    isSecret: boolean;\n    isLocked: boolean;\n    effectUuids?: ActivityEffect[];\n    isHomebrew?: boolean;\n    criticalSuccess?: ActivityOutcome;\n    success?: ActivityOutcome;\n    failure?: ActivityOutcome;\n    criticalFailure?: ActivityOutcome;\n}\n\nfunction influenceCompanions(): CampingActivityData[] {\n    return allCompanionNames.flatMap(c => {\n        const influence: CampingActivityData = {\n            name: `Influence ${c}` as CampingActivityName,\n            journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.D83mNy8bYqKULEnu',\n            isLocked: true,\n            isSecret: false,\n            skillRequirements: [],\n            skills: 'any',\n            criticalSuccess: {message: `You gain 2 Influence Points with ${c}`},\n            success: {message: `You gain 1 Influence Points with ${c}`},\n            failure: {message: `You gain no Influence Points with ${c}`},\n            criticalFailure: {message: `You lose 1 Influence Points with ${c}`},\n        };\n        const discover: CampingActivityData = {\n            name: `Discover ${c}` as CampingActivityName,\n            journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.nCwES51tV7FmrfCN',\n            isLocked: true,\n            isSecret: true,\n            skillRequirements: [],\n            skills: 'any',\n            criticalSuccess: {message: `Choose two of the following: You learn which skill that can Influence ${c} has the lowest DC (skipping any skills that you already know), one of ${c}s personal biases, one of ${c}s resistances, or one of ${c}s weaknesses. you can choose the same option twice to learn two pieces of information from the same category.`},\n            success: {message: `Choose one of the following: You learn which skill that can Influence ${c} has the lowest DC (skipping any skills that you already know), one of ${c}s personal biases, one of ${c}s resistances, or one of ${c}s weaknesses.`},\n            failure: {message: 'You learn no information.'},\n            criticalFailure: {message: `Choose a piece of information to learn about, as success, but the information is incorrect. For instance, you might think ${c} is susceptible to flattery when actually ${c} is resistant to flattery.`},\n        };\n        return [influence, discover];\n    });\n}\n\nexport const allCampingActivities: CampingActivityData[] = [{\n    name: 'Camouflage Campsite',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.mlLCjokti3RXAlUP',\n    isLocked: false,\n    isSecret: true,\n    dc: 'zone',\n    skillRequirements: [{skill: 'stealth', proficiency: 'trained'}],\n    skills: ['stealth'],\n    criticalSuccess: {\n        message: 'Your camouflage attempt exceeds expectation. Increase the Encounter DC for your camp by 2. The first time a flat check would result in an encounter during this camping session, instead treat that result as a failure with no encounter.',\n        modifyRandomEncounterDc: {\n            day: 2,\n            night: 2,\n        },\n    },\n    success: {\n        message: 'Your work helps hide your camp from detection. Increase the Encounter DC for your camp by 1.',\n        modifyRandomEncounterDc: {\n            day: 1,\n            night: 1,\n        },\n    },\n    criticalFailure: {\n        message: 'You believe youve done well at your camouflage attempt but have actually forgotten something important or accidentally did something to make the campsite more noticeable. Decrease the Encounter DC for your camp by 2, and flat checks made to determine encounters result in a critical success on a roll of 19 or 20.',\n        modifyRandomEncounterDc: {\n            day: -2,\n            night: -2,\n        },\n    },\n}, {\n    name: 'Cook Meal',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.S72BNBTfKfkCjriU',\n    isLocked: false,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    criticalSuccess: {\n        message: 'The character gains the recipes listed critical success effect.',\n    },\n    success: {\n        message: 'The character gains the recipes listed success effect.',\n    },\n    failure: {\n        message: 'The character gains no special benefit from the meal, though it still prevents starvation.',\n    },\n    criticalFailure: {\n        message: 'The character suffers the recipes critical failure effect.',\n    },\n}, {\n    name: 'Discover Special Meal',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.5I8jnFjirbbIUkGy',\n    isLocked: false,\n    isSecret: false,\n    dc: 'zone',\n    skillRequirements: [{skill: 'cooking', proficiency: 'trained'}],\n    skills: ['cooking'],\n    criticalSuccess: {\n        message: 'You discover the special meal and add it to the list of recipes the party knows. In addition, your research was efficient, and you recover half of the ingredients you had to expend to attempt this activity.',\n    },\n    success: {\n        message: 'As critical success, but you do not recover any ingredients.',\n    },\n    failure: {\n        message: 'You fail to discover the special meal and do not recover any ingredients.',\n    },\n    criticalFailure: {\n        message: 'As failure, but you also expose yourself to the special meals critical failure effect while performing an unwise taste test.',\n    },\n}, {\n    name: 'Hunt and Gather',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.RujdVNvLpoQBBdVV',\n    isLocked: false,\n    isSecret: false,\n    dc: 'zone',\n    skillRequirements: [{skill: 'survival', proficiency: 'trained'}],\n    skills: ['survival', 'hunting'],\n    criticalSuccess: {\n        message: 'You find a number of Basic Ingredients equal to twice the zones DC, plus 4 Special Ingredients. If youre Hunting and Gathering in a zone thats at least level 7, increase the number of special ingredients found to 8; if youre doing so in a zone thats at least level 14, increase it to 12.',\n    },\n    success: {\n        message: 'You find a number of Basic Ingredients equal to the zones DC, plus [[/r 1d4]] Special Ingredients. If youre Hunting and Gathering in a zone thats at least level 7, increase the number of special ingredients found to [[/r 2d4]]; if youre doing so in a zone thats at least level 14, increase it to [[/r 3d4]].',\n    },\n    failure: {\n        message: 'You find a number of Basic Ingredients equal to the zones DC.',\n    },\n    criticalFailure: {\n        message: 'You find [[/r 1d4]] Basic Ingredients (maximum equal to the zones DC). In addition, youve attracted attention. Make an additional flat check to determine if a random encounter occurs at your campsite following this activity.',\n        checkRandomEncounter: true,\n    },\n}, {\n    name: 'Learn from a Companion',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.MyeB2g0yDwEsqfI9',\n    isLocked: true,\n    isSecret: false,\n    dc: 20,\n    skillRequirements: [],\n    skills: ['perception'],\n    criticalSuccess: {\n        message: 'You learn the companions special activity. Any PC who meets that activitys requirements (see table above) can now perform that activity even when the companion isnt in the camp.',\n    },\n    success: {\n        message: 'You make progress in learning the special activity but require at least one more day to master it. If you attempt to Learn from this Companion the next time you camp, the result of that check is improved by one degree of success from the result rolled.',\n    },\n    failure: {\n        message: 'You fail to learn anything from the companion.',\n    },\n    criticalFailure: {\n        message: 'You fail to learn from the companion, who grows frustrated with the party. No further attempts to Learn from this Companion can be attempted during this camping session.',\n    },\n}, {\n    name: 'Organize Watch',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.wgyPZBRgPjTeK0Ch',\n    isLocked: false,\n    isSecret: false,\n    dc: 'zone',\n    skillRequirements: [{skill: 'perception', proficiency: 'expert'}],\n    skills: ['perception'],\n    criticalSuccess: {\n        message: 'The camps watch is efficient. Treat the total time required for rest as if the party size were 1 more, and all characters gain a +2 status bonus to Perception checks made during their shift on watch.',\n        effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.010XlkzzjX38BHsO'}],\n    },\n    success: {\n        message: 'Characters gain a +1 status bonus to Perception checks made during their shift on watch.',\n        effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.MOXWga7l8dsypUPy'}],\n    },\n    failure: {\n        message: 'Your attempt to organize the watch doesnt grant any additional benefits.',\n    },\n    criticalFailure: {\n        message: 'As failure, but you may have attracted unwanted attention. Attempt a flat check against the zones Encounter DC to determine if a random encounter occurs.',\n        checkRandomEncounter: true,\n    },\n}, {\n    name: 'Tell Campfire Story',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.XaKD1oGTAgZUjlQ5',\n    isLocked: false,\n    isSecret: false,\n    dc: 'actorLevel',\n    skillRequirements: [],\n    skills: ['performance'],\n    criticalSuccess: {\n        message: 'You inspire your allies dramatically. For the remainder of the camping session, your allies gain a +2 status bonus to attack rolls, saving throws, and skill checks during combat at the campsite. The bonuses end as soon as daily preparations begin after resting is concluded. If an ally spent the hour Relaxing, they can also choose to reroll a failed roll at any time once during the remainder of the camping session while the status bonus persists; this is a fortune effect.',\n        effectUuids: [{\n            uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.2vdskbqd0VrWKR9Y',\n            target: 'allies',\n        }],\n    },\n    success: {\n        message: 'You inspire your allies dramatically. For the remainder of the camping session, your allies gain a +1 status bonus to attack rolls, saving throws, and skill checks during combat at the campsite. The bonuses end as soon as daily preparations begin after resting is concluded. An ally who spent the hour Relaxing receives a +2 status bonus.',\n        effectUuids: [{\n            uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.wT2NzrfgmWmCMRtv',\n            target: 'allies',\n        }],\n    },\n    failure: {\n        message: 'Your allies are unmoved and receive no benefits.',\n    },\n    criticalFailure: {\n        message: 'Your story distracts or unsettles your allies. They each take a 1 status penalty to skill checks until they Relax or until they begin daily preparations.',\n        effectUuids: [{\n            uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.y5Jqw40SWNOgcxvC',\n            target: 'allies',\n        }],\n    },\n}, ...influenceCompanions(), {\n    name: 'Blend Into The Night',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.jz1FI7zSoPLR8iBL',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    modifyRandomEncounterDc: {\n        day: 0,\n        night: 2,\n    },\n}, {\n    name: 'Bolster Confidence',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.pxHYFLK7VYGppCzS',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.mAEvnTqFuLIASQLB'}],\n}, {\n    name: 'Camp Management',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.JRScwsFTXTpTwWYA',\n    isLocked: true,\n    isSecret: false,\n    dc: 'zone',\n    skillRequirements: [],\n    skills: ['survival'],\n    criticalSuccess: {\n        message: 'During the hour immediately following this critical success, each PC may attempt two Camping activities instead of one. This success does not increase the number of activities companions may attempt.',\n    },\n    success: {\n        message: 'During the hour immediately following this critical success, one PC may attempt two Camping activities instead of one. This success does not increase the number of activities companions may attempt.',\n    },\n    criticalFailure: {\n        message: 'All checks made to resolve Camping activities take a 2 circumstance penalty for the remainder of this camping session.',\n        effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.vpH13xgAqX4zsU6o'}],\n    },\n}, {\n    name: 'Dawnflower\\'s Blessing',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.X4ggcXUe0wPiW4jt',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.eaWmjDOIvUF9aDbq'}],\n}, {\n    name: 'Enhance Campfire',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.ytyW9F39m7xf0gx5',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.NFPQHxvpJd2vsKMe'}],\n}, {\n    name: 'Enhance Weapons',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.2Dn89HrY7gyvQiOH',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Intimidating Posture',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.LhhERalHv4QA14fQ',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Maintain Armor',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.zUaeA8Ud9dv3hhnc',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Set Alarms',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.vWSQmYLKlrk3rLDE',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n    effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.ptjs54eoEX8EAQNq'}],\n}, {\n    name: 'Set Traps',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.5ynOh085kwNp75t4',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Undead Guardians',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.YzOixXzCwfXOBjtx',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Water Hazards',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.HGcwmsfjVqfLeYhu',\n    isLocked: true,\n    isSecret: false,\n    skillRequirements: [],\n    skills: [],\n}, {\n    name: 'Wilderness Survival',\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.8PNH77YHVkw9KoAv',\n    isLocked: true,\n    isSecret: false,\n    dc: 'zone',\n    skillRequirements: [],\n    skills: [],\n    effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.v9i9W49PeJ9NkfXX'}],\n}, {\n    name: 'Prepare Campsite',\n    dc: 'zone',\n    skills: ['survival'],\n    skillRequirements: [],\n    isSecret: false,\n    journalUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.uSTTCqRYCWj7a38F.JournalEntryPage.Iuen7iSvZAlnAJFB',\n    isLocked: false,\n    criticalSuccess: {\n        message: 'Prepare Campsite: You find the perfect spot for a camp. Flat checks to determine encounters at the campsite for the next 24 hours have a DC 2 higher than normal, and the first 2 hours spent performing Camping activities does not incur the usual flat check for random encounters.',\n        modifyRandomEncounterDc: {\n            day: 2,\n            night: 2,\n        },\n    },\n    success: {\n        message: 'Prepare Campsite: You find a serviceable spot for a camp and for Camping activities.',\n    },\n    failure: {\n        message: 'Prepare Campsite: Your campsite will work, but its not the best. Campsite activities that require checks take a 2 penalty.',\n        effectUuids: [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.X1OvR5j1cAXZ4Lbp'}],\n    },\n    criticalFailure: {\n        message: 'Prepare Campsite: Your campsite is a mess. You can use it to rest and to perform daily preparations, but it isnt good enough to allow for Campsite activities at all. Worse, your attempt to secure a campsite has possibly attracted unwanted attentionattempt a flat check against the zones Encounter DC. If successful, a random encounter automatically occurs.',\n        checkRandomEncounter: true,\n    },\n}];\n\nexport async function getHuntAndGatherQuantities(\n    degreeOfSuccess: DegreeOfSuccess,\n    zoneDc: number,\n    zoneLevel: number,\n): Promise<FoodAmount> {\n    if (degreeOfSuccess === DegreeOfSuccess.CRITICAL_SUCCESS) {\n        return {\n            basicIngredients: 2 * zoneDc,\n            specialIngredients: zoneLevel >= 14 ? 12 : (zoneLevel >= 7 ? 8 : 4),\n            rations: 0,\n        };\n    } else if (degreeOfSuccess === DegreeOfSuccess.SUCCESS) {\n        return {\n            basicIngredients: zoneDc,\n            specialIngredients: await roll((zoneLevel >= 14 ? 3 : (zoneLevel >= 7 ? 2 : 1)) + 'd4', 'Special Ingredients'),\n            rations: 0,\n        };\n    } else if (degreeOfSuccess === DegreeOfSuccess.FAILURE) {\n        return {\n            basicIngredients: zoneDc,\n            specialIngredients: 0,\n            rations: 0,\n        };\n    } else {\n        return {\n            basicIngredients: await roll('1d4', 'Basic Ingredients'),\n            specialIngredients: 0,\n            rations: 0,\n        };\n    }\n}\n\nexport async function addToInventory(actor: Actor, uuid: string, quantity: number): Promise<void> {\n    if (quantity > 0) {\n        const item = (await fromUuid(uuid))?.toObject();\n        if (isConsumableItem(item) && item.system.uses.max > 0) {\n            const max = item.system.uses.max;\n            item.system.quantity = Math.ceil(quantity / max);\n            item.system.uses.value = quantity % max;\n        } else {\n            item.system.quantity = quantity;\n        }\n        await actor.addToInventory(item, undefined, false);\n    }\n\n}\n\nexport async function addIngredientsToActor(actor: Actor, ingredients: FoodAmount): Promise<void> {\n    await addToInventory(actor, basicIngredientUuid, ingredients.basicIngredients);\n    await addToInventory(actor, specialIngredientUuid, ingredients.specialIngredients);\n    await addToInventory(actor, rationUuid, ingredients.rations);\n}\n\nexport async function huntAndGather(game: Game, actor: Actor, degreeOfSuccess: DegreeOfSuccess, region: string): Promise<FoodAmount> {\n    const {zoneDC, zoneLevel} = getRegionInfo(game, region);\n    return await getHuntAndGatherQuantities(degreeOfSuccess, zoneDC, zoneLevel);\n}\n","import {Proficiency} from './data';\nimport {SkillRequirement} from './activities';\nimport {capitalize, unslugify} from '../utils';\n\ntype ItemType = 'effect' | 'consumable';\n\nasync function getItemNames(uuids: Set<string>): Promise<Set<string>> {\n    const applicableItems = (await Promise.all(Array.from(uuids).map(uuid => fromUuid(uuid))) as (Item | null)[])\n        .filter(i => i !== null) as Item[];\n    const names = applicableItems\n        .filter(item => item !== undefined && item !== null)\n        .map(item => item.name);\n    return new Set(names);\n}\n\nfunction getItemsByName(actor: Actor, type: ItemType, names: Set<string>): Item[] {\n    return actor.itemTypes[type]\n        .filter(i => names.has(i.name));\n}\n\nexport async function getActorItemsByUuid(actor: Actor, type: ItemType, uuids: Set<string>): Promise<Item[]> {\n    const names = await getItemNames(uuids);\n    return getItemsByName(actor, type, names);\n}\n\nexport function isEffectItem(item: Item): item is Item & EffectItem {\n    return item.type === 'effect';\n}\n\nexport function isConsumableItem(item: Item): item is Item & ConsumableItem {\n    return item.type === 'consumable';\n}\n\nexport async function getActorEffectsByUuid(actor: Actor, uuids: Set<string>): Promise<(Item & EffectItem)[]> {\n    const items = await getActorItemsByUuid(actor, 'effect', uuids);\n    return items.filter(isEffectItem);\n}\n\nexport async function actorHasEffectByUuid(actor: Actor, uuid: string): Promise<boolean> {\n    const effects = await getActorEffectsByUuid(actor, new Set([uuid]));\n    return effects.length > 0;\n}\n\n\nexport async function getConsumablesByUuid(actor: Actor, uuids: Set<string>): Promise<(Item & ConsumableItem)[]> {\n    const items = await getActorItemsByUuid(actor, 'consumable', uuids);\n    return items.filter(isConsumableItem);\n}\n\nexport async function hasItemByUuid(actor: Actor, type: ItemType, uuids: Set<string>): Promise<boolean> {\n    return (await getActorItemsByUuid(actor, type, uuids)).length > 0;\n}\n\nexport function proficiencyToRank(proficiency: Proficiency): number {\n    if (proficiency === 'trained') {\n        return 1;\n    } else if (proficiency === 'expert') {\n        return 2;\n    } else if (proficiency === 'master') {\n        return 3;\n    } else {\n        return 4;\n    }\n}\n\nexport class NotProficientError extends Error {\n\n}\n\nexport async function validateSkillProficiencies(actor: Actor, requirements: SkillRequirement[]): Promise<void> {\n    for (const requirement of requirements) {\n        const skill = requirement.skill;\n        const proficiency = requirement.proficiency;\n        if (!await satisfiesSkillProficiency(actor, skill, proficiency)) {\n            const name = actor.name;\n            throw new NotProficientError(`${name} requires at least ${capitalize(proficiency)} in ${unslugify(skill)}`);\n        }\n    }\n}\n\nexport async function satisfiesSkillProficiency(actor: Actor, skill: string, minimumProficiency: Proficiency): Promise<boolean> {\n    const skillProp = await getSkill(actor, skill);\n    const rank = proficiencyToRank(minimumProficiency);\n    if (skillProp) {\n        return skillProp.rank >= rank;\n    }\n    return false;\n}\n\nexport async function getSkill(actor: Actor, skill: string): Promise<ActorSkill | null> {\n    const skills = actor.skills;\n    const loreSkill = `${skill}-lore`;\n    if (skill === 'perception') {\n        return actor.perception;\n    } else if (skill in skills) {\n        return skills[skill];\n    } else if (loreSkill in skills) {\n        return skills[loreSkill];\n    } else {\n        return null;\n    }\n}\n\nexport async function hasCookingLore(actorUuid: string): Promise<boolean> {\n    const actor = await fromUuid(actorUuid) as Actor | null;\n    if (actor) {\n        return await getSkill(actor, 'cooking') !== null;\n    } else {\n        return false;\n    }\n}\n\nexport async function getActorByUuid(uuid: string): Promise<Actor | null> {\n    const document = await fromUuid(uuid);\n    if (document instanceof Actor) {\n        return document;\n    }\n    return null;\n}\n\nexport async function getActorsByUuid(uuids: Set<string>): Promise<Actor[]> {\n    return (await Promise.all(Array.from(uuids).map(a => getActorByUuid(a))))\n        .filter(a => a !== null) as Actor[];\n}\n\nexport async function getItemByUuid(uuid: string): Promise<Item | null> {\n    const document = await fromUuid(uuid);\n    if (document instanceof Item) {\n        return document;\n    }\n    return null;\n}\n\nexport async function getItemsByUuid(uuids: Set<string>): Promise<Item[]> {\n    return (await Promise.all(Array.from(uuids).map(i => getItemByUuid(i))))\n        .filter(a => a !== null) as Item[];\n}\n\nexport async function getEffectByUuid(uuid: string): Promise<Item & EffectItem | null> {\n    const document = await fromUuid(uuid);\n    if (document instanceof Item && isEffectItem(document)) {\n        return document;\n    }\n    return null;\n}\n\nexport async function getEffectsByUuid(uuids: Set<string>): Promise<(Item & EffectItem)[]> {\n    const items = await getItemsByUuid(uuids);\n    return items.filter(isEffectItem) as (Item & EffectItem)[];\n}\n\n\nasync function removeActorEffectsByUuid(actor: Actor, uuids: Set<string>): Promise<void> {\n    const existingEffects = await getActorEffectsByUuid(actor, uuids);\n    await actor.deleteEmbeddedDocuments('Item', existingEffects.map(e => e.id));\n}\n\nasync function removeActorEffectsByName(actor: Actor, names: Set<string>): Promise<void> {\n    const existingEffects = getItemsByName(actor, 'effect', names);\n    await actor.deleteEmbeddedDocuments('Item', existingEffects.map(e => e.id));\n}\n\nexport async function removeActorsEffectsByUuid(actors: Actor[], uuids: Set<string>): Promise<void> {\n    await Promise.all(actors.map(a => removeActorEffectsByUuid(a, uuids)));\n}\n\nexport async function removeActorsEffectsByName(actors: Actor[], names: Set<string>): Promise<void> {\n    await Promise.all(actors.map(a => removeActorEffectsByName(a, names)));\n}\n\n","import {allCampingActivities, CampingActivityData, CampingActivityName} from './activities';\nimport {getRegionInfo} from './regions';\nimport {getLevelBasedDC, postDegreeOfSuccessMessage, slugify, unslugify} from '../utils';\nimport {DegreeOfSuccess, degreeToProperty, StringDegreeOfSuccess} from '../degree-of-success';\nimport {DcType} from './data';\nimport {RecipeData} from './recipes';\nimport {checkRandomEncounterMessage} from './chat';\nimport {getActorByUuid} from './actor';\n\nexport type RestRollMode = 'one' | 'none' | 'one-every-4-hours';\n\nexport interface CampingActivity {\n    activity: CampingActivityName;\n    actorUuid: string | null;\n    result: StringDegreeOfSuccess | null,\n    selectedSkill: string | null;\n}\n\nexport type ChosenMeal = 'meal' | 'rationsOrSubsistence' | 'nothing';\n\nexport interface ActorMeal {\n    actorUuid: string;\n    favoriteMeal: string | null;\n    chosenMeal: ChosenMeal;\n}\n\nexport type CookingSkill = 'survival' | 'cooking';\n\nexport interface Cooking {\n    knownRecipes: string[];\n    subsistenceAmount: number;\n    magicalSubsistenceAmount: number;\n    chosenMeal: string;\n    cookingSkill: CookingSkill;\n    actorMeals: ActorMeal[];\n    homebrewMeals: RecipeData[];\n    degreeOfSuccess: StringDegreeOfSuccess | null;\n}\n\n\nexport interface Camping {\n    actorUuids: string[];\n    campingActivities: CampingActivity[];\n    homebrewCampingActivities: CampingActivityData[];\n    lockedActivities: CampingActivityName[];\n    cooking: Cooking;\n    watchSecondsRemaining: number;\n    gunsToClean: number;\n    dailyPrepsAtTime: number;\n    currentRegion: string;\n    encounterModifier: number;\n    restRollMode: RestRollMode;\n    increaseWatchActorNumber: number;\n    actorUuidsNotKeepingWatch: string[];\n    huntAndGatherTargetActorUuid?: string | null;\n    ignoreSkillRequirements: boolean;\n}\n\nexport function getDefaultConfiguration(game: Game, migratedRecipes: string[]): Camping {\n    return {\n        actorUuids: [],\n        campingActivities: [],\n        cooking: {\n            chosenMeal: 'Basic Meal',\n            actorMeals: [],\n            magicalSubsistenceAmount: 0,\n            subsistenceAmount: 0,\n            knownRecipes: Array.from(new Set(['Basic Meal', 'Hearty Meal', ...migratedRecipes])),\n            homebrewMeals: [],\n            cookingSkill: 'survival',\n            degreeOfSuccess: null,\n        },\n        restRollMode: 'one',\n        currentRegion: 'Rostland Hinterlands',\n        dailyPrepsAtTime: game.time.worldTime,\n        homebrewCampingActivities: [],\n        encounterModifier: 0,\n        gunsToClean: 0,\n        watchSecondsRemaining: 0,\n        actorUuidsNotKeepingWatch: [],\n        increaseWatchActorNumber: 0,\n        lockedActivities: allCampingActivities\n            .filter(a => a.isLocked)\n            .map(a => a.name),\n        ignoreSkillRequirements: false,\n    };\n}\n\nexport function getDC(game: Game, actor: Actor, dcType: DcType, region: string): number {\n    if (dcType === 'zone') {\n        return getRegionInfo(game, region).zoneDC;\n    } else if (dcType === 'actorLevel') {\n        return getLevelBasedDC(actor.level);\n    } else {\n        return dcType;\n    }\n}\n\nexport interface SkillCheckOptions {\n    game: Game,\n    actor: Actor,\n    dc?: DcType,\n    skill: string,\n    secret?: boolean,\n    isWatch?: boolean,\n    activity?: CampingActivityData,\n    region: string;\n}\n\nexport async function rollCampingCheck(\n    {\n        game,\n        actor,\n        dc,\n        skill,\n        secret = false,\n        isWatch = false,\n        region,\n        activity,\n    }: SkillCheckOptions): Promise<DegreeOfSuccess | null> {\n    const rollData: RollOptions = {\n        extraRollOptions: ['camping'],\n    };\n    if (isWatch) {\n        rollData.extraRollOptions?.push('watch');\n    }\n    if (activity) {\n        rollData['extraRollOptions']?.push('action:' + slugify(activity.name));\n    }\n    if (dc) {\n        rollData['dc'] = {value: getDC(game, actor, dc, region)};\n    }\n    if (secret) {\n        rollData['rollMode'] = 'blindroll';\n    }\n    let result;\n    const skills = actor.skills;\n    const loreSkill = `${skill}-lore`;\n    const skillToRoll = skill in skills ? skill : (loreSkill in skills ? loreSkill : null);\n    if (skill === 'perception') {\n        result = await actor.perception.roll(rollData);\n    } else if (skillToRoll === null) {\n        ui.notifications?.error(`${actor.name} does not have skill ${unslugify(skill)}`);\n        return null;\n    } else {\n        result = await skills[skillToRoll].roll(rollData);\n    }\n    const degree = result?.degreeOfSuccess ?? null;\n    if (degree !== null) {\n        await postDegreeOfSuccessMessage({\n            degreeOfSuccess: degree,\n            messageConfig: {\n                isPrivate: secret,\n                critSuccess: activity?.criticalSuccess?.message,\n                success: activity?.success?.message,\n                failure: activity?.failure?.message,\n                critFailure: activity?.criticalFailure?.message,\n            },\n        });\n        if (activity !== undefined && activity[degreeToProperty(degree)]?.checkRandomEncounter) {\n            await checkRandomEncounterMessage();\n        }\n    }\n    return degree;\n}\n\n\nexport function getCampingActivityData(current: Camping): CampingActivityData[] {\n    const homebrewActivities = current.homebrewCampingActivities;\n    const homebrewNames = new Set(homebrewActivities.map(i => i.name.toLocaleLowerCase()));\n    return [\n        ...allCampingActivities.filter(a => !homebrewNames.has(a.name.toLocaleLowerCase())),\n        ...homebrewActivities,\n    ];\n}\n\nexport interface CombatEffect {\n    uuid: string;\n    target: string;\n}\n\nconst combatEffects: Partial<Record<CampingActivityName, CombatEffect>> = {\n    'Enhance Weapons':\n        {\n            uuid: '@UUID[Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.ZKJlIqyFgbKDACnG]{Enhance Weapons}',\n            target: 'Allies',\n        },\n    'Set Traps':\n        {\n            uuid: '@UUID[Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.PSBOS7ZEl9RGWBqD]{Set Traps}',\n            target: 'Enemies',\n        },\n    'Undead Guardians':\n        {\n            uuid: '@UUID[Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.KysTaC245mOnSnmE]{Undead Guardians}',\n            target: '1 Ally',\n        },\n    'Water Hazards':\n        {\n            uuid: '@UUID[Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.LN6mH7Muj4hgvStt]{Water Hazards}',\n            target: 'Enemies',\n        },\n    'Maintain Armor': {\n        uuid: '@UUID[Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.wojV4NiAOYsnfFby]{Maintain Armor: Armor}',\n        target: '',\n    },\n};\n\nasync function getMaintainArmorTarget(actorUuids: string[]): Promise<string> {\n    const actors = await Promise.all(actorUuids.map(uuid => fromUuid(uuid) as Promise<Actor | null>));\n    const level = Math.max(1, ...(actors.map(a => a?.system.details.level.value ?? 1)));\n    if (level < 3) {\n        return '1 Ally';\n    } else {\n        const allies = 1 + Math.floor((level - 1) / 2);\n        return `${allies} Allies`;\n    }\n}\n\nexport async function getCombatEffects(data: Camping): Promise<Partial<Record<CampingActivityName, CombatEffect>>> {\n    const result: Partial<Record<CampingActivityName, CombatEffect>> = {};\n    const maintainArmorTarget = await getMaintainArmorTarget(data.actorUuids);\n    data.campingActivities.forEach(a => {\n        const activityName = a.activity;\n        if (activityName in combatEffects && a.actorUuid) {\n            const combatEffect = combatEffects[activityName]!;\n            const target = activityName === 'Maintain Armor' ? maintainArmorTarget : combatEffect.target;\n            result[activityName] = {\n                ...combatEffect,\n                target,\n            };\n        }\n    });\n    return result;\n}\n\nexport function getPartyActors(game: Game): Actor[] {\n    return game.actors?.filter(a => a.type === 'party') ?? [];\n}\n\nexport async function getHuntAndGatherActor(game: Game, data: Camping): Promise<Actor | null> {\n    const uuid = data.huntAndGatherTargetActorUuid;\n    if (uuid && (data.actorUuids.includes(uuid) || getPartyActors(game).find(a => a.uuid === uuid))) {\n        return await getActorByUuid(uuid);\n    }\n    return null;\n}\n","import {getActorByUuid} from './actor';\nimport {isFirstGm} from '../utils';\nimport {getCamping, getCampingActor} from './storage';\nimport {getEncounterDC, rollRandomEncounter} from './random-encounters';\nimport {\n    ActorAndIngredients,\n    addDiscoverSpecialMealResult,\n    addHuntAndGatherResult,\n    FoodAmount,\n    getIngredientList,\n} from './eating';\n\n\nasync function parseIngredientButton(element: HTMLElement): Promise<ActorAndIngredients | null> {\n    const actorUuid = element.dataset.actorUuid ?? '';\n    const specialIngredients = parseInt(element.dataset.specialIngredients ?? '0');\n    const basicIngredients = parseInt(element.dataset.basicIngredients ?? '0');\n    const actor = await getActorByUuid(actorUuid);\n    if (actor) {\n        return {specialIngredients, basicIngredients, actor};\n    }\n    return null;\n}\n\nexport async function addRecipe(game: Game, element: HTMLElement): Promise<void> {\n    const actorAndIngredients = await parseIngredientButton(element);\n    const critFailUuids = element.dataset.critFailUuids?.split(',') ?? [];\n    const recipe = element.dataset.recipe || null;\n    if (actorAndIngredients) {\n        if (isFirstGm(game)) {\n            await addDiscoverSpecialMealResult(game, actorAndIngredients, recipe, critFailUuids);\n        } else {\n            game.socket?.emit('module.pf2e-kingmaker-tools', {\n                action: 'addDiscoverSpecialMealResult',\n                data: {\n                    actorUuid: actorAndIngredients.actor.uuid,\n                    specialIngredients: actorAndIngredients.specialIngredients,\n                    basicIngredients: actorAndIngredients.basicIngredients,\n                    critFailUuids,\n                    recipe,\n                },\n            });\n        }\n    }\n}\n\nexport async function addIngredients(game: Game, element: HTMLElement): Promise<void> {\n    const actorAndIngredients = await parseIngredientButton(element);\n    if (actorAndIngredients) {\n        if (isFirstGm(game)) {\n            await addHuntAndGatherResult(game, actorAndIngredients);\n        } else {\n            game.socket?.emit('module.pf2e-kingmaker-tools', {\n                action: 'addHuntAndGatherResult',\n                data: {\n                    actorUuid: actorAndIngredients.actor.uuid,\n                    specialIngredients: actorAndIngredients.specialIngredients,\n                    basicIngredients: actorAndIngredients.basicIngredients,\n                },\n            });\n        }\n    }\n}\n\n\nexport async function postHuntAndGatherResult(actor: Actor, food: FoodAmount): Promise<void> {\n    const basicIngredients = food.basicIngredients;\n    const specialIngredients = food.specialIngredients;\n    const ingredients = getIngredientList(basicIngredients, specialIngredients);\n    const content = `\n        <p><b>${actor.name}</b>: Add:</p>\n        <ul>${ingredients}</ul>\n        <button \n            type=\"button\" \n            class=\"km-add-food\" \n            data-actor-uuid=\"${actor.uuid}\"\n            data-basic-ingredients=\"${basicIngredients}\"\n            data-special-ingredients=\"${specialIngredients}\"\n        >Apply</button>\n    `;\n    await ChatMessage.create({content});\n}\n\nexport async function postDiscoverSpecialMealResult(\n    actor: Actor,\n    cost: FoodAmount,\n    recipe: string | null,\n    critFailUuids: string[],\n): Promise<void> {\n    const basicIngredients = cost.basicIngredients;\n    const specialIngredients = cost.specialIngredients;\n    const content = `\n        <p>${recipe ? `Learn ${recipe} and remove` : 'Remove'}${critFailUuids.length > 0 ? ' and suffer the Critical Failure effect' : ''}:</p>\n        <ul>${getIngredientList(basicIngredients, specialIngredients)}</ul>\n        <button \n            type=\"button\" \n            class=\"km-add-recipe\" \n            data-actor-uuid=\"${actor.uuid}\"\n            data-basic-ingredients=\"${basicIngredients}\"\n            data-special-ingredients=\"${specialIngredients}\"\n            ${recipe ? `data-recipe=\"${recipe}\"` : ''}\n            data-crit-fail-uuids=\"${critFailUuids.join(',')}\"\n        >Apply</button>\n    `;\n    await ChatMessage.create({content});\n}\n\nexport async function checkRandomEncounterMessage(): Promise<void> {\n    await ChatMessage.create({\n        content: '<button class=\"km-random-encounter\" type=\"button\">Check for Random Encounter</button>',\n        type: CONST.CHAT_MESSAGE_TYPES.ROLL,\n        rollMode: 'blindroll',\n    });\n}\n\nasync function checkForRandomEncounter(game: Game): Promise<void> {\n    const actor = getCampingActor(game);\n    if (actor) {\n        const current = getCamping(actor);\n        const dc = getEncounterDC(current, game);\n        await rollRandomEncounter(game, current.currentRegion, dc, false);\n    }\n}\n\nexport function bindCampingChatEventListeners(game: Game): void {\n    const actor = getCampingActor(game);\n    if (actor) {\n        const chatLog = $('#chat-log');\n        chatLog.on('click', '.km-add-food', (event) => addIngredients(game, event.currentTarget));\n        chatLog.on('click', '.km-add-recipe', (event) => addRecipe(game, event.currentTarget));\n        chatLog.on('click', '.km-random-encounter', () => checkForRandomEncounter(game));\n    }\n}\n","import {escapeHtml, isBlank, isFirstGm, isKingmakerInstalled, parseSelect} from '../utils';\nimport {getCamping, getCampingActor} from './storage';\nimport {getBooleanSetting} from '../settings';\n\n// FIXME\n// eslint-disable-next-line @typescript-eslint/no-unused-vars, @typescript-eslint/no-explicit-any\ntype EntityDocument<T> = any;\n\nexport interface CombatUpdate {\n    round: number;\n}\n\nasync function setEntityPlaylist(entity: EntityDocument<unknown>, name: string | null): Promise<void> {\n    await entity.setFlag('pf2e-kingmaker-tools', 'combat-track', {name});\n}\n\nfunction getEntityPlaylist(entity: EntityDocument<unknown>): string | null {\n    const playlist = entity.getFlag('pf2e-kingmaker-tools', 'combat-track') as {\n        name: string | null | undefined\n    } | undefined;\n    if (playlist?.name) {\n        return playlist.name;\n    }\n    return null;\n}\n\ninterface CombatPlaylistDialogOptions {\n    game: Game,\n    entityName: string,\n    activePlaylist: string | null | undefined,\n    onSubmit: (playlistName: string | null) => Promise<void>,\n}\n\nasync function setSceneCombatPlaylistDialog(options: CombatPlaylistDialogOptions): Promise<void> {\n    const playlistNames = options.game.playlists?.map(p => p.name ?? 'Unknown Playlist Name') ?? [];\n    new Dialog({\n        title: `Combat Track: ${options.entityName}`,\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-playlist\">Playlist</label>\n                <select name=\"playlist\">\n                    <option value=\"\">-</option>\n                    ${playlistNames.map(p => {\n            const name = escapeHtml(p);\n            return `<option value=\"${name}\" ${name === options.activePlaylist ? 'selected' : ''}>${name}</option>`;\n        }).join('')}\n                </select>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const track = parseSelect($html, 'playlist');\n                    if (isBlank(track)) {\n                        await options.onSubmit(null);\n                    } else {\n                        await options.onSubmit(track.trim());\n                    }\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 350,\n    }).render(true);\n}\n\nexport async function showSetSceneCombatPlaylistDialog(game: Game, entity: EntityDocument<unknown>): Promise<void> {\n    await setSceneCombatPlaylistDialog({\n        game,\n        activePlaylist: getEntityPlaylist(entity),\n        entityName: entity.name ?? 'Unknown Entity',\n        onSubmit: (playlist) => setEntityPlaylist(entity, playlist),\n    });\n}\n\nconst defaultKingmakerModuleSound = 'The Shrike Hills';\n\nconst kingmakerModulePlaylists = new Map<string, string>();\nkingmakerModulePlaylists.set('Dunsward', 'Dunsward');\nkingmakerModulePlaylists.set('Hooktongue', 'The Narlmarches');\nkingmakerModulePlaylists.set('Kamelands', 'Glenebon');\nkingmakerModulePlaylists.set('Narlmarches', 'The Narlmarches');\nkingmakerModulePlaylists.set('Nomen Heights', 'Dunsward');\nkingmakerModulePlaylists.set('Pitax', 'Capital Under Attack');\nkingmakerModulePlaylists.set('Sellen Hills', 'Glenebon');\nkingmakerModulePlaylists.set('Thousand Voices', 'First World');\nkingmakerModulePlaylists.set('Tor of Levenies', 'Dunsward');\nkingmakerModulePlaylists.set('Tuskwater', 'Glenebon');\nkingmakerModulePlaylists.set('Glenebon Lowlands', 'Glenebon');\nkingmakerModulePlaylists.set('Glenebon Uplands', 'Glenebon');\nkingmakerModulePlaylists.set('Tiger Lords', 'Glenebon');\nkingmakerModulePlaylists.set('Drelev', 'Glenebon');\nkingmakerModulePlaylists.set('Numeria', 'Glenebon');\nkingmakerModulePlaylists.set('Branthlend Mountains', 'Glenebon');\n\nfunction getKingmakerCombatSound(game: Game, name: string): PlaylistSound | undefined {\n    const combatPlaylistSourceId = '7CiwVus60FiuKFhK';\n    return game.playlists\n        ?.find(p => p._source._id === combatPlaylistSourceId)\n        ?.sounds\n        ?.getName(name);\n}\n\n/**\n * use overridden playlist first if it exists, otherwise fall back to kingmaker module one if\n * kingmaker has one available\n */\nfunction getRegionPlaylist(game: Game, region: string): Playlist | PlaylistSound | undefined {\n    const defaultRegionPlaylist = game.playlists?.getName(`Kingmaker.${region}`);\n    const kingmakerModulePlaylistSound = kingmakerModulePlaylists.get(region);\n    if (isKingmakerInstalled(game)\n        && defaultRegionPlaylist === undefined\n        && kingmakerModulePlaylistSound) {\n        return getKingmakerCombatSound(game, kingmakerModulePlaylistSound);\n    } else {\n        return defaultRegionPlaylist;\n    }\n}\n\nfunction getDefaultPlaylist(game: Game): Playlist | PlaylistSound | undefined {\n    const defaultPlaylist = game.playlists?.getName('Kingmaker.Default');\n    if (isKingmakerInstalled(game)\n        && defaultPlaylist === undefined) {\n        return getKingmakerCombatSound(game, defaultKingmakerModuleSound);\n    } else {\n        return defaultPlaylist;\n    }\n}\n\nfunction getRegion(game: Game): string {\n    const campingActor = getCampingActor(game);\n    if (campingActor) {\n        const camping = getCamping(campingActor);\n        return camping.currentRegion;\n    } else {\n        return 'Brevoy';\n    }\n}\n\nasync function ifPlaylistExists(game: Game, actors: Actor[], callback: (playlist: Playlist | PlaylistSound) => Promise<void>): Promise<void> {\n    if (isFirstGm(game) && getBooleanSetting(game, 'enableCombatTracks')) {\n        const region = getRegion(game);\n        const actorsPlaylist = actors\n            .map(a => getEntityPlaylist(a))\n            .find(a => !isBlank(a));\n        const sceneCombatPlaylist = game.scenes?.active ? getEntityPlaylist(game.scenes.active) : undefined;\n        const regionPlaylist = getRegionPlaylist(game, region);\n        const defaultPlaylist = getDefaultPlaylist(game);\n        const playlist =\n            (actorsPlaylist ? game.playlists?.getName(actorsPlaylist) : undefined)\n            ?? (sceneCombatPlaylist ? game.playlists?.getName(sceneCombatPlaylist) : undefined)\n            ?? regionPlaylist\n            ?? defaultPlaylist;\n        console.log('Found Playlist ' + playlist?.name);\n        if (playlist) {\n            await callback(playlist);\n        }\n    }\n}\n\nexport async function checkBeginCombat(game: Game, combat: StoredDocument<Combat>, update: CombatUpdate): Promise<void> {\n    if (combat.round === 0 && update.round === 1) {\n        const actors = combat.combatants\n            .map(a => a.actor)\n            .filter(a => a !== null) as Actor[];\n        await ifPlaylistExists(game, actors, async (music) => {\n            await game.scenes?.active?.playlist?.stopAll();\n            if (music instanceof Playlist) {\n                await music.playAll();\n            } else {\n                await music.update({playing: true});\n            }\n        });\n    }\n}\n\nexport async function stopCombat(game: Game, combat: StoredDocument<Combat> | null): Promise<void> {\n    const actors = (combat?.combatants\n        ?.map(a => a.actor)\n        ?.filter(a => a !== null) ?? []) as Actor[];\n    await ifPlaylistExists(game, actors, async (music) => {\n        if (music.playing) {\n            if (music instanceof Playlist) {\n                await music.stopAll();\n            } else {\n                await music.update({playing: false});\n            }\n            if (game.scenes?.active?.playlistSound) {\n                await game.scenes.active.playlistSound.update({playing: true});\n            } else {\n                await game.scenes?.active?.playlist?.playAll();\n            }\n        }\n    });\n}\n","export type DcType = 'zone' | 'actorLevel' | number;\nexport const specialIngredientUuid = 'Compendium.pf2e.equipment-srd.Item.OCTireuX60MaPcEi';\nexport const basicIngredientUuid = 'Compendium.pf2e.equipment-srd.Item.kKnMlymiqZLVEAtI';\nexport const rationUuid = 'Compendium.pf2e.equipment-srd.Item.L9ZV076913otGtiB';\n\nexport type CombatEffectCompanions = 'Amiri' | 'Nok-Nok' | 'Jaethal' | 'Kalikke';\n\nexport type Proficiency = 'trained' | 'expert' | 'master' | 'legendary';\n\nexport const allowedActors = new Set([\n    'character',\n    'npc',\n    'loot',\n    'vehicle',\n]);","import {\n    capitalize,\n    createUUIDLink,\n    deCamelCase,\n    escapeHtml,\n    isBlank,\n    LabelAndValue,\n    listenClick,\n    parseSelect,\n    parseTextInput,\n    range,\n    unslugify,\n} from '../../utils';\nimport {ActivityEffect, ActivityOutcome, CampingActivityData, CampingActivityName, EffectTarget} from '../activities';\nimport {getEffectByUuid} from '../actor';\nimport {DcType, Proficiency} from '../data';\nimport {skillDialog, SkillView} from '../../common/skills-dialog';\nimport {allActorSkills, CharacterSkill} from '../../kingdom/data/skills';\n\nexport interface AddActivityOptions {\n    onSubmit: (activity: CampingActivityData) => Promise<void>;\n    homebrewActivities: CampingActivityData[];\n    activity?: CampingActivityData;\n}\n\ninterface Effect {\n    target: string;\n    effect: string;\n    key: string;\n}\n\ninterface ViewOutcome {\n    id: string;\n    label: string;\n    message: string;\n    effects: Effect[];\n    modifyRandomEncounterDc: {\n        day: number;\n        night: number;\n    };\n    checkRandomEncounter: boolean;\n}\n\ninterface ViewData {\n    outcomes: ViewOutcome[];\n    effects: Effect[];\n    name: CampingActivityName;\n    journalUuid: string;\n    dc: DcType | '';\n    modifyRandomEncounterDc: {\n        day: number;\n        night: number;\n    },\n    isSecret: boolean;\n    errors: string[];\n    dcs: LabelAndValue[];\n    skills: SkillView[];\n}\n\nconst allOutcomes = ['criticalSuccess', 'success', 'failure', 'criticalFailure'] as const;\ntype  ActivityOutcomeType = typeof allOutcomes[number];\n\ntype FormData = {\n    'day-encounter-dc': number;\n    'night-encounter-dc': number;\n    dc: string;\n    journal: string;\n    name: string;\n    secret: false;\n    'skill-proficiency': Proficiency;\n    'skill-requirement': string;\n    skills: string;\n    'criticalFailure-day-modifier': number;\n    'criticalFailure-message': string;\n    'criticalFailure-night-modifier': number;\n    'criticalFailure-roll-encounter': boolean;\n    'failure-day-modifier': number;\n    'failure-message': string;\n    'failure-night-modifier': number;\n    'failure-roll-encounter': boolean;\n    'criticalSuccess-day-modifier': number;\n    'criticalSuccess-message': string;\n    'criticalSuccess-night-modifier': number;\n    'criticalSuccess-roll-encounter': boolean;\n    'success-day-modifier': number;\n    'success-message': string;\n    'success-night-modifier': number;\n    'success-roll-encounter': boolean;\n};\n\nfunction emptyOutcome(): ActivityOutcome {\n    return {\n        checkRandomEncounter: false,\n        effectUuids: [],\n        modifyRandomEncounterDc: {\n            day: 0,\n            night: 0,\n        },\n        message: '',\n    };\n}\n\nclass AddCampingActivities extends FormApplication<FormApplicationOptions & AddActivityOptions, object, null> {\n    private onSubmitCallback: (activity: CampingActivityData) => Promise<void>;\n    private homebrewActivities: CampingActivityData[];\n    private activity: CampingActivityData;\n    private originalName: CampingActivityName | undefined;\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-add-camping-activities';\n        options.title = 'Manage Camping Activities';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/camping/add-activities.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & AddActivityOptions) {\n        super(object, options);\n        this.onSubmitCallback = options.onSubmit;\n        this.homebrewActivities = deepClone(options.homebrewActivities);\n        this.originalName = options.activity?.name;\n        this.activity = deepClone(options.activity) ?? {\n            journalUuid: '',\n            isHomebrew: true,\n            dc: 'zone',\n            effectUuids: [],\n            modifyRandomEncounterDc: {\n                night: 0,\n                day: 0,\n            },\n            isLocked: false,\n            skills: 'any',\n            isSecret: false,\n            name: '' as CampingActivityName,\n            skillRequirements: [],\n            criticalFailure: emptyOutcome(),\n            criticalSuccess: emptyOutcome(),\n            success: emptyOutcome(),\n            failure: emptyOutcome(),\n        };\n    }\n\n    override async getData(): Promise<ViewData> {\n        return {\n            outcomes: await Promise.all(allOutcomes.map(async (s) => {\n                const activity = this.activity[s];\n                return {\n                    id: s,\n                    label: unslugify(s),\n                    checkRandomEncounter: activity?.checkRandomEncounter ?? false,\n                    message: activity?.message ?? '',\n                    modifyRandomEncounterDc: {\n                        day: activity?.modifyRandomEncounterDc?.day ?? 0,\n                        night: activity?.modifyRandomEncounterDc?.night ?? 0,\n                    },\n                    effects: await this.getEffects(activity?.effectUuids ?? [], s),\n                };\n            })),\n            effects: await this.getEffects(this.activity.effectUuids ?? [], 'effect'),\n            dc: this.activity.dc ?? '',\n            isSecret: this.activity.isSecret ?? false,\n            journalUuid: this.activity.journalUuid ?? '',\n            modifyRandomEncounterDc: {\n                day: this.activity.modifyRandomEncounterDc?.day ?? 0,\n                night: this.activity.modifyRandomEncounterDc?.night ?? 0,\n            },\n            name: this.activity.name ?? '',\n            errors: await this.validate(this.activity),\n            dcs: ['actorLevel', 'zone', ...range(0, 60)].map(e => {\n                return {label: deCamelCase(e.toString()), value: e.toString()};\n            }),\n            skills: this.activity.skills === 'any' ? [{id: 'all', label: 'All'}] : this.activity.skills.map(s => {\n                const proficiency = this.activity.skillRequirements\n                    .find(r => r.skill === s)?.proficiency;\n                return {\n                    label: unslugify(s),\n                    id: s,\n                    proficiency,\n                };\n            }),\n        };\n    }\n\n    private async getEffects(effectUuids: ActivityEffect[], key: string): Promise<Effect[]> {\n        return await Promise.all(effectUuids?.map(async (e): Promise<Effect> => {\n            return {\n                key,\n                target: e.target ? capitalize(e.target) : 'All',\n                effect: await TextEditor.enrichHTML(createUUIDLink(e.uuid)),\n            };\n        }));\n    }\n\n    protected async _updateObject(event: Event, formData: FormData): Promise<void> {\n        console.log(formData);\n        this.activity.journalUuid = formData.journal;\n        this.activity.name = formData.name as CampingActivityName;\n        this.activity.isSecret = formData.secret;\n        this.activity.isLocked = false;\n        this.activity.dc = parseDC(formData.dc);\n        if (formData['night-encounter-dc'] || formData['day-encounter-dc']) {\n            this.activity.modifyRandomEncounterDc = {\n                day: formData['day-encounter-dc'] ?? 0,\n                night: formData['night-encounter-dc'] ?? 0,\n            };\n        } else {\n            this.activity.modifyRandomEncounterDc = undefined;\n        }\n        this.activity.isHomebrew = true;\n        allOutcomes.forEach(outcome => {\n            this.activity[outcome]!.message = formData[`${outcome}-message`];\n            this.activity[outcome]!.checkRandomEncounter = formData[`${outcome}-roll-encounter`];\n            this.activity[outcome]!.modifyRandomEncounterDc!.day = formData[`${outcome}-day-modifier`];\n            this.activity[outcome]!.modifyRandomEncounterDc!.night = formData[`${outcome}-night-modifier`];\n        });\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.save', async (): Promise<void> => {\n            await this.onSubmitCallback(this.activity);\n            await this.close();\n        });\n        listenClick($html, '.add-effect', async (ev): Promise<void> => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const type = button.dataset.type as ActivityOutcomeType | 'effect';\n            const value: ActivityEffect = {\n                target: 'all',\n                uuid: '',\n            };\n            editActivityDialog(value, () => {\n                if (type === 'effect') {\n                    this.activity.effectUuids = (this.activity.effectUuids ?? []);\n                    this.activity.effectUuids.push(value);\n                } else {\n                    this.activity[type]!.effectUuids = (this.activity[type]?.effectUuids ?? []);\n                    this.activity[type]!.effectUuids!.push(value);\n                }\n                this.render();\n            });\n        });\n        listenClick($html, '.edit-skills', async (): Promise<void> => {\n            const skills = this.activity.skills;\n            const selectedLores = skills === 'any' ? [] : skills\n                .filter(s => !allActorSkills.includes(s as CharacterSkill))\n                .map(s => {\n                    return {\n                        id: s,\n                        proficiency: this.activity.skillRequirements.find(req => req.skill === s)?.proficiency,\n                    };\n                });\n            const selectedSkills = skills === 'any' ? [] : skills\n                .filter(s => allActorSkills.includes(s as CharacterSkill))\n                .map(s => {\n                    return {\n                        id: s,\n                        proficiency: this.activity.skillRequirements.find(req => req.skill === s)?.proficiency,\n                    };\n                });\n            skillDialog({\n                selectedLores,\n                selectedSkills,\n                atLeastOne: true,\n                all: skills === 'any',\n                onSave: (data) => {\n                    if (data.all) {\n                        this.activity.skills = 'any';\n                        this.activity.skillRequirements = [];\n                    } else {\n                        const loresAndSkills = [\n                            ...data.selectedSkills,\n                            ...data.selectedLores,\n                        ];\n                        this.activity.skills = loresAndSkills.map(s => s.id);\n                        this.activity.skillRequirements = loresAndSkills\n                            .filter(s => s.proficiency !== undefined)\n                            .map(s => {\n                                return {\n                                    skill: s.id,\n                                    proficiency: s.proficiency!,\n                                };\n                            });\n                    }\n                    this.render();\n                },\n                availableSkills: [...allActorSkills],\n            });\n        });\n        listenClick($html, '.edit-effect', async (ev): Promise<void> => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const type = button.dataset.type as ActivityOutcomeType | 'effect';\n            const index = parseInt(button.dataset.id ?? '0', 10);\n            let value: ActivityEffect;\n            if (type === 'effect') {\n                value = this.activity.effectUuids![index];\n            } else {\n                value = this.activity[type]!.effectUuids![index];\n            }\n            editActivityDialog(value, () => this.render());\n        });\n        listenClick($html, '.delete-effect', async (ev): Promise<void> => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const type = button.dataset.type as ActivityOutcomeType | 'effect';\n            const index = parseInt(button.dataset.id ?? '0', 10);\n            if (type === 'effect') {\n                this.activity.effectUuids = this.activity.effectUuids\n                    ?.filter((_, i) => i !== index);\n            } else {\n                this.activity[type]!.effectUuids = this.activity[type]?.effectUuids\n                    ?.filter((_, i) => i !== index);\n            }\n            this.render();\n        });\n    }\n\n    private async validate(activity: CampingActivityData): Promise<string[]> {\n        const result = [];\n        if (isBlank(activity.name)) {\n            result.push('Name must not be blank');\n        }\n        if (this.homebrewActivities.find(a => a.name === activity.name && a.name !== this.originalName)) {\n            result.push(`Homebrew Activity with name ${activity.name} already exists`);\n        }\n        if (activity.journalUuid && !(await fromUuid(activity.journalUuid))) {\n            result.push(`Journal with uuid ${activity.journalUuid} does not exist`);\n        }\n        return result;\n    }\n}\n\nfunction editActivityDialog(data: ActivityEffect, onOk: () => void = (): void => {\n}): void {\n    new Dialog({\n        title: 'Add/Edit Effect',\n        content: `\n        <form class=\"simple-dialog-form\">\n           <div>\n                <label for=\"km-effect\">Effect UUID</label>\n                <input type=\"text\" name=\"effect\" id=\"km-effect\" value=\"${escapeHtml(data.uuid)}\">\n            </div>\n            <div>\n                <label for=\"km-effect-target\">Effect Target</label>\n                <select name=\"effect-target\" id=\"km-effect-target\">\n                    <option value=\"all\" ${data.target === 'all' ? 'selected' : ''}>All</option>\n                    <option value=\"allies\" ${data.target === 'allies' ? 'selected' : ''}>Allies</option>\n                    <option value=\"self\" ${data.target === 'self' ? 'selected' : ''}>Self</option>\n                </select>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const effectUuid = parseTextInput($html, 'effect');\n                    const effectTarget = parseSelect($html, 'effect-target') as EffectTarget;\n                    const item = await getEffectByUuid(effectUuid);\n                    if (item === null) {\n                        ui.notifications?.error(`Can not find effect item with uuid ${effectUuid}`);\n                    } else {\n                        data.uuid = effectUuid;\n                        data.target = effectTarget;\n                        onOk();\n                    }\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 321,\n    }).render(true);\n}\n\nexport function addActivityDialog(options: AddActivityOptions): void {\n    new AddCampingActivities(null, options).render(true);\n}\n\nfunction parseDC(value: string): DcType | undefined {\n    if (!isBlank(value)) {\n        if (value === 'zone') {\n            return 'zone';\n        } else if (value === 'actorLevel') {\n            return 'actorLevel';\n        } else {\n            const number = parseInt(value, 10);\n            if (!isNaN(number)) {\n                return number;\n            }\n        }\n    }\n    return undefined;\n}\n","import {parseCheckbox, parseNumberInput, parseSelect, parseTextInput} from '../../utils';\nimport {MealEffect, Rarity, RecipeData} from '../recipes';\nimport {getEffectByUuid} from '../actor';\n\nexport interface AddRecipeOptions {\n    onSubmit: (recipe: RecipeData) => Promise<void>;\n    recipes: RecipeData[];\n}\n\nexport function addRecipeDialog({onSubmit, recipes}: AddRecipeOptions): void {\n    new Dialog({\n        title: 'Add Recipe',\n        content: `\n        <div>\n        <p>Hint: UUIDs can be found in the item's <b>Rules</b> tab</p>\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-recipe-name\">Name</label>\n                <input type=\"text\" name=\"name\" id=\"km-recipe-name\" placeholder=\"Unknown Meal\">\n            </div>\n            <div>\n                <label for=\"km-recipe-uuid\">UUID</label>\n                <input type=\"text\" name=\"uuid\" id=\"km-recipe-uuid\">\n            </div>\n            <div>\n                <label for=\"km-recipe-level\">Level</label>\n                <input type=\"number\" name=\"level\" id=\"km-recipe-level\"  placeholder=\"0\">\n            </div>\n            <div>\n                <label for=\"km-recipe-rarity\">Rarity</label>\n                <select name=\"rarity\">\n                    <option value=\"common\">Common</option>\n                    <option value=\"uncommon\">Uncommon</option>\n                    <option value=\"rare\">Rare</option>\n                    <option value=\"unique\">Unique</option>\n                </select>\n            </div>\n            <div>\n                <label for=\"km-recipe-cooking-lore-dc\">Cooking Lore DC</label>\n                <input type=\"number\" name=\"cooking-lore-dc\" id=\"km-recipe-cooking-lore-dc\" placeholder=\"0\">\n            </div>\n            <div>\n                <label for=\"km-recipe-survival-dc\">Survival DC</label>\n                <input type=\"number\" name=\"survival-dc\" id=\"km-recipe-survival-dc\" placeholder=\"0\">\n            </div>\n            <div>\n                <label for=\"km-recipe-basic\">Basic Ingredients</label>\n                <input type=\"number\" name=\"basic-ingredients\" id=\"km-recipe-basic\" placeholder=\"0\">\n            </div>\n            <div>\n                <label for=\"km-recipe-special\">Special Ingredients</label>\n                <input type=\"number\" name=\"special-ingredients\" id=\"km-recipe-special\" placeholder=\"0\">\n            </div>\n            <div>\n                <label for=\"km-recipe-cost\">Cost</label>\n                <input type=\"text\" name=\"cost\" id=\"km-recipe-cost\" placeholder=\"0 gp\">\n            </div>\n            \n            <div>\n                <label for=\"km-favorite-meal-effect-uuid\">Favorite Meal: Effect UUID</label>\n                <input type=\"text\" name=\"favorite-meal-effect-uuid\" id=\"km-favorite-meal-effect-uuid\">\n            </div>\n            <div>\n                <label for=\"km-favorite-meal-remove-rest\">Favorite Meal: Remove Effect after Rest</label>\n                <input type=\"checkbox\" name=\"favorite-meal-remove-rest\" id=\"km-favorite-meal-remove-rest\">\n            </div>\n            \n            <div>\n                <label for=\"km-critical-success-effect-uuid\">Critical Success: Effect UUID</label>\n                <input type=\"text\" name=\"critical-success-effect-uuid\" id=\"km-critical-success-effect-uuid\">\n            </div>\n            <div>\n                <label for=\"km-critical-success-remove-rest\">Critical Success: Remove Effect after Rest</label>\n                <input type=\"checkbox\" name=\"critical-success-remove-rest\" id=\"km-critical-success-remove-rest\">\n            </div>\n            \n            <div>\n                <label for=\"km-success-effect-uuid\">Success: Effect UUID</label>\n                <input type=\"text\" name=\"success-effect-uuid\" id=\"km-success-effect-uuid\">\n            </div>\n            <div>\n                <label for=\"km-success-remove-rest\">Success: Remove Effect after Rest</label>\n                <input type=\"checkbox\" name=\"success-remove-rest\" id=\"km-success-remove-rest\">\n            </div>\n            \n            <div>\n                <label for=\"km-critical-failure-effect-uuid\">Critical Failure: Effect UUID</label>\n                <input type=\"text\" name=\"critical-failure-effect-uuid\" id=\"km-critical-failure-effect-uuid\">\n            </div>\n            <div>\n                <label for=\"km-critical-failure-remove-rest\">Critical Failure: Remove Effect after Rest</label>\n                <input type=\"checkbox\" name=\"critical-failure-remove-rest\" id=\"km-critical-failure-remove-rest\">\n            </div>\n        </form>\n        </div>\n        `,\n        buttons: {\n            add: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Add',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const uuid = parseTextInput($html, 'uuid');\n                    const item = await fromUuid(uuid);\n                    const name = parseTextInput($html, 'name') || 'Unknown Meal';\n                    if (item === null) {\n                        ui.notifications?.error(`Can not find item with uuid ${uuid}`);\n                    } else if (recipes.find(r => r.name === name)) {\n                        ui.notifications?.error(`Recipe with name ${name} exists already`);\n                    } else {\n                        const favoriteEffect = await parseEffects($html, 'favorite-meal');\n                        const critSuccEffect = await parseEffects($html, 'critical-success');\n                        const succEffect = await parseEffects($html, 'success');\n                        const failEffect = await parseEffects($html, 'critical-failure');\n                        await onSubmit({\n                            isHomebrew: true,\n                            specialIngredients: parseNumberInput($html, 'special-ingredients') || 0,\n                            level: parseNumberInput($html, 'level') || 0,\n                            name,\n                            rarity: parseSelect($html, 'rarity') as Rarity,\n                            cost: parseTextInput($html, 'cost') || '0 gp',\n                            uuid,\n                            survivalDC: parseNumberInput($html, 'survival-dc') || 0,\n                            basicIngredients: parseNumberInput($html, 'basic-ingredients') || 0,\n                            cookingLoreDC: parseNumberInput($html, 'cooking-lore-dc') || 0,\n                            favoriteMeal: {\n                                effects: favoriteEffect,\n                            },\n                            criticalSuccess: {\n                                effects: critSuccEffect,\n                            },\n                            success: {\n                                effects: succEffect,\n                            },\n                            criticalFailure: {\n                                effects: failEffect,\n                            },\n                        });\n                    }\n                },\n            },\n        },\n        default: 'add',\n    }, {\n        jQuery: false,\n        width: 510,\n    }).render(true);\n}\n\nasync function parseEffects($html: HTMLElement, name: string): Promise<MealEffect[]> {\n    const effect = parseTextInput($html, name + '-effect-uuid') || undefined;\n    const removeAfterRest = parseCheckbox($html, name + '-remove-rest') || false;\n    if (effect) {\n        const item = await getEffectByUuid(effect);\n        if (item === null) {\n            ui.notifications?.error(`Can not find effect item with uuid ${effect}`);\n        } else {\n            return [{\n                uuid: effect,\n                removeAfterRest,\n            }];\n        }\n    }\n    return [];\n}\n","import {parseNumberInput} from '../../utils';\n\nexport interface AskDcOptions {\n    onSubmit: (dc: number) => Promise<void>;\n    activity: string;\n}\nexport function askDcDialog(options: AskDcOptions): void {\n    new Dialog({\n        title: `Set DC: ${options.activity}`,\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-dc\">DC</label>\n                <input type=\"number\" name=\"dc\" id=\"km-dc\">\n            </div>\n        </form>\n        `,\n        buttons: {\n            roll: {\n                icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n                label: 'Roll',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    await options.onSubmit(parseNumberInput($html, 'dc'));\n                },\n            },\n        },\n        default: 'roll',\n    }, {\n        jQuery: false,\n        width: 250,\n    }).render(true);\n}\n","import {escapeHtml, parseCheckbox, parseNumberInput, parseSelect, parseTextInput, rollModeChoices} from '../../utils';\nimport {RestRollMode} from '../camping';\nimport {setSetting} from '../../settings';\n\nexport interface SettingData {\n    gunsToClean: number;\n    restRollMode: RestRollMode;\n    increaseWatchActorNumber: number;\n    huntAndGatherTargetActorUuid: string | null | undefined;\n    actors: Actor[];\n    actorsKeepingWatch: { uuid: string, name: string, watchEnabled: boolean }[];\n    ignoreSkillRequirements: boolean;\n    randomEncounterRollMode: RollMode,\n    proxyRandomEncounterTable: string;\n}\n\nexport interface CampingSettingOptions {\n    onSubmit: (data: {\n        gunsToClean: number,\n        restRollMode: RestRollMode,\n        increaseWatchActorNumber: number,\n        actorUuidsNotKeepingWatch: string[],\n        huntAndGatherTargetActorUuid: string | null,\n        ignoreSkillRequirements: boolean,\n    }) => Promise<void>;\n    data: SettingData;\n    game: Game,\n}\n\nexport function campingSettingsDialog({onSubmit, data, game}: CampingSettingOptions): void {\n    new Dialog({\n        title: 'Camping Settings',\n        content: `\n        <form class=\"km-settings-form\">\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-guns-to-clean\">Guns To Clean</label>\n                    <input type=\"number\" name=\"guns-to-clean\" id=\"km-guns-to-clean\" value=\"${data.gunsToClean}\">\n                </div>\n            </div>\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-increase-actor-watch-number\">Increase Actors Keeping Watch</label>\n                    <input type=\"number\" name=\"increase-actor-watch-number\" id=\"km-increase-actor-watch-number\" value=\"${data.increaseWatchActorNumber}\">\n                </div>\n            </div>\n            ${data.actorsKeepingWatch.map(a => {\n            return `\n                <div>\n                    <div class=\"form-elements\">\n                        <label for=\"km-actor-uuids-keeping-watch-${a.uuid}\">Keep Watch: ${escapeHtml(a.name)}</label>\n                        <input type=\"checkbox\" name=\"actor-uuids-keeping-watch-${a.uuid}\" id=\"km-actor-uuids-keeping-watch-${a.uuid}\" ${a.watchEnabled ? 'checked' : ''}>\n                    </div>\n                </div>\n                `;\n        }).join('')}\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-rest-roll-mode\">Rest Random Encounter Roll Mode</label>\n                    <select name=\"rest-roll-mode\" id=\"km-rest-roll-mode\">\n                        <option value=\"none\" ${data.restRollMode === 'none' ? 'selected' : ''}>Don't Roll Encounter Check</option>\n                        <option value=\"one\" ${data.restRollMode === 'one' ? 'selected' : ''}>Roll 1 Encounter Check</option>\n                        <option value=\"one-every-4-hours\" ${data.restRollMode === 'one-every-4-hours' ? 'selected' : ''}>Roll 1 Encounter Check Every 4 Hours</option>\n                    </select>\n                </div>\n            </div>\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-proxy-random-encounter-table\">Proxy Random Encounter Table</label>\n                    <input type=\"text\" name=\"proxy-random-encounter-table\" id=\"km-proxy-random-encounter-table\" value=\"${data.proxyRandomEncounterTable}\">\n                </div>\n                <div class=\"help\">\n                    <p>Name of the in world roll table that is rolled first to check what kind of encounter is rolled. Use the string \"Creature\" to roll on the region roll table in the proxy roll table or link another roll table of your choice. Leave blank to always roll on the region random encounter tables.</p>\n                </div>\n            </div>\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-random-encounter-roll-mode\">Random Encounter Roll Mode</label>\n                    <select name=\"random-encounter-roll-mode\" id=\"km-random-encounter-roll-mode\">\n                        ${Object.entries(rollModeChoices)\n            .map(([value, label]) => {\n                    return `<option value=\"${value}\" ${value === data.randomEncounterRollMode ? 'selected' : ''}>${label}</option>`;\n                },\n            ).join('')}\n                    </select>\n                </div>\n            </div>\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-hunt-and-gather-actor\">Add Ingredients from Hunt and Gather To</label>\n                    <select name=\"hunt-and-gather-actor\" id=\"km-hunt-and-gather-actor\">\n                        <option value=\"\">Actor performing Hunt and Gather</option>\n                        ${data.actors.map(a => {\n            return `\n                            <option value=\"${a.uuid}\" ${a.uuid === data.huntAndGatherTargetActorUuid ? 'selected' : ''}>${a.name}</option>\n                            `;\n        }).join('')}\n                    </select>\n                </div>\n            </div>\n            <div>\n                <div class=\"form-elements\">\n                    <label for=\"km-ignore-skill-requirements\">Do not validate Activity Skill Proficiency</label>\n                    <input type=\"checkbox\" name=\"ignore-skill-requirements\" id=\"km-ignore-skill-requirements\" ${data.ignoreSkillRequirements ? 'checked' : ''}>\n                </div>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const gunsToClean = parseNumberInput($html, 'guns-to-clean');\n                    const increaseWatchActorNumber = parseNumberInput($html, 'increase-actor-watch-number') || 0;\n                    const restRollMode = parseSelect($html, 'rest-roll-mode') as RestRollMode;\n                    const huntAndGatherTargetActorUuid = parseSelect($html, 'hunt-and-gather-actor') || null;\n                    const ignoreSkillRequirements = parseCheckbox($html, 'ignore-skill-requirements') || false;\n                    const actorUuidsNotKeepingWatch = data.actorsKeepingWatch\n                        .filter(a => !parseCheckbox($html, `actor-uuids-keeping-watch-${a.uuid}`))\n                        .map(a => a.uuid);\n                    const randomEncounterRollMode: RollMode = (parseSelect($html, 'random-encounter-roll-mode') as RollMode) || 'publicroll';\n                    const proxyRandomEncounterTable = parseTextInput($html, 'proxy-random-encounter-table');\n                    await setSetting(game, 'proxyEncounterTable', proxyRandomEncounterTable);\n                    await setSetting(game, 'randomEncounterRollMode', randomEncounterRollMode);\n                    await onSubmit({\n                        gunsToClean,\n                        restRollMode,\n                        increaseWatchActorNumber,\n                        actorUuidsNotKeepingWatch,\n                        huntAndGatherTargetActorUuid,\n                        ignoreSkillRequirements,\n                    });\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 550,\n    }).render(true);\n}\n","import {RecipeData} from '../recipes';\nimport {toTemplateRecipe, ViewRecipeData} from './manage-recipes';\nimport {escapeHtml, parseRadio} from '../../utils';\nimport {FoodAmount} from '../eating';\n\nexport interface LearnRecipeOptions {\n    actor: Actor;\n    availableFood: FoodAmount;\n    availableRecipes: RecipeData[];\n    onSubmit: (recipe: string | null) => Promise<void>\n}\n\nfunction tpl(availableRecipes: ViewRecipeData[], availableFood: FoodAmount): string {\n    const recipes = availableRecipes.map((r) => {\n        return {\n            ...r,\n            disabled: availableFood.specialIngredients < (r.specialIngredients * 2) ||\n                availableFood.basicIngredients < (r.basicIngredients * 2),\n        };\n    });\n    const checkedIndex = recipes.findIndex(r => !r.disabled);\n    return `\n    <form>\n        <h1>Recipes Learnable in Zone</h1>\n        <p><b>Available Basic Ingredients</b>: ${availableFood.basicIngredients}</p>\n        <p><b>Available Special Ingredients</b>: ${availableFood.specialIngredients}</p>\n        <table class=\"km-table\">\n            <thead>\n            <tr>\n                <th>Recipe</th>\n                <th>DC</th>\n                <th>Cost</th>\n                <th>Learn</th>\n            </tr>\n            </thead>\n            <tbody>\n            ${recipes.map((r, index) => {\n                const checked = checkedIndex === index;\n                return `<tr>\n                    <td>${r.recipe}</td>\n                    <td>${r.cookingLoreDC}</td>\n                    <td>${escapeHtml(r.learningCost)}</td>\n                    <td><input type=\"radio\" name=\"recipe\" value=\"${escapeHtml(r.name)}\" ${checked ? 'checked' : ''} ${r.disabled ? 'disabled' : ''}></td>\n                </tr>`;\n    }).join('')}\n            </tbody>\n        </table>\n    </form>\n`;\n}\n\nexport async function discoverSpecialMeal(options: LearnRecipeOptions): Promise<void> {\n    const availableRecipes = await Promise.all(options.availableRecipes\n        .map(r => toTemplateRecipe(r, new Set())));\n    new Dialog({\n        title: 'Discover Special Meal',\n        content: tpl(availableRecipes, options.availableFood),\n        buttons: {\n            learn: {\n                icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n                label: 'Learn',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const recipe = parseRadio($html, 'recipe');\n                    await options.onSubmit(recipe);\n                },\n            },\n        },\n        default: 'learn',\n    }, {\n        jQuery: false,\n        width: 510,\n    }).render(true);\n}\n","import {listenClick} from '../../utils';\nimport {CampingActivityName} from '../activities';\nimport {getCampingActivityData} from '../camping';\nimport {getCamping, saveCamping} from '../storage';\nimport {addActivityDialog} from './add-activity';\n\ninterface ManageActivitiesOptions {\n    game: Game;\n    actor: Actor;\n}\n\ninterface ViewActivity {\n    isHomebrew: boolean;\n    name: string;\n    enabled: boolean;\n}\n\ninterface ManageActivityView {\n    activities: ViewActivity[];\n}\n\ntype ManageActivitiesFormData = Record<string, boolean>;\n\nclass ManageCampingActivities extends FormApplication<FormApplicationOptions & ManageActivitiesOptions, object, null> {\n    private game: Game;\n    private actor: Actor;\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-manage-camping-activities';\n        options.title = 'Manage Camping Activities';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/camping/manage-activities.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & ManageActivitiesOptions) {\n        super(object, options);\n        this.game = options.game;\n        this.actor = options.actor;\n    }\n\n    override async getData(): Promise<ManageActivityView> {\n        const camping = getCamping(this.actor);\n        const activities = getCampingActivityData(camping);\n        const lockedActivities = new Set(camping.lockedActivities);\n        return {\n            activities: activities\n                .sort((a, b) => a.name.localeCompare(b.name))\n                .map(a => {\n                    return {\n                        name: a.name,\n                        isHomebrew: !!a.isHomebrew,\n                        enabled: !lockedActivities.has(a.name),\n                    };\n                }),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: ManageActivitiesFormData): Promise<void> {\n        console.log(formData);\n        await saveCamping(this.game, this.actor, {\n            lockedActivities: Object.entries(formData)\n                .filter(([, enabled]) => !enabled)\n                .map(([name]) => name) as CampingActivityName[],\n        });\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.add-activity', async (): Promise<void> => {\n            const camping = getCamping(this.actor);\n            await addActivityDialog({\n                homebrewActivities: camping.homebrewCampingActivities,\n                onSubmit: async (activity): Promise<void> => {\n                    await saveCamping(this.game, this.actor, {\n                        homebrewCampingActivities: [...camping.homebrewCampingActivities, activity],\n                    });\n                    this.render();\n                },\n            });\n        });\n        listenClick($html, '.edit-activity', async (ev: Event): Promise<void> => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const name = button.dataset.name!;\n            const camping = getCamping(this.actor);\n            await addActivityDialog({\n                activity: camping.homebrewCampingActivities.find(a => a.name === name),\n                homebrewActivities: camping.homebrewCampingActivities,\n                onSubmit: async (activity): Promise<void> => {\n                    await saveCamping(this.game, this.actor, {\n                        homebrewCampingActivities: [...camping.homebrewCampingActivities.filter(a => a.name !== name), activity],\n                    });\n                    this.render();\n                },\n            });\n        });\n        listenClick($html, '.delete-activity', async (ev: Event): Promise<void> => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const name = button.dataset.name!;\n            const camping = getCamping(this.actor);\n            await saveCamping(this.game, this.actor, {\n                homebrewCampingActivities: camping.homebrewCampingActivities.filter(a => a.name !== name),\n            });\n            this.render();\n        });\n    }\n}\n\n\nexport async function manageActivitiesDialog(options: ManageActivitiesOptions): Promise<void> {\n    new ManageCampingActivities(null, options).render(true);\n}\n","import {Rarity, RecipeData} from '../recipes';\nimport {createUUIDLink, escapeHtml, parseCheckbox} from '../../utils';\n\ninterface ManageRecipesOptions {\n    recipes: RecipeData[];\n    isGM: boolean;\n    learnedRecipes: Set<string>;\n    onSubmit: (learnedRecipes: Set<string>, deletedRecipes: Set<string>) => Promise<void>\n}\n\nexport interface ViewRecipeData {\n    learned: boolean;\n    recipe: string;\n    recipeName: string;\n    cookingLoreDC: number;\n    learningCost: string;\n    cookingCost: string;\n    price: string;\n    rarity: Rarity,\n    level: number;\n    name: string;\n    isHomebrew: boolean;\n    basicIngredients: number;\n    specialIngredients: number;\n}\n\nfunction formatCost(basic: number, special: number): string {\n    const result = [];\n    if (basic > 0) {\n        result.push(`Basic: ${basic}`);\n    }\n    if (special > 0) {\n        result.push(`Special: ${special}`);\n    }\n    return result.join(', ');\n}\n\nexport async function toTemplateRecipe(recipe: RecipeData, learnedRecipes: Set<string>): Promise<ViewRecipeData> {\n    return {\n        learned: learnedRecipes.has(recipe.name),\n        name: recipe.name,\n        recipe: await TextEditor.enrichHTML(createUUIDLink(recipe.uuid, recipe.name)),\n        recipeName: recipe.name,\n        cookingLoreDC: recipe.cookingLoreDC,\n        cookingCost: formatCost(recipe.basicIngredients, recipe.specialIngredients),\n        learningCost: formatCost(recipe.basicIngredients*2, recipe.specialIngredients*2),\n        basicIngredients: recipe.basicIngredients,\n        specialIngredients: recipe.specialIngredients,\n        price: recipe.cost,\n        rarity: recipe.rarity,\n        level: recipe.level,\n        isHomebrew: recipe.isHomebrew ?? false,\n    };\n}\n\nfunction tpl(data: ViewRecipeData[], isGM: boolean): string {\n    return `\n        <form class=\"camping-dialog\">\n            <table class=\"km-table\">\n                <tr>\n                    <th>Name</th>\n                    <th>Rarity</th>\n                    <th>Level</th>\n                    <th>DC</th>\n                    <th>Cooking Cost</th>\n                    <th>Learning Cost</th>\n                    <th>Purchase Cost</th>\n                    <th>Learned</th>\n                    <th>Delete</th>\n                </tr>\n                ${data.map((r, index) => {\n        return `<tr>\n                        <td>${r.recipe}</td>\n                        <td>${escapeHtml(r.rarity)}</td>\n                        <td>${r.level}</td>\n                        <td>${r.cookingLoreDC}</td>\n                        <td>${escapeHtml(r.cookingCost)}</td>\n                        <td>${escapeHtml(r.learningCost)}</td>\n                        <td>${escapeHtml(r.price)}</td>\n                        <td><input type=\"checkbox\" name=\"add-${index}\" ${r.learned ? 'checked' : ''} ${r.name === 'Basic Meal' || r.name === 'Hearty Meal' ? 'disabled' : ''}></td>\n                        <td><input type=\"checkbox\" name=\"delete-${index}\" ${r.isHomebrew && isGM ? '' : 'disabled'}></td>\n                    </tr>`;\n    }).join('\\n')}\n            </table>\n        </form>\n        `;\n}\n\nexport async function manageRecipesDialog(options: ManageRecipesOptions): Promise<void> {\n    const recipes = [...options.recipes];\n    recipes.sort((a, b) => a.level-b.level || a.name.localeCompare(b.name));\n    const data = await Promise.all(recipes.map(r => toTemplateRecipe(r, options.learnedRecipes)));\n    new Dialog({\n        title: 'Manage Recipes',\n        content: tpl(data, options.isGM),\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const enableRecipes = data\n                        .map((r, index) => {\n                            const enabled = parseCheckbox($html, `add-${index}`);\n                            return {enabled, name: r.name};\n                        })\n                        .filter(r => r.enabled)\n                        .map(r => r.name);\n                    const deleteRecipes = data\n                        .map((r, index) => {\n                            const enabled = parseCheckbox($html, `delete-${index}`);\n                            return {enabled, name: r.name};\n                        })\n                        .filter(r => r.enabled)\n                        .map(r => r.name);\n                    await options.onSubmit(new Set(enableRecipes), new Set(deleteRecipes));\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 900,\n        height: 600,\n    }).render(true);\n}\n","import {getActorsByUuid, getConsumablesByUuid, getItemsByUuid, isConsumableItem} from './actor';\nimport {basicIngredientUuid, rationUuid, specialIngredientUuid} from './data';\nimport {addIngredientsToActor} from './activities';\nimport {allRecipes, getKnownRecipes, RecipeData} from './recipes';\nimport {Camping, getHuntAndGatherActor} from './camping';\nimport {getRegionInfo} from './regions';\nimport {addOf} from '../utils';\nimport {getCamping, getCampingActor, saveCamping} from './storage';\n\nexport async function getConsumableFromUuid(uuid: string): Promise<(Item & ConsumableItem) | null> {\n    const item = await fromUuid(uuid) as Item | null;\n    if (item && isConsumableItem(item)) {\n        return item;\n    }\n    return null;\n}\n\nexport async function getActorConsumables(actors: Actor[]): Promise<FoodAmount> {\n    const rationSourceId = (await getConsumableFromUuid(rationUuid))?.sourceId;\n    const specialIngredientsSourceId = (await getConsumableFromUuid(specialIngredientUuid))?.sourceId;\n    const basicIngredientsId = (await getConsumableFromUuid(basicIngredientUuid))?.sourceId;\n    const result: FoodAmount = {\n        rations: 0,\n        specialIngredients: 0,\n        basicIngredients: 0,\n    };\n    for (const actor of actors) {\n        const consumables = actor.itemTypes.consumable;\n        const ration = consumables\n            .find(c => c.sourceId === rationSourceId && rationSourceId !== undefined) as ConsumableItem | undefined;\n        const specialIngredient = consumables\n            .find(c => c.sourceId === specialIngredientsSourceId && specialIngredientsSourceId !== undefined) as ConsumableItem | undefined;\n        const basicIngredient = consumables\n            .find(c => c.sourceId === basicIngredientsId && basicIngredientsId !== undefined) as ConsumableItem | undefined;\n        result.rations += ration ? ration.system.uses.value + (Math.max(0, ration.quantity - 1) * ration.system.uses.max) : 0;\n        result.basicIngredients += basicIngredient ? basicIngredient.quantity : 0;\n        result.specialIngredients += specialIngredient ? specialIngredient.quantity : 0;\n    }\n    return result;\n}\n\n\ninterface ConsumedResource {\n    value: number;\n    warning: boolean;\n}\n\nexport interface ConsumedFood {\n    magicalSubsistence: number;\n    subsistence: number;\n    rations: ConsumedResource;\n    basicIngredients: ConsumedResource;\n    specialIngredients: ConsumedResource;\n}\n\ninterface FoodCost {\n    recipeSpecialIngredientCost: number;\n    recipeBasicIngredientCost: number;\n    actorsConsumingRations: number;\n    actorsConsumingMeals: number;\n    availableSubsistence: number;\n    availableMagicalSubsistence: number;\n}\n\nexport function canCook(camping: Camping): boolean {\n    const hasPreparedCampsite = camping.campingActivities\n        .find(a => a.activity === 'Prepare Campsite'\n            && (a.result === 'success' || a.result === 'criticalSuccess' || a.result === 'failure')) !== undefined;\n    const actorIsCooking = camping.campingActivities\n        .find(a => a.activity === 'Cook Meal' && a.actorUuid) !== undefined;\n    return hasPreparedCampsite && actorIsCooking;\n}\n\nexport function calculateConsumedFood(canCook: boolean, actorConsumables: FoodAmount, foodCost: FoodCost): ConsumedFood {\n    const availableBasicIngredients = actorConsumables.basicIngredients;\n    const availableSpecialIngredients = actorConsumables.specialIngredients;\n    const availableRations = actorConsumables.rations;\n    const {\n        availableMagicalSubsistence,\n        availableSubsistence,\n        actorsConsumingRations,\n        actorsConsumingMeals,\n    } = foodCost;\n    const recipeSpecialIngredientCost = canCook ? foodCost.recipeSpecialIngredientCost : 0;\n    const recipeBasicIngredientCost = canCook ? foodCost.recipeBasicIngredientCost : 0;\n    const requiredRationsTotal = actorsConsumingMeals + actorsConsumingRations;\n    const availableRationsTotal = availableRations + availableSubsistence + availableMagicalSubsistence;\n\n    const consumedRations = Math.max(0, requiredRationsTotal - availableSubsistence - availableMagicalSubsistence);\n    const consumedSubsistence = Math.max(0, requiredRationsTotal - consumedRations - availableMagicalSubsistence);\n    const consumedMagicalSubsistence = Math.max(0, requiredRationsTotal - consumedSubsistence - consumedRations);\n    return {\n        magicalSubsistence: consumedMagicalSubsistence,\n        subsistence: consumedSubsistence,\n        rations: {\n            value: consumedRations,\n            warning: (availableRationsTotal - requiredRationsTotal) < 0,\n        },\n        specialIngredients: {\n            value: recipeSpecialIngredientCost * actorsConsumingMeals,\n            warning: recipeSpecialIngredientCost * actorsConsumingMeals > availableSpecialIngredients,\n        },\n        basicIngredients: {\n            value: recipeBasicIngredientCost * actorsConsumingMeals,\n            warning: recipeBasicIngredientCost * actorsConsumingMeals > availableBasicIngredients,\n        },\n    };\n}\n\nexport interface FoodAmount {\n    rations: number;\n    specialIngredients: number;\n    basicIngredients: number;\n}\n\n/**\n * Special case for rations because these are fucked up\n * @param actors\n * @param amount\n */\nasync function removeRations(actors: Actor[], amount: number): Promise<void> {\n    let remainingToRemove = amount;\n    for (const actor of actors) {\n        if (remainingToRemove > 0) {\n            const updates = [];\n            const rations = await getConsumablesByUuid(actor, new Set([rationUuid]));\n            for (const ration of rations) {\n                if (remainingToRemove > 0) {\n                    const system = ration.system;\n                    const quantity = ration.quantity;\n                    const charges = system.uses.value;\n                    const max = system.uses.max;\n                    const quantitiesOf7 = Math.max(0, quantity - 1);\n                    const available = quantitiesOf7 * max + charges;\n                    if (remainingToRemove >= available) {\n                        await ration.delete();\n                        remainingToRemove -= available;\n                    } else {\n                        const leftOver = available - remainingToRemove;\n                        const leftOverCharges = leftOver % max;\n                        const leftOverQuantity = Math.ceil(leftOver / max);\n                        updates.push({\n                            _id: ration.id,\n                            'system.quantity': leftOverQuantity,\n                            'system.uses.value': leftOverCharges === 0 ? max : leftOverCharges,\n                        });\n                        remainingToRemove = 0;\n                    }\n                }\n            }\n            if (updates.length > 0) {\n                await actor.updateEmbeddedDocuments('Item', updates);\n            }\n        }\n    }\n}\n\nasync function removeItems(actors: Actor[], amount: number, uuid: string): Promise<void> {\n    let remainingToRemove = amount;\n    for (const actor of actors) {\n        if (remainingToRemove > 0) {\n            const updates = [];\n            const items = await getConsumablesByUuid(actor, new Set([uuid]));\n            for (const item of items) {\n                if (remainingToRemove > 0) {\n                    const quantity = item.quantity;\n                    if (remainingToRemove >= quantity) {\n                        await item.delete();\n                        remainingToRemove -= quantity;\n                    } else {\n                        const leftOverQuantity = quantity - remainingToRemove;\n                        updates.push({\n                            _id: item.id,\n                            'system.quantity': leftOverQuantity,\n                        });\n                        remainingToRemove = 0;\n                    }\n                }\n            }\n            if (updates.length > 0) {\n                await actor.updateEmbeddedDocuments('Item', updates);\n            }\n        }\n    }\n}\n\nexport async function removeFood(actors: Actor[], config: FoodAmount): Promise<void> {\n    await removeRations(actors, config.rations);\n    await removeItems(actors, config.basicIngredients, basicIngredientUuid);\n    await removeItems(actors, config.specialIngredients, specialIngredientUuid);\n}\n\nexport async function addFood(actors: Actor[], food: FoodAmount): Promise<void> {\n    await Promise.all(actors.map(a => addIngredientsToActor(a, food)));\n}\n\nexport interface ActorAndIngredients {\n    specialIngredients: number;\n    basicIngredients: number;\n    actor: Actor;\n}\n\nexport function getIngredientList(basicIngredients: number, specialIngredients: number): string {\n    const result = [];\n    if (basicIngredients) result.push(`<b>Basic Ingredients</b>: ${basicIngredients}`);\n    if (specialIngredients) result.push(`<b>Special Ingredients</b>: ${specialIngredients}`);\n    return result\n        .map(a => `<li>${a}</li>`)\n        .join('');\n}\n\nexport async function addDiscoverSpecialMealResult(\n    game: Game,\n    actorAndIngredients: ActorAndIngredients,\n    recipe: string | null,\n    critFailUuids: string[],\n): Promise<void> {\n    const campingActor = getCampingActor(game);\n    if (campingActor) {\n        const camping = getCamping(campingActor);\n        const actors = await getActorsByUuid(new Set(camping.actorUuids));\n        const actor = actorAndIngredients.actor;\n        const basicIngredients = actorAndIngredients.basicIngredients;\n        const specialIngredients = actorAndIngredients.specialIngredients;\n        await removeFood(actors, {\n            specialIngredients,\n            basicIngredients,\n            rations: 0,\n        });\n        const itemsToAdd = (await getItemsByUuid(new Set(critFailUuids))).map(i => i.toObject());\n        if (itemsToAdd.length > 0) {\n            await actor.createEmbeddedDocuments('Item', itemsToAdd);\n        }\n        const content = `<p>Removed:</p>\n        <ul>${getIngredientList(basicIngredients, specialIngredients)}</ul>\n        ${recipe || itemsToAdd.length > 0 ? `\n            <p>Added:</p>\n            <ul>\n                ${recipe ? `<li><b>Recipe</b>: ${recipe}</li>` : ''}\n                ${itemsToAdd.length === 0 ? '' : `<li><b>Meal Effects</b>: ${itemsToAdd.map(i => i.name).join(', ')}</li>`}\n            </ul>\n        ` : ''}\n        `;\n        if (recipe) {\n            camping.cooking.knownRecipes = Array.from(new Set([...camping.cooking.knownRecipes, recipe]));\n            await saveCamping(game, campingActor, camping);\n        }\n        await ChatMessage.create({content});\n    }\n}\n\nexport async function addHuntAndGatherResult(game: Game, actorAndIngredients: ActorAndIngredients): Promise<void> {\n    const campingActor = getCampingActor(game);\n    if (campingActor) {\n        const camping = getCamping(campingActor);\n        const actor = (await getHuntAndGatherActor(game, camping)) || actorAndIngredients.actor;\n        const specialIngredients = actorAndIngredients.specialIngredients;\n        const basicIngredients = actorAndIngredients.basicIngredients;\n        await addFood([actor], {\n            specialIngredients,\n            basicIngredients,\n            rations: 0,\n        });\n        const content = `<p>Added to ${addOf(actor.name ?? actor.uuid)} inventory:</p>\n        <ul>\n            <li><b>Basic Ingredients</b>: ${basicIngredients}</li>\n            <li><b>Special Ingredients</b>: ${specialIngredients}</li>\n        </ul>\n        `;\n        await ChatMessage.create({content});\n    }\n}\n\nexport function getCookingActorUuid(data: Camping): string | null {\n    return data.campingActivities\n        .find(a => a.activity === 'Cook Meal')?.actorUuid ?? null;\n}\n\nexport async function getCookingActorByUuid(data: Camping): Promise<Actor | null> {\n    const uuid = getCookingActorUuid(data);\n    if (uuid) {\n        return await fromUuid(uuid) as Actor | null;\n    }\n    return null;\n}\n\nexport function getChosenMealData(data: Camping): RecipeData {\n    const knownRecipes = getKnownRecipes(data);\n    const chosenMeal = knownRecipes.includes(data.cooking.chosenMeal) ? data.cooking.chosenMeal : 'Basic Meal';\n    const recipeData = getRecipeData(data);\n    return recipeData.find(a => a.name === chosenMeal) ??\n        recipeData.find(a => a.name === 'Basic Meal')!;\n}\n\nexport function getRecipeData(data: Camping): RecipeData[] {\n    return allRecipes.concat(data.cooking.homebrewMeals);\n}\n\nexport async function subsist(game: Game, actor: Actor, region: string): Promise<void> {\n    const {zoneDC} = getRegionInfo(game, region);\n    game.pf2e.actions.subsist({\n        actors: [actor],\n        skill: 'survival',\n        difficultyClass: {value: zoneDC},\n    });\n}\n","import {getAllMealEffectUuids, getMealEffectUuids, RecipeData} from './recipes';\nimport {StringDegreeOfSuccess} from '../degree-of-success';\nimport {ActivityEffect, ActivityOutcome, CampingActivityData, CampingActivityName} from './activities';\nimport {groupBySingle, isFirstGm} from '../utils';\nimport {\n    getActorByUuid,\n    getActorEffectsByUuid,\n    getActorsByUuid,\n    getEffectsByUuid,\n    getItemsByUuid,\n    removeActorsEffectsByUuid,\n} from './actor';\nimport {Camping, getCampingActivityData} from './camping';\nimport {getCamping, getCampingActor} from './storage';\nimport {getRecipeData} from './eating';\n\nasync function addActorRecipeEffect(\n    actor: Actor,\n    recipe: RecipeData,\n    degree: StringDegreeOfSuccess,\n    favoriteMeal: string | undefined,\n): Promise<void> {\n    const effectUuids = getMealEffectUuids(recipe, favoriteMeal, degree);\n    const items = await getItemsByUuid(new Set(effectUuids));\n    await actor.createEmbeddedDocuments('Item', items.map(i => i.toObject()));\n}\n\nexport interface SyncMealEffectOptions {\n    actors: Actor[];\n    recipe: RecipeData;\n    recipes: RecipeData[];\n    degree: StringDegreeOfSuccess;\n    actorUuidsEatingMeal: Set<string>;\n    actorUuidAndFavoriteMeal: Map<string, string>;\n}\n\nexport async function syncActorMealEffects(options: SyncMealEffectOptions): Promise<void> {\n    const uuids = getAllMealEffectUuids(options.recipes);\n    await removeActorsEffectsByUuid(options.actors, new Set(uuids));\n    await Promise.all(options.actors\n        .filter(a => options.actorUuidsEatingMeal.has(a.uuid))\n        .map(a => addActorRecipeEffect(a, options.recipe, options.degree, options.actorUuidAndFavoriteMeal.get(a.uuid))));\n}\n\ninterface CampingActivityResult {\n    result: StringDegreeOfSuccess | null;\n    activityName: CampingActivityName;\n    actor: Actor;\n}\n\nexport interface SyncActorCampingEffectOptions {\n    actors: Actor[];\n    campingActivities: CampingActivityData[];\n    actorCampingActivities: Map<string, CampingActivityResult>;\n}\n\nfunction getActivityOutcomeUuids(outcome: ActivityOutcome | undefined): string[] {\n    if (outcome !== undefined && outcome.effectUuids !== undefined) {\n        return outcome.effectUuids.map(e => e.uuid);\n    }\n    return [];\n}\n\nexport function getCampingEffectUuids(activity: CampingActivityData): string[] {\n    return [\n        ...(getActivityOutcomeUuids(activity.criticalSuccess)),\n        ...(getActivityOutcomeUuids(activity.success)),\n        ...(getActivityOutcomeUuids(activity.failure)),\n        ...(getActivityOutcomeUuids(activity.criticalFailure)),\n        ...(activity.effectUuids === undefined ? [] : activity.effectUuids.map(e => e.uuid)),\n    ];\n}\n\nexport function getAllCampingEffectUuids(activities: CampingActivityData[]): string[] {\n    return activities.flatMap(a => getCampingEffectUuids(a));\n}\n\ninterface EffectsForActor {\n    actor: Actor;\n    effectUuids: string[];\n}\n\nfunction getActivityEffectsByResult(data: CampingActivityData | undefined, result: StringDegreeOfSuccess | null): ActivityEffect[] {\n    return [\n        ...(data?.effectUuids ?? []),\n        ...(result === null ? [] : (data?.[result]?.effectUuids ?? [])),\n    ];\n}\n\nfunction getEffectUuidsForActors(options: SyncActorCampingEffectOptions): EffectsForActor[] {\n    const actorActivityDataByName = groupBySingle(options.campingActivities, a => a.name);\n    const effectsPerformedByActor = Array.from(options.actorCampingActivities.values())\n        .map(e => {\n            const data = actorActivityDataByName.get(e.activityName);\n            const effects = getActivityEffectsByResult(data, e.result);\n            return {actor: e.actor, effects};\n        });\n    const effectsForActors = new Map();\n    const allActors = options.actors;\n    const actorUuids = allActors.map(a => a.uuid);\n    effectsPerformedByActor.forEach(actorAndEffect => {\n        actorAndEffect.effects.forEach(effect => {\n            actorUuids.forEach(actorUuid => {\n                if (effect.target === 'all'\n                    || effect.target === undefined\n                    || (effect.target === 'self' && actorUuid === actorAndEffect.actor.uuid)\n                    || (effect.target === 'allies' && actorUuid !== actorAndEffect.actor.uuid)) {\n                    const existingEffects = effectsForActors.get(actorUuid) ?? [];\n                    existingEffects.push(effect.uuid);\n                    effectsForActors.set(actorUuid, existingEffects);\n                }\n            });\n        });\n    });\n    return allActors.map(actor => {\n        return {\n            actor,\n            effectUuids: [...(effectsForActors.get(actor.uuid) ?? [])],\n        };\n    });\n}\n\nasync function syncActorCampingEffects(actor: Actor, effects: (Item & EffectItem)[], allUuids: Set<string>): Promise<void> {\n    const effectNames = new Set(effects.map(e => e.name));\n    const existingEffects = await getActorEffectsByUuid(actor, allUuids);\n    const existingEffectNames = new Set(existingEffects.map(e => e.name));\n    const effectsToAdd = effects.filter(e => !existingEffectNames.has(e.name));\n    const effectsToRemove = existingEffects.filter(e => !effectNames.has(e.name)).map(e => e.id);\n    await Promise.all([\n        actor.createEmbeddedDocuments('Item', effectsToAdd.map(e => e.toObject())),\n        actor.deleteEmbeddedDocuments('Item', effectsToRemove),\n    ]);\n}\n\nexport async function syncActorsCampingEffects(options: SyncActorCampingEffectOptions): Promise<void> {\n    const uuids = new Set(getAllCampingEffectUuids(options.campingActivities));\n    const effectUuidsForActors = getEffectUuidsForActors(options);\n    await Promise.all(effectUuidsForActors\n        .filter(a => a.actor.type === 'npc' || a.actor.type === 'character')\n        .map(async effectsForActor => {\n            const effects = await getEffectsByUuid(new Set(effectsForActor.effectUuids));\n            await syncActorCampingEffects(effectsForActor.actor, effects, uuids);\n        }));\n}\n\nexport abstract class DiffListener {\n    protected constructor(protected action: string, protected game: Game) {\n    }\n\n    async testFireChange(previous: Camping, update: Partial<Camping>): Promise<void> {\n        if (this.shouldFireChange(previous, update)) {\n            console.log('Firing Sync Event: ' + this.action, previous, update);\n            await this.fireChange();\n        }\n    }\n\n    async fireChange(): Promise<void> {\n        // GM has all of the permissions so change can be immediately made\n        if (isFirstGm(this.game)) {\n            const current = this.getCurrent();\n            if (current) {\n                await this.onReceive(current);\n            }\n        } else {\n            // otherwise we're a player and need to send the event to the GM in index.ts\n            this.game.socket?.emit('module.pf2e-kingmaker-tools', {\n                action: this.action,\n            });\n        }\n    }\n\n    protected getCurrent(): Camping | null {\n        const actor = getCampingActor(this.game);\n        if (actor) {\n            return getCamping(actor);\n        }\n        return null;\n    }\n\n    canHandle(action: string): boolean {\n        return this.action === action;\n    }\n\n    async onReceive(camping: Camping): Promise<void> {\n        console.log('Receiving update event: ' + this.action, camping);\n    }\n\n    protected abstract shouldFireChange(previous: Camping, update: Partial<Camping>): boolean;\n}\n\nexport class CampingActivitiesListener extends DiffListener {\n    constructor(game: Game) {\n        super('syncCampingEffects', game);\n    }\n\n    protected shouldFireChange(previous: Camping, update: Partial<Camping>): boolean {\n        const diff = diffObject(previous, update) as Partial<Camping>;\n        return 'campingActivities' in diff\n            && update?.campingActivities?.find(a => a.activity === 'Prepare Campsite'\n                && a.result !== null\n                && a.result !== 'criticalFailure',\n            ) !== undefined;\n    }\n\n    async onReceive(camping: Camping): Promise<void> {\n        await super.onReceive(camping);\n        const activities = (await Promise.all(camping.campingActivities\n            .filter(a => a.actorUuid !== null)\n            .map(async (a) => {\n                const result: CampingActivityResult = {\n                    result: a.result,\n                    activityName: a.activity,\n                    actor: await getActorByUuid(a.actorUuid!) as Actor,\n                };\n                return [a.activity, result] as [CampingActivityName, CampingActivityResult];\n            }),\n        )).filter(([, result]) => result.actor !== null);\n        const actorCampingActivities = new Map<CampingActivityName, CampingActivityResult>(activities);\n        await syncActorsCampingEffects({\n            actors: await getActorsByUuid(new Set(camping.actorUuids)),\n            campingActivities: getCampingActivityData(camping),\n            actorCampingActivities,\n        });\n    }\n}\n\n\nexport class ClearCampingActivitiesListener extends DiffListener {\n    constructor(game: Game) {\n        super('clearCampingEffects', game);\n    }\n\n    protected shouldFireChange(previous: Camping, update: Partial<Camping>): boolean {\n        const diff = diffObject(previous, update) as Partial<Camping>;\n        return 'campingActivities' in diff\n            && update?.campingActivities?.find(a => a.activity === 'Prepare Campsite'\n                && (a.result === null || a.result === 'criticalFailure'),\n            ) !== undefined;\n    }\n\n    async onReceive(camping: Camping): Promise<void> {\n        await super.onReceive(camping);\n        const actors = await getActorsByUuid(new Set(camping.actorUuids));\n        const campingActivityData = getCampingActivityData(camping);\n        const campingEffectUuids = getAllCampingEffectUuids(campingActivityData);\n        await removeActorsEffectsByUuid(actors, new Set(campingEffectUuids));\n    }\n\n}\n\nexport async function eat(game: Game, camping: Camping): Promise<void> {\n    const actorUuidAndMeal = groupBySingle(camping.cooking.actorMeals, a => a.actorUuid);\n    const actorUuidAndFavoriteMeal = new Map();\n    Array.from(actorUuidAndMeal.values())\n        .filter(a => a.favoriteMeal !== null)\n        .forEach(a => actorUuidAndFavoriteMeal.set(a.actorUuid, a.favoriteMeal));\n    const recipes = getRecipeData(camping);\n    const recipe = recipes.find(r => r.name === camping.cooking.chosenMeal);\n    const degree = camping.cooking.degreeOfSuccess;\n    const actors = await getActorsByUuid(new Set(camping.actorUuids));\n    if (degree !== null && recipe !== undefined) {\n        const actorUuidsEatingMeal = new Set(camping.cooking.actorMeals\n            .filter(a => a.chosenMeal === 'meal')\n            .map(a => a.actorUuid));\n        await syncActorMealEffects({\n            actors,\n            degree,\n            recipe,\n            recipes,\n            actorUuidAndFavoriteMeal,\n            actorUuidsEatingMeal,\n        });\n    } else {\n        const recipeEffectUuids = getAllMealEffectUuids(recipes);\n        await removeActorsEffectsByUuid(actors, new Set(recipeEffectUuids));\n    }\n}\n\nexport function getDiffListeners(game: Game): DiffListener[] {\n    return [\n        new ClearCampingActivitiesListener(game),\n        new CampingActivitiesListener(game),\n    ];\n}\n","import {getStringSetting} from '../settings';\nimport {findRollTableUuidWithFallback, findWorldTableUuid, rollRollTable} from '../roll-tables';\nimport {DegreeOfSuccess, determineDegreeOfSuccess, StringDegreeOfSuccess} from '../degree-of-success';\nimport {regions, toOfficialKingmakerRollTableName} from './regions';\nimport {CampingActivityData} from './activities';\nimport {Camping, getCampingActivityData} from './camping';\nimport {getWorldTime, isDayOrNight} from '../time/calculation';\nimport {isKingmakerInstalled} from '../utils';\n\n\nasync function succeededEncounterFlatCheck(region: string, dc: EncounterDc): Promise<boolean> {\n    const flavor = `Rolling Random Encounter for terrain ${region} with Flat DC ${dc.total}`;\n    const dieRoll = await new Roll('1d20').evaluate();\n    await dieRoll.toMessage({flavor}, {rollMode: 'gmroll'});\n    const degreeOfSuccess = determineDegreeOfSuccess(dieRoll.total, dieRoll.total, dc.total);\n    return degreeOfSuccess === DegreeOfSuccess.CRITICAL_SUCCESS || degreeOfSuccess === DegreeOfSuccess.SUCCESS;\n}\n\nasync function findCreatureRollTable(game: Game, region: string): Promise<string> {\n    const key = isKingmakerInstalled(game) ? toOfficialKingmakerRollTableName(region, regions.get(region)!) : region;\n    return (await findRollTableUuidWithFallback(game, key, 'pf2e-kingmaker-tools.kingmaker-tools-random-encounters'))!;\n}\n\nexport async function rollRandomEncounter(game: Game, region: string, dc: EncounterDc, forgoFlatCheck = false): Promise<boolean> {\n    const creatureRollTable = await findCreatureRollTable(game, region);\n    const worldEncounterTable = getStringSetting(game, 'proxyEncounterTable')?.trim();\n    const encounterTypeRollTable = findWorldTableUuid(game, worldEncounterTable)!;\n    const rollMode = getStringSetting(game, 'randomEncounterRollMode') as unknown as keyof CONFIG.Dice.RollModes;\n    const rollOptions: Partial<RollTable.DrawOptions> = {rollMode};\n\n    if (forgoFlatCheck || await succeededEncounterFlatCheck(region, dc)) {\n        if (encounterTypeRollTable === undefined ||\n            encounterTypeRollTable === null ||\n            encounterTypeRollTable.trim() === '') {\n            console.log('Rolling on creature table ' + creatureRollTable);\n            await rollRollTable(game, creatureRollTable, rollOptions);\n        } else {\n            const typeResult = await rollRollTable(game, encounterTypeRollTable, rollOptions);\n            /* eslint-disable @typescript-eslint/no-explicit-any */\n            const tableResult = typeResult.draw.results[0] as any;\n            if (tableResult?.text?.trim() === 'Creature') {\n                console.log('Rolling on creature table ' + creatureRollTable);\n                await rollRollTable(game, creatureRollTable, rollOptions);\n            }\n        }\n        return true;\n    }\n    return false;\n}\n\n\nexport interface ActivityModifier {\n    day: number,\n    night: number\n}\n\nexport function getActivityModifier(\n    campingActivityData: CampingActivityData,\n    result: StringDegreeOfSuccess | null,\n): ActivityModifier {\n    if (campingActivityData.modifyRandomEncounterDc) {\n        return {\n            day: campingActivityData.modifyRandomEncounterDc.day,\n            night: campingActivityData.modifyRandomEncounterDc.night,\n        };\n    } else if (result !== null) {\n        const mods = campingActivityData[result]?.modifyRandomEncounterDc;\n        return {\n            day: mods?.day ?? 0,\n            night: mods?.night ?? 0,\n        };\n    } else {\n        return {day: 0, night: 0};\n    }\n}\n\nexport interface EncounterDc {\n    modifier: number;\n    activityModifier: number;\n    dc: number;\n    total: number;\n}\n\nexport function getEncounterDC(data: Camping, game: Game): EncounterDc {\n    const currentRegionData = regions.get(data.currentRegion);\n    const modifier = data.encounterModifier;\n    const activityModifier = getCampingActivityData(data)\n        .map(campingActivityData => {\n            const campingActivity = data.campingActivities\n                .find(ca => ca.activity === campingActivityData.name);\n            const result = campingActivity?.result ?? null;\n            const actorUuid = campingActivity?.actorUuid ?? null;\n            if (actorUuid !== null && (result !== null || campingActivityData.skills.length === 0)) {\n                const mods = getActivityModifier(campingActivityData, result);\n                return mods[isDayOrNight(getWorldTime(game))];\n            } else {\n                return 0;\n            }\n        }).reduce((a, b) => a + b, 0);\n    const dc = currentRegionData?.encounterDC ?? 0;\n    return {\n        modifier,\n        activityModifier,\n        dc,\n        total: modifier + dc + activityModifier,\n    };\n}\n","import {getRegionInfo} from './regions';\nimport {StringDegreeOfSuccess} from '../degree-of-success';\nimport {Camping} from './camping';\nimport {getRecipeData} from './eating';\n\nexport type Rarity = 'common' | 'uncommon' | 'rare' | 'unique';\n\nexport interface MealEffect {\n    uuid: string;\n    removeAfterRest?: boolean;\n}\n\nexport interface CookingOutcome {\n    effects?: MealEffect[];\n    chooseRandomly?: boolean;\n}\n\nexport interface RecipeData {\n    name: string,\n    basicIngredients: number,\n    specialIngredients: number,\n    cookingLoreDC: number,\n    survivalDC: number,\n    uuid: string,\n    level: number,\n    cost: string,\n    rarity: Rarity,\n    isHomebrew?: boolean;\n    criticalSuccess: CookingOutcome;\n    success: CookingOutcome;\n    criticalFailure: CookingOutcome;\n    favoriteMeal?: CookingOutcome;\n}\n\nconst firstWorldMincePieEffects = {\n    strength: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.69VWFB5UNLau1Rzt',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.iV22sORhjIhWZMKw',\n    },\n    dexterity: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.OAxcELiLh04BLVvP',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.CQGJi8WiBq0T8Kc6',\n    },\n    constitution: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.WVRQf9SLX0iRh3Ur',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.L8HdDXKrfa3gDakt',\n    },\n    wisdom: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.69MQw1WMMlN4hEzb',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.6CjFExnLSe9qij9z',\n    },\n    intelligence: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.yLf2n65zVocqsl6r',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Af25wacbdYDnFKwM',\n    },\n    charisma: {\n        criticalSuccessUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.sd45BQ4P7BtsYEuP',\n        successUuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.VhzUKWFVrZ7tgcEQ',\n    },\n};\n\nexport const allRecipes: RecipeData[] = [\n    {\n        'name': 'Basic Meal',\n        'basicIngredients': 2,\n        'specialIngredients': 0,\n        'cookingLoreDC': 18,\n        'survivalDC': 22,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.J5nci1DS7i1wDph4',\n        'level': 0,\n        'cost': '0 gp',\n        'rarity': 'common',\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.2DLTsWVdUnjewzhQ',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.6IguL0ipdLTiVthS',\n                removeAfterRest: true,\n            }],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.gqy7D2LEWSak1pzM',\n                removeAfterRest: true,\n            }],\n        },\n    },\n    {\n        'name': 'Hearty Meal',\n        'basicIngredients': 4,\n        'specialIngredients': 0,\n        'cookingLoreDC': 14,\n        'survivalDC': 16,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.K5l6QZci2mCofOBg',\n        'level': 0,\n        'cost': '0 gp',\n        'rarity': 'common',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.7aBiVefiVDXS2XmV'}],\n        },\n        'favoriteMeal': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.KeiNZDcAiGZjyzhn',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.LbW38wFmd1JSBPK6',\n                removeAfterRest: true,\n            }],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.uI4ZsdIGx7Yoy2rI'}],\n        },\n    },\n    {\n        'name': 'Jeweled Rice',\n        'basicIngredients': 1,\n        'specialIngredients': 0,\n        'cookingLoreDC': 14,\n        'survivalDC': 16,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.N3k7OGUKHn4kTu59',\n        'level': 0,\n        'cost': '5 sp',\n        'rarity': 'common',\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.MGFPIxwSgRLvkV71'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.OxEApkXu0hw34Ci5'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Sc5N6l1oCY1oiTfA'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.d8xr0i8GHY4195sa'}],\n        },\n    },\n    {\n        'name': 'Fish-On-A-Stick',\n        'basicIngredients': 2,\n        'specialIngredients': 0,\n        'cookingLoreDC': 17,\n        'survivalDC': 19,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.b59ro2GHvRvBOko8',\n        'level': 1,\n        'cost': '1 gp',\n        'rarity': 'common',\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.8eIGJPWFlg4L94wY'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.L5sACVlUjYP6lJ7q'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.c9qgXgiAJikyTM0p',\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.dZTQ5rfedrpLUTxE',\n            }],\n        },\n    },\n    {\n        'name': 'Haggis',\n        'basicIngredients': 2,\n        'specialIngredients': 0,\n        'cookingLoreDC': 15,\n        'survivalDC': 17,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.tKcKHaxGW48w5UMj',\n        'level': 1,\n        'cost': '1 gp',\n        'rarity': 'common',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.1CIuG1XTo4R8fmeL'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ISeHA2sG6wwJyV6I'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.RttWd7ZJNbsFsQjE'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.k0BWf8aF5plRvhyk',\n                removeAfterRest: true,\n            }],\n        },\n    },\n    {\n        'name': 'Rice-N-Nut Pudding',\n        'basicIngredients': 2,\n        'specialIngredients': 1,\n        'cookingLoreDC': 16,\n        'survivalDC': 18,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.IrrRh2yttdTDU1A5',\n        'level': 2,\n        'cost': '2 gp',\n        'rarity': 'common',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.3Gj0AaUzqwN0CdTi'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.AI1hYVSAMmKgEO9u'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.GzZYeBB1UGMAykXc',\n                removeAfterRest: true,\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.IRTWUl4HjRa82A1B'}],\n        },\n    },\n    {\n        'name': 'Shepherd\\'s Pie',\n        'basicIngredients': 4,\n        'specialIngredients': 0,\n        'cookingLoreDC': 18,\n        'survivalDC': 20,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.GsPVSA1GNm4tvmcR',\n        'level': 2,\n        'cost': '2 gp',\n        'rarity': 'uncommon',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.3a5uIGu77TLQE9ZB'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.84dIJjkOdLeHWkx2'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.COa19ug1vjTGHy04'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.RL8zdU7YyoiduDva'}],\n        },\n    },\n    {\n        'name': 'Broiled Tuskwater Oysters',\n        'basicIngredients': 2,\n        'specialIngredients': 1,\n        'cookingLoreDC': 20,\n        'survivalDC': 22,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.aXmbLuQMQOMAlls3',\n        'level': 3,\n        'cost': '3 gp',\n        'rarity': 'uncommon',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.57461QLkB8M3S0AS'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.BlKsZq6anCMSEshB',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.X8sGtdz4yfVl2pKJ'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ebP1xWOh7vGZmmlz'}],\n        },\n    },\n    {\n        'name': 'Succulent Sausages',\n        'basicIngredients': 3,\n        'specialIngredients': 1,\n        'cookingLoreDC': 18,\n        'survivalDC': 20,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.IZoPx6QH5NRY1HBi',\n        'level': 3,\n        'cost': '3 gp',\n        'rarity': 'common',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.EULsp9VffKbWpD0b'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.G0qnixpCakGeHTp1',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.WDJQpYYx0N91mkO0',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.jseoPPvbPg4Vr7MI'}],\n        },\n    },\n    {\n        'name': 'Chocolate Ice Cream',\n        'basicIngredients': 2,\n        'specialIngredients': 1,\n        'cookingLoreDC': 19,\n        'survivalDC': 21,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.xfIwKyG1pNFp8JbN',\n        'level': 4,\n        'cost': '5 gp',\n        'rarity': 'common',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.0QmbpFYAoyzUu1gi'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.9brr5UKBsZcboAOx'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.KqktmooFbYLQQ2S1'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.L85BNpJEFAozA9kW',\n                removeAfterRest: true,\n            }],\n        },\n    },\n    {\n        'name': 'Galt Ragout',\n        'basicIngredients': 4,\n        'specialIngredients': 0,\n        'cookingLoreDC': 20,\n        'survivalDC': 22,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.agI35cH4peI3aIX5',\n        'level': 4,\n        'cost': '5 gp',\n        'rarity': 'uncommon',\n        'criticalSuccess': {\n            'effects': [\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.MADgm2doEOSlNe7u'},\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.JqxNxAVZzAdCAoCZ'},\n            ],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Uh9fQWIE0Nc2hwLi'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.bH9QjKt6LybagxcR',\n                removeAfterRest: true,\n            }],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.x1lKNowlbhotDu0q'}],\n        },\n    },\n    {\n        'name': 'Baked Spider Legs',\n        'basicIngredients': 4,\n        'specialIngredients': 1,\n        'survivalDC': 22,\n        'cookingLoreDC': 20,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.OXKHrajfyBjEBLTM',\n        'level': 5,\n        'cost': '8 gp',\n        'rarity': 'common',\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.0faDj5jOYlPTwB21'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.M2gTzsYSnmcq7Lho'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.MVrKXXHzxzyfy3mi'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.kmHHmbR283uOoDK9'}],\n        },\n    },\n    {\n        'name': 'Cheese Crostata',\n        'basicIngredients': 4,\n        'specialIngredients': 0,\n        'cookingLoreDC': 22,\n        'survivalDC': 24,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.GAf8W01ppdseIGbq',\n        'level': 5,\n        'cost': '8 gp',\n        'rarity': 'uncommon',\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.1VchCdA1LMBhYENe'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.2c2nrlkL2XJXXQIA'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.EBa9BjdANCMLKMEy',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.MI6MF3R5OswdGBUd'},\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.X7fTfenq4TukJJM4'},\n            ],\n        },\n    },\n    {\n        'name': 'Grilled Silver Eel',\n        'basicIngredients': 4,\n        'specialIngredients': 1,\n        'cookingLoreDC': 24,\n        'survivalDC': 26,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.UMgvKT6nNTPvp28R',\n        'level': 6,\n        'cost': '13 gp',\n        'rarity': 'uncommon',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Dj9026jn8dI7oP0j'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Vb39DIJ5OfWpN2ig',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Zw8I0G3RqDfNHuCl'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ta81jwzhkNsN88EZ'}],\n        },\n    },\n    {\n        'name': 'Hunter\\'s Roast',\n        'basicIngredients': 4,\n        'specialIngredients': 0,\n        'cookingLoreDC': 22,\n        'survivalDC': 24,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.5QyW0eFSJRgmyRzU',\n        'level': 6,\n        'cost': '13 gp',\n        'rarity': 'common',\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.0un8LMe7iv59He25',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.LiXnKWPOkDBZRpLE'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.RzOGQxp3VHlpYtWJ',\n                removeAfterRest: true,\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.zuPWMtCTzuD96Ykz'}],\n        },\n    },\n    {\n        'name': 'Owlbear Omelet',\n        'basicIngredients': 4,\n        'specialIngredients': 1,\n        'cookingLoreDC': 25,\n        'survivalDC': 27,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.3ak0XG0Xf66q2ApV',\n        'level': 7,\n        'cost': '18 gp',\n        'rarity': 'uncommon',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.JY3TBLbVAbQHtmtu'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.O4XVtCWn4Hq5QKUP'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.RLJuUa9tzPrC6PqP',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.kyzTn0AUN4Q8G6TH'}],\n        },\n    },\n    {\n        'name': 'Sweet Pancakes',\n        'basicIngredients': 2,\n        'specialIngredients': 2,\n        'cookingLoreDC': 23,\n        'survivalDC': 25,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.WrDLx0FVkaglg1hh',\n        'level': 7,\n        'cost': '18 gp',\n        'rarity': 'common',\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.BXTnX9xhnYvolrFk'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Lpo0XSUVmGDQaXtz'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ovbBMpOBtB1CrLOv'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.q5JHZeJeAIscA1ky'}],\n        },\n    },\n    {\n        'name': 'Smoked Trout And Hydra Pate',\n        'basicIngredients': 6,\n        'specialIngredients': 2,\n        'cookingLoreDC': 26,\n        'survivalDC': 28,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.t5pXd39gRgNkPoiu',\n        'level': 8,\n        'cost': '25 gp',\n        'rarity': 'uncommon',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.4d6roHW75xe52o7A'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.LBzsqdKb182lO5Fm',\n                removeAfterRest: true,\n            }],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.miTcZbTcQLJu2NKR',\n                removeAfterRest: true,\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ve7NrzeHMwLsmbl3'}],\n        },\n    },\n    {\n        'name': 'Onion Soup',\n        'basicIngredients': 2,\n        'specialIngredients': 1,\n        'cookingLoreDC': 24,\n        'survivalDC': 26,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.laM0IfTV8eviU1vm',\n        'level': 8,\n        'cost': '25 gp',\n        'rarity': 'common',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.6Vu7Ts4p79O6JsD2'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.8IzlPm2joulb5r0p',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.hHTMldJIDoqpCF7U'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.pIgoUydEo8wU2Avm'}],\n        },\n    },\n    {\n        'name': 'Whiterose Oysters',\n        'basicIngredients': 3,\n        'specialIngredients': 2,\n        'cookingLoreDC': 26,\n        'survivalDC': 28,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.p08orFcjqQzA7KdE',\n        'level': 9,\n        'cost': '35 gp',\n        'rarity': 'common',\n        'favoriteMeal': {\n            'effects': [\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.E3tZfxCJ5GQoIbei'},\n                {\n                    uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.cCKgpxIsFevgENf2',\n                    removeAfterRest: true,\n                },\n            ],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.ZDDZz5ynEOR20LUC'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.uw5M3YfEJs23RmX5',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.yMsjuwLmbF8h1jVt'}],\n        },\n    },\n    {\n        'name': 'Kameberry Pie',\n        'basicIngredients': 3,\n        'specialIngredients': 2,\n        'cookingLoreDC': 27,\n        'survivalDC': 29,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.zX4S7wsOxB8CcVWw',\n        'level': 10,\n        'cost': '50 gp',\n        'rarity': 'common',\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.elsXArG4GqGin6LB',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.lWy7BZYGab0uNf9H'}],\n        },\n        'criticalSuccess': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.n6ykp8NjXDFcvqXM',\n                removeAfterRest: true,\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.sQz8ugumjOMSHiYt'}],\n        },\n    },\n    {\n        'name': 'Monster Casserole',\n        'basicIngredients': 7,\n        'specialIngredients': 2,\n        'cookingLoreDC': 28,\n        'survivalDC': 30,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.gqT2VQGYgDQIMYsW',\n        'level': 11,\n        'cost': '70 gp',\n        'rarity': 'common',\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.5GT0JeRjYJc8e5ZA',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.af6hFeUUfsF1GiX8'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.gNGXKMmJdNQJZode'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.qad6gIwEpQQIkZwQ'}],\n        },\n    },\n    {\n        'name': 'Seasoned Wings And Thighs',\n        'basicIngredients': 4,\n        'specialIngredients': 2,\n        'cookingLoreDC': 30,\n        'survivalDC': 32,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.BTKN1IgANoof0tfB',\n        'level': 12,\n        'cost': '100 gp',\n        'rarity': 'common',\n        'criticalSuccess': {\n            'effects': [\n                {\n                    uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.uchgkN3hm1T51zfM',\n                    removeAfterRest: true,\n                },\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.JqKhpMXiQCEsDSCw'},\n            ],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.JqKhpMXiQCEsDSCw'}],\n        },\n        'criticalFailure': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.q3vnRHRBn3HmRhkV',\n                removeAfterRest: true,\n            }],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.xF0K40VzyjIbbRMA'}],\n        },\n    },\n    {\n        'name': 'Giant Scrambled Egg With Shambletus',\n        'basicIngredients': 6,\n        'specialIngredients': 2,\n        'cookingLoreDC': 33,\n        'survivalDC': 35,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.IiV8wHXKZS1HbLLW',\n        'level': 13,\n        'cost': '150 gp',\n        'rarity': 'uncommon',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Q1Qg8K9G7R9wU4rI'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.TLxckltEWbHKCXDi'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.pTjrRRqxUJnbDRIB'}],\n        },\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.f2yKkelj374SNszb'}],\n        },\n    },\n    {\n        'name': 'Mastodon Steak',\n        'basicIngredients': 4,\n        'specialIngredients': 3,\n        'cookingLoreDC': 34,\n        'survivalDC': 36,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.SfNeVcYxBD4uCfrT',\n        'level': 14,\n        'cost': '225 gp',\n        'rarity': 'uncommon',\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.0yH2V9UFRyGwXIRn'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Ln9Q3cH6NzGZAJUs'}],\n        },\n        'success': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.M6jcQsHsPEkigTTG',\n                removeAfterRest: true,\n            }],\n        },\n        'criticalSuccess': {\n            'effects': [{\n                uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.xq4qNyrsL5wVYkcQ',\n                removeAfterRest: true,\n            }],\n        },\n    },\n    {\n        'name': 'Hearty Purple Soup',\n        'basicIngredients': 6,\n        'specialIngredients': 3,\n        'cookingLoreDC': 40,\n        'survivalDC': 42,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.yAB0s5JgzCZpf0dT',\n        'level': 16,\n        'cost': '500 gp',\n        'rarity': 'rare',\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.6RjaP1s58ITIVn6u'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Zn0CB7bL7vHrMNTU'}],\n        },\n        'criticalSuccess': {\n            'effects': [\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.hLGCjXajAYEcII9J'},\n            ],\n        },\n        'criticalFailure': {\n            'effects': [\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.o6F8QZbTvt9os8Ni'},\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.TQXXVzD1ZZHnouTI'},\n                {uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.SJvEGeMryIekwIKk'},\n            ],\n        },\n    },\n    {\n        'name': 'Black Linnorm Stew',\n        'basicIngredients': 8,\n        'specialIngredients': 3,\n        'cookingLoreDC': 43,\n        'survivalDC': 45,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.V6uIWe6BVFV9Ewo3',\n        'level': 18,\n        'cost': '1200 gp',\n        'rarity': 'rare',\n        'criticalSuccess': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.I2LiwNjrowS5u4UG'}],\n        },\n        'success': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.m3FgRCWbVupkaORL'}],\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.s1DfJpXFkJorHsuu'}],\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.sxr0BsJJGeLyNBgq'}],\n        },\n    },\n    {\n        'name': 'First World Mince Pie',\n        'basicIngredients': 8,\n        'specialIngredients': 4,\n        'cookingLoreDC': 45,\n        'survivalDC': 47,\n        'uuid': 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.RmMZWrzgd8Wh8z5H',\n        'level': 20,\n        'cost': '3500 gp',\n        'rarity': 'rare',\n        'criticalSuccess': {\n            'effects': Object.values(firstWorldMincePieEffects).map(v => {\n                return {uuid: v.criticalSuccessUuid};\n            }),\n            chooseRandomly: true,\n        },\n        'criticalFailure': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.72N0nZAAo2iuCGBd'}],\n        },\n        'success': {\n            'effects': Object.values(firstWorldMincePieEffects).map(v => {\n                return {uuid: v.successUuid};\n            }),\n            chooseRandomly: true,\n        },\n        'favoriteMeal': {\n            'effects': [{uuid: 'Compendium.pf2e-kingmaker-tools.kingmaker-tools-meal-effects.Item.Wfmt1NvfIqF3gFav'}],\n        },\n    },\n];\n\n\nexport function getRecipesKnownInRegion(game: Game, region: string, recipes: RecipeData[]): RecipeData[] {\n    const {zoneLevel} = getRegionInfo(game, region);\n    return recipes.filter(recipe => recipe.rarity === 'common' && recipe.level <= zoneLevel);\n}\n\nexport function getOutcomeEffects(outcome: CookingOutcome | undefined, includeAll: boolean): string[] {\n    const effects = outcome?.effects?.flatMap(e => e.uuid) ?? [];\n    if (!includeAll && outcome?.chooseRandomly && effects.length > 0) {\n        const randomIndex = Math.floor(Math.random() * (effects.length - 1));\n        return [effects[randomIndex]];\n    } else {\n        return effects;\n    }\n}\n\nexport function getExpiringOutcomeEffects(outcome: CookingOutcome | undefined): string[] {\n    return outcome?.effects\n        ?.filter(e => e.removeAfterRest)\n        ?.flatMap(e => e.uuid) ?? [];\n}\n\nexport function getAllMealEffectUuids(recipes: RecipeData[]): string[] {\n    return recipes.flatMap(r => [\n        ...getOutcomeEffects(r.criticalFailure, true),\n        ...getOutcomeEffects(r.success, true),\n        ...getOutcomeEffects(r.criticalSuccess, true),\n        ...getOutcomeEffects(r.favoriteMeal, true),\n    ]);\n}\n\nexport function getAllExpiringMealEffectUuids(recipes: RecipeData[]): string[] {\n    return recipes.flatMap(r => [\n        ...getExpiringOutcomeEffects(r.criticalFailure),\n        ...getExpiringOutcomeEffects(r.success),\n        ...getExpiringOutcomeEffects(r.criticalSuccess),\n        ...getExpiringOutcomeEffects(r.favoriteMeal),\n    ]);\n}\n\nexport function getMealEffectUuids(recipe: RecipeData, favoriteMeal: string | undefined, degree: StringDegreeOfSuccess): string[] {\n    const favoriteMealEffects = recipe.name === favoriteMeal ? getOutcomeEffects(recipe.favoriteMeal, false) : [];\n    const effects = degree === 'criticalSuccess'\n    || degree === 'success'\n    || degree === 'criticalFailure' ? getOutcomeEffects(recipe[degree], false) : [];\n    return degree === 'criticalSuccess' || degree === 'success' ? [...effects, ...favoriteMealEffects] : effects;\n}\n\nexport function getKnownRecipes(camping: Camping): string[] {\n    const recipes = new Set(getRecipeData(camping).map(r => r.name));\n    return camping.cooking.knownRecipes.filter(r => recipes.has(r));\n}\n","import {MonthNumbers} from 'luxon';\n\ninterface ZoneData {\n    zoneDC: number;\n    encounterDC: number;\n    level: number;\n}\n\nexport const regions = new Map<string, ZoneData>();\nregions.set('Brevoy', {zoneDC: 14, encounterDC: 12, level: 0});\nregions.set('Rostland Hinterlands', {zoneDC: 15, encounterDC: 12, level: 1});\nregions.set('Greenbelt', {zoneDC: 16, encounterDC: 14, level: 2});\nregions.set('Tuskwater', {zoneDC: 18, encounterDC: 12, level: 3});\nregions.set('Kamelands', {zoneDC: 19, encounterDC: 12, level: 4});\nregions.set('Narlmarches', {zoneDC: 20, encounterDC: 14, level: 5});\nregions.set('Sellen Hills', {zoneDC: 20, encounterDC: 12, level: 6});\nregions.set('Dunsward', {zoneDC: 18, encounterDC: 12, level: 7});\nregions.set('Nomen Heights', {zoneDC: 24, encounterDC: 12, level: 8});\nregions.set('Tors of Levenies', {zoneDC: 28, encounterDC: 16, level: 9});\nregions.set('Hooktongue', {zoneDC: 32, encounterDC: 14, level: 10});\nregions.set('Drelev', {zoneDC: 28, encounterDC: 12, level: 11});\nregions.set('Tiger Lords', {zoneDC: 28, encounterDC: 12, level: 12});\nregions.set('Rushlight', {zoneDC: 26, encounterDC: 12, level: 13});\nregions.set('Glenebon Lowlands', {zoneDC: 30, encounterDC: 12, level: 14});\nregions.set('Pitax', {zoneDC: 29, encounterDC: 12, level: 15});\nregions.set('Glenebon Uplands', {zoneDC: 35, encounterDC: 12, level: 16});\nregions.set('Numeria', {zoneDC: 36, encounterDC: 12, level: 17});\nregions.set('Thousand Voices', {zoneDC: 43, encounterDC: 14, level: 18});\nregions.set('Branthlend Mountains', {zoneDC: 41, encounterDC: 16, level: 19});\n\nexport function toOfficialKingmakerRollTableName(regionName: string, data: ZoneData): string {\n    const zoneId = `${data.level}`.padStart(2, '0');\n    return `Zone ${zoneId}: ${regionName}`;\n}\n\ninterface RegionInfo {\n    zoneDC: number,\n    zoneLevel: number\n}\n\nexport function getRegionInfo(game: Game, region: string): RegionInfo {\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    const zone = regions.get(region);\n    const zoneDC = zone?.zoneDC ?? 14;\n    const zoneLevel = zone?.level ?? 0;\n    return {zoneDC, zoneLevel};\n}\n\nexport type GolarionMonth = 'Abadius'\n    | 'Calistril'\n    | 'Pharast'\n    | 'Gozran'\n    | 'Desnus'\n    | 'Sarenith'\n    | 'Erastus'\n    | 'Arodus'\n    | 'Rova'\n    | 'Lamashan'\n    | 'Neth'\n    | 'Kuthona';\n\nexport interface WeatherData {\n    precipitationDC: number;\n    coldDC?: number;\n    season: 'spring' | 'summer' | 'fall' | 'winter';\n}\n\nexport const golarionMonths = new Map<MonthNumbers, GolarionMonth>();\ngolarionMonths.set(1, 'Abadius');\ngolarionMonths.set(2, 'Calistril');\ngolarionMonths.set(3, 'Pharast');\ngolarionMonths.set(4, 'Gozran');\ngolarionMonths.set(5, 'Desnus');\ngolarionMonths.set(6, 'Sarenith');\ngolarionMonths.set(7, 'Erastus');\ngolarionMonths.set(8, 'Arodus');\ngolarionMonths.set(9, 'Rova');\ngolarionMonths.set(10, 'Lamashan');\ngolarionMonths.set(11, 'Neth');\ngolarionMonths.set(12, 'Kuthona');\n\nconst weatherData = new Map<GolarionMonth, WeatherData>();\nweatherData.set('Abadius', {coldDC: 16, precipitationDC: 8, season: 'winter'});\nweatherData.set('Calistril', {coldDC: 18, precipitationDC: 8, season: 'winter'});\nweatherData.set('Pharast', {precipitationDC: 15, season: 'spring'});\nweatherData.set('Gozran', {precipitationDC: 15, season: 'spring'});\nweatherData.set('Desnus', {precipitationDC: 15, season: 'spring'});\nweatherData.set('Sarenith', {precipitationDC: 20, season: 'summer'});\nweatherData.set('Erastus', {precipitationDC: 20, season: 'summer'});\nweatherData.set('Arodus', {precipitationDC: 20, season: 'summer'});\nweatherData.set('Rova', {precipitationDC: 15, season: 'fall'});\nweatherData.set('Lamashan', {precipitationDC: 15, season: 'fall'});\nweatherData.set('Neth', {precipitationDC: 15, season: 'fall'});\nweatherData.set('Kuthona', {coldDC: 18, precipitationDC: 8, season: 'winter'});\n\nexport function getSeason(month: GolarionMonth): WeatherData {\n    return weatherData.get(month)!;\n}\n\nexport const eventLevels = new Map<string, number>();\neventLevels.set('Fog', 0);\neventLevels.set('Heavy downpour', 0);\neventLevels.set('Cold snap', 1);\neventLevels.set('Windstorm', 1);\neventLevels.set('Hailstorm, severe', 2);\neventLevels.set('Blizzard', 6);\neventLevels.set('Supernatural storm', 6);\neventLevels.set('Flash flood', 7);\neventLevels.set('Wildfire', 4);\neventLevels.set('Subsidence', 5);\neventLevels.set('Thunderstorm', 7);\neventLevels.set('Tornado', 12);\n","import {\n    actorHasEffectByUuid,\n    getActorsByUuid,\n    hasItemByUuid,\n    removeActorsEffectsByName,\n    removeActorsEffectsByUuid,\n} from './actor';\nimport {Camping, getCampingActivityData, rollCampingCheck} from './camping';\nimport {saveCamping} from './storage';\nimport {getAllExpiringMealEffectUuids} from './recipes';\nimport {getRecipeData} from './eating';\nimport {getEncounterDC, rollRandomEncounter} from './random-encounters';\nimport {formatHours} from '../time/app';\n\n\nfunction calculateRestSeconds(partySize: number, restDurationSeconds: number): number {\n    if (partySize < 2) {\n        return restDurationSeconds;\n    } else {\n        let seconds = restDurationSeconds + Math.floor(restDurationSeconds / (partySize - 1));\n        // round up seconds to next minute\n        if (seconds % 60 !== 0) {\n            seconds += 60 - (seconds % 60);\n        }\n        return seconds;\n    }\n}\n\nexport function calculateDailyPreparationsSeconds(gunsToClean: number): number {\n    return gunsToClean === 0 ? 30 * 60 : Math.ceil(gunsToClean / 4) * 3600;\n}\n\nasync function healMoreHp(actor: Actor, data: Camping): Promise<void> {\n    const healMoreHp = await hasItemByUuid(actor, 'effect', new Set([\n        getRecipeData(data).find(r => r.name === 'Basic Meal')!.criticalSuccess!.effects![0].uuid!,\n        getCampingActivityData(data).find(a => a.name === 'Dawnflower\\'s Blessing')!.effectUuids![0]!.uuid!,\n    ]));\n    if (healMoreHp) {\n        const currentHp = actor.attributes.hp.value;\n        const maxHp = actor.attributes.hp.max;\n        const conMod = actor.abilities.con.mod;\n        const level = actor.level;\n        const maxRestored = Math.max(conMod, 1) * level;\n        const hpLost = maxHp - currentHp;\n        const hpRestored = hpLost >= maxRestored ? maxRestored : hpLost;\n        if (hpRestored > 0) {\n            await actor.update({'system.attributes.hp.value': currentHp + hpRestored});\n        }\n    }\n}\n\nasync function removeExpiredMealEffects(actors: Actor[], camping: Camping): Promise<void> {\n    const recipeData = getRecipeData(camping);\n    const expiringUuids = getAllExpiringMealEffectUuids(recipeData);\n    await removeActorsEffectsByUuid(actors, new Set(expiringUuids));\n}\n\nasync function getAverageRestDuration(camping: Camping): Promise<number> {\n    // hardcode fish on a stick\n    const fishOnAStick = getRecipeData(camping).find(r => r.name === 'Fish-On-A-Stick')!;\n    const favoriteMeal = fishOnAStick.favoriteMeal!.effects![0]!.uuid;\n    const criticalFailure = fishOnAStick.criticalFailure!.effects![0]!.uuid;\n    const actors = await getActorsByUuid(new Set(camping.actorUuids));\n    const actorsFavoriteMeal = (await Promise.all(actors\n        .map(async a => (await actorHasEffectByUuid(a, favoriteMeal)) ? 1 : 0)))\n        .reduce((a: number, b: number) => a + b, 0);\n    const actorsCriticalFailure = (await Promise.all(actors\n        .map(async a => (await actorHasEffectByUuid(a, criticalFailure)) ? 1 : 0)))\n        .reduce((a: number, b: number) => a + b, 0);\n    const actorsHavingNeither = actors.length - (actorsCriticalFailure + actorsFavoriteMeal);\n    return Math.floor(\n        ((8 * 3600 * actorsHavingNeither) +\n            (7 * 3600 * actorsFavoriteMeal) +\n            (9 * 3600 * actorsCriticalFailure)) / actors.length);\n}\n\nexport function getActorsKeepingWatch(data: Camping, actors: Actor[]): number {\n    const organizeWatchCritSuccess = data.campingActivities\n        .find(a => a.activity === 'Organize Watch' && a.result === 'criticalSuccess');\n    // 1 person can't keep watch, so don't increase to 2\n    const additionalWatchers = actors.length > 1 ? (organizeWatchCritSuccess ? 1 : 0) : 0;\n    const blacklistedActorNumber = data.actorUuidsNotKeepingWatch\n        .filter(uuid => data.actorUuids.includes(uuid))\n        .length;\n    return actors.length + additionalWatchers + data.increaseWatchActorNumber - blacklistedActorNumber;\n}\n\nexport async function getWatchSecondsDuration(actors: Actor[], data: Camping): Promise<number> {\n    return calculateRestSeconds(getActorsKeepingWatch(data, actors), await getAverageRestDuration(data));\n}\n\nexport interface WatchHours {\n    restHours: string;\n    currentRestHours: string;\n}\n\nexport function getRestHours(watchSecondsDuration: number, dailyPrepsSeconds: number, watchSecondsRemaining: number): WatchHours {\n    const fullDurationSeconds = watchSecondsDuration + dailyPrepsSeconds;\n    const currentSeconds = watchSecondsRemaining > 0 ? Math.max(0, fullDurationSeconds - watchSecondsRemaining) : 0;\n    return {\n        currentRestHours: formatHours(currentSeconds),\n        restHours: formatHours(fullDurationSeconds),\n    };\n}\n\ninterface RestAdvanceTo {\n    encounter: boolean;\n    advanceToSeconds: number;\n    remainingSeconds: number;\n}\n\nexport async function getWatchRandomEncounterData(\n    game: Game,\n    camping: Camping,\n    watchDurationSeconds: number,\n): Promise<RestAdvanceTo> {\n    const dailyPrepsDuration = calculateDailyPreparationsSeconds(camping.gunsToClean);\n    const mode = camping.restRollMode;\n    const dc = getEncounterDC(camping, game);\n    const fullRestDurationInSeconds = watchDurationSeconds + dailyPrepsDuration;\n    const region = camping.currentRegion;\n    if (mode === 'one') {\n        if (await rollRandomEncounter(game, region, dc)) {\n            const advanceToSeconds = Math.floor(Math.random() * watchDurationSeconds);\n            return {\n                encounter: true,\n                remainingSeconds: fullRestDurationInSeconds - advanceToSeconds,\n                advanceToSeconds,\n            };\n        }\n    } else if (mode === 'one-every-4-hours') {\n        const checks = Math.floor(watchDurationSeconds / (3600 * 4));\n        const encounterAtSeconds = Math.floor(Math.random() * 4 * 3600);\n        for (let i = 0; i < checks; i += 1) {\n            if (await rollRandomEncounter(game, region, dc)) {\n                const advanceToSeconds = i * 3600 * 4 + encounterAtSeconds;\n                return {\n                    advanceToSeconds,\n                    remainingSeconds: fullRestDurationInSeconds - advanceToSeconds,\n                    encounter: true,\n                };\n            }\n        }\n    }\n    return {\n        advanceToSeconds: fullRestDurationInSeconds,\n        remainingSeconds: 0,\n        encounter: false,\n    };\n}\n\nexport interface RestParameters {\n    game: Game;\n    sheetActor: Actor;\n    camping: Camping;\n    watchDurationSeconds: number;\n}\n\nasync function playRestingPlaylist(game: Game): Promise<void> {\n    const restingPlaylist = game.playlists?.getName('Kingmaker.Resting');\n    if (restingPlaylist) {\n        await Promise.all(restingPlaylist.sounds.map(a => a.update({playing: true})));\n    }\n}\n\nexport async function rest(params: RestParameters): Promise<void> {\n    const {game, camping, watchDurationSeconds, sheetActor} = params;\n    const actors = await getActorsByUuid(new Set(camping.actorUuids));\n\n    // if remaining seconds are 0 from the start, we haven't started the watch yet\n    if (camping.watchSecondsRemaining === 0) {\n        await playRestingPlaylist(game);\n        camping.watchSecondsRemaining = await startWatch(game, camping, watchDurationSeconds, actors);\n    } else {\n        await game.time.advance(camping.watchSecondsRemaining);\n        camping.watchSecondsRemaining = 0;\n    }\n    await saveCamping(game, sheetActor, camping);\n\n    if (camping.watchSecondsRemaining === 0) {\n        await completeDailyPreparations(game, sheetActor, actors, camping);\n    }\n}\n\nasync function startWatch(game: Game, camping: Camping, watchDurationSeconds: number, actors: Actor[]): Promise<number> {\n    const {\n        advanceToSeconds,\n        remainingSeconds,\n        encounter,\n    } = await getWatchRandomEncounterData(game, camping, watchDurationSeconds);\n    await game.time.advance(advanceToSeconds);\n    if (encounter) {\n        const actorsKeepingWatch = actors\n            .filter(a => !camping.actorUuidsNotKeepingWatch.includes(a.uuid) && (a.type === 'character' || a.type === 'npc'));\n        if (actorsKeepingWatch.length > 0) {\n            const actorKeepingWatchIndex = Math.floor(Math.random() * actorsKeepingWatch.length);\n            await rollCampingCheck({\n                game,\n                isWatch: true,\n                secret: true,\n                region: camping.currentRegion,\n                actor: actorsKeepingWatch[actorKeepingWatchIndex],\n                skill: 'perception',\n            });\n        }\n    }\n    return remainingSeconds;\n}\n\nasync function completeDailyPreparations(\n    game: Game,\n    sheetActor: Actor,\n    actors: Actor[],\n    data: Camping,\n): Promise<void> {\n    await Promise.all(actors.map(async actor => await healMoreHp(actor, data)));\n    data.cooking.degreeOfSuccess = null;\n    data.campingActivities.forEach(a => a.result = null);\n    data.dailyPrepsAtTime = game.time.worldTime;\n    await removeActorsEffectsByName(actors, new Set([\n        'Undead Guardians (Aided)',\n        'Undead Guardians (Defended)',\n    ]));\n    await removeActorsEffectsByUuid(actors, new Set([\n        'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.ZKJlIqyFgbKDACnG', // enhance weapons\n        'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.pbhKANmDOvwuuchk', // aided\n        'Compendium.pf2e-kingmaker-tools.kingmaker-tools-camping-effects.Item.tERAC9KHwBjoUt5u', // defended\n    ]));\n    await removeExpiredMealEffects(actors, data);\n    await saveCamping(game, sheetActor, data);\n    await game.pf2e.actions.restForTheNight({actors, skipDialog: true});\n}\n","import {\n    combatEffectsToChat,\n    toViewActorMeals,\n    toViewActors,\n    toViewCampingActivities,\n    toViewDegrees,\n    ViewCampingData,\n} from './view';\nimport {formatHours} from '../time/app';\nimport {getEncounterDC, rollRandomEncounter} from './random-encounters';\nimport {regions} from './regions';\nimport {CampingActivityData, CampingActivityName, huntAndGather} from './activities';\nimport {\n    ActorMeal,\n    Camping,\n    CookingSkill,\n    getCampingActivityData,\n    getDefaultConfiguration,\n    getPartyActors,\n    rollCampingCheck,\n    SkillCheckOptions,\n} from './camping';\nimport {manageActivitiesDialog} from './dialogs/manage-activities';\nimport {manageRecipesDialog} from './dialogs/manage-recipes';\nimport {getKnownRecipes, getRecipesKnownInRegion, RecipeData} from './recipes';\nimport {addRecipeDialog} from './dialogs/add-recipe';\nimport {campingSettingsDialog} from './dialogs/camping-settings';\nimport {DegreeOfSuccess, degreeToProperty, StringDegreeOfSuccess} from '../degree-of-success';\nimport {getTimeOfDayPercent, getWorldTime} from '../time/calculation';\nimport {formatWorldTime} from '../time/format';\nimport {LabelAndValue, listenClick} from '../utils';\nimport {getActorsByUuid, hasCookingLore, NotProficientError, validateSkillProficiencies} from './actor';\nimport {askDcDialog} from './dialogs/ask-dc';\nimport {discoverSpecialMeal} from './dialogs/learn-recipe';\nimport {setupDialog} from '../kingdom/dialogs/setup-dialog';\nimport {getCamping, saveCamping} from './storage';\nimport {postDiscoverSpecialMealResult, postHuntAndGatherResult} from './chat';\nimport {DiffListener, eat, getDiffListeners} from './effect-syncing';\nimport {\n    calculateDailyPreparationsSeconds,\n    getActorsKeepingWatch,\n    getRestHours,\n    getWatchSecondsDuration,\n    rest,\n} from './resting';\nimport {\n    calculateConsumedFood,\n    canCook,\n    getActorConsumables,\n    getChosenMealData,\n    getCookingActorByUuid,\n    getCookingActorUuid,\n    getRecipeData,\n    removeFood,\n    subsist,\n} from './eating';\nimport {allowedActors} from './data';\nimport {openJournal} from '../foundry-utils';\nimport {getStringSetting} from '../settings';\n\ninterface CampingOptions {\n    game: Game;\n    actor: Actor;\n}\n\ninterface CampingData {\n    chosenMeal: string;\n    subsistenceAmount: number;\n    magicalSubsistenceAmount: number;\n    currentRegion: string;\n    mealDegreeOfSuccess: StringDegreeOfSuccess | null;\n    cookingSkill: CookingSkill;\n}\n\n\nexport class CampingSheet extends FormApplication<CampingOptions & FormApplicationOptions, ViewCampingData, null> {\n    private diffListeners: DiffListener[];\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'camping-app';\n        options.title = 'Camping Sheet';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/camping/sheet.hbs';\n        options.classes = ['kingmaker-tools-app', 'camping-app'];\n        options.scrollY = ['.camping-sidebar', '.camping-content'];\n        options.width = 862;\n        options.height = 'auto';\n        options.dragDrop = [{\n            dropSelector: '.new-camping-actor, .camping-activity, .camping-actor, .eating-actor',\n            dragSelector: '.camping-actor, .content-link[data-type=Item]',\n        }];\n        options.closeOnSubmit = false;\n        options.submitOnChange = true;\n        options.submitOnClose = false;\n        options.editable = true;\n        return options;\n    }\n\n    private isGM: boolean;\n    private readonly game: Game;\n    private actor: Actor;\n\n    constructor(options: CampingOptions) {\n        super(null, options);\n        this.game = options.game;\n        this.isGM = this.game.user?.isGM ?? false;\n        this.actor = options.actor;\n        this.actor.apps[this.appId] = this;\n        this.diffListeners = getDiffListeners(this.game);\n    }\n\n    override async getData(): Promise<ViewCampingData> {\n        const data = await this.read();\n        const currentSeconds = this.game.time.worldTime;\n        const currentRegion = data.currentRegion;\n        const sumElapsedSeconds = Math.abs(currentSeconds - data.dailyPrepsAtTime);\n        const activityData = getCampingActivityData(data);\n        const actors = await this.getActors(data);\n        const watchSecondsDuration = await getWatchSecondsDuration(actors, data);\n        const actorsKeepingWatch = getActorsKeepingWatch(data, actors);\n        const {total: encounterDC, modifier: currentEncounterDCModifier} = getEncounterDC(data, this.game);\n        const actorConsumables = await getActorConsumables([...actors, ...getPartyActors(this.game)]);\n        const knownRecipes = getKnownRecipes(data);\n        const chosenMealData = getChosenMealData(data);\n        const chosenMeal = chosenMealData.name;\n        const isUser = !this.isGM;\n        const viewActors = await toViewActors(data.actorUuids, data.campingActivities, getCampingActivityData(data), isUser);\n        const dailyPrepsSeconds = calculateDailyPreparationsSeconds(data.gunsToClean);\n        const viewData: ViewCampingData = {\n            isGM: this.isGM,\n            isUser,\n            ...actorConsumables,\n            currentEncounterDCModifier,\n            encounterDC,\n            watchEnabled: viewActors.length > 0,\n            adventuringSince: formatHours(sumElapsedSeconds, data.dailyPrepsAtTime > currentSeconds),\n            regions: Array.from(regions.keys()),\n            currentRegion,\n            actors: viewActors,\n            campingActivities: await toViewCampingActivities(data.campingActivities, activityData, new Set(data.lockedActivities)),\n            watchSecondsDuration,\n            dailyPrepsDuration: formatHours(dailyPrepsSeconds),\n            watchDuration: formatHours(watchSecondsDuration),\n            subsistenceAmount: data.cooking.subsistenceAmount,\n            magicalSubsistenceAmount: data.cooking.magicalSubsistenceAmount,\n            chosenMeal: chosenMeal,\n            knownRecipes: knownRecipes,\n            knownFavoriteRecipes: knownRecipes.filter(r => r !== 'Basic Meal'),\n            degreesOfSuccesses: toViewDegrees(),\n            mealDegreeOfSuccess: data.cooking.degreeOfSuccess,\n            time: formatWorldTime(getWorldTime(this.game)),\n            // 4px offset is half of the element's width including borders\n            timeMarkerPositionPx: Math.floor(getTimeOfDayPercent(getWorldTime(this.game)) * 8.46) - 4,\n            hasCookingActor: canCook(data),\n            consumedFood: calculateConsumedFood(canCook(data), actorConsumables, {\n                actorsConsumingRations: data.cooking.actorMeals.filter(a => a.chosenMeal === 'rationsOrSubsistence').length,\n                actorsConsumingMeals: data.cooking.actorMeals.filter(a => a.chosenMeal === 'meal').length,\n                availableSubsistence: data.cooking.subsistenceAmount,\n                availableMagicalSubsistence: data.cooking.magicalSubsistenceAmount,\n                recipeBasicIngredientCost: chosenMealData?.basicIngredients ?? 0,\n                recipeSpecialIngredientCost: chosenMealData?.specialIngredients ?? 0,\n            }),\n            actorMeals: await toViewActorMeals(data.actorUuids, data.cooking.actorMeals, getRecipeData(data)),\n            ...(await this.getCookingSkillData(data)),\n            chosenMealDc: await this.getMealDc(data, chosenMealData),\n            showContinueRest: data.watchSecondsRemaining !== 0,\n            ...getRestHours(watchSecondsDuration, dailyPrepsSeconds, data.watchSecondsRemaining),\n            actorsKeepingWatch,\n        };\n        return viewData;\n    }\n\n    private async getCookingSkillData(data: Camping): Promise<{\n        cookingSkill: CookingSkill,\n        cookingSkills: LabelAndValue[]\n    }> {\n        const hasCookingLore = await this.cookingActorHasCookingLore(data);\n        const cookingSkills = [\n            ...(hasCookingLore ? [{value: 'cooking', label: 'Cooking'}] : []),\n            {value: 'survival', label: 'Survival'},\n        ];\n        const cookingSkill = hasCookingLore ? data.cooking.cookingSkill : 'survival';\n        return {\n            cookingSkills,\n            cookingSkill,\n        };\n    }\n\n    protected _canDragDrop(): boolean {\n        return true;\n    }\n\n    protected _canDragStart(): boolean {\n        return true;\n    }\n\n    private async getMealDc(data: Camping, chosenMealData: RecipeData): Promise<number> {\n        const skillData = await this.getCookingSkillData(data);\n        if (skillData.cookingSkill === 'survival') {\n            return chosenMealData.survivalDC;\n        } else {\n            return chosenMealData.cookingLoreDC;\n        }\n    }\n\n    private async cookingActorHasCookingLore(data: Camping): Promise<boolean> {\n        const cookingActor = getCookingActorUuid(data);\n        if (cookingActor) {\n            return await hasCookingLore(cookingActor);\n        } else {\n            return false;\n        }\n    }\n\n    private async getActors(data: Camping): Promise<Actor[]> {\n        return await getActorsByUuid(new Set(data.actorUuids));\n    }\n\n    protected _getHeaderButtons(): Application.HeaderButton[] {\n        const buttons = super._getHeaderButtons();\n        buttons.unshift({\n            label: 'Help',\n            class: 'pf2e-kingmaker-tools-hb1',\n            icon: 'fas fa-question',\n            onclick: () => openJournal('Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.iAQCUYEAq4Dy8uCY.JournalEntryPage.bmKVD2uzBK6Qu8QS'),\n        });\n        if (this.game.user?.isGM ?? false) {\n            buttons.unshift({\n                label: 'Show Players',\n                class: 'pf2e-kingmaker-tools-hb2',\n                icon: 'fas fa-eye',\n                onclick: () => this.emit({\n                    action: 'openCampingSheet',\n                }),\n            });\n        }\n        return buttons;\n    }\n\n    private emit(args: object): void {\n        this.game.socket!.emit('module.pf2e-kingmaker-tools', args);\n    }\n\n    private reRender(): void {\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        Hooks.on('updateWorldTime', this.reRender.bind(this));\n        Hooks.on('updateItem', this.reRender.bind(this));\n        Hooks.on('createItem', this.reRender.bind(this));\n        Hooks.on('deleteItem', this.reRender.bind(this));\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.remove-actor', async (ev) => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const uuid = button.dataset.uuid;\n            const type = button.dataset.type;\n            if (uuid !== undefined && type !== undefined) {\n                await this.removeActor(uuid, type);\n            }\n        });\n        listenClick($html, '.post-combat-effects', async () => {\n            const current = await this.read();\n            await combatEffectsToChat(current);\n        });\n        listenClick($html, '.advance-hours', async (ev) => {\n            const target = ev.currentTarget as HTMLButtonElement;\n            const hours = target.dataset.hours ?? '0';\n            await this.advanceHours(parseInt(hours, 10));\n        });\n        listenClick($html, '.manage-recipes', async () => {\n            const current = await this.read();\n            await manageRecipesDialog({\n                isGM: this.isGM,\n                recipes: getRecipeData(current),\n                learnedRecipes: new Set(getKnownRecipes(current)),\n                onSubmit: async (knownRecipes, deletedRecipes) => {\n                    current.cooking.knownRecipes = Array.from(knownRecipes);\n                    current.cooking.homebrewMeals = current.cooking.homebrewMeals\n                        .filter(m => !deletedRecipes.has(m.name));\n                    await this.update({cooking: current.cooking});\n                },\n            });\n        });\n        listenClick($html, '.add-recipes', async () => {\n            const current = await this.read();\n            await addRecipeDialog({\n                recipes: getRecipeData(current),\n                onSubmit: async (recipe) => {\n                    current.cooking.homebrewMeals.push(recipe);\n                    await this.update({cooking: current.cooking});\n                },\n            });\n        });\n        listenClick($html, '.manage-activities', async () => {\n            await manageActivitiesDialog({\n                game: this.game,\n                actor: this.actor,\n            });\n        });\n        listenClick($html, '.subsist', async (ev) => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const uuid = button.dataset.uuid!;\n            const current = await this.read();\n            const actor = await fromUuid(uuid) as Actor | null;\n            if (actor) {\n                await subsist(this.game, actor, current.currentRegion);\n            }\n        });\n        listenClick($html, '.roll-encounter', async () => await this.rollRandomEncounter(true));\n        listenClick($html, '.check-encounter', async () => await this.rollRandomEncounter());\n        listenClick($html, '.consume-food', async () => await this.consumeFood());\n        listenClick($html, '.decrease-zone-dc-modifier', async () => {\n            const current = await this.read();\n            await this.update({encounterModifier: current.encounterModifier - 1});\n        });\n        listenClick($html, '.reset-adventuring-time', async () => await this.resetAdventuringSince());\n        listenClick($html, '.eat-food', async () => await eat(this.game, await this.read()));\n        listenClick($html, '.increase-zone-dc-modifier', async () => {\n            const current = await this.read();\n            await this.update({encounterModifier: current.encounterModifier + 1});\n        });\n        listenClick($html, '.reset-zone-dc-modifier', async () => await this.update({encounterModifier: 0}));\n        listenClick($html, '.cook-food', async () => {\n            const current = await this.read();\n            const cookingActor = await getCookingActorByUuid(current);\n            if (cookingActor) {\n                const {cookingSkill} = await this.getCookingSkillData(current);\n                const chosenMealData = getChosenMealData(current);\n                const dc = await this.getMealDc(current, chosenMealData);\n                const activity = getCampingActivityData(current)\n                    .find(a => a.name === 'Cook Meal')!;\n                const result = await rollCampingCheck({\n                    game: this.game,\n                    actor: cookingActor,\n                    activity,\n                    dc,\n                    skill: cookingSkill,\n                    region: current.currentRegion,\n                });\n                if (result !== null) {\n                    current.cooking.degreeOfSuccess = degreeToProperty(result);\n                    await this.update({\n                        cooking: current.cooking,\n                    });\n                }\n            }\n        });\n        listenClick($html, '.rest', async () => {\n            const camping = await this.read();\n            const actors = await this.getActors(camping);\n            await rest({\n                camping,\n                sheetActor: this.actor,\n                game: this.game,\n                watchDurationSeconds: await getWatchSecondsDuration(actors, camping),\n            });\n        });\n        listenClick($html, '.roll-check', async (ev) => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const activity = button.dataset.activity!;\n            const skill = button.dataset.skill!;\n            await this.rollCheck(activity, skill);\n        });\n        listenClick($html, '.recipe-info', async () => {\n            const current = await this.read();\n            const recipe = getChosenMealData(current);\n            const item = await fromUuid(recipe.uuid) as Item | null;\n            item?.sheet?.render(true);\n        });\n        listenClick($html, '.camping-settings', async () => {\n            const current = await this.read();\n            const actors = await getActorsByUuid(new Set(current.actorUuids));\n            const partyActors = getPartyActors(this.game);\n            campingSettingsDialog({\n                data: {\n                    actors: [...actors, ...partyActors],\n                    huntAndGatherTargetActorUuid: current.huntAndGatherTargetActorUuid,\n                    restRollMode: current.restRollMode,\n                    gunsToClean: current.gunsToClean,\n                    increaseWatchActorNumber: current.increaseWatchActorNumber,\n                    ignoreSkillRequirements: current.ignoreSkillRequirements,\n                    proxyRandomEncounterTable: getStringSetting(this.game, 'proxyEncounterTable'),\n                    randomEncounterRollMode: getStringSetting(this.game, 'randomEncounterRollMode') as RollMode,\n                    actorsKeepingWatch: actors\n                        .map(a => {\n                            return {\n                                uuid: a.uuid,\n                                name: a.name ?? 'Unknown Actor',\n                                watchEnabled: !current.actorUuidsNotKeepingWatch.includes(a.uuid),\n                            };\n                        }),\n                },\n                game: this.game,\n                onSubmit: async (data) => await this.update(data),\n            });\n        });\n        listenClick($html, '.camping-actors .actor-image', async (ev) => {\n            const button = ev.currentTarget as HTMLButtonElement;\n            const uuid = button.dataset.uuid;\n            if (uuid !== undefined) {\n                await this.openUuidSheet(uuid);\n            }\n        });\n        listenClick($html, '.camping-actors .actor-header', async (ev) => {\n            const button = ev.currentTarget as HTMLElement;\n            const uuid = button.dataset.uuid;\n            if (uuid !== undefined) {\n                await openJournal(uuid);\n            }\n        });\n    }\n\n    private async rollCheck(activity: string, skill: string): Promise<void> {\n        const current = await this.read();\n        const activityData = getCampingActivityData(current)\n            .find(a => a.name === activity);\n        const actorUuid = current.campingActivities\n            .find(a => a.activity === activity)\n            ?.actorUuid;\n        const actor = actorUuid ? (await fromUuid(actorUuid)) as Actor | null : null;\n        if (activityData && actor) {\n            if (activity === 'Discover Special Meal') {\n                await this.discoverSpecialMeal(activityData, skill, actor, getRecipeData(current), current.currentRegion);\n            } else if (activity === 'Hunt and Gather') {\n                await this.huntAndGather(activityData, skill, actor, current.currentRegion);\n            } else {\n                await this.rollStandardCheck(activityData, skill, actor, current.currentRegion);\n            }\n        }\n    }\n\n    private async rollStandardCheck(\n        activity: CampingActivityData,\n        skill: string,\n        actor: Actor,\n        currentRegion: string,\n    ): Promise<void> {\n        const dcType = activity.dc;\n        const rollOptions: SkillCheckOptions = {\n            skill,\n            secret: activity.isSecret,\n            activity,\n            actor,\n            game: this.game,\n            region: currentRegion,\n        };\n        const activityName = activity.name;\n        if (dcType) {\n            rollOptions.dc = dcType;\n            await this.setActivityResult(activityName, await rollCampingCheck(rollOptions));\n        } else {\n            askDcDialog({\n                activity: activityName,\n                onSubmit: async (dc) => {\n                    rollOptions.dc = dc;\n                    await this.setActivityResult(activityName, await rollCampingCheck(rollOptions));\n                },\n            });\n        }\n    }\n\n    private async rollRandomEncounter(forgoFlatCheck = false): Promise<void> {\n        const current = await this.read();\n        const dc = getEncounterDC(current, this.game);\n        await rollRandomEncounter(this.game, current.currentRegion, dc, forgoFlatCheck);\n    }\n\n    override close(options?: Application.CloseOptions): Promise<void> {\n        Hooks.off('updateWorldTime', this.render);\n        Hooks.off('updateItem', this.render);\n        Hooks.off('createItem', this.render);\n        Hooks.off('deleteItem', this.render);\n        return super.close(options);\n    }\n\n    private async advanceHours(hours: number): Promise<void> {\n        await this.game.time.advance(hours * 3600);\n    }\n\n    private async removeActor(uuid: string, type: string): Promise<void> {\n        const current = await this.read();\n        if (type === 'camping-actors') {\n            await this.update({\n                actorUuids: current.actorUuids.filter(id => id !== uuid),\n                campingActivities: current.campingActivities.filter(a => a.actorUuid !== uuid),\n            });\n        } else {\n            const campingConfiguration = await this.read();\n            const activity = campingConfiguration.campingActivities\n                .find(a => a.activity === type);\n            if (activity) {\n                activity.actorUuid = null;\n                await this.update({campingActivities: campingConfiguration.campingActivities});\n            }\n        }\n    }\n\n    protected _onDragStart(event: DragEvent): void {\n        super._onDragStart(event);\n        const target = event.currentTarget as HTMLLIElement;\n        const uuid = target.dataset.uuid;\n        event?.dataTransfer?.setData('text/plain', JSON.stringify({type: 'Actor', uuid: uuid}));\n    }\n\n    protected async _onDrop(event: DragEvent): Promise<void> {\n        const target = event.currentTarget as HTMLLIElement;\n        const document = await this.parseDropData(event);\n        if (document) {\n            const campingConfiguration = await this.read();\n            if (target.classList.contains('camping-activity') && (document.type === 'character' || document.type === 'npc')) {\n                const activityName = target.dataset.name as CampingActivityName;\n                const current = await this.read();\n                const data = getCampingActivityData(current);\n                const proficiencyRequirements = data\n                    .find(a => a.name === activityName)?.skillRequirements ?? [];\n                if (document instanceof Actor) {\n                    try {\n                        if (!current.ignoreSkillRequirements) {\n                            await validateSkillProficiencies(document, proficiencyRequirements);\n                        }\n                        await this.setActivityActor(campingConfiguration, activityName, document.uuid);\n                    } catch (e) {\n                        if (e instanceof NotProficientError) {\n                            ui.notifications?.error(e.message);\n                        } else {\n                            throw e;\n                        }\n                    }\n                } else {\n                    await this.handleItemDrop(document, target.dataset.actorUuid!);\n                }\n            } else if (target.classList.contains('new-camping-actor') && !campingConfiguration.actorUuids.includes(document.uuid)) {\n                await this.update({actorUuids: [...(campingConfiguration.actorUuids), document.uuid]});\n            } else if (target.classList.contains('camping-actor') && document instanceof Item) {\n                await this.handleItemDrop(document, target.dataset.actorUuid!);\n            } else if (target.classList.contains('eating-actor') && document instanceof Item) {\n                await this.handleItemDrop(document, target.dataset.actorUuid!);\n            }\n        }\n    }\n\n    private async setActivityActor(campingConfiguration: Camping, activityName: CampingActivityName, uuid: string): Promise<void> {\n        const activity = campingConfiguration.campingActivities\n            .find(a => a.activity === activityName);\n        if (activity) {\n            activity.actorUuid = uuid;\n        } else {\n            campingConfiguration.campingActivities.push({\n                activity: activityName,\n                actorUuid: uuid,\n                result: null,\n                selectedSkill: null,\n            });\n        }\n        await this.update({campingActivities: campingConfiguration.campingActivities});\n    }\n\n    private async parseDropData(event: DragEvent): Promise<Actor | Item | null> {\n        const dropData = event.dataTransfer?.getData('text/plain');\n        if (!dropData) return null;\n        try {\n            const data = JSON.parse(dropData);\n            const uuid = data.uuid;\n            if (typeof uuid !== 'string') {\n                console.error('No uuid found on drop data: ' + dropData);\n                return null;\n            }\n            const document = await fromUuid(uuid) as Actor | Item | null;\n            if (document) {\n                const type = document?.type;\n                if (document instanceof Actor && allowedActors.has(type) || document instanceof Item) {\n                    return document;\n                } else {\n                    console.error('No character or item document type, instead found: ' + type);\n                    return null;\n                }\n            }\n        } catch (e) {\n            console.error(e);\n            console.info(dropData);\n        }\n        return null;\n    }\n\n    private async update(data: Partial<Camping>): Promise<void> {\n        await saveCamping(this.game, this.actor, data);\n    }\n\n    private async read(): Promise<Camping> {\n        return getCamping(this.actor);\n    }\n\n    private async openUuidSheet(uuid: string): Promise<void> {\n        const item = await fromUuid(uuid) as Item | null;\n        item?.sheet?.render(true);\n    }\n\n    protected async _updateObject(event: Event, formData: CampingData): Promise<void> {\n        console.log('formdata', formData);\n        const current = await this.read();\n        const mealDegreeOfSuccess = this.parseNullableSelect(formData.mealDegreeOfSuccess) as StringDegreeOfSuccess | null;\n        const update = {\n            currentRegion: formData.currentRegion,\n            campingActivities: getCampingActivityData(current).map(activityData => {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                const data = formData as any;\n                const degreeKey = `actorActivityDegreeOfSuccess.${activityData.name}`;\n                const skillKey = `selectedSkill.${activityData.name}`;\n                return {\n                    activity: activityData.name,\n                    selectedSkill: this.parseNullableSelect(data[skillKey]),\n                    result: this.parseNullableSelect(data[degreeKey]) as StringDegreeOfSuccess | null,\n                    actorUuid: current.campingActivities\n                        .find(activity => activity.activity === activityData.name)?.actorUuid ?? null,\n                };\n            }),\n            cooking: {\n                magicalSubsistenceAmount: formData.magicalSubsistenceAmount,\n                subsistenceAmount: formData.subsistenceAmount,\n                chosenMeal: formData.chosenMeal,\n                homebrewMeals: current.cooking.homebrewMeals,\n                knownRecipes: getKnownRecipes(current),\n                degreeOfSuccess: mealDegreeOfSuccess,\n                actorMeals: await this.parseActorMeals(formData),\n                cookingSkill: formData.cookingSkill as CookingSkill,\n            },\n        };\n        await this.update(update);\n        this.render();\n    }\n\n    private parseNullableSelect(formData: string | null | undefined): string | null {\n        if (formData === null || formData === undefined || formData.length === 0 || formData === '-') {\n            return null;\n        }\n        return formData;\n    }\n\n    private async consumeFood(): Promise<void> {\n        const current = await this.read();\n        const actors = [...(await this.getActors(current)), ...getPartyActors(this.game)];\n        const actorConsumables = await getActorConsumables(actors);\n        const chosenMealData = getRecipeData(current)\n            .find(a => a.name === current.cooking.chosenMeal);\n        const consumed = calculateConsumedFood(canCook(current), actorConsumables, {\n            actorsConsumingRations: current.cooking.actorMeals.filter(a => a.chosenMeal === 'rationsOrSubsistence').length,\n            actorsConsumingMeals: current.cooking.actorMeals.filter(a => a.chosenMeal === 'meal').length,\n            availableSubsistence: current.cooking.subsistenceAmount,\n            availableMagicalSubsistence: current.cooking.magicalSubsistenceAmount,\n            recipeBasicIngredientCost: chosenMealData?.basicIngredients ?? 0,\n            recipeSpecialIngredientCost: chosenMealData?.specialIngredients ?? 0,\n        });\n        const config = {\n            rations: consumed.rations.value,\n            specialIngredients: consumed.specialIngredients.value,\n            basicIngredients: consumed.basicIngredients.value,\n        };\n        await removeFood(actors, config);\n        await ChatMessage.create({\n            content: `Removed up to the following amounts from actor inventories\n                <ul>\n                    <li><b>Rations</b>: ${config.rations}</li>\n                    <li><b>Basic Ingredients</b>: ${config.basicIngredients}</li>\n                    <li><b>Special Ingredients</b>: ${config.specialIngredients}</li>\n                </ul>\n            `,\n        });\n    }\n\n    private async parseActorMeals(formData: CampingData): Promise<ActorMeal[]> {\n        const current = await this.read();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const data = formData as any;\n        return current.actorUuids.map(uuid => {\n            const x: ActorMeal = {\n                actorUuid: uuid,\n                favoriteMeal: this.parseNullableSelect(data['actorFavoriteMeal.' + uuid]),\n                chosenMeal: data['actorChosenMeal.' + uuid],\n            };\n            return x;\n        });\n    }\n\n    private async setActivityResult(activityName: string, degreeOfSuccess: DegreeOfSuccess | null): Promise<void> {\n        const current = await this.read();\n        const activity = current.campingActivities.find(a => a.activity === activityName);\n        if (degreeOfSuccess !== null && activity) {\n            activity.result = degreeToProperty(degreeOfSuccess);\n            await this.update({\n                campingActivities: current.campingActivities,\n            });\n        }\n    }\n\n    private async handleItemDrop(document: Item, actorUuid: string): Promise<void> {\n        const actor = await fromUuid(actorUuid) as Actor | null;\n        if (actor) {\n            await actor.createEmbeddedDocuments('Item', [document.toObject()]);\n        }\n    }\n\n    private async discoverSpecialMeal(\n        activityData: CampingActivityData,\n        skill: string,\n        actor: Actor,\n        recipeData: RecipeData[],\n        currentRegion: string,\n    ): Promise<void> {\n        const current = await this.read();\n        const availableFood = await getActorConsumables(await this.getActors(current));\n        const availableRecipes = getRecipesKnownInRegion(this.game, currentRegion, recipeData)\n            .filter(r => !getKnownRecipes(current).includes(r.name));\n        await discoverSpecialMeal({\n            actor,\n            availableFood,\n            availableRecipes,\n            onSubmit: async (recipeName) => {\n                const data = availableRecipes.find(r => r.name === recipeName);\n                if (recipeName !== null && data) {\n                    const current = await this.read();\n                    const result = await rollCampingCheck({\n                        game: this.game,\n                        actor: actor,\n                        dc: data.cookingLoreDC,\n                        skill,\n                        activity: activityData,\n                        region: currentRegion,\n                    });\n                    if (result !== null) {\n                        const isCriticalSuccess = result === DegreeOfSuccess.CRITICAL_SUCCESS;\n                        const isSuccess = result === DegreeOfSuccess.SUCCESS;\n                        const isCriticalFailure = result === DegreeOfSuccess.CRITICAL_FAILURE;\n                        const removeIngredients = {\n                            specialIngredients: isCriticalSuccess ? data.specialIngredients : data.specialIngredients * 2,\n                            basicIngredients: isCriticalSuccess ? data.basicIngredients : data.basicIngredients * 2,\n                            rations: 2,\n                        };\n                        const recipeToAdd = isSuccess || isCriticalSuccess ? data.name : null;\n                        const critFailUuids = isCriticalFailure\n                            ? data.criticalFailure.effects?.map(e => e.uuid) ?? []\n                            : [];\n                        await postDiscoverSpecialMealResult(actor, removeIngredients, recipeToAdd, critFailUuids);\n                        await this.persistActivityDegreeOfSuccess(current, result, 'Discover Special Meal');\n                    }\n                }\n            },\n        });\n    }\n\n    private async persistActivityDegreeOfSuccess(\n        current: Camping,\n        degreeOfSuccess: DegreeOfSuccess,\n        activity: string,\n    ): Promise<void> {\n        current.campingActivities.forEach(a => {\n            if (a.activity === activity) {\n                a.result = degreeToProperty(degreeOfSuccess);\n            }\n        });\n        await this.update({\n            campingActivities: current.campingActivities,\n        });\n    }\n\n    private async huntAndGather(\n        activity: CampingActivityData,\n        skill: string,\n        actor: Actor,\n        currentRegion: string,\n    ): Promise<void> {\n        const current = await this.read();\n        const result = await rollCampingCheck({\n            game: this.game,\n            actor: actor,\n            region: currentRegion,\n            skill,\n            activity,\n            dc: activity.dc,\n        });\n        if (result !== null) {\n            const ingredients = await huntAndGather(this.game, actor, result, currentRegion);\n            await postHuntAndGatherResult(actor, ingredients);\n            await this.persistActivityDegreeOfSuccess(current, result, activity.name);\n        }\n    }\n\n    private async resetAdventuringSince(): Promise<void> {\n        await saveCamping(this.game, this.actor, {\n            dailyPrepsAtTime: this.game.time.worldTime,\n        });\n    }\n}\n\nexport function openCampingSheet(game: Game): void {\n    const sheetActor = game?.actors?.find(a => a.name === 'Camping Sheet');\n    if (sheetActor) {\n        new CampingSheet({game, actor: sheetActor}).render(true);\n    } else {\n        setupDialog(game, 'Camping', 'ggZCKHx8DdqAVVP8', async () => {\n            const sheetActor = game?.actors?.find(a => a.name === 'Camping Sheet');\n            // migrate old recipes\n            const migratedRecipes = game?.actors?.filter(a => a.type === 'character')\n                ?.flatMap(a => {\n                    const knownRecipes = a.getFlag('pf2e-kingmaker-tools', 'knownRecipes');\n                    if (Array.isArray(knownRecipes)) {\n                        return knownRecipes as string[];\n                    } else {\n                        return [];\n                    }\n                }) ?? [];\n            await sheetActor?.setFlag('pf2e-kingmaker-tools', 'camping-sheet', getDefaultConfiguration(game, migratedRecipes));\n            await openCampingSheet(game);\n        });\n    }\n}\n\n\n","import {Camping} from './camping';\nimport {getDiffListeners} from './effect-syncing';\n\nexport async function saveCamping(game: Game, sheetActor: Actor, update: Partial<Camping>): Promise<void> {\n    const current = getCamping(sheetActor);\n    console.info('Saving', update);\n    await sheetActor.setFlag('pf2e-kingmaker-tools', 'camping-sheet', update);\n    console.log('diff', diffObject(current, update));\n    for (const l of getDiffListeners(game)) {\n        await l.testFireChange(current, update);\n    }\n}\n\nexport function getCamping(sheetActor: Actor): Camping {\n    const camping = sheetActor.getFlag('pf2e-kingmaker-tools', 'camping-sheet') as Camping;\n    console.log('Reading', camping);\n    return deepClone(camping);\n}\n\nexport function getCampingActor(game: Game): Actor | null {\n    return game?.actors\n            ?.find(a => a.name === 'Camping Sheet' && a instanceof Actor)\n        ?? null;\n}\n","import {ActorMeal, Camping, CampingActivity, CookingSkill, getCombatEffects} from './camping';\nimport {CampingActivityData, CampingActivityName} from './activities';\nimport {StringDegreeOfSuccess} from '../degree-of-success';\nimport {escapeHtml, LabelAndValue, unslugify} from '../utils';\nimport {RecipeData} from './recipes';\nimport {ConsumedFood} from './eating';\n\ninterface ViewActorMeal extends ViewActor {\n    favoriteMeal: string | null;\n    favoriteMealUuid: string | null;\n    chosenMeal: string;\n}\n\ntype CssClass = StringDegreeOfSuccess | 'secret' | null;\n\ninterface ViewCampingActor extends ViewActor {\n    cssClass: CssClass;\n    noActivityChosen: boolean;\n    activity: string | null;\n}\n\nexport interface ViewCampingData {\n    actorMeals: ViewActorMeal[];\n    actors: ViewCampingActor[];\n    campingActivities: ViewCampingActivity[];\n    currentRegion: string;\n    regions: string[];\n    adventuringSince: string;\n    encounterDC: number;\n    currentEncounterDCModifier: number;\n    isGM: boolean;\n    isUser: boolean;\n    rations: number;\n    specialIngredients: number;\n    basicIngredients: number;\n    watchSecondsDuration: number;\n    watchDuration: string;\n    dailyPrepsDuration: string;\n    subsistenceAmount: number;\n    magicalSubsistenceAmount: number;\n    knownRecipes: string[];\n    knownFavoriteRecipes: string[];\n    chosenMeal: string;\n    degreesOfSuccesses: ViewDegreeOfSuccess[];\n    mealDegreeOfSuccess: StringDegreeOfSuccess | null;\n    time: string;\n    timeMarkerPositionPx: number;\n    hasCookingActor: boolean;\n    consumedFood: ConsumedFood;\n    chosenMealDc: number;\n    cookingSkill: CookingSkill;\n    cookingSkills: LabelAndValue[];\n    showContinueRest: boolean;\n    watchEnabled: boolean;\n    restHours: string;\n    currentRestHours: string;\n    actorsKeepingWatch: number;\n}\n\nexport interface ViewActor {\n    uuid: string;\n    image: string;\n}\n\n\nexport interface ViewCampingActivity {\n    name: string;\n    slug: string;\n    actor: ViewActor | null;\n    journalUuid: string | null;\n    isSkillCheck: boolean;\n    degreeOfSuccess: StringDegreeOfSuccess | null;\n    skills: LabelAndValue[];\n    selectedSkill: string | null;\n    isSecret: boolean;\n    isHidden: boolean;\n    askDc: boolean;\n}\n\nasync function toViewActivity(\n    activity: CampingActivity | undefined,\n    activityData: CampingActivityData,\n    isHidden: boolean,\n): Promise<ViewCampingActivity> {\n    const skills: string[] = [];\n    const activityDataSkills = activityData.skills;\n    if (activityDataSkills === 'any' && activity?.actorUuid) {\n        const actor = await fromUuid(activity.actorUuid) as Actor | null;\n        if (actor) {\n            Object.keys(actor.skills).forEach(s => skills.push(s));\n        }\n    } else if (Array.isArray(activityDataSkills)) {\n        activityDataSkills.forEach(a => skills.push(a));\n    }\n    return {\n        name: activityData.name,\n        actor: activity?.actorUuid ? await toViewActor(activity.actorUuid) : null,\n        journalUuid: activityData.journalUuid ?? null,\n        isSkillCheck: skills.length > 0,\n        skills: skills.map(s => {\n            return {value: s, label: unslugify(s)};\n        }),\n        degreeOfSuccess: activity?.result ?? null,\n        slug: escapeHtml(activityData.name),\n        isSecret: activityData.isSecret,\n        selectedSkill: activity?.selectedSkill ?? (activityDataSkills.length > 0 ? activityDataSkills[0] : null),\n        isHidden,\n        askDc: activityData.dc === undefined,\n    };\n}\n\nexport async function toViewActor(uuid: string): Promise<ViewActor> {\n    const actor = await fromUuid(uuid) as Actor | null;\n    return {\n        image: actor?.img ?? 'modules/pf2e-kingmaker-tools/static/img/add-actor.webp',\n        uuid,\n    };\n}\n\nfunction getCssClass(chosenActivity: CampingActivity | undefined, hasSkillCheck: boolean, isUser: boolean): CssClass {\n    const result = chosenActivity?.result;\n    if (!hasSkillCheck) {\n        return 'criticalSuccess';\n    } else if (result !== undefined && result !== null) {\n        if (isUser) {\n            return 'secret';\n        } else {\n            return result;\n        }\n    } else {\n        return null;\n    }\n}\n\nexport async function toViewActors(\n    actorUuids: string[],\n    activities: CampingActivity[],\n    activityData: CampingActivityData[],\n    isUser: boolean,\n): Promise<ViewCampingActor[]> {\n    const actorInfos = await Promise.all(actorUuids.map(uuid => toViewActor(uuid)));\n    return actorInfos\n        .filter(a => a !== null)\n        .map(actor => {\n            const chosenActivity = activities\n                .filter(a => a.activity !== 'Prepare Campsite')\n                .find(a => a.actorUuid === actor.uuid);\n            const hasSkillCheck = (activityData\n                .find(a => a.name === chosenActivity?.activity && chosenActivity.activity !== undefined)\n                ?.skills ?? []).length > 0;\n            const cssClass = getCssClass(chosenActivity, hasSkillCheck, isUser);\n            return {\n                ...actor,\n                noActivityChosen: !chosenActivity,\n                activity: chosenActivity?.activity ?? null,\n                cssClass,\n            };\n        });\n}\n\nexport async function toViewCampingActivities(\n    activities: CampingActivity[],\n    data: CampingActivityData[],\n    lockedActivities: Set<CampingActivityName>,\n): Promise<ViewCampingActivity[]> {\n    const prepareCampActivity = activities.find(a => a.activity === 'Prepare Campsite');\n    const prepareCampDegreeOfSuccess = prepareCampActivity?.result ?? null;\n    const canPerformActivities = prepareCampDegreeOfSuccess !== 'criticalFailure' && prepareCampDegreeOfSuccess !== null;\n    const result = (await Promise.all(\n        data.map(a => {\n                const isHidden = (lockedActivities.has(a.name) || !canPerformActivities) && a.name !== 'Prepare Campsite';\n                return toViewActivity(activities.find(d => d.activity === a.name), a, isHidden);\n            },\n        ),\n    ));\n\n    result.sort((a, b) =>\n        (a.name === 'Prepare Campsite' ? -1 : 0) - (b.name === 'Prepare Campsite' ? -1 : 0)\n        || a.name.localeCompare(b.name));\n    return result;\n}\n\ninterface ViewDegreeOfSuccess {\n    value: StringDegreeOfSuccess;\n    label: string;\n}\n\nexport function toViewDegrees(): ViewDegreeOfSuccess[] {\n    return [\n        {value: 'criticalSuccess', label: 'Critical Success'},\n        {value: 'success', label: 'Success'},\n        {value: 'failure', label: 'Failure'},\n        {value: 'criticalFailure', label: 'Critical Failure'},\n    ];\n}\n\nexport async function toViewActorMeals(actorUuids: string[], actorMeals: ActorMeal[], recipeData: RecipeData[]): Promise<ViewActorMeal[]> {\n    return await Promise.all(actorUuids.map(async uuid => {\n        const favoriteMeal = actorMeals.find(m => m.actorUuid === uuid)?.favoriteMeal ?? null;\n        const favoriteMealUuid = favoriteMeal ? recipeData.find(r => r.name === favoriteMeal)?.uuid ?? null : null;\n        return {\n            ...(await toViewActor(uuid)),\n            favoriteMeal,\n            favoriteMealUuid,\n            chosenMeal: actorMeals.find(m => m.actorUuid === uuid)?.chosenMeal ?? 'meal',\n        };\n    }));\n}\n\nexport async function combatEffectsToChat(data: Camping): Promise<void> {\n    const effects = await getCombatEffects(data);\n    if (Object.keys(effects).length > 0) {\n        const companionsAndLabels = Object.entries(effects)\n            .map(([name, link]) => `<b>${name} (${link.target})<b>: ${link.uuid}`)\n            .join('<br>');\n        await ChatMessage.create({content: companionsAndLabels});\n    }\n}\n","import {Proficiency} from '../camping/data';\nimport {\n    capitalize,\n    distinctBy,\n    isBlank,\n    LabelAndValue,\n    listenClick,\n    loreToLoreSkill,\n    slugifyable,\n    unslugify,\n} from '../utils';\nimport {allTrainedSkillRanks} from '../kingdom/data/skills';\n\n\ninterface Skill {\n    id: string;\n    proficiency?: Proficiency;\n}\n\nexport interface SaveSkillData {\n    selectedSkills: Skill[];\n    selectedLores: Skill[];\n    all: boolean;\n    allProficiency?: Proficiency;\n}\n\ninterface SkillDialogOptions {\n    availableSkills: string[];\n    selectedSkills?: Skill[];\n    selectedLores?: Skill[];\n    all?: boolean;\n    atLeastOne?: boolean;\n    allProficiency?: Proficiency;\n    onSave: (data: SaveSkillData) => void;\n}\n\ntype SkillsFormData = Record<string, unknown>\n\ninterface SelectableSkillView extends SkillView {\n    selected: boolean;\n}\n\nexport interface SkillView {\n    id: string;\n    label: string;\n    proficiency?: Proficiency;\n}\n\ninterface SkillsView {\n    showLores: boolean;\n    lores?: SkillView[];\n    skills: SelectableSkillView[];\n    proficiencies: LabelAndValue[];\n    all: boolean;\n    showAll: boolean;\n    allProficiency?: Proficiency;\n    errors: string[];\n}\n\nclass SkillDialog extends FormApplication<FormApplicationOptions & SkillDialogOptions, object, null> {\n    private onOk: (data: SaveSkillData) => void;\n    private skills: string[];\n    private selectedSkills: Skill[];\n    private selectedLores: Skill[];\n    private showLores: boolean;\n    private all: boolean;\n    private allProficiency?: Proficiency;\n    private showAll: boolean;\n    private atLeastOne: boolean;\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-skills-dialog';\n        options.title = 'Choose Skills';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/common/skills-dialog.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        options.width = 250;\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & SkillDialogOptions) {\n        super(object, options);\n        this.skills = options.availableSkills;\n        this.selectedSkills = options.selectedSkills ?? [];\n        this.selectedLores = options.selectedLores ?? [];\n        this.showLores = options.selectedLores !== undefined;\n        this.onOk = options.onSave;\n        this.all = options.all ?? false;\n        this.showAll = options.all !== undefined;\n        this.allProficiency = options.allProficiency;\n        this.atLeastOne = options.atLeastOne ?? false;\n    }\n\n    override getData(): Promise<SkillsView> | SkillsView {\n        return {\n            skills: this.skills.map(skill => {\n                const selected = this.selectedSkills.find(s => s.id === skill);\n                return {\n                    id: skill,\n                    label: unslugify(skill),\n                    selected: selected !== undefined,\n                    proficiency: selected?.proficiency,\n                };\n            }),\n            lores: [...this.selectedLores.map(lore => {\n                return {\n                    id: lore.id,\n                    label: unslugify(lore.id),\n                    proficiency: lore?.proficiency,\n                };\n            }), {id: '', label: ''}],\n            showLores: this.showLores,\n            proficiencies: allTrainedSkillRanks.map(r => {\n                return {\n                    label: capitalize(r),\n                    value: r,\n                };\n            }),\n            showAll: this.showAll,\n            all: this.all,\n            allProficiency: this.allProficiency,\n            errors: this.validate(),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: SkillsFormData): Promise<void> {\n        console.log(formData);\n        this.selectedSkills = this.skills\n            .filter(skill => formData[skill])\n            .map(skill => {\n                const proficiency = formData[`${skill}-proficiency`];\n                return {\n                    id: skill,\n                    proficiency: proficiency === '-' ? undefined : (proficiency as Proficiency),\n                };\n            });\n        const lores = Object.entries(formData)\n            .filter(([id, label]) => id.endsWith('-lore') && !isBlank(label as string) && slugifyable((label as string).trim()))\n            .map(([, label]) => {\n                const canonicalId = loreToLoreSkill(label as string);\n                const proficiency = formData[canonicalId + '-lore-proficiency'] as Proficiency | undefined;\n                return {\n                    id: canonicalId,\n                    proficiency,\n                };\n            });\n        this.selectedLores = distinctBy(lores, (l) => l.id);\n        this.all = formData['all'] as boolean;\n        this.allProficiency = formData['all-proficiency'] as Proficiency | undefined;\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.save', async (): Promise<void> => {\n            this.onOk({\n                selectedSkills: this.selectedSkills,\n                selectedLores: this.selectedLores,\n                all: this.all,\n                allProficiency: this.allProficiency,\n            });\n            await this.close();\n        });\n    }\n\n    private validate(): string[] {\n        const result = [];\n        if (this.atLeastOne && this.selectedSkills.length === 0 && this.selectedLores.length === 0 && !this.all) {\n            result.push('Must select at least one skill');\n        }\n        return result;\n    }\n}\n\n\nexport function skillDialog(options: SkillDialogOptions): void {\n    new SkillDialog(null, options).render(true);\n}","export enum DegreeOfSuccess {\n    CRITICAL_FAILURE,\n    FAILURE,\n    SUCCESS,\n    CRITICAL_SUCCESS\n}\n\n\nfunction adjustByDieNumber(dieNumber: number, degree: DegreeOfSuccess): DegreeOfSuccess {\n    if (dieNumber === 1) {\n        return Math.max(0, degree - 1);\n    } else if (dieNumber === 20) {\n        return Math.min(3, degree + 1);\n    } else {\n        return degree;\n    }\n}\n\nexport const allDegreesOfSuccesses = ['criticalSuccess', 'success', 'failure', 'criticalFailure'] as const;\nexport type StringDegreeOfSuccess = typeof allDegreesOfSuccesses[number];\n\nexport function degreeToProperty(degree: DegreeOfSuccess): StringDegreeOfSuccess {\n    if (degree === DegreeOfSuccess.CRITICAL_SUCCESS) {\n        return 'criticalSuccess';\n    } else if (degree === DegreeOfSuccess.SUCCESS) {\n        return 'success';\n    } else if (degree === DegreeOfSuccess.FAILURE) {\n        return 'failure';\n    } else {\n        return 'criticalFailure';\n    }\n}\n\nexport function determineDegreeOfSuccess(\n    dieNumber: number,\n    result: number,\n    dc: number,\n): DegreeOfSuccess {\n    if (result <= dc - 10) {\n        return adjustByDieNumber(dieNumber, DegreeOfSuccess.CRITICAL_FAILURE);\n    } else if (result >= dc + 10) {\n        return adjustByDieNumber(dieNumber, DegreeOfSuccess.CRITICAL_SUCCESS);\n    } else if (result >= dc) {\n        return adjustByDieNumber(dieNumber, DegreeOfSuccess.SUCCESS);\n    } else {\n        return adjustByDieNumber(dieNumber, DegreeOfSuccess.FAILURE);\n    }\n}\n","export async function openJournal(uuid: string): Promise<void> {\n    const journal = await fromUuid(uuid) as JournalEntry | JournalEntryPage | null;\n    if (journal instanceof JournalEntryPage) {\n        journal?.parent?.sheet?.render(true, {pageId: journal.id});\n    } else {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (journal as any).sheet.render(true);\n    }\n}","import {findRollTableUuidWithFallback, rollRollTable} from './roll-tables';\nimport {getStringSetting} from './settings';\n\nasync function rollEvent(game: Game, tableName: string): Promise<void> {\n    const rollTable = (await findRollTableUuidWithFallback(game, tableName, 'pf2e-kingmaker-tools.kingmaker-tools-rolltables'))!;\n\n    const rollMode = getStringSetting(game, 'kingdomEventRollMode') as unknown as keyof CONFIG.Dice.RollModes;\n    const rollOptions: Partial<RollTable.DrawOptions> = {rollMode};\n\n    await rollRollTable(game, rollTable, rollOptions);\n}\n\nexport async function rollKingdomEvent(game: Game): Promise<void> {\n    const tableName = getStringSetting(game, 'kingdomEventsTable').trim();\n    await rollEvent(game, tableName);\n}\n\nexport async function rollCultEvent(game: Game): Promise<void> {\n    const tableName = getStringSetting(game, 'kingdomCultTable').trim();\n    await rollEvent(game, tableName);\n}\n","import {getKingdom, saveKingdom} from './storage';\nimport {ActivityResults, getKingdomActivitiesById} from './data/activityData';\nimport {updateResources} from './resources';\nimport {gainFame} from './kingdom-utils';\nimport {parsePayButton, payStructure} from './dialogs/structure-browser';\n\ninterface KingdomChatButton {\n    selector: string;\n    callback: (game: Game, actor: Actor, ev: Event) => Promise<void>;\n}\n\nexport const kingdomChatButtons: KingdomChatButton[] = [\n    {\n        selector: '.km-pay-structure',\n        callback: async (game: Game, actor: Actor, event: Event): Promise<void> => {\n            event.preventDefault();\n            const target = event.currentTarget as HTMLButtonElement;\n            const costs = parsePayButton(target);\n            await payStructure(actor, costs);\n        },\n    },\n    {\n        selector: '.km-gain-fame-button',\n        callback: async (game: Game, actor: Actor, event: Event): Promise<void> => {\n            event.preventDefault();\n            const update = gainFame(getKingdom(actor), 1);\n            await saveKingdom(actor, update);\n        },\n    },\n    {\n        selector: '.km-gain-lose',\n        callback: async (game: Game, actor: Actor, event: Event): Promise<void> => {\n            event.preventDefault();\n            const target = event.currentTarget as HTMLButtonElement;\n            await updateResources(game, actor, target);\n        },\n    },\n    {\n        selector: '.km-apply-modifier-effect',\n        callback: async (game: Game, actor: Actor, event: Event): Promise<void> => {\n            event.preventDefault();\n            const target = event.currentTarget as HTMLButtonElement;\n            const activity = target.dataset.activity!;\n            const degree = target.dataset.degree! as keyof ActivityResults;\n            const index = parseInt(target.dataset.index ?? '0', 10);\n            const kingdom = getKingdom(actor);\n            const activityData = getKingdomActivitiesById(kingdom.homebrewActivities);\n            const modifier = activityData[activity]?.[degree]?.modifiers?.(kingdom)?.[index];\n            if (modifier !== undefined) {\n                // copy modifier because we alter the consumeId\n                const modifierCopy = {\n                    ...modifier,\n                };\n                if (modifierCopy.consumeId !== undefined) {\n                    modifierCopy.consumeId = crypto.randomUUID();\n                }\n                const modifiers = [...kingdom.modifiers, modifierCopy];\n                await saveKingdom(actor, {modifiers});\n            } else {\n                console.error(`Can not find modifier ${activity}.${degree}.modifiers.${index}`);\n            }\n        },\n    },\n];\n\n","export const allAbilities = [\n    'culture',\n    'economy',\n    'loyalty',\n    'stability',\n] as const;\n\nexport type Ability = typeof allAbilities[number];\n\nexport function calculateAbilityModifier(score: number): number {\n    return Math.floor((score - 10) / 2);\n}\n\nexport type AbilityScores = Record<Ability, number>;\n","import {Skill} from './skills';\nimport {Kingdom, SkillRanks} from './kingdom';\nimport {getKingdomActivitiesById, KingdomActivity, KingdomActivityById} from './activityData';\nimport {armyStatisticsByLevel} from '../../armies/data';\n\nexport const allKingdomPhases = [\n    'army',\n    'civic',\n    'commerce',\n    'event',\n    'leadership',\n    'region',\n    'upkeep',\n] as const;\n\nexport type KingdomPhase = typeof allKingdomPhases[number];\n\nexport function getActivitySkills(skills: Partial<SkillRanks>, skillRanks?: SkillRanks): Skill[] {\n    if (skillRanks) {\n        return (Object.entries(skills) as [Skill, number][])\n            .filter(([skill, rank]) => rank <= skillRanks[skill])\n            .map(([skill]) => skill);\n    } else {\n        return Object.keys(skills) as Skill[];\n    }\n}\n\ninterface GroupedActivityNames {\n    untrained: Set<string>;\n    trained: Set<string>;\n    expert: Set<string>;\n    master: Set<string>;\n    legendary: Set<string>;\n    oncePerRound: Set<string>;\n    leadership: Set<string>;\n    region: Set<string>;\n    event: Set<string>;\n    army: Set<string>;\n    commerce: Set<string>;\n    upkeep: Set<string>;\n    civic: Set<string>;\n    companion: Set<string>;\n}\n\nexport function groupKingdomActivities(activities: KingdomActivityById): GroupedActivityNames {\n    const result: GroupedActivityNames = {\n        untrained: new Set(),\n        trained: new Set(),\n        expert: new Set(),\n        master: new Set(),\n        legendary: new Set(),\n        oncePerRound: new Set(),\n        leadership: new Set(),\n        region: new Set(),\n        event: new Set(),\n        army: new Set(),\n        commerce: new Set(),\n        upkeep: new Set(),\n        civic: new Set(),\n        companion: new Set(),\n    };\n    (Object.entries(activities) as [string, KingdomActivity][])\n        .forEach(([activity, data]) => {\n            result[data.phase].add(activity);\n            if (data.oncePerRound) result.oncePerRound.add(activity);\n            if (data.companion) result.companion.add(activity);\n            if (Object.values(data.skills).every(rank => rank === 0)) {\n                result.untrained.add(activity);\n            } else if (Object.values(data.skills).every(rank => rank === 1)) {\n                result.trained.add(activity);\n            } else if (Object.values(data.skills).every(rank => rank === 2)) {\n                result.expert.add(activity);\n            } else if (Object.values(data.skills).every(rank => rank === 3)) {\n                result.master.add(activity);\n            } else if (Object.values(data.skills).every(rank => rank === 4)) {\n                result.legendary.add(activity);\n                return result;\n            }\n        });\n    return result;\n}\n\nexport function enableCompanionActivities(type: KingdomPhase, unlockedCompanionActivities: Set<string>, names: GroupedActivityNames): string[] {\n    return Array.from(names[type])\n        .filter(activity => {\n            if (names.companion.has(activity)) {\n                return unlockedCompanionActivities.has(activity);\n            } else {\n                return true;\n            }\n        });\n}\n\nexport function createActivityLabel(groupedActivities: GroupedActivityNames, activity: string, kingdom: Kingdom): string {\n    const kingdomLevel = kingdom.level;\n    const data = getKingdomActivitiesById(kingdom.homebrewActivities)[activity];\n    const label = data.title;\n    const hints = [];\n    if (activity === 'claim-hex') {\n        if (kingdomLevel >= 9) {\n            hints.push('three times per turn');\n        } else if (kingdomLevel >= 4) {\n            hints.push('twice per turn');\n        } else {\n            hints.push('once per turn');\n        }\n    } else if (activity === 'train-army') {\n        const maxTactics = armyStatisticsByLevel.get(kingdom.level)?.maximumTactics ?? 6;\n        hints.push(`Max ${maxTactics} per Army`);\n    }\n    if (groupedActivities.trained.has(activity)) {\n        hints.push('trained');\n    } else if (groupedActivities.expert.has(activity)) {\n        hints.push('expert');\n    } else if (groupedActivities.master.has(activity)) {\n        hints.push('master');\n    }\n    if (groupedActivities.oncePerRound.has(activity)) {\n        hints.push('once per turn');\n    }\n    if (data.hint) {\n        hints.push(data.hint);\n    }\n    const append = hints.length > 0 ? ` (${hints.join(', ')})` : '';\n    return label + append;\n}\n\n\nexport function getPerformableActivities(\n    ranks: SkillRanks,\n    enableCapitalInvestment: boolean,\n    ignoreSkillRequirements: boolean,\n    activities: KingdomActivityById,\n): Record<string, boolean> {\n    return Object.fromEntries(Object.values(activities).map(activity => {\n        const activityRanks = activity.skills;\n        const noBuildingPreventsActivity = activity.id !== 'capital-investment' || enableCapitalInvestment;\n        const enabled = ignoreSkillRequirements || (Object.entries(activityRanks) as [Skill, number][])\n            .some(([skill, rank]) => ranks[skill] >= rank) && noBuildingPreventsActivity;\n        return [activity.id, enabled];\n    })) as Record<string, boolean>;\n}\n","import {KingdomPhase} from './activities';\nimport {allSkills, Skill} from './skills';\nimport {Companion} from './companions';\nimport {Modifier} from '../modifiers';\nimport {Commodities, hasFeat, Kingdom} from './kingdom';\nimport {Ruin} from './ruin';\nimport {unslugify} from '../../utils';\nimport {ResourceMode, ResourceTurn, RolledResources} from '../resources';\n\nexport type SkillRanks = Partial<Record<Skill, number>>;\n\nfunction simpleRank(skills: Skill[], rank = 0): SkillRanks {\n    return skills\n        .map(skill => {\n            return {[skill]: rank};\n        })\n        .reduce((a, b) => Object.assign(a, b), {});\n}\n\nexport interface ActivityResult {\n    msg: string;\n    modifiers?: (kingdom: Kingdom) => Modifier[];\n}\n\nexport interface ActivityResults {\n    criticalSuccess?: ActivityResult;\n    success?: ActivityResult;\n    failure?: ActivityResult;\n    criticalFailure?: ActivityResult;\n}\n\nexport interface ActivityContent extends ActivityResults {\n    title: string;\n    description: string;\n    requirement?: string;\n    special?: string;\n    skills: SkillRanks;\n    phase: KingdomPhase;\n    dc: 'control' | 'custom' | 'none' | number;\n    dcAdjustment?: number;\n    enabled: boolean;\n    companion?: Companion;\n    fortune: boolean;\n    oncePerRound: boolean;\n    hint?: string;\n}\n\nexport interface KingdomActivity extends ActivityContent {\n    id: string;\n}\n\nexport type KingdomActivityById = Record<string, KingdomActivity>;\n\nconst activityData: Record<string, ActivityContent> = {\n    'abandon-hex': {\n        title: 'Abandon Hex',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: 'After careful consideration, you decide that you would rather not hold onto a particular hex as part of your claimed territory. You renounce your claim to it and pull back any settlers or explorers. Attempt a basic Exploration or Wilderness check. You can abandon more than one hex at a time, but each additional hex you abandon increases the DC of this check by 1.',\n        requirement: 'The hex to be abandoned must be controlled.',\n        skills: simpleRank(['exploration', 'wilderness']),\n        criticalSuccess: {\n            msg: `You abandon the hex or hexes, decreasing your kingdom's Size by 1 per hex abandoned (this affects all statistics determined by Size; see page 532). Settlers and explorers return and resettle elsewhere in your kingdom, bringing with them bits of salvage from the abandoned hexes. ${gainRP(1)} per abandoned hex.`,\n        },\n        success: {\n            msg: `You abandon the hex or hexes, decreasing your kingdom's Size by 1 per hex abandoned (this affects all statistics determined by Size; see page 532). Settlers and explorers return and resettle elsewhere in your kingdom, bringing with them bits of salvage from the abandoned hexes. ${gainUnrest(1)}`,\n        },\n        failure: {\n            msg: `You abandon the hex or hexes, decreasing your kingdom's Size by 1 per hex abandoned (this affects all statistics determined by Size; see page 532). Some citizens become disgruntled refugees who refuse to leave the hex. ${gainUnrest(2)} and then attempt a @Check[type:flat|dc:6]. If you fail, the refugees become bandits, and during your next Event phase, your kingdom experiences a Squatters kingdom event automatically in addition to any other event that might occur.`,\n        },\n        criticalFailure: {\n            msg: `You abandon the hex or hexes, decreasing your kingdom's Size by 1 per hex abandoned (this affects all statistics determined by Size; see page 532). Some citizens become disgruntled refugees who refuse to leave the hex. ${gainUnrest(3)} and automatically experience a Bandit Activity kingdom event.`,\n        },\n        special: 'The Unrest gained from abandoning a hex doubles if it includes a settlement. A settlement in an abandoned hex becomes a Freehold (page 536).',\n    },\n    'build-roads': {\n        title: 'Build Roads',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: `<p>You order your kingdoms engineers to construct a network of robust roads through the hex. Travel along roads uses a terrain type one step better than the surrounding terrain; for example, roads through forest hexesnormally difficult terrainallow travel as if it were open terrain.</p>\n<p>Spend RP as determined by the hexs most inhospitable terrain (if the hex includes any rivers that cross the hex from one hex side to any other, you must spend double the normal RP cost to also build bridges; this adds the Bridge structure to that hex):</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check. Work with the GM to determine where your roads appear on the map.</p>`,\n        requirement: 'The hex in which you seek to build roads must be claimed by your kingdom.',\n        skills: simpleRank(['engineering']),\n        criticalSuccess: {\n            msg: 'You build roads into the target hex and, if possible, one adjacent claimed hex that doesnt yet have roads and whose terrain features are at least as hospitable as those of the target hex',\n        },\n        success: {\n            msg: 'You build roads in the hex.',\n        },\n        failure: {\n            msg: 'You fail to build roads in the hex.',\n        },\n        criticalFailure: {\n            msg: 'Your attempt to build roads ends in disaster. Not only do you fail to build roads, but you lose several workers to an accident, banditry, a vicious monster, or some other unforeseen occurrence. ' + gainUnrest(1),\n        },\n    },\n    'build-structure': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'civic',\n        dc: 'custom',\n        title: 'Build Structure',\n        description: `You attempt to build a structure in the settlement thats granting the Civic activity. You may choose any structure for which you meet the requirements. Select the appropriate number of contiguous buildable lots in a single block as specified by the structures entry and spend the specified RP and Commodity cost. Then attempt the structures skill check.\n\nYou can also use this activity to attempt to repair a structure that was damaged as the result of an event but hasnt been replaced by Rubble. To do this, first spend half the structures listed RP and Commodity cost, and then attempt the specified check. The existing structure gives you a +2 item bonus to the check.\n\nOn a success, record the new construction on the Urban Grid. Unless the structures entry states otherwise, its effects are immediate; if the structure adjusts a Ruins point total, adjust it upon construction.\n`,\n        skills: simpleRank([...allSkills]),\n        criticalSuccess: {\n            msg: 'You construct or repair the structure with great efficiency and get back half of the Commodities spent in construction or repair.',\n        },\n        success: {\n            msg: 'You construct or repair the structure.',\n        },\n        failure: {\n            msg: 'You fail to construct or repair the structure. You can try to complete it next Kingdom turn; if you do so, you do not need to re-pay the RP and Commodity cost.',\n        },\n        criticalFailure: {\n            msg: 'You fail to construct the structure; if you were attempting to repair a damaged structure, it is reduced to Rubble. In either event, Rubble now fills the structures lots, which must be cleared with the Demolish activity before you can attempt to Build a Structure in them again.',\n        },\n    },\n    'capital-investment': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Capital Investment',\n        description: `You contribute funds from your personal wealth for the good of the kingdom, including coinage, gems, jewelry, weapons and armor salvaged from enemies, magical or alchemical items, and so on. Your contribution generates economic activity in the form of RP that can be used during your current Kingdom turn or on the next Kingdom turn (your choice).\n\nYou can use Capital Investment to repay funds from Tap Treasury (page 528). In this case, no roll is needed and you simply deduct the appropriate amount of funds from your personal wealth to pay back that which was borrowed. When you use Capital Investment to generate RP, the amount of gp required to make an investment is set by your kingdoms level. Investments below this amount cause your attempt at Capital Investment to suffer an automatic critical failure, while investments above this amount are lost. The investment required is equal to the value listed on Table 109: Party Treasure by Level @UUID[Compendium.pf2e.journals.S55aqwWIzpQRFhcq.JournalEntryPage.Ly8l2GT6dbvuY3A2]{Treasure}; use the value for your kingdoms level under the Currency per Additional PC as the required investment value. This is a basic check.`,\n        requirement: 'You must be within the influence of a settlement that contains at least one Bank.',\n        skills: simpleRank(['trade']),\n        criticalSuccess: {\n            msg: `Success Your kingdom reaps the benefits of your investment. ${gainRolledRD(4)}`,\n        },\n        success: {\n            msg: `Your investment helps the economy. ${gainRolledRD(2)}`,\n        },\n        failure: {\n            msg: `Your investment ends up being used to shore up shortfalls elsewhere. ${gainRP('1d4')}`,\n        },\n        criticalFailure: {\n            // TODO: increase crime by an equal amount\n            msg: `Your investment is embezzled, lost, or otherwise misappropriated. Choose one of the following: either ${gainRolledRD(1)} and also increase your Crime by an equal amount, or gain 0 RP and ${gainRuin('crime', 1)}`,\n        },\n    },\n    'celebrate-holiday': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Celebrate Holiday',\n        description: 'You declare a day of celebration. Holidays may be religious, historical, martial, or simply festive, but all relieve your citizens from their labors and give them a chance to make merry at the kingdoms expense. Attempt a basic check, but if your kingdom Celebrated a Holiday the previous turn, the DC increases by 4, as your kingdom hasnt had a chance to recover from the previous gala.',\n        skills: simpleRank(['folklore']),\n        criticalSuccess: {\n            msg: 'Your holidays are a delight to your people. The event is expensive, but incidental income from the celebrants covers the cost. You gain a +2 circumstance bonus to Loyalty-based checks until the end of your next Kingdom turn.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                abilities: ['loyalty'],\n                value: 2,\n                name: 'Celebrate Holiday: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: `Your holidays are a success, but theyre also expensive. You gain a +1 circumstance bonus to Loyalty-based checks until the end of your next Kingdom turn. ${loseRolledRD(1)}. If you cant afford this cost, treat this result as a Critical Failure instead.`,\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                abilities: ['loyalty'],\n                value: 1,\n                name: 'Celebrate Holiday: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: `The holiday passes with little enthusiasm, but is still expensive. ${loseRolledRD(1)}. If you cant afford this cost, treat this result as a Critical Failure instead.`,\n        },\n        criticalFailure: {\n            msg: `Your festival days are poorly organized, and the citizens actively mock your failed attempt to celebrate. ${createResourceButton({\n                turn: 'next',\n                value: '4',\n                mode: 'lose',\n                type: 'resource-dice',\n            })}. The failure also causes you to take a 1 circumstance penalty to Loyalty-based checks until the end of the next Kingdom turn.`,\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                abilities: ['loyalty'],\n                value: -1,\n                name: 'Celebrate Holiday: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'claim-hex': {\n        title: 'Claim Hex',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        requirement: 'You have Reconnoitered the hex to be claimed during hexploration. This hex must be adjacent to at least one hex thats already part of your kingdom. If the hex to be claimed contains dangerous hazards or monsters, they must first be cleared outeither via standard adventuring or the Clear Hex activity.',\n        description: `Your surveyors fully explore the hex and attempt to add it into your kingdoms domain. ${loseRP(1)} and then attempt a basic Exploration, Intrigue, Magic, or Wilderness check.`,\n        skills: simpleRank(['exploration', 'intrigue', 'magic', 'wilderness']),\n        criticalSuccess: {\n            msg: 'You claim the hex and immediately add it to your territory, increasing your kingdom\\'s Size by 1 (this affects all statistics determined by Size; see page 532). Your occupation of the hex goes so smoothly that you can immediately attempt another Region activity.',\n        },\n        success: {\n            msg: 'You claim the hex and add it to your territory, increasing your kingdom\\'s Size by 1 (this affects all statistics determined by Size; see page 532).',\n        },\n        failure: {\n            msg: 'You fail to claim the hex.',\n        },\n        criticalFailure: {\n            msg: 'You fail to claim the hex, and a number of early settlers and explorers are lost, causing you to take a 1 circumstance penalty to Stability-based checks until the end of your next Kingdom turn.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                abilities: ['stability'],\n                value: -1,\n                name: 'Claim Hex: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n        special: 'At 1st level, when selecting the three activities you take during the Region Activities step of the Activity phase of the Kingdom turn, you may select this activity no more than once. Once your kingdom reaches 4th level, you may select it up to twice per turn, and after reaching 9th level you may select it up to three times per turn. When you successfully claim a hex, gain kingdom XP (see page 540). Many hexes have terrain features that grant benefits to your kingdom when claimed; see Terrain Features on page 535.',\n    },\n    'clandestine-business': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Clandestine Business',\n        description: 'You know there are criminals in your kingdom, and they know you know. You encourage them to send kickbacks in the form of resources and Commodities to the government, but the common citizens will be more than upset if they find out! This starts as a basic check against your Control DC, but every subsequent Kingdom turn you pursue Clandestine Business, the DC increases by 2. Every Kingdom turn that passes without Clandestine Business reduces the DC by 1 (until you reach your Control DC).',\n        skills: simpleRank(['intrigue'], 1),\n        criticalSuccess: {\n            msg: `${gainRolledRD(2)}. In addition, you ${gainCommodities('luxuries', '1d4')}. The public is none the wiser.`,\n        },\n        success: {\n            msg: `Either ${gainRolledRD(2)}, or gain ${gainCommodities('luxuries', '1d4')}. Regardless of your choice, rumors spread about where the government is getting these gifts. ${gainUnrest(1)}.`,\n        },\n        failure: {\n            msg: `${gainRolledRD(1)}. Rumors are backed up with eyewitness accounts. ${gainUnrest(1)} and ${gainRuin('corruption', 1)}.`,\n        },\n        criticalFailure: {\n            msg: `You gain nothing from the Clandestine Business but angry citizens. ${gainUnrest('1d6')}, ${gainRuin('corruption', 2)}, and one other Ruin of your choice by 1.`,\n        },\n    },\n    'clear-hex': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        title: 'Clear Hex',\n        phase: 'region',\n        dc: 'custom',\n        description: `<p>Engineers and mercenaries attempt to prepare a hex to serve as the site for a settlement, or they work to remove an existing improvement, a dangerous hazard, or an encounter.</p>\n<p>If youre trying to prepare a hex for a settlement or demolish an improvement you previously built (or that was already present in the hex), spend RP as determined by the hexs most inhospitable terrain feature:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic Engineering check. If youre trying to remove a hazard or encounter, instead attempt an Exploration check. The DC of this check is set by the highest level creature or hazard in the hex (as set by Table 105: DCs by Level, on page 503 of the Pathfinder Core Rulebook).</p>\n\n<p>If the hex youre attempting to Clear has existing Ruins or an existing Structure, your action doesnt physically remove the buildings from the area and you can later incorporate these buildings (or repair ruined ones) into a Settlement you build here later (see page 542). Regardless of the skill used, increase the basic DC by 2 if the hex to be cleared is not yet part of your kingdom.</p>`,\n        skills: simpleRank(['engineering', 'exploration']),\n        criticalSuccess: {\n            msg: `You successfully clear the hex. If you spent RP to attempt this activity, youre refunded half of the RP cost. If you were removing dangerous creatures (but not hazards) from the hex, your explorers and mercenaries recover 2 Luxury Commodities as treasure. ${gainCommodities('luxuries', 2)}`,\n        },\n        success: {\n            msg: 'You successfully clear the hex.',\n        },\n        failure: {\n            msg: 'You fail to clear the hex.',\n        },\n        criticalFailure: {\n            msg: `You catastrophically fail to clear the hex and several workers lose their lives. ${gainUnrest(1)}`,\n        },\n    },\n    'collect-taxes': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'commerce',\n        dc: 'control',\n        title: 'Collect Taxes',\n        description: 'Tax collectors travel through the lands to collect funds for the betterment of the kingdom. Attempt a basic check.',\n        skills: simpleRank(['trade'], 1),\n        criticalSuccess: {\n            msg: 'Your tax collectors are wildly successful! For the remainder of the Kingdom turn, gain a +2 circumstance bonus to Economy-based checks.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['economy'],\n                value: 2,\n                name: 'Collect Taxes: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: `Your tax collectors gather enough to grant you a +1 circumstance bonus to Economy-based checks for the remainder of the Kingdom turn. If you attempted to Collect Taxes during the previous turn, ${gainUnrest(1)}`,\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['economy'],\n                value: 1,\n                name: 'Collect Taxes: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: `Your tax collectors gather enough to grant you a +1 circumstance bonus to Economy-based checks for the remainder of the Kingdom turn. In addition, people are unhappy about taxes${gainUnrest(1)} (or ${gainUnrest(2)} if you attempted to Collect Taxes the previous turn).`,\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['economy'],\n                value: 1,\n                name: 'Collect Taxes: Failure',\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            msg: `Your tax collectors encounter resistance from the citizens and their attempts to gather taxes are rebuffed. While the tax collectors still manage to gather enough taxes to support essential government, they have angered the kingdom's citizens and encouraged rebellious acts. ${gainUnrest(2)}, and choose one Ruin to increase by 1.`,\n        },\n    },\n    'craft-luxuries': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Craft Luxuries',\n        description: `You encourage your artisans to craft luxury goods and may even aid them in this pursuit. ${loseRolledRD(1)}. Then attempt a basic check.`,\n        skills: simpleRank(['arts']),\n        criticalSuccess: {\n            msg: `Your artisans exceed expectations and craft extravagant goods. ${gainCommodities('luxuries', '1d4')}`,\n        },\n        success: {\n            msg: `Your artisans produce some delightful goods. ${gainCommodities('luxuries', 1)}`,\n        },\n        failure: {\n            msg: 'Your artisans fail to produce anything noteworthy.',\n        },\n        criticalFailure: {\n            // TODO: increase ruins by 1\n            msg: 'Your artisans not only fail to produce anything noteworthy, but some took advantage of the opportunity to push their own agendas or earn more for themselves by selling to underground markets. Increase one of your Ruins by 1.',\n        },\n    },\n    'create-a-masterpiece': {\n        oncePerRound: true,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Create a Masterpiece',\n        description: 'You encourage your kingdoms artists to create and display a masterful work of art to bolster your kingdoms reputation. Attempt a basic check; the result affects either Fame or Infamy (depending on the type of kingdom youre running). Create a Masterpiece may be attempted only once per Kingdom turn regardless of the number of leaders pursuing activities.',\n        skills: simpleRank(['arts'], 1),\n        criticalSuccess: {\n            msg: `${gainFame(1)}, and ${createResourceButton({\n                turn: 'next',\n                type: 'fame',\n                value: '1',\n            })}. ${gainRolledRD(2)}`,\n        },\n        success: {\n            msg: gainFame(1),\n        },\n        failure: {\n            msg: 'Your attempt to create a masterpiece fails.',\n        },\n        criticalFailure: {\n            msg: `Not only does your attempt to create a masterpiece fail, it does so in a dramatic and humiliating way. ${loseFame(1)}; if you have no Fame or Infamy points to lose, instead ${gainUnrest('1d4')}`,\n        },\n    },\n    'creative-solution': {\n        enabled: true,\n        oncePerRound: false,\n        fortune: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Creative Solution',\n        description: 'You work with your kingdoms scholars, thinkers, and practitioners of magical and mundane experimentation to come up with new ways to resolve issues when business as usual is just not working. Attempt a basic check.',\n        skills: simpleRank(['scholarship']),\n        criticalSuccess: {\n            msg: `You can call upon the solution to aid in resolving any Kingdom skill check made during the remainder of this Kingdom turn ${gainSolution('creative-solution')}. Do so when a Kingdom skill check is rolled, but before you learn the result. Immediately reroll that check with a +2 circumstance bonus; you must take the new result. If you dont use your Creative Solution by the end of this turn, you lose this benefit and gain 10XP instead.`,\n            modifiers: () => [{\n                turns: 1,\n                enabled: false,\n                value: 2,\n                name: 'Creative Solution: Critical Success',\n                type: 'circumstance',\n                consumeId: '',\n            }],\n        },\n        success: {\n            msg: `You can call upon the solution to aid in resolving any Kingdom skill check made during the remainder of this Kingdom turn ${gainSolution('creative-solution')}. Do so when a Kingdom skill check is rolled, but before you learn the result. Immediately reroll that check with a +2 circumstance bonus; you must take the new result. If you dont use your Creative Solution by the end of this turn, you lose this benefit and gain 10XP instead. In addition, ${loseRP('1d4')} to research the solution. This cost is paid now, whether or not you use your Creative Solution.`,\n            modifiers: () => [{\n                turns: 1,\n                enabled: false,\n                value: 2,\n                name: 'Creative Solution: Success',\n                type: 'circumstance',\n                consumeId: '',\n            }],\n        },\n        failure: {\n            msg: `Your attempt at researching is a failure and you ${loseRP('2d6')}. It provides no advantage.`,\n        },\n        criticalFailure: {\n            msg: `Your attempt at researching is a failure and you ${loseRP('2d6')}. It provides no advantage. In addition, your scholars and thinkers are so frustrated that you take a 1 circumstance penalty to Culture-based checks until the end of the next Kingdom turn.`,\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                value: -1,\n                name: 'Creative Solution: Critical Failure',\n                type: 'circumstance',\n                abilities: ['culture'],\n            }],\n        },\n        special: 'You cannot influence a check with Supernatural Solution and Creative Solution simultaneously.',\n    },\n    'decadent-feasts': {\n        companion: 'Jaethal',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Decadent Feasts',\n        description: `Urgathoa is more than just the goddess of undeath shes also the goddess of gluttony. And Jaethal is no fool; she understands the fear her goddess inspires in the living and knows that focusing on other aspects of her worship are more likely to result in positive growth for the nation. In order to distract the populace, she arranges for decadent feasts for the people, simultaneously feeding the hungry while camouflaging some of her faiths more sinister aspects. ${loseCommodities('food', '1d8')} and ${loseCommodities('luxuries', 1)}, then attempt a basic Agriculture or Trade check to determine how effective the feasts are.`,\n        skills: simpleRank(['agriculture']),\n        criticalSuccess: {\n            msg: `The people rejoice and glut themselves on the repast! ${loseUnrest('1d6')}, and the next time this Kingdom turn you suffer an effect that increases Unrest, do not increase your Unrest.`,\n        },\n        success: {\n            msg: `The people enjoy the meal, but no longer than it takes to gulp it down. ${loseUnrest('1d3')}`,\n        },\n        failure: {\n            msg: `The meal is appreciated, but the people remain suspicious. ${loseUnrest(1)}.`,\n        },\n        criticalFailure: {\n            msg: `The people are too suspicious of the feast to enjoy it. Worse, rumors that Jaethal is trying to distract the citizens from an evil ritual spread. ${gainUnrest('1d4')} and ${gainRuin('corruption', 1)}`,\n        },\n    },\n    'deliberate-planning': {\n        companion: 'Kalikke',\n        oncePerRound: false,\n        fortune: true,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Deliberate Planning',\n        description: 'Kalikke takes time and weighs all options when faced with decisions, regardless of their importance. While this can sometimes lead her to taking too long to make choices, her theoretical analysis can be quite helpful in navigating continuous events. Choose a single continuous event that will affect your kingdom on this turns Event Phase, then attempt a Scholarship check against that events DC.',\n        skills: simpleRank([...allSkills]),\n        criticalSuccess: {\n            msg: 'Kalikkes aid has been monumentally helpful. When you roll to resolve the continuous event you chose, you can roll twice and choose which result to apply. You gain a +1 circumstance bonus to each roll. This is a Fortune effect.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: false,\n                value: 1,\n                name: 'Deliberate Planning: Critical Success',\n                type: 'circumstance',\n                phases: ['event'],\n            }],\n        },\n        success: {\n            msg: 'Kalikkes suggestions are useful, granting you a +1 circumstance bonus to rolls to resolve the chosen continuous event.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: false,\n                value: 1,\n                name: 'Deliberate Planning: Success',\n                type: 'circumstance',\n                phases: ['event'],\n            }],\n        },\n        failure: {\n            msg: 'Kalikkes advice isnt helpful, but neither does it hinder your ability to handle the event.',\n        },\n        criticalFailure: {\n            msg: 'You got too caught up in Kalikkes theoretical analysis and spent too much time preparing. When you roll to resolve the continuous event you tried to plan for, roll twice and take the worse result.',\n        },\n    },\n    'demolish': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'civic',\n        dc: 'control',\n        title: 'Demolish',\n        description: 'Choose a single occupied lot in one of your settlements and attempt a basic check to reduce it to Rubble and then clear the Rubble away to make ready for a new structure. For multiple-lot structures, youll need to perform multiple Demolish activities (or critically succeed at the activity) to fully clear all of the lots. As soon as you begin Demolishing a multiple-lot structure, all of the lots occupied by that structure no longer function.',\n        skills: simpleRank(['engineering']),\n        criticalSuccess: {\n            msg: 'Choose one of the following effects: you demolish an entire multiple-lot structure all at once and clear all of the lots it occupied, or you recover [[/r 1d6#Commodities]] Commodities (chosen from lumber, stone, and ore) from the Rubble of a single-lot demolition.',\n        },\n        success: {\n            msg: 'You demolish the lot successfully.',\n        },\n        failure: {\n            msg: 'You fail to demolish the lot. It remains in Rubble and cannot be used for further construction until you successfully Demolish it.',\n        },\n        criticalFailure: {\n            msg: `You fail to demolish the lot. It remains in Rubble and cannot be used for further construction until you successfully Demolish it. In addition, accidents during the demolition cost you the lives of some of your workers. ${gainUnrest(1)}`,\n        },\n    },\n    'deploy-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'control',\n        title: 'Deploy Army',\n        description: `The army moves through your kingdom or beyond. Since this travel occurs over the course of the entire month that preceded the Kingdom turn, the ground an army covers when it deploys can be quite extensive. You can Deploy an Army with an Exploration, Boating, or Magic check.\n\nWhen you use an Exploration check, choose a location within 20 hexes of the armys current hex. If the armys starting point and ending point are connected by a road, increase the result one degree of success. Count roadless hexes that contain swamps or mountains, or each hex where you must cross a river or lake without the aid of a bridge, as two hexes. You can issue orders to force march. Doing so grants a +4 circumstance bonus on the check, but causes the army to increase its weary condition by 1 (or by 2, if you fail the check).\n\nWhen you use a Boating check, the armys starting point and ending point must be connected by a body of water; choose any location within 20 hexes along this route.\n\nYou must be at least master in Magic to attempt a Magic check. When you do so, choose any location within 30 hexes of the armys current hex, then roll your check. If the armys deployment causes it to cross your kingdoms border, the DC increases by 5. If the armys deployment causes it to cross an enemy kingdoms border, the DC instead increases by 10.`,\n        skills: {\n            warfare: 0,\n            boating: 0,\n            magic: 3,\n        },\n        criticalSuccess: {\n            msg: 'The army arrives much more quickly than you anticipated; it arrives at its destination and then becomes efficient.',\n        },\n        success: {\n            msg: 'The army arrives at its destination. ',\n        },\n        failure: {\n            msg: 'The army arrives at its destination, but ran into some sort of trouble along the way. Increase the armys weary condition by 1 and attempt a @Check[type:flat|dc:6]; on a failure, reduce the armys HP by 1.',\n        },\n        criticalFailure: {\n            msg: `Rather than arriving at its destination, the army becomes lost until it recovers from this condition. ${gainUnrest('1d4')}, and attempt a @Check[type:flat|dc:11]; on a failure, reduce the armys HP by 1.`,\n        },\n    },\n    'disband-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'none',\n        title: 'Disband Army',\n        description: 'You can choose to disband an army with no check needed. If the army consisted of conscripts from your kingdom, the soldiers revert to being citizens. If the army was recruited from creatures encountered in the wilds, they return to their homes. A disbanded army no longer contributes to your kingdoms Consumption.',\n        skills: simpleRank([...allSkills]),\n    },\n    'establish-farmland': {\n        title: 'Establish Farmland',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: `You plant crops and establish livestock in permanent farms, ranches, and other growing operations to create Farmland (page 535). If youre attempting to Establish Farmland in a hex that is predominantly plains, you must ${loseRP(1)} and the check is against your Control DC. If youre targeting a hex that is predominantly hills, you must spend ${loseRP(2)} and the check is against your Control DC + 5.`,\n        requirement: 'Plains or hills are the predominant terrain feature in the hex; the hex is in the influence of one of your settlements.',\n        skills: simpleRank(['agriculture']),\n        criticalSuccess: {\n            msg: 'You establish two adjacent Farmland hexes instead of one. If your target hex was a hills hex, the additional hex may be a hills hex or a plains hex; otherwise, the additional hex must be a plains hex. If no appropriate hex is available, treat this result as a regular success instead.',\n        },\n        success: {\n            msg: 'You establish one Farmland hex.',\n        },\n        failure: {\n            msg: 'You fail to establish a Farmland hex.',\n        },\n        criticalFailure: {\n            msg: 'You fail to establish a Farmland hex, and your attempt potentially causes the spread of a blight. At the start of each of the next two Event phases, attempt a @Check[type:flat|dc:6|showDC:all]; on a failure, your kingdom experiences a Crop Failure event in this and all adjacent hexes.',\n        },\n    },\n    'establish-settlement': {\n        title: 'Establish Settlement',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: 'You draw up plans, gather resources, entice citizens, and establish boundaries to found a brand new settlement in the hex. Attempt a basic Engineering, Industry, Politics, or Scholarship check. If you cannot pay the RP required by the result of this check, treat your result as a critical failure. A settlement always starts as a village. See page 540 for further details about building settlements.',\n        requirement: 'The hex in which youre establishing the settlement has been Cleared and doesnt currently have a settlement (including a Freehold) in it.',\n        skills: simpleRank(['engineering', 'industry', 'politics', 'scholarship']),\n        criticalSuccess: {\n            msg: `You establish the settlement largely with the aid of enthusiastic volunteers. ${loseRP('1d6')}`,\n        },\n        success: {\n            msg: `You establish the settlement. ${loseRP('3d6')}`,\n        },\n        failure: {\n            msg: `You establish the settlement, but inefficiently and at great expense. ${loseRP('6d6')}`,\n        },\n        criticalFailure: {\n            msg: 'You fail to establish the settlement.',\n        },\n    },\n    'establish-trade-agreement': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Establish Trade Agreement',\n        description: `You send a band of merchants out to establish a trade agreement between your kingdom and a group with whom youve established diplomatic relations. If a navigable river connects your kingdom with the other groups territory, you can attempt a Boating check to Establish the Trade Agreement. If your kingdoms proficiency rank in Magic is Master or higher, you can attempt a Magic check. Otherwise, attempt a Trade check.\n\nThe checks DC is either the groups Negotiation DC (see sidebar) or your kingdoms Control DC, whichever is higher.`,\n        requirement: 'You have diplomatic relations with the group you wish to establish an agreement with.',\n        skills: {\n            boating: 0,\n            trade: 0,\n            magic: 3,\n        },\n        criticalSuccess: {\n            msg: `You successfully establish a trade agreement with your target, and your merchants return with gifts! ${gainRolledRD(2)}`,\n        },\n        success: {\n            msg: 'You successfully establish a trade agreement.',\n        },\n        failure: {\n            msg: `Your traders reach their destination but need to sweeten the deal to secure the trade agreement. ${loseRolledRD(2)}. If you do so, you successfully establish a trade agreement, otherwise the attempt fails.`,\n        },\n        criticalFailure: {\n            msg: `Your trade agreement is a total loss and your traders do not return. ${gainUnrest(1)}, and until the end of the next Kingdom turn, take a 1 circumstance penalty to all Economy-related checks.`,\n            modifiers: () => [{\n                turns: 2,\n                enabled: false,\n                value: -1,\n                name: 'Establish Trade Agreement: Critical Failure',\n                type: 'circumstance',\n                abilities: ['economy'],\n            }],\n        },\n    },\n    'establish-work-site-lumber': {\n        title: 'Establish Work Site Lumber',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: `<p>Your hire a crew of workers to travel to a hex that contains Lumber, Ore, or Stone to be harvested. Spend RP as determined by the hexs most inhospitable terrain:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check. Lumber camps can be established in any hex that contains a significant amount of forest terrain. Mines and quarries can be established in any hex that contains a significant amount of hill or mountain terrain.</p>`,\n        skills: simpleRank(['engineering']),\n        criticalSuccess: {\n            msg: 'You establish a Work Site in the hex and proceed to discover an unexpectedly rich supply of high quality Commodities. All Commodity yields granted by this site are doubled until the end of the next Kingdom turn.',\n        },\n        success: {\n            msg: 'You establish a Work Site in the hex.',\n        },\n        failure: {\n            msg:\n                'You fail to establish a Work Site in the hex.',\n        },\n        criticalFailure: {\n            msg: `Not only do you fail to establish a Work Site, but you lose several workers to an accident, banditry, a vicious monster, or some other unforeseen occurrence. ${gainUnrest(1)}`,\n        },\n    },\n    'establish-work-site-mine': {\n        title: 'Establish Work Site Mine',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: `<p>Your hire a crew of workers to travel to a hex that contains Lumber, Ore, or Stone to be harvested. Spend RP as determined by the hexs most inhospitable terrain:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check. Lumber camps can be established in any hex that contains a significant amount of forest terrain. Mines and quarries can be established in any hex that contains a significant amount of hill or mountain terrain.</p>`,\n        skills: simpleRank(['engineering']),\n        criticalSuccess: {\n            msg: 'You establish a Work Site in the hex and proceed to discover an unexpectedly rich supply of high quality Commodities. All Commodity yields granted by this site are doubled until the end of the next Kingdom turn.',\n        },\n        success: {\n            msg: 'You establish a Work Site in the hex.',\n        },\n        failure: {\n            msg: 'You fail to establish a Work Site in the hex.',\n        },\n        criticalFailure: {\n            msg: `Not only do you fail to establish a Work Site, but you lose several workers to an accident, banditry, a vicious monster, or some other unforeseen occurrence. ${gainUnrest(1)}`,\n        },\n    },\n    'establish-work-site-quarry': {\n        title: 'Establish Work Site Quarry',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: `<p>Your hire a crew of workers to travel to a hex that contains Lumber, Ore, or Stone to be harvested. Spend RP as determined by the hexs most inhospitable terrain:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check. Lumber camps can be established in any hex that contains a significant amount of forest terrain. Mines and quarries can be established in any hex that contains a significant amount of hill or mountain terrain.</p>`,\n        skills: simpleRank(['engineering']),\n        criticalSuccess: {\n            msg: 'You establish a Work Site in the hex and proceed to discover an unexpectedly rich supply of high quality Commodities. All Commodity yields granted by this site are doubled until the end of the next Kingdom turn.',\n        },\n        success: {\n            msg: 'You establish a Work Site in the hex.',\n        },\n        failure: {\n            msg: 'You fail to establish a Work Site in the hex.',\n        },\n        criticalFailure: {\n            msg: `Not only do you fail to establish a Work Site, but you lose several workers to an accident, banditry, a vicious monster, or some other unforeseen occurrence. ${gainUnrest(1)}`,\n        },\n    },\n    'evangelize-the-dead': {\n        companion: 'Harrim',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Evangelize the Dead',\n        description: 'Harrim spends time preaching the End Times. While his sermons certainly arent for everyone, his methods avoid deliberately antagonizing those who see hope in the world while simultaneously providing ease and calm to the more desperate among the kingdoms citizens. Attempt a basic Folklore check to determine how effective his sermons are.',\n        skills: simpleRank(['folklore']),\n        criticalSuccess: {\n            msg: `Harrims prayers soothe and calm the more criminal-minded citizens for the time being. ${loseUnrest('1d4')}, and either ${loseRuin('crime', 2)} or ${loseRuin('corruption', 1)} or ${loseRuin('strife', 1)}.`,\n        },\n        success: {\n            msg: `Harrims prayers serve to redirect and calm discord. ${loseUnrest('1d3')}`,\n        },\n        failure: {\n            msg: `Harrims prayers serve to redirect and calm discord. ${loseUnrest('1')}`,\n        },\n        criticalFailure: {\n            msg: `Harrims prayers have unsettled some of your citizens. ${gainUnrest('1d4')} and ${gainRuin('decay', 1)} `,\n        },\n    },\n    'false-victory': {\n        companion: 'Kanerah',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'False Victory',\n        description: 'Kanerahs contacts with the criminal underworld and her knack for dodging punishment and claiming responsibility for victories she had no direct role in can be harnessed to engineer false victories to trick the kingdoms citizens into thinking their leaders are doing more than they actually are to create a safe place to live. Such attempts are not without risks, though, for if things backfire, you can cause problems where none existed in the first place. When setting up a false victory, attempt a basic Intrigue check.',\n        skills: simpleRank(['intrigue']),\n        criticalSuccess: {\n            // TODO: ruin of your choice\n            msg: `At the end of this Kingdom turns Event Phase, roll again on the random kingdom events table. Rumors of this event being resolved spread throughout your kingdom. You dont gain any of the benefits of resolving this false victory, but instead ${loseUnrest('1d6')} and one Ruin of your choice by 1. If you randomly roll that same random kingdom event at any time during the next four kingdom turns, you can attempt an Intrigue check with a +1 circumstance bonus to resolve it rather than the normal check to resolve it.`,\n            modifiers: () => [{\n                turns: 5,\n                enabled: false,\n                value: 1,\n                name: 'False Victory: Critical Success',\n                type: 'circumstance',\n                phases: ['event'],\n                skills: ['intrigue'],\n            }],\n        },\n        success: {\n            msg: `Vague rumors of the kingdoms leaders attaining victories over vague threats spread through the kingdom. ${loseUnrest('1d3')}`,\n        },\n        failure: {\n            msg: `The false event fails to manifest, and rumors of the truth spread throughout the kingdom. ${gainUnrest(1)}. You cannot attempt False Victory on your next Kingdom turn.`,\n        },\n        criticalFailure: {\n            msg: 'The truth comes out, and the citizens revolt against this attempt to manipulate them. A Public Scandal event takes place during this kingdoms event phase, in addition to any other events that would normally take place. Attempt a DC @Check[type:flat|dc:11|showDC:all] check. On a success, the Public Scandal involves a randomly determined leader, but on a failure, the blame falls on Kanerah. Regardless of how the Public Scandal plays out, you cannot attempt False Victory again for 6 Kingdom turns.',\n        },\n    },\n    'focused-attention': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 20,\n        title: 'Focused Attention',\n        description: `You set aside time to focus attention on aiding another leader in an activity. Choose another leader and a Kingdom skill, then attempt a DC 20 check using the chosen skill. On a success, you grant that leader a +2 circumstance bonus to one kingdom check using that skill, provided that leader attempts the skill check during the same Kingdom turn.\n\nThe Cooperative Leadership Kingdom feat (page 531) increases the efficiency of this activity.`,\n        skills: simpleRank([...allSkills]),\n        criticalSuccess: {\n            msg: 'You grant that leader a +2 circumstance bonus to one kingdom check using that skill, provided that leader attempts the skill check during the same Kingdom turn',\n            modifiers: (kingdom) => [{\n                turns: 1,\n                enabled: false,\n                consumeId: '',\n                value: hasFeat(kingdom, 'Cooperative Leadership') ? 3 : 2,\n                name: 'Focused Attention: Critical Success',\n                type: 'circumstance',\n                rollOptions: ['focused-attention'],\n            }],\n        },\n        success: {\n            msg: 'You grant that leader a +2 circumstance bonus to one kingdom check using that skill, provided that leader attempts the skill check during the same Kingdom turn',\n            modifiers: (kingdom) => [{\n                turns: 1,\n                enabled: false,\n                consumeId: '',\n                value: hasFeat(kingdom, 'Cooperative Leadership') ? 3 : 2,\n                name: 'Focused Attention: Success',\n                type: 'circumstance',\n                rollOptions: ['focused-attention'],\n            }],\n        },\n    },\n    'fortify-hex': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        title: 'Fortify Hex',\n        description: `<p>Your command your engineers to construct a protected encampment, such as a fort or barbican, to serve as a defensive post in the hex. Spend RP as determined by the hexs most inhospitable terrain:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check. A fortified hex grants an additional bonus in warfare (see Appendix 3), but also gives traveling PCs a place to rest that prevents wandering monsters from interrupting their rest.</p>`,\n        requirement: 'The target hex must be claimed by your kingdom and must not have a settlement in it.',\n        skills: simpleRank(['defense']),\n        criticalSuccess: {\n            msg: `You find a defensible position for your fortification and finish construction efficiently. Gain a refund of half the RP you spent to build in the hex, then ${loseUnrest(1)}`,\n        },\n        success: {\n            msg:\n                `You establish your fortification in the hex. ${loseUnrest(1)}`,\n        },\n        failure: {\n            msg: 'You fail to fortify the hex.',\n        },\n        criticalFailure: {\n            msg: `Your attempt ends in disaster. Not only do you fail to build a structure, but you lose several workers to an accident, banditry, a vicious monster, or some other unforeseen occurrence. ${gainUnrest(1)}`,\n        },\n    },\n    'garrison-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'control',\n        title: 'Garrison Army',\n        description: 'You move an army into a fortification and assign them to guard it. In order to garrison, the army must be located in a hex that contains a Refuge, Settlement, or Work Site. If youre garrisoning the army in a Refuge hex, attempt a basic Defense check. If youre garrisoning the army in a settlement, attempt a basic Politics check. If youre garrisoning the army in a Work Site hex, attempt a basic Engineering check. This checks DC increases by 5 if the hex is not part of your kingdom, or by 10 if the location is part of an enemy kingdom.',\n        requirement: 'The army is in the same hex as a Refuge, Settlement, or Work Site.',\n        skills: simpleRank(['defense', 'politics', 'engineering']),\n        criticalSuccess: {\n            msg: 'The army becomes fortified until it is deployed. Additionally, the efficiency of the garrisoning reduces this armys Consumption by 2 (to a minimum of 1) until it is deployed.',\n        },\n        success: {\n            msg: 'The army becomes fortified until it is deployed.',\n        },\n        failure: {\n            msg: 'The army becomes fortified until the next Kingdom turn begins, at which point you must use this activity again to maintain the fortified condition.',\n        },\n        criticalFailure: {\n            msg: `Your army clashes with local citizens, abuses their authority, lets their watchful readiness slack, and/or provokes confrontations where they are not needed. It does not become fortified, and you cannot attempt to garrison that army at this location again for 4 Kingdom turns. ${gainUnrest(1)}`,\n        },\n    },\n    'gather-livestock': {\n        title: 'Gather Livestock',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: 'Attempt a basic check to gather excess livestock from local wildlife, ranches, and farms. This generates a number of Food commodities.',\n        skills: simpleRank(['wilderness']),\n        criticalSuccess: {\n            msg: gainCommodities('food', '1d4'),\n        },\n        success: {\n            msg: gainCommodities('food', 1),\n        },\n        failure: {\n            msg: 'Gain no Food commodities.',\n        },\n        criticalFailure: {\n            msg: `${loseCommodities('food', '1d4')} to spoilage. If you have no Food to lose, you instead ${gainUnrest(1)}`,\n        },\n    },\n    'go-fishing': {\n        title: 'Go Fishing',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: 'Attempt a basic check to fish for food from the rivers and lakes in your kingdom.',\n        requirement: 'Must have at least one claimed hex that includes river or lake terrain.',\n        skills: simpleRank(['boating']),\n        criticalSuccess: {\n            msg: gainCommodities('food', '1d4'),\n        },\n        success: {\n            msg: gainCommodities('food', 1),\n        },\n        failure: {\n            msg: 'Gain no Food commodities.',\n        },\n        criticalFailure: {\n            msg: `You lose some fishers to tragic accidents; ${gainUnrest(1)}`,\n        },\n    },\n    'harvest-azure-lily-pollen': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'region',\n        dc: 'control',\n        title: 'Harvest Azure Lily Pollen',\n        description: 'You or a small group of trained herbalists or naturalists work to harvest and process azure lily pollen in hopes of creating a few doses of the poison (detailed on page 584). Attempt a DC 30 Agriculture check. You must then wait 1 Kingdom turn before attempting this activity again, to give the lilies time to recover.',\n        skills: simpleRank(['agriculture'], 3),\n        criticalSuccess: {\n            msg: 'You create 2 doses of azure lily pollen.',\n        },\n        success: {\n            msg: `You create 1 dose of azure lily pollen but must also attempt a @Check[type:basic|dc:11|showDC:all]. On a failure, some of the poison makes its way into criminal hands; ${gainRuin('crime', 1)}`,\n        },\n        failure: {\n            msg:\n                `You fail to harvest any azure lily pollen, in part because many of the resources make their way into the kingdoms criminal underworld. ${gainRuin('crime', 1)}`,\n        },\n        criticalFailure: {\n            msg: `Not only do you fail to harvest any pollen, and not only do resources make their way into the hands of criminals, but whispers and rumors that you allowed this to happen on purpose spread through the kingdom. ${gainUnrest('1d4')}, ${gainRuin('corruption', 1)}, and ${gainRuin('crime', 2)}`,\n        },\n    },\n    'harvest-crops': {\n        title: 'Harvest Crops',\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        description: 'Attempt a basic check to forage for wild edibles or gather excess crops from farms.',\n        skills: simpleRank(['agriculture']),\n        criticalSuccess: {\n            msg: gainCommodities('food', '1d4'),\n        },\n        success: {\n            msg: gainCommodities('food', 1),\n        },\n        failure: {\n            msg: 'Gain no Food commodities.',\n        },\n        criticalFailure: {\n            msg: `${loseCommodities('food', '1d4')} to spoilage; if you have no Food to lose, you instead ${gainUnrest(1)}`,\n        },\n    },\n    'hire-adventurers': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Hire Adventurers',\n        description: `While the PCs can strike out themselves to deal with ongoing events, its often more efficient to Hire Adventurers. When you Hire Adventurers to help end an ongoing event, the DC is equal to your Control DC adjusted by the events level modifier. ${loseRolledRD(1)} each time you attempt this activity.`,\n        skills: simpleRank(['exploration']),\n        criticalSuccess: {\n            msg: 'You end the continuous event.',\n        },\n        success: {\n            msg: 'The continuous event doesnt end, but you gain a +2 circumstance bonus to resolve the event during the next Event phase.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: false,\n                phases: ['event'],\n                value: 2,\n                name: 'Hire Adventurers: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'You fail to end the continuous event. If you try to end the continuous event again, the cost in RP increases to 2 Resource Dice.',\n        },\n        criticalFailure: {\n            msg: 'You fail to end the continuous event. If you try to end the continuous event again, the cost in RP increases to 2 Resource Dice. In addition, word spreads quickly through the regionyou can no longer attempt to end this continuous event by Hiring Adventurers.',\n        },\n    },\n    'improve-lifestyle': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'commerce',\n        dc: 'control',\n        title: 'Improve Lifestyle',\n        description: 'Attempt a basic check to draw upon your kingdoms treasury to enhance the quality of life for your citizens. This activity can be taken only during the Commerce phase of a Kingdom turn',\n        skills: simpleRank(['politics']),\n        criticalSuccess: {\n            msg: 'Your push to Improve Lifestyles affords your citizens significant free time to pursue recreational activities. For the remainder of the Kingdom turn, you gain a +2 circumstance bonus to Culture-based checks.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['culture'],\n                value: 2,\n                name: 'Improve Lifestyle: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'Your push to Improve Lifestyles helps your citizens enjoy life. For the remainder of the Kingdom turn, you gain a +1 circumstance bonus to Culture-based checks.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['culture'],\n                value: 1,\n                name: 'Improve Lifestyle: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'Your push to Improve Lifestyles helps your citizens enjoy life. For the remainder of the Kingdom turn, you gain a +1 circumstance bonus to Culture-based checks. In addition, youve strained your treasury. Take a 1 circumstance penalty to Economy-based checks for the remainder of this Kingdom turn.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['economy'],\n                value: -1,\n                name: 'Improve Lifestyle: Failure',\n                type: 'circumstance',\n            }, {\n                turns: 1,\n                enabled: true,\n                abilities: ['culture'],\n                value: 1,\n                name: 'Improve Lifestyle: Failure',\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            // TODO: ruin of choice\n            msg: `Your attempt to Improve Lifestyles backfires horribly as criminal elements in your kingdom abuse your generosity. You take a 1 circumstance penalty to Economy-based checks for the remainder of the Kingdom turn, ${gainUnrest(1)}, and add 1 to a Ruin of your choice.`,\n            modifiers: () => [{\n                turns: 1,\n                enabled: true,\n                abilities: ['economy'],\n                value: -1,\n                name: 'Improve Lifestyle: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'infiltration': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Infiltration',\n        description: 'You send spies out to gather intelligence on a neighboring nation, a cult or thieves guild within your borders, an unclaimed Freehold, or even an unexplored adventure site. Alternately, you can simply send your spies out to investigate the current health of your kingdom. Attempt a basic check.',\n        skills: simpleRank(['intrigue']),\n        criticalSuccess: {\n            msg: `You learn something valuable or helpful. If you were infiltrating a specific target, the GM decides what is learned, but the information is exact and precise. For example, if you were infiltrating an unexplored ruin, you might learn that the site is infested with web lurkers and spider swarms. If you were investigating your kingdoms health, your spies reveal easy methods to address citizen dissatisfaction, allowing you to choose one of the following: ${loseUnrest('1d4')} or reduce a Ruin of your choice by 1.`,\n        },\n        success: {\n            msg: `You learn something helpful about the target, but the information is vague and imprecise. For example, if you were infiltrating the same ruin mentioned in the critical success above, you might learn that some sort of aberration uses the ruins as its lair. If you were investigating your kingdoms health, your spies learn enough that you can take action. ${loseUnrest(1)}`,\n        },\n        failure: {\n            msg: 'Your spies fail to learn anything of import, but they are not themselves compromised.',\n        },\n        criticalFailure: {\n            msg: 'You never hear from your spies again, but someone certainly does! You take a 2 circumstance penalty on all kingdom checks until the end of the next Kingdom turn as counter-infiltration from an unknown enemy tampers with your kingdoms inner workings.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                value: -2,\n                name: 'Infiltration: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'irrigation': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'region',\n        dc: 'control',\n        title: 'Irrigation',\n        description: `<p>You send excavators to build waterways, canals, or drainage systems to convey water from areas that have natural access to a river or lake. Spend RP as determined by the hexs most inhospitable terrain feature:</p>\n<ul>\n<li><b>Mountains</b>: ${loseRP(12)}</li>\n<li><b>Swamps</b>: ${loseRP(8)}</li>\n<li><b>Forests</b>: ${loseRP(4)}</li>\n<li><b>Hills</b>: ${loseRP(2)}</li>\n<li><b>Plains</b>: ${loseRP(1)}</li>\n</ul>\n<p>Then attempt a basic check.</p>`,\n        requirement: 'You control a hex adjacent to a river or lake that itself does not contain a river or lake.',\n        skills: simpleRank(['engineering'], 1),\n        criticalSuccess: {\n            msg: 'The hex gains a river or lake terrain feature (or you change the effects of a previous critical failure at Irrigation in this hex into a failure); work with your GM to determine where these features appear in the hex. In addition, your workers were efficient and quick, and you regain half the RP you spent building the waterways.',\n        },\n        success: {\n            msg: 'The hex gains a river or lake terrain feature (or you change the effects of a previous critical failure at Irrigation in this hex into a failure); work with your GM to determine where these features appear in the hex.',\n        },\n        failure: {\n            msg: 'You fail to build workable systems or to restore a previous critical failure, and the hex does not gain the river or lake terrain feature.',\n        },\n        criticalFailure: {\n            msg: `You fail to build workable systems or to restore a previous critical failure, and the hex does not gain the river or lake terrain feature. Your attempts at Irrigation are so completely useless that they become breeding grounds for disease. ${gainUnrest(1)}. From this point onward, at the start of your Kingdom turns Event phase, attempt a @Check[type:flat|dc:4]. This flat checks DC increases by 1 for each hex in your kingdom that contains a critically failed attempt at Irrigation. If you fail this flat check, your kingdom suffers a Plague event in addition to any other event it might have. You can attempt this activity again in a later Kingdom turn to undo a critically failed Irrigation attempt.`,\n        },\n    },\n    'manage-trade-agreements': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'commerce',\n        dc: 'control',\n        title: 'Manage Trade Agreements',\n        description: `You send agents out to attend to established trade agreements. ${loseRP(2)} per Trade Agreement you wish to manage. Then attempt a basic check. If you Managed Trade Agreements on the previous turn, increase this DC by 5.`,\n        skills: simpleRank(['trade']),\n        criticalSuccess: {\n            msg: `${createResourceButton({\n                value: '1',\n                turn: 'next',\n                type: 'resource-dice',\n            })} per trade agreement, and 1 Commodity of your choice per trade agreement (no more than half of these Commodities may be Luxuries).`,\n        },\n        success: {\n            msg: `${createResourceButton({\n                value: '1',\n                turn: 'next',\n                type: 'resource-dice',\n            })} per trade agreement, or 1 Commodity of your choice per trade agreement (no more than half of these Commodities may be Luxuries).`,\n        },\n        failure: {\n            msg: `${createResourceButton({value: '1', turn: 'next', type: 'resource-points'})} per trade agreement`,\n        },\n        criticalFailure: {\n            msg: 'You gain no benefit, as your traders and merchants met with bad luck on the road. You cant Manage Trade Agreements for 1 Kingdom turn.',\n        },\n    },\n    'new-leadership': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'upkeep',\n        dc: 'control',\n        title: 'New Leadership',\n        description: `<p>You announce the promotion of a character into a leadership role, whether theyre a newly appointed leader or just shifting from one leadership role to another. You normally perform this activity at the start of a Kingdom turn, but if unexpected events (such as the death of the character) remove a leader from a leadership role, you may immediately use the New Leadership activity to attempt to assign a new leader to that role, even outside of a Kingdom turn (applying the vacancy penalty for that role as appropriate). Attempt a basic Intrigue, Politics, Statecraft, or Warfare skill checkwhile any of these skills can be used, each skill is particularly suited to assigning two specific leadership roles.</p>\n<ul>\n<li><b>Intrigue</b>: Grants a +2 circumstance bonus to checks to assign Emissaries and Treasurers.</li>\n<li><b>Politics</b>: Grants a +2 circumstance bonus to checks to assign Counselors and Rulers.</li>\n<li><b>Statecraft</b>: Grants a +2 circumstance bonus to checks to assign Magisters and Viceroys.</li>\n<li><b>Warfare</b>: Grants a +2 circumstance bonus to checks to assign Generals and Wardens.</li>\n</ul>\n\n<p>Rulers are particularly difficult to assign; when you take this activity to assign a new Ruler, you take a 4 circumstance penalty to the skill check, and unless you achieve a critical success, you ${gainUnrest(1)}. Whether or not you are simultaneously assigning a leader, you may also use this activity to attempt to reselect the four leadership roles that you have invested. Any result other than a critical failure allows this.</p>`,\n        skills: simpleRank(['intrigue', 'politics', 'statecraft', 'warfare']),\n        criticalSuccess: {\n            msg: 'The people love the new leader. The leader immediately provides the benefits tied to occupying the new role and gains a +1 circumstance bonus to all Kingdom skill checks they attempt before the end of the next Kingdom turn.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: false,\n                value: 1,\n                name: 'New Leadership: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: `The people accept the new leader. The leader immediately provides the benefits tied to occupying the new role. ${gainUnrest(1)}`,\n        },\n        failure: {\n            msg: `The people are unsure about the new leader. The leader takes a 1 circumstance penalty to all checks they attempt as part of their activities during the Activity phase of each Kingdom turn. At the end of the next Kingdom turn, the leader can attempt any Loyalty-based basic skill check to ingratiate themselves with the populace. The leader may attempt this check at the end of each Kingdom turn until they succeed. Success removes this penalty, but a critical failure results in the development detailed in Critical Failure below. ${gainUnrest(1)}`,\n            modifiers: () => [{\n                enabled: false,\n                value: -1,\n                name: 'New Leadership: Failure',\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            msg: `The people reject the new leader. The leadership role is treated as vacant and you must attempt to reassign it using the New Leadership activity at the start of the next Kingdom turn. ${gainUnrest(1)}`,\n        },\n    },\n    'offensive-gambit': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'custom',\n        title: 'Offensive Gambit',\n        description: 'You order an attack against an enemy army, causing a war encounter to begin after this Kingdom turn ends. No check is necessary if you wish to engage the enemy without attempting to gain an advantage in initiative. If you want to gain an advantage by surprising the enemy, attempt an Intrigue check. If you want to gain an advantage by intimidating the enemy, attempt a Warfare check. In either case, the DC is equal to the enemy armys Scouting DC.',\n        requirement: 'You have at least one army in the same hex as an enemy army.',\n        skills: simpleRank(['intrigue']),\n        criticalSuccess: {\n            msg: 'Your approach surprises or intimidates the enemy. Your armies in this hex gain a +2 circumstance bonus on their initiative checks, and one enemy army of the partys choice in this hex becomes shaken 1.',\n        },\n        success: {\n            msg: 'Your approach gives you an advantage. Your armies in this hex gain a +2 circumstance bonus on their initiative checks.',\n        },\n        failure: {\n            msg: 'You gain no advantage in the battle.',\n        },\n        criticalFailure: {\n            msg: 'Not only do you fail to gain advantage, but the enemy forces have anticipated the attack. Enemy armies in this hex at the time of the Offensive',\n        },\n    },\n    'outfit-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'control',\n        title: 'Outfit Army',\n        description: `You provide your army with better gear. Choose what sort of gear you wish to provide your army with from the list beginning on page 67. The level of the gear chosen must be equal to or less than the armys level. If youre crafting or purchasing gear, the level of the gear chosen must be equal to or less than your kingdom level. If youre distributing resources gained from battle, the level of the gear chosen must be equal to or less than the highest level of an enemy army defeated in that battle. \n\nIf youre purchasing the gear, this activity requires a basic Trade check and costs the standard amount of RP for the gear; you cannot purchase magic gear unless your kingdom is at least expert rank in Magic. \n\nIf youre distributing gear gained from battle, this activity requires a basic Warfare check and does not cost RP.`,\n        skills: simpleRank(['trade', 'warfare']),\n        criticalSuccess: {\n            msg: 'The gear proved particularly easy to outfit, and the army becomes efficient.',\n        },\n        success: {\n            msg: 'The gear is sufficient, and your army becomes outfitted with it immediately.',\n        },\n        failure: {\n            msg: 'The gear proves to be unusable and the attempt to outfit the army fails. If you spent RP on the check, it is refunded.',\n        },\n        criticalFailure: {\n            msg: 'The gear proves to be unusable and the attempt to outfit the army fails.',\n        },\n    },\n    'pledge-of-fealty': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Pledge of Fealty',\n        description: `When your representatives encounter freeholders, refugees, independent groups, or other bands of individuals gathered in the wilderness who arent already part of a nation, you can offer them a place in your kingdom, granting them the benefits of protection, security, and prosperity in exchange for their fealty. The benefits granted to your kingdom can vary wildly, but often manifest as one-time boons to your commodities or unique bonuses against certain types of events. The adventure text in this campaign offers numerous examples of groups who could accept a Pledge of Fealty.\n\nYou can attempt this skill check with Intrigue, Statecraft, or Warfare; however, certain groups will respond better (or worse) to specific skills. The DC is the groups Negotiation DC (see the sidebar on page 519).`,\n        skills: simpleRank(['intrigue', 'statecraft', 'warfare'], 1),\n        criticalSuccess: {\n            msg: 'The group becomes part of your kingdom, granting the specific boon or advantage listed in that groups entry. If you havent already claimed the hex in which the group dwells, you immediately do so, gain 10XP and increasing your kingdom\\'s Size by 1 (this affects all statistics determined by Size; see page 532). If the hex doesnt share a border with your kingdom, it becomes a secondary territory and checks involving this location take a Control penalty.',\n        },\n        success: {\n            msg: `The group becomes part of your kingdom, granting the specific boon or advantage listed in that groups entry. If the hex doesnt share a border with your kingdom, it becomes a secondary territory and checks involving this location take a Control penalty. ${loseRolledRD(1)} to the result to integrate the group into your kingdom.`,\n        },\n        failure: {\n            msg:\n                `The group refuses to pledge to you at this time. You can attempt to get them to Pledge Fealty next turn. ${gainUnrest(1)}`,\n        },\n        criticalFailure: {\n            msg: `The group refuses to pledge to youfurthermore, it will never Pledge Fealty to your kingdom, barring significant in-play changes or actions by the PCs (subject to the GMs approval). The groups potentially violent rebuff of your offer ${gainUnrest(2)} and increases a Ruin of your choice by 1.`,\n        },\n    },\n    'preventative-measures': {\n        companion: 'Tristian',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Preventative Measures',\n        description: 'Tristian helps to organize magical defenses and resources to combat potential upcoming disasters or dangers to the kingdom. Attempt a basic Magic check to determine how effective the magical preparations are.',\n        skills: simpleRank(['magic']),\n        criticalSuccess: {\n            msg: 'The next time during this Kingdom turn that you attempt a Kingdom skill check to resolve a dangerous event, you gain a +2 circumstance bonus to the check and, unless you roll a critical failure, the result is improved one degree. If you reach the end of this Kingdom turn and havent had a dangerous event, you may decrease one Ruin of your choice by 1.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: false,\n                value: 2,\n                name: 'Preventative Measures: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'The next time during this Kingdom turn that you attempt a Kingdom skill check to resolve a dangerous event, you gain a +2 circumstance bonus to the check.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: false,\n                value: 2,\n                name: 'Preventative Measures: Success',\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            msg: `The attempt to put preventative measures in place has resulted in significant waste of resources. You cant use Preventative Measures again on your next Kingdom turn, and ${createResourceButton({\n                turn: 'next',\n                value: '2',\n                type: 'resource-dice',\n                mode: 'lose',\n            })}`,\n        },\n    },\n    'process-hidden-fees': {\n        companion: 'Jubilost',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Process Hidden Fees',\n        description: 'With Jubilosts aid, you can process additional taxes, fees, and payments. Attempt a basic Trade check to determine what sorts of additional resources you gather.',\n        skills: simpleRank(['trade']),\n        criticalSuccess: {\n            msg: createResourceButton({\n                turn: 'next',\n                value: '2',\n                type: 'resource-dice',\n            }),\n        },\n        success: {\n            msg: `${createResourceButton({\n                turn: 'next',\n                value: '1',\n                type: 'resource-dice',\n            })}, but the citizens suspect something is going on: if you attempt to Process Hidden Fees on the next Kingdom turn, the result is worsened one degree.`,\n        },\n        failure: {\n            msg: `${createResourceButton({\n                turn: 'next',\n                value: '1',\n                type: 'resource-dice',\n            })}, but the citizens catch wind of the fees and grow unhappy. ${gainUnrest(1)}, and you cannot Process Hidden Fees on your next Kingdom turn.`,\n        },\n        criticalFailure: {\n            msg: `${createResourceButton({\n                turn: 'next',\n                value: '1',\n                type: 'resource-dice',\n            })}, but the citizens catch wind of the fees and grow unhappy. ${gainUnrest('1d6')}, and you cannot Process Hidden Fees on your next Kingdom turn.`,\n        },\n    },\n    'prognostication': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Prognostication',\n        description: 'Your kingdoms spellcasters read the omens and provide advice on how best to prepare for near-future events. Attempt a basic check.',\n        skills: simpleRank(['magic'], 1),\n        criticalSuccess: {\n            msg: 'If you have a random kingdom event this turn, roll twice to determine the event that takes place. The players choose which of the two results occurs, and the kingdom gains a +2 circumstance bonus to the check to resolve the event.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: true,\n                value: 2,\n                name: 'Prognostication: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'Gain a +1 circumstance bonus to checks made to resolve random kingdom events this turn.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: true,\n                value: 1,\n                name: 'Prognostication: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'Your spellcasters divine no aid.',\n        },\n        criticalFailure: {\n            msg: 'Your spellcasters provide inaccurate readings of the future. You automatically have a random kingdom event this turn. Roll twice to determine the event that takes place; the GM decides which of the two results occurs.',\n        },\n    },\n    'provide-care': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Provide Care',\n        description: 'Attempt a basic check to organize and encourage your settlements healers, apothecaries, medics, and other caregivers to provide care and support for citizens in need.',\n        skills: simpleRank(['defense']),\n        criticalSuccess: {\n            msg: `You provide unexpectedly compassionate support for the people. ${loseUnrest(1)} and reduce one Ruin of your choice by 1.`,\n        },\n        success: {\n            msg: `Your care soothes the worries and fears of the populace; ${loseUnrest(1)}.`,\n        },\n        failure: {\n            msg: 'You dont provide any notable care for the citizens, but at least you dont make things worse.',\n        },\n        criticalFailure: {\n            msg: `Your attempt to provide care backfires. ${gainUnrest(1)} or a Ruin of your choice by 1.`,\n        },\n    },\n    'purchase-commodities': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Purchase Commodities',\n        description: `You can spend RP to Purchase Commodities, but doing so is more expensive than gathering them or relying upon trade agreements. When you Purchase Commodities, select the Commodity you wish to purchase (Food, Lumber, Luxuries, Ore, or Stone). ${loseRP(8)} if youre purchasing Luxuries or ${loseRP(4)} if youre purchasing any other Commodity. Then attempt a basic check.`,\n        skills: simpleRank(['trade']),\n        criticalSuccess: {\n            msg: `<p>You immediately gain 4 Commodities of the chosen type:</p> <ul>\n<li>${gainCommodities('food', '4')}</li>\n<li>${gainCommodities('ore', '4')}</li>\n<li>${gainCommodities('lumber', '4')}</li>\n<li>${gainCommodities('stone', '4')}</li>\n<li>${gainCommodities('luxuries', '4')}</li>\n</ul><p>and 2 Commodities of any other type (except Luxuries):</p> <ul>\n<li>${gainCommodities('food', '2')}</li>\n<li>${gainCommodities('ore', '2')}</li>\n<li>${gainCommodities('lumber', '2')}</li>\n<li>${gainCommodities('stone', '2')}</li>\n</ul>`,\n        },\n        success: {\n            msg: `<p>You gain 2 Commodities of the chosen type.<p> <ul>\n<li>${gainCommodities('food', '2')}</li>\n<li>${gainCommodities('ore', '2')}</li>\n<li>${gainCommodities('lumber', '2')}</li>\n<li>${gainCommodities('stone', '2')}</li>\n<li>${gainCommodities('luxuries', '2')}</li>\n</ul>`,\n        },\n        failure: {\n            msg: `<p>You gain 1 Commodity of the chosen type.</p> <ul>\n<li>${gainCommodities('food', '1')}</li>\n<li>${gainCommodities('ore', '1')}</li>\n<li>${gainCommodities('lumber', '1')}</li>\n<li>${gainCommodities('stone', '1')}</li>\n<li>${gainCommodities('luxuries', '1')}</li>\n</ul>`,\n        },\n        criticalFailure: {\n            msg: 'Failure You gain no Commodities.',\n        },\n    },\n    'quell-unrest': {\n        oncePerRound: true,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Quell Unrest',\n        description: 'You send your agents among the citizenry with the charge of suppressing dissent and calming unrest. You can attempt a basic Arts, Folklore, Intrigue, Magic, Politics, or Warfare check to Quell Unrest, but you can never use the same skill for this activity in consecutive Kingdom turns. This activity cannot be attempted more than once per Kingdom turn.',\n        skills: simpleRank(['arts', 'folklore', 'intrigue', 'magic', 'politics', 'warfare']),\n        criticalSuccess: {\n            msg: loseUnrest('1d6'),\n        },\n        success: {\n            msg: loseUnrest(1),\n        },\n        failure: {\n            msg: 'You fail to reduce Unrest.',\n        },\n        criticalFailure: {\n            msg: `You not only fail to reduce Unrest, but actually incite further anger among the citizenry. Choose one of the following: ${gainUnrest('1d4')} or increase two Ruins of your choice by 1.`,\n        },\n    },\n    'read-all-about-it': {\n        companion: 'Linzi',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Read All About It',\n        description: 'You take advantage of your nations paper to print an extra edition, a bonus-sized issue, or something to spread news to the citizens of the nation so that they are more prepared for upcoming events or more informed on how to deal with ongoing events. Attempt a basic Scholarship check to determine how helpful the information proves to be.',\n        requirement: 'You have built a Printing Press',\n        skills: simpleRank(['scholarship']),\n        criticalSuccess: {\n            msg: 'Your kingdom becomes particularly prepared. The next time you attempt a skill check to resolve any event during this Kingdom turn, you gain a +4 circumstance bonus to the roll.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: true,\n                value: 4,\n                name: 'Read All About It: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'The information is helpful, but only against ongoing events. The next time you attempt a skill check to resolve an ongoing event during this Kingdom turn, you gain a +2 circumstance bonus to the roll.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['event'],\n                enabled: false,\n                value: 2,\n                name: 'Read All About It: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'You fail to prepare your people for the worst.',\n        },\n        criticalFailure: {\n            msg: 'Critical parts of the information you published are false. You take a 2 circumstance penalty to all skill checks made to resolve Kingdom events for the remainder of this Kingdom turn',\n            modifiers: () => [{\n                turns: 1,\n                phases: ['event'],\n                enabled: true,\n                value: -2,\n                name: 'Read All About It: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'recover-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'control',\n        title: 'Recover Army',\n        description: `\n        When an army endures ill fortune, it can become afflicted by negative conditions. You can use the Recover Army activity to work at removing an affliction with a basic skill check (this DC increases by 5 if you are attempting to Recover from the defeated condition); the skill required for the check depends on the affliction:\n        <table>\n        <tr>\n        <th>Condition</th>\n        <th>Skill Check to Recover</th>\n        </tr>\n        <tr>\n            <td>Damaged</td>\n            <td>Defense or Folklore (expert)</td>\n        </tr>\n        <tr>\n            <td>Defeated</td>\n            <td>Politics (master) or Warfare (expert)</td>\n        </tr>\n        <tr>\n            <td>Lost</td>\n            <td>Exploration or Wilderness (expert)</td>\n        </tr>\n        <tr>\n            <td>Mired or Pinned</td>\n            <td>Engineering or Magic (expert)</td>\n        </tr>\n        <tr>\n            <td>Shaken</td>\n            <td>Arts or Warfare (expert)</td>\n        </tr>\n        <tr>\n            <td>Weary</td>\n            <td>Arts (expert) or Defense</td>\n        </tr>                \n        </table>\n        `,\n        skills: {\n            'defense': 0,\n            'folklore': 2,\n            'politics': 3,\n            'warfare': 2,\n            'exploration': 0,\n            'wilderness': 2,\n            'engineering': 0,\n            'magic': 2,\n            'arts': 2,\n        },\n        criticalSuccess: {\n            msg: 'You reduce the afflictions value by 2 (or in the case of a damaged army, increase its HP by 2 up to its maximum). If the affliction does not have a value, it is removed.',\n        },\n        success: {\n            msg: 'As critical success but you reduce the afflictions value by 1 (or in the case of a damaged army, increase its HP by 1 up to its maximum).',\n        },\n        failure: {\n            msg: 'You fail to remove the affliction. ',\n        },\n        criticalFailure: {\n            msg: 'You fail to remove the affliction and your soldiers lowered morale spreads discontent; ' + gainUnrest(1) + '. If you were attempting to recover a defeated army, the army is destroyed.',\n        },\n    },\n    'recruit-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Recruit Army',\n        description: 'Either you recruit an army from your kingdoms citizens, or you secure the allegiance of a specialized army you encountered in the Stolen Lands. If youre recruiting an army from your kingdoms citizens, choose one of the basic armies listed at the start of page 570 and attempt a Warfare check against the armys Recruitment DC. If youre securing a specialized army, you must attempt a Statecraft check against the Recruitment DC;',\n        skills: simpleRank(['warfare', 'statecraft']),\n        criticalSuccess: {\n            msg: 'You recruit the army; it becomes efficient.',\n        },\n        success: {\n            msg: 'You recruit the army.',\n        },\n        failure: {\n            msg: 'You fail to recruit the army.',\n        },\n        criticalFailure: {\n            msg: `Many of the individuals in the army you attempted to recruit took offense at the attempt. ${gainUnrest(1)}, and you cannot attempt to recruit an army again until the next Kingdom turn.`,\n        },\n    },\n    'recruit-monsters': {\n        companion: 'Nok-Nok',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'region',\n        dc: 'control',\n        title: 'Recruit Monsters',\n        description: 'While Nok-Nok is quick to suggest that most of the monsters the party encounters during their adventures deserve killing, he also understands that there can be exceptions. Some can be bribed or allied with, while others can be trusted to act on their instinctsa canny person can capitalize on these instincts or alliances to bolster a kingdoms defenses. Attempt a basic Intrigue check.',\n        skills: simpleRank(['intrigue']),\n        criticalSuccess: {\n            msg: `You manage to locate a monsters lair and take steps to incorporate it into your kingdoms defense. The next time your kingdom suffers a Bandit Activity, Monster Activity, Sacrifices, or Undead Uprising random event, you can use your recruited monster to help resolve the event. Doing so removes the Recruited Monster from your kingdom (you can attempt to recruit a new monster on a future kingdom turn though) but allows you to roll a skill check twice when resolving the Dangerous Hex event, taking the better of the two results as your actual result. This is a fortune effect.\n\nYour kingdom can support 1 Recruited Monster at a time. If your kingdom is master in Intrigue, you can support up to 2 Recruited Monsters at a time, and if your kingdom is legendary in Intrigue, you can support up to 3 Recruited Monsters at a time.`,\n        },\n        success: {\n            msg: 'You locate a monsters lair but cant recruit it into your kingdoms defense just yet. If you attempt this activity on your next kingdom turn; the result of that check is improved one degree as you continue to build a rapport with the monster.',\n        },\n        failure: {\n            msg: 'You fail to locate a monster, or if you were recruiting a monster you didnt succeed at recruiting on the previous turn, that monster moves on and you must start the recruitment procedure from scratch in the future.',\n        },\n        criticalFailure: {\n            msg: 'You found a monster, but it proves impossible to recruit. Worse, youve attracted its attention. A Monster Activity event occurs during the kingdoms next Event Phase, in addition to any other potential random events.',\n        },\n    },\n    'relocate-capital': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Relocate Capital',\n        description: 'One of your settlements that is not your current capital must contain a Castle, Palace, or Town Hall. All leaders must spend all of their leadership activities during the Activity phase of a Kingdom turn on this activity. The kingdom leaders announce that they are uprooting the seat of government from its current home and reestablishing it in another settlement. Attempt a check with a DC equal to the kingdoms Control DC + 5. You cannot Relocate your Capital again for at least 3 Kingdom turns.',\n        skills: simpleRank(['industry'], 1),\n        criticalSuccess: {\n            msg: 'The move goes off splendidly, with people excited about the new capital and celebrating the leaderships wisdom.',\n        },\n        success: {\n            msg: `The move goes smoothly and with minimal disruption, but some folks are upset or homesick. ${gainUnrest(1)}`,\n        },\n        failure: {\n            msg: `The move causes unhappiness. ${gainUnrest(1)} and increase two Ruins of your choice by 1.`,\n        },\n        criticalFailure: {\n            msg: `The people reject the idea of the new capital and demand you move it back. The move is unsuccessful, and your capital remains unchanged. ${gainUnrest('1d4')}. Increase three Ruins of your choice by 1 and the fourth Ruin by 3.`,\n        },\n    },\n    'repair-reputation-corruption': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        dcAdjustment: 2,\n        title: 'Repair Reputation Corruption',\n        description: `When things have gotten out of hand in the kingdom and the nations reputation has become damaged, you can focus efforts on a campaign to reassure the citizens and bring them closer together, stamp down crime, organize repairs and maintenance of public structures, or strive to adjust poor public opinions.\n\nThe skill used to Repair Reputation depends on which Ruin total you wish to reduce. If you wish to reduce your Corruption, you attempt an Arts check. If you wish to reduce your Crime, you attempt a Trade check. If you wish to reduce your Decay, you attempt an Engineering check. If you wish to reduce your Strife, you attempt an Intrigue check. In all cases, the DC is your Control DC + 2.`,\n        skills: simpleRank(['arts'], 1),\n        criticalSuccess: {\n            msg: `${loseRuin('corruption', 2)} and reduce its current ruin penalty by 1 to a minimum of 0.`,\n        },\n        success: {\n            msg: loseRuin('corruption', 1),\n        },\n        failure: {\n            msg: 'You fail to reduce the targeted Ruin. You cannot attempt to Repair Reputation on this Ruin for 1 Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `You fail to reduce the targeted Ruin in a particularly public and embarrassing way. ${gainUnrest('1d4')}, and you cannot attempt to Repair Reputation for 3 Kingdom turns.`,\n        },\n    },\n    'repair-reputation-crime': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        dcAdjustment: 2,\n        title: 'Repair Reputation Crime',\n        description: `When things have gotten out of hand in the kingdom and the nations reputation has become damaged, you can focus efforts on a campaign to reassure the citizens and bring them closer together, stamp down crime, organize repairs and maintenance of public structures, or strive to adjust poor public opinions.\n\nThe skill used to Repair Reputation depends on which Ruin total you wish to reduce. If you wish to reduce your Corruption, you attempt an Arts check. If you wish to reduce your Crime, you attempt a Trade check. If you wish to reduce your Decay, you attempt an Engineering check. If you wish to reduce your Strife, you attempt an Intrigue check. In all cases, the DC is your Control DC + 2.`,\n        skills: simpleRank(['trade'], 1),\n        criticalSuccess: {\n            msg: `${loseRuin('crime', 2)} and reduce its current ruin penalty by 1 to a minimum of 0.`,\n        },\n        success: {\n            msg: loseRuin('crime', 1),\n        },\n        failure: {\n            msg: 'You fail to reduce the targeted Ruin. You cannot attempt to Repair Reputation on this Ruin for 1 Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `You fail to reduce the targeted Ruin in a particularly public and embarrassing way. ${gainUnrest('1d4')}, and you cannot attempt to Repair Reputation for 3 Kingdom turns.`,\n        },\n    },\n    'repair-reputation-decay': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        dcAdjustment: 2,\n        title: 'Repair Reputation Decay',\n        description: `When things have gotten out of hand in the kingdom and the nations reputation has become damaged, you can focus efforts on a campaign to reassure the citizens and bring them closer together, stamp down crime, organize repairs and maintenance of public structures, or strive to adjust poor public opinions.\n\nThe skill used to Repair Reputation depends on which Ruin total you wish to reduce. If you wish to reduce your Corruption, you attempt an Arts check. If you wish to reduce your Crime, you attempt a Trade check. If you wish to reduce your Decay, you attempt an Engineering check. If you wish to reduce your Strife, you attempt an Intrigue check. In all cases, the DC is your Control DC + 2.`,\n        skills: simpleRank(['engineering'], 1),\n        criticalSuccess: {\n            msg: `${loseRuin('decay', 2)} and reduce its current ruin penalty by 1 to a minimum of 0.`,\n        },\n        success: {\n            msg: loseRuin('decay', 1),\n        },\n        failure: {\n            msg: 'You fail to reduce the targeted Ruin. You cannot attempt to Repair Reputation on this Ruin for 1 Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `You fail to reduce the targeted Ruin in a particularly public and embarrassing way. ${gainUnrest('1d4')}, and you cannot attempt to Repair Reputation for 3 Kingdom turns.`,\n        },\n    },\n    'repair-reputation-strife': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        dcAdjustment: 2,\n        title: 'Repair Reputation Strife',\n        description: `When things have gotten out of hand in the kingdom and the nations reputation has become damaged, you can focus efforts on a campaign to reassure the citizens and bring them closer together, stamp down crime, organize repairs and maintenance of public structures, or strive to adjust poor public opinions.\n\nThe skill used to Repair Reputation depends on which Ruin total you wish to reduce. If you wish to reduce your Corruption, you attempt an Arts check. If you wish to reduce your Crime, you attempt a Trade check. If you wish to reduce your Decay, you attempt an Engineering check. If you wish to reduce your Strife, you attempt an Intrigue check. In all cases, the DC is your Control DC + 2.`,\n        skills: simpleRank(['intrigue'], 1),\n        criticalSuccess: {\n            msg: `${loseRuin('strife', 2)} and reduce its current ruin penalty by 1 to a minimum of 0.`,\n        },\n        success: {\n            msg: loseRuin('strife', 1),\n        },\n        failure: {\n            msg: 'You fail to reduce the targeted Ruin. You cannot attempt to Repair Reputation on this Ruin for 1 Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `You fail to reduce the targeted Ruin in a particularly public and embarrassing way. ${gainUnrest('1d4')}, and you cannot attempt to Repair Reputation for 3 Kingdom turns.`,\n        },\n    },\n    'repair-the-flooded-mine': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 32,\n        title: 'Repair the Flooded Mine',\n        description: `A group of engineers work to drain the flooded mine, shore up its damaged section, and establish the mine as a functional Work Site. ${loseRP(20)}, then attempt a DC 32 Engineering check.`,\n        skills: simpleRank(['engineering'], 3),\n        criticalSuccess: {\n            msg: 'The mine is repaired, and as a bonus, your workers Establish a Work Site at the mine immediately. This mine produces 2 Ore Commodities per Kingdom turn.',\n        },\n        success: {\n            msg: 'The mine is repaired. This mine produces 2 Ore Commodities per Kingdom turn.',\n        },\n        failure: {\n            msg: 'Work on repairing the mine proceeds, but at a much slower (and more expensive) pace than youd hoped. The mine remains flooded, but you can attempt this check again on the next Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `Work on repairing the mine proceeds, but at a much slower (and more expensive) pace than youd hoped. The mine remains flooded, but you can attempt this check again on the next Kingdom turn. In addition, a catastrophic failure costs the lives of several workers. ${gainUnrest(2)} and ${gainRuin('decay', 1)}. The next time you attempt to Repair the Flooded Mine, it costs 40 RP.`,\n        },\n    },\n    'request-foreign-aid': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Request Foreign Aid',\n        description: 'When disaster strikes, you send out a call for help to another nation with whom you have diplomatic relations. The DC of this check is equal to the other groups Negotiation DC +2 (see the sidebar on page 519).',\n        requirement: 'You have diplomatic relations with the group you are requesting aid from.',\n        skills: simpleRank(['statecraft'], 1),\n        criticalSuccess: {\n            msg: `Your allys aid grants a +4 circumstance bonus to any one Kingdom skill check attempted during the remainder of this Kingdom turn. You can choose to apply this bonus to any Kingdom skill check after the die is rolled, but must do so before the result is known. In addition, ${gainRolledRD(2)}; this RP does not accrue into XP at the end of the turn if you dont spend it.`,\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                enabled: false,\n                value: 4,\n                name: 'Request Foreign Aid: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: `Your allys aid grants you either a +2 circumstance bonus to any one Kingdom skill check attempted during the remainder of this Kingdom turn or ${gainRolledRD(1)}. This RP does not accrue into XP at the end of the turn if you dont spend it. You can choose to apply the bonus to any Kingdom skill check after the die is rolled, but must do so before the result is known.`,\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                enabled: false,\n                value: 2,\n                name: 'Request Foreign Aid: Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: `Your ally marshals its resources but cannot get aid to you in time to deal with your current situation. ${createResourceButton({\n                turn: 'next',\n                value: '1d4',\n                type: 'resource-points',\n            })}`,\n        },\n        criticalFailure: {\n            msg: `Your ally is tangled up in its own problems and is unable to assist you, is insulted by your request for aid, or might even have an interest in seeing your kingdom struggle against one of your ongoing events. Whatever the case, your pleas for aid make your kingdom look desperate. You gain no aid, but you do ${gainUnrest('1d4')}.`,\n        },\n    },\n    'rest-and-relax': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Rest and Relax',\n        description: `Working non-stop can burn out even the most devoted and dedicated individual. As such, its important to take time for yourself, and thus set a good example for the nation.\n\nYou take time to relax, and you extend the chance to unwind to your citizens as well. The Kingdom skill you use to determine the effectiveness of your time off depends on how you want to spend it: Use a basic Arts check to spend the time engaged in entertainment or the pursuit of a hobby. Use a basic Boating check to enjoy trips on the lakes and rivers of your kingdom. Use a basic Scholarship check to spend the time reading or studying a topic of personal interest beyond your daily duties. Use a basic Trade check to spend your time shopping or feasting. Use a basic Wilderness check to get away from the bustle and relax in the countryside. If your kingdom Rested and Relaxed the previous Kingdom turn, the DC increases by 4, as your kingdoms production and output hasnt had a chance to catch up to all those vacation days.`,\n        skills: simpleRank(['arts', 'boating', 'scholarship', 'trade', 'wilderness']),\n        criticalSuccess: {\n            msg: 'The citizens enjoy the time off and are ready to get back to work. ' + loseUnrest(1) + ', and the next Leadership activity you take gains a +2 circumstance bonus.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['leadership'],\n                enabled: true,\n                value: 2,\n                name: 'Rest and Relax: Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: `The time spent relaxing has calmed nerves; ${loseUnrest(1)}.`,\n        },\n        failure: {\n            msg: 'The rest is welcome, but not particularly beneficial in the long term.',\n        },\n        criticalFailure: {\n            msg: 'The time is wasted, and when you get back to work, you have to spend extra time catching up. Take a 2 circumstance penalty to your next skill check made as a Leadership activity.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                phases: ['leadership'],\n                enabled: true,\n                value: -2,\n                name: 'Rest and Relax: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'restore-the-temple-of-the-elk': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 25,\n        title: 'Restore the Temple of the Elk',\n        description: `You work with several worshippers of Erastil, gifted masons, and skilled laborers to restore the temple and once more consecrate it as a sacred place devoted to the worship of Erastil. ${loseRP('1d6')}, then attempt a DC 25 Folklore check.`,\n        skills: simpleRank(['folklore']),\n        criticalSuccess: {\n            msg: 'The temple is restored and can now serve as a Refuge terrain feature. If you later build a settlement here, the temple instead functions as a free Shrine in the settlement. In addition, your work was so excellent that youve attracted Erastils attention! The PC who rolled the Folklore check is granted Erastils minor boon: whenever that PC critically fails a check to Subsist in the wild, they gain a failure instead. @UUID[Compendium.pf2e.boons-and-curses.hrTl9kfSNrOQeNze]{Erastil - Minor Boon}',\n        },\n        success: {\n            msg: 'The temple is restored and can now serve as a Refuge terrain feature. If you later build a settlement here, the temple instead functions as a free Shrine in the settlement.',\n        },\n        failure: {\n            msg: 'Work proceeds but is not yet complete; you can attempt to restore the temple again on the next Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `Disaster strikes as the temples cavern collapses and rubble spills out to bury and destroy much of the temples plaza. ${gainRuin('decay', 1)} and ${gainUnrest('1d4')}. You can still attempt to Restore the Temple, but the DC for success increases by 4. This increase is cumulative with successive critical failures.`,\n        },\n    },\n    'send-diplomatic-envoy': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'leadership',\n        dc: 'custom',\n        title: 'Send Diplomatic Envoy',\n        description: 'You send emissaries to another group to foster positive relations and communication. The DC of this check is the groups Negotiation DC (see the sidebar on page 519). Attempts to Send a Diplomatic Envoy to a nation with which your kingdom is at war take a 4 circumstance penalty to the check and have the result worsened one degree. At the GMs option, some wars might be so heated that this activity has no chance of success.',\n        skills: simpleRank(['statecraft'], 1),\n        criticalSuccess: {\n            msg: 'Your envoys are received quite warmly and make a good first impression. You establish diplomatic relations with the group (see page 534 for more information) and gain a +2 circumstance bonus to all checks made with that group until the next Kingdom turn.',\n            modifiers: () => [{\n                turns: 1,\n                enabled: false,\n                value: 2,\n                name: 'Send Diplomatic Envoy: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'You establish diplomatic relations.',\n        },\n        failure: {\n            msg: 'Your envoys are received, but the target organization isnt ready to engage in diplomatic relations. If you attempt to Send a Diplomatic Envoy to the group next Kingdom turn, you gain a +2 circumstance bonus to that check.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: false,\n                value: 2,\n                activities: ['send-diplomatic-envoy'],\n                name: 'Send Diplomatic Envoy: Success',\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            msg: `Disaster! Your envoy fails to reach their destination, is turned back at the border, or is taken prisoner or executed, at the GMs discretion. The repercussions on your kingdoms morale and reputation are significant. Choose one of the following results: ${gainUnrest('1d4')}, add 1 to a Ruin of your choice, or ${loseRolledRD(2)}. In any event, you cannot attempt to Send a Diplomatic Envoy to this same target for the next 3 Kingdom Turns.`,\n        },\n    },\n    'show-of-force': {\n        companion: 'Regongar',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Show of Force',\n        description: 'Using Regongars advice, a public show of force is performed in an attempt to curtail criminal activity or subversive activity in the kingdom. Attempt a basic Warfare check to determine how effective the Show of Force is.',\n        skills: simpleRank(['warfare']),\n        criticalSuccess: {\n            msg: `The kingdoms criminals are cowed by the show of force. ${loseRuin('crime', 2)} and reduce one other Ruin of your choice by 1.`,\n        },\n        success: {\n            msg: `The kingdoms criminals take note of the show of force. ${loseRuin('crime', 1)}`,\n        },\n        failure: {\n            msg: `The show of force fails to impress criminals but unsettles the rest of the citizens. ${gainUnrest(1)}.`,\n        },\n        criticalFailure: {\n            msg: `The criminals are emboldened by the failed show of force. ${gainUnrest('1d4')} and ${gainRuin('crime', 1)}.`,\n        },\n    },\n    'spread-the-legend': {\n        companion: 'Linzi',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Spread the Legend',\n        description: 'Linzi works to spread the word of the partys heroics and achievements, both through word of mouth and by distributing chapbooks or one-sheets detailing their exploits. Attempt a basic Arts check to determine the success of Linzis efforts. If she has secured a printing press for the kingdom after the PCs help with her quest (see To Ask for Forgiveness, below), the Arts check gains a +2 item bonus.',\n        skills: simpleRank(['arts']),\n        criticalSuccess: {\n            msg: `Not only do Linzis stories bring pride and patriotism to the nation, but they also help increase its glory. ${loseUnrest('1d6')}, and ${createResourceButton({\n                type: 'fame',\n                turn: 'next',\n                value: '1',\n            })}. In addition, if the kingdom experiences a dangerous random event during this turns Event Phase, reduce that events level modifier by 1.`,\n        },\n        success: {\n            msg: `The rousing and inspiring stories Linzi spreads about the PCs helps to bring the nation together. ${loseUnrest('1d6')}`,\n        },\n        failure: {\n            msg: `Linzi avoids spreading unfortunate news, but only just barely. The citizens are only slightly entertained by their leaders exploits. ${loseUnrest(1)}.`,\n        },\n        criticalFailure: {\n            msg: `Linzi accidentally spreads news of a humiliating or embarrassing nature, causing the people of the kingdom to lose respect for their leaders. ${gainUnrest('1d4')}.`,\n        },\n    },\n    'supernatural-solution': {\n        enabled: true,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Supernatural Solution',\n        description: 'Your spellcasters try to resolve issues when mundane solutions just arent enough. Attempt a basic check.',\n        oncePerRound: false,\n        fortune: true,\n        skills: simpleRank(['magic']),\n        criticalSuccess: {\n            msg: `You can call upon your spellcasters supernatural solution to aid in resolving any Kingdom skill check made during the remainder of this Kingdom turn ${gainSolution('supernatural-solution')}. Do so just before a Kingdom skill check is rolled (by yourself or any other PC). Attempt a Magic check against the same DC in addition to the Kingdom skill check, and take whichever of the two results you prefer. If you dont use your Supernatural Solution by the end of this Kingdom turn, this benefit ends and you gain 10XP instead.`,\n        },\n        success: {\n            msg: `You can call upon your spellcasters supernatural solution to aid in resolving any Kingdom skill check made during the remainder of this Kingdom turn ${gainSolution('supernatural-solution')}. Do so just before a Kingdom skill check is rolled (by yourself or any other PC). Attempt a Magic check against the same DC in addition to the Kingdom skill check, and take whichever of the two results you prefer. If you dont use your Supernatural Solution by the end of this Kingdom turn, this benefit ends and you gain 10XP instead. However, you ${loseRP('1d4')} to research the solution. This cost is paid now, whether or not you use your supernatural solution.`,\n        },\n        failure: {\n            msg: `Your attempt at researching a supernatural solution costs additional RP to research, but is ultimately a failure, providing no advantage. ${loseRP('2d6')}`,\n        },\n        criticalFailure: {\n            msg: `Your attempt at researching a supernatural solution costs additional RP to research, but is ultimately a failure, providing no advantage. ${loseRP('2d6')}. In addition, your spellcasters resources and morale are impacted such that you cannot attempt a Supernatural Solution again for 2 Kingdom turns.`,\n        },\n        special: 'You cannot influence a check with Supernatural Solution and Creative Solution simultaneously.',\n    },\n    'supplementary-hunting': {\n        companion: 'Ekundayo',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'region',\n        dc: 'control',\n        title: 'Supplementary Hunting',\n        description: 'Following Ekundayos advice, rural-dwelling citizens work to supplement stores of food and resources through hunting and trapping. Attempt a basic Wilderness check to gather excess livestock from the local wildlife, ranches, and farms to generate food commodities.',\n        skills: simpleRank(['wilderness']),\n        criticalSuccess: {\n            msg: `${gainCommodities('food', '1d4')}, ${gainCommodities('luxuries', 1)}, and ${createResourceButton({\n                type: 'resource-dice',\n                turn: 'next',\n                value: '1',\n            })}`,\n        },\n        success: {\n            msg: `Choose one: ${gainCommodities('food', '1d4')}, ${gainCommodities('luxuries', 1)}, or ${createResourceButton({\n                type: 'resource-dice',\n                turn: 'next',\n                value: '1',\n            })}`,\n        },\n        failure: {\n            msg: 'Your hunters and trappers fail to supplement your stores and must spend time resupplying and setting new traps; you cannot attempt Supplementary Hunting on the next Kingdom turn.',\n        },\n        criticalFailure: {\n            msg: `Your hunters and trappers fail to supplement your stores and must spend time resupplying and setting new traps; you cannot attempt Supplementary Hunting on the next Kingdom turn. In addition, your hunters and trappers have accidentally attracted the attention of dangerous wildlife. Either ${gainUnrest('1d4')} or increase a Ruin of your choice by 1.`,\n        },\n    },\n    'tap-treasury': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'commerce',\n        dc: 'control',\n        title: 'Tap Treasury',\n        description: 'You tap into the cash reserves of your kingdom for the PCs personal use or to provide emergency funding for an event. This is a basic check, but after you succeed or critically succeed at this activity, all future attempts to Tap Treasury have their results worsened two degrees. This penalty persists until funds equal to those taken from the treasury are repaid via Capital Investment',\n        skills: simpleRank(['statecraft']),\n        criticalSuccess: {\n            msg: 'You withdraw funds equal to the Currency per Additional PC column on Table 109: Party Treasure By Level @UUID[Compendium.pf2e.journals.S55aqwWIzpQRFhcq.JournalEntryPage.Ly8l2GT6dbvuY3A2]{Treasure}, or you successfully fund the unexpected event that required you to Tap your Treasury.',\n        },\n        success: {\n            msg: 'You withdraw funds equal to the Currency per Additional PC column on Table 109: Party Treasure By Level @UUID[Compendium.pf2e.journals.S55aqwWIzpQRFhcq.JournalEntryPage.Ly8l2GT6dbvuY3A2]{Treasure}, or you successfully fund the unexpected event that required you to Tap your Treasury. In addition, you overdraw your treasury in the attempt. You take a 1 circumstance penalty to all Economy-based checks until the end of your next Kingdom turn.',\n            modifiers: () => [{\n                value: -1,\n                name: 'Tap Treasury: Success',\n                abilities: ['economy'],\n                turns: 2,\n                enabled: true,\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'You fail to secure the funds you need, and rumors about the kingdoms potential shortfall of cash cause you to take a 1 circumstance penalty to all Loyalty- and Economy-based checks until the end of your next Kingdom turn.',\n            modifiers: () => [{\n                value: -1,\n                name: 'Tap Treasury: Success',\n                abilities: ['economy', 'loyalty'],\n                turns: 2,\n                enabled: true,\n                type: 'circumstance',\n            }],\n        },\n        criticalFailure: {\n            msg: `You fail to secure the funds you need, and rumors about the kingdoms potential shortfall of cash cause you to take a 1 circumstance penalty to all Loyalty- and Economy-based checks until the end of your next Kingdom turn. In addition, rumors spiral out of control. ${gainUnrest(1)} and add 1 to a Ruin of your choice.`,\n            modifiers: () => [{\n                value: -1,\n                name: 'Tap Treasury: Success',\n                abilities: ['economy', 'loyalty'],\n                turns: 2,\n                enabled: true,\n                type: 'circumstance',\n            }],\n        },\n    },\n    'trade-commodities': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'commerce',\n        dc: 'control',\n        title: 'Trade Commodities',\n        description: 'There are five different categories of Commodities: Food, Lumber, Luxuries, Ore, and Stone. When you Trade Commodities, select one Commodity that your kingdom currently stockpiles and reduce that Commoditys stockpile by up to 4. Then attempt a basic check. If you trade with a group that youve established diplomatic relations with, you gain a +1 circumstance bonus to the check.',\n        skills: simpleRank(['industry']),\n        criticalSuccess: {\n            msg: `${createResourceButton({\n                type: 'resource-dice',\n                turn: 'next',\n                value: '2',\n            })} per point of stockpile expended from your Commodity now.`,\n        },\n        success: {\n            msg: `${createResourceButton({\n                type: 'resource-dice',\n                turn: 'next',\n                value: '1',\n            })} per point of stockpile expended from your Commodity now.`,\n        },\n        failure: {\n            msg: createResourceButton({type: 'resource-dice', turn: 'next', value: '1'}),\n        },\n        criticalFailure: {\n            msg: `You gain no bonus Resource Dice (though the Commodity remains depleted). If you Traded Commodities the previous turn, ${gainUnrest(1)}`,\n        },\n    },\n    'train-army': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: true,\n        phase: 'army',\n        dc: 'control',\n        title: 'Train Army',\n        description: 'You train an army in the use of a tactic. Choose one of the tactics from those listed starting on page 68, then attempt a Scholarship or Warfare check against the tactics Training DC. If your army has already learned its maximum number of tactics, the newly learned tactic replaces a previously learned tactic of your choice. ',\n        skills: simpleRank(['scholarship', 'warfare']),\n        criticalSuccess: {\n            msg: 'The army learns the tactic and then becomes efficient.',\n        },\n        success: {\n            msg: 'The army learns the tactic.',\n        },\n        failure: {\n            msg: 'The army fails to learn the tactic.',\n        },\n        criticalFailure: {\n            msg: 'The army not only fails to learn the tactic but becomes frustrated and exhausted from the training; increase the armys weary condition by 1.',\n        },\n    },\n    'warfare-exercises': {\n        companion: 'Valerie',\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Warfare Exercises',\n        description: 'Valerie spends time studying the nations armies, speaking with its commanders, researching historical records of battles, and running simulations in war rooms to help predict the best ways to prepare for upcoming conflicts. Attempt a basic Warfare check to determine the success of these exercises.',\n        skills: simpleRank(['warfare']),\n        criticalSuccess: {\n            msg: 'The exercises reveal a wide range of suggestions for the PCs to use during that months military exercises. All Army activities taken during this Kingdom turns Activity Phase gain a +1 circumstance bonus. This bonus increases to +2 at Kingdom level 9 and +3 at Kingdom level 15. In addition, the next time this Kingdom turn that you roll a critical failure on an Army activity, the result is improved to a regular failure instead.',\n            modifiers: (kingdom: Kingdom) => [{\n                turns: 1,\n                consumeId: '',\n                enabled: true,\n                phases: ['army'],\n                value: kingdom.level < 9 ? 1 : (kingdom.level < 15 ? 2 : 3),\n                name: 'Warfare Exercises: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: 'The exercises grant a +1 circumstance bonus to your first Army activity taken during the Kingdom turns Activity Phase. This bonus increases to +2 at Kingdom level 9 and +3 at Kingdom level 15.',\n            modifiers: (kingdom: Kingdom) => [{\n                turns: 1,\n                consumeId: '',\n                enabled: true,\n                phases: ['army'],\n                value: kingdom.level < 9 ? 1 : (kingdom.level < 15 ? 2 : 3),\n                name: 'Warfare Exercises: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        failure: {\n            msg: 'The warfare exercises provide no insight this turn.',\n        },\n        criticalFailure: {\n            msg: 'You accidentally form incorrect assumptions about your military tactics. The next time you roll a failure on an Army activity this Kingdom turn, it becomes a critical failure instead.',\n        },\n    },\n    'reconnoiter-hex': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Reconnoiter Hex',\n        description: `You send a team to spend time surveying and exploring a specific hex, getting the lay of the land and looking for unusual features and specific sites. ${loseRP(1)} and then attempt a Basic check.`,\n        skills: simpleRank(['wilderness']),\n        criticalSuccess: {\n            msg: 'Your team successfully explores the hex and it is now Reconnoitered for the purpose of Claim Hex. Your team automatically finds one Special or Hidden feature if the hex contains one. If the hex contains multiple Special or Hidden Features the GM chooses one. If the hex contains an Encounter or Hazard, the team avoids it and reports back useful and detailed information on it. In addition, your team\\'s reconnaissance of the hex goes so smoothly you may immediately attempt an additional Reconnoiter Hex activity on an adjacent hex. Treat a Critical Success on this additional check as a Success instead.',\n        },\n        success: {\n            msg: 'Your team successfully explores the hex and it is now Reconnoitered for the purpose of Claim Hex. If the hex contains a Special feature your team may find it if your GM wishes. If the hex contains an Encounter or Hazard, the team avoids it and reports basic information on it.',\n        },\n        failure: {\n            msg: 'Your team fails to explore the hex sufficiently. If the hex contains an Encounter or Hazard, the team escapes it and reports basic information on it.',\n        },\n        criticalFailure: {\n            msg: 'Your team fails to explore the hex sufficiently and a number of the team are lost, causing you to take a -1 circumstance penalty to Loyalty-based checks until the end of your next Kingdom turn. If the hex contains an Encounter or Hazard, the team members were lost to it and the survivors can report back basic information on it.',\n            modifiers: () => [{\n                turns: 2,\n                enabled: true,\n                abilities: ['loyalty'],\n                value: -1,\n                name: 'Reconnoiter Hex: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n    'take-charge': {\n        oncePerRound: false,\n        fortune: false,\n        enabled: false,\n        phase: 'leadership',\n        dc: 'control',\n        title: 'Take Charge',\n        description: 'You spend some time getting directly involved in helping your kingdom. Choose a skill that your Kingdom is at least Trained in, then attempt a basic check. You can never use the same skill for this activity twice in the same Kingdom turn.',\n        skills: simpleRank([...allSkills], 1),\n        criticalSuccess: {\n            msg: `${gainRP(1)}. In addition you get a +1 Circumstance Bonus to the next Check you make this turn with the chosen skill. `,\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                enabled: false,\n                value: 1,\n                name: 'Take Charge: Critical Success',\n                type: 'circumstance',\n            }],\n        },\n        success: {\n            msg: gainRP(1),\n        },\n        failure: {\n            msg: 'You fail to generate RP.',\n        },\n        criticalFailure: {\n            msg: 'You take a -1 Circumstance Penalty to the next Check you make this turn with the chosen skill.',\n            modifiers: () => [{\n                turns: 1,\n                consumeId: '',\n                enabled: false,\n                value: -1,\n                name: 'Take Charge: Critical Failure',\n                type: 'circumstance',\n            }],\n        },\n    },\n};\n\ninterface CreateResourceButton {\n    type: RolledResources,\n    mode?: ResourceMode,\n    turn?: ResourceTurn,\n    value: string,\n    hints?: string;\n}\n\nexport function gainXp(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'xp'});\n}\n\nexport function gainFame(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'fame'});\n}\n\nexport function loseFame(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'fame', mode: 'lose'});\n}\n\nexport function gainCommodities(type: keyof Commodities, value: number | string): string {\n    return createResourceButton({value: `${value}`, type});\n}\n\nexport function loseCommodities(type: keyof Commodities, value: number | string): string {\n    return createResourceButton({value: `${value}`, type, mode: 'lose'});\n}\n\nexport function gainRuin(type: Ruin, value: number | string): string {\n    return createResourceButton({value: `${value}`, type});\n}\n\nexport function loseRuin(type: Ruin, value: number | string): string {\n    return createResourceButton({value: `${value}`, type, mode: 'lose'});\n}\n\nexport function gainRolledRD(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'rolled-resource-dice'});\n}\n\nexport function loseRolledRD(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'rolled-resource-dice', mode: 'lose'});\n}\n\nexport function gainRP(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'resource-points'});\n}\n\nexport function loseRP(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'resource-points', mode: 'lose'});\n}\n\nexport function gainUnrest(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'unrest'});\n}\n\nexport function loseUnrest(value: number | string): string {\n    return createResourceButton({value: `${value}`, type: 'unrest', mode: 'lose'});\n}\n\nexport function gainSolution(type: 'creative-solution' | 'supernatural-solution'): string {\n    return createResourceButton({value: '1', type, mode: 'gain'});\n}\n\nexport function createResourceButton({turn = 'now', value, mode = 'gain', type, hints}: CreateResourceButton): string {\n    const turnLabel = turn === 'now' ? '' : ' Next Turn';\n    const label = `${mode === 'gain' ? 'Gain' : 'Lose'} ${value} ${unslugify(type)}${turnLabel}`;\n    return `<button type=\"button\" class=\"km-gain-lose\" \n        data-type=\"${type}\"\n        data-mode=\"${mode}\"\n        data-turn=\"${turn}\"\n        ${value !== undefined ? `data-value=\"${value}\"` : ''}\n        >${label}${hints !== undefined ? `(${hints})` : ''}</button>`;\n}\n\nexport function getKingdomActivitiesById(additionalActivities: KingdomActivity[]): KingdomActivityById {\n    return <KingdomActivityById>Object.fromEntries(getKingdomActivities(additionalActivities)\n        .map(activity => [activity.id, activity]));\n}\n\nexport function getKingdomActivities(additionalActivities: KingdomActivity[]): KingdomActivity[] {\n    const homebrewIds = new Set(additionalActivities.map(a => a.id));\n    return Array.from(Object.entries(activityData))\n        .filter(([id]) => !homebrewIds.has(id))\n        .map(([id, activity]) => {\n            return {\n                id,\n                ...activity,\n            };\n        })\n        .concat(additionalActivities);\n}","import {Skill} from './skills';\nimport {Leader} from './leaders';\nimport {Leaders, LeaderValues} from './kingdom';\nimport {mergeObjects} from '../../utils';\nimport {getStringArraySetting} from '../../settings';\n\nconst allActorTypes = [\n    'pc',\n    'npc',\n    'companion',\n] as const;\n\nexport type ActorTypes = typeof allActorTypes[number];\n\nexport const allCompanions = [\n    'Amiri',\n    'Ekundayo',\n    'Harrim',\n    'Jaethal',\n    'Jubilost',\n    'Kalikke',\n    'Kanerah',\n    'Linzi',\n    'Nok-Nok',\n    'Octavia',\n    'Regongar',\n    'Tristian',\n    'Valerie',\n] as const;\n\nexport type Companion = typeof allCompanions[number];\n\nexport function isCompanionName(name: string): name is Companion {\n    return allCompanions.includes(name as Companion);\n}\n\nexport type UnlockSkills = Partial<Record<Skill, string[]>>;\n\nexport interface CompanionUnlock {\n    activities: string[];\n    actionSkills: UnlockSkills;\n    roles: Set<Leader>;\n}\n\nexport const companionActivityUnlocks: Record<Companion, CompanionUnlock> = {\n    'Harrim': {activities: ['evangelize-the-dead'], actionSkills: {}, roles: new Set(['magister'])},\n    'Jaethal': {activities: ['decadent-feasts'], actionSkills: {}, roles: new Set(['emissary'])},\n    'Kalikke': {activities: ['deliberate-planning'], actionSkills: {}, roles: new Set(['counselor'])},\n    'Kanerah': {activities: ['false-victory'], actionSkills: {}, roles: new Set(['emissary'])},\n    'Regongar': {activities: ['show-of-force'], actionSkills: {}, roles: new Set(['general'])},\n    'Valerie': {activities: ['warfare-exercises'], actionSkills: {}, roles: new Set(['general'])},\n    'Tristian': {activities: ['preventative-measures'], actionSkills: {}, roles: new Set(['magister'])},\n    'Linzi': {activities: ['spread-the-legend'], actionSkills: {}, roles: new Set(['counselor'])},\n    'Jubilost': {activities: ['process-hidden-fees'], actionSkills: {}, roles: new Set(['treasurer'])},\n    'Nok-Nok': {activities: ['recruit-monsters'], actionSkills: {}, roles: new Set(['emissary'])},\n    'Ekundayo': {activities: ['supplementary-hunting'], actionSkills: {}, roles: new Set(['general', 'warden'])},\n    'Amiri': {activities: [], actionSkills: {}, roles: new Set(['warden'])},\n    'Octavia': {\n        activities: [],\n        actionSkills: {magic: ['celebrate-holiday', 'craft-luxuries', 'create-a-masterpiece', 'rest-and-relax']},\n        roles: new Set(['magister']),\n    },\n};\n\nfunction getCompanionUnlock(role: Leader, values: LeaderValues): CompanionUnlock | undefined {\n    const leaderName = values.name;\n    const unlock = leaderName in companionActivityUnlocks ? companionActivityUnlocks[leaderName as Companion] : undefined;\n    if (values.type === 'companion' && unlock?.roles?.has(role)) {\n        return unlock;\n    } else {\n        return undefined;\n    }\n}\n\nfunction getCompanionUnlocks(leaders: Leaders, alwaysEnableCompanionNames: Set<Companion>): CompanionUnlock[] {\n    const overridenUnlocks = Array.from(alwaysEnableCompanionNames)\n        .map(name => companionActivityUnlocks[name]) as CompanionUnlock[];\n    const leaderUnlocks = (Object.entries(leaders) as [Leader, LeaderValues][])\n        .flatMap(([role, values]) => {\n            const unlock = getCompanionUnlock(role, values);\n            const companionName = values.name;\n            const overridden = isCompanionName(companionName) && alwaysEnableCompanionNames.has(companionName);\n            if (!overridden && unlock) {\n                return unlock;\n            } else {\n                return [];\n            }\n        });\n    return [...leaderUnlocks, ...overridenUnlocks];\n}\n\nfunction checkCompanionRoleInvested(leader: Leader, values: LeaderValues): boolean {\n    if (values.type === 'companion') {\n        return getCompanionUnlock(leader, values) !== undefined;\n    } else {\n        return values.invested;\n    }\n}\n\nexport function applyLeaderCompanionRules(leaders: Leaders): Leaders {\n    return {\n        counselor: {...leaders.counselor, invested: checkCompanionRoleInvested('counselor', leaders.counselor)},\n        emissary: {...leaders.emissary, invested: checkCompanionRoleInvested('emissary', leaders.emissary)},\n        general: {...leaders.general, invested: checkCompanionRoleInvested('general', leaders.general)},\n        magister: {...leaders.magister, invested: checkCompanionRoleInvested('magister', leaders.magister)},\n        ruler: {...leaders.ruler, invested: checkCompanionRoleInvested('ruler', leaders.ruler)},\n        treasurer: {...leaders.treasurer, invested: checkCompanionRoleInvested('treasurer', leaders.treasurer)},\n        viceroy: {...leaders.viceroy, invested: checkCompanionRoleInvested('viceroy', leaders.viceroy)},\n        warden: {...leaders.warden, invested: checkCompanionRoleInvested('warden', leaders.warden)},\n    };\n}\n\nexport function getCompanionUnlockActivities(leaders: Leaders, alwaysEnableCompanionNames: Set<Companion>): string[] {\n    return getCompanionUnlocks(leaders, alwaysEnableCompanionNames)\n        .flatMap(unlock => unlock.activities);\n}\n\nexport function getCompanionSkillUnlocks(leaders: Leaders, alwaysEnableCompanionNames: Set<Companion>): UnlockSkills {\n    return getCompanionUnlocks(leaders, alwaysEnableCompanionNames)\n        .map(unlock => unlock.actionSkills)\n        .reduce((prev, curr) => mergeObjects(prev, curr, (a, b) => [...a, ...b]), {});\n}\n\nexport function getOverrideUnlockCompanionNames(game: Game): Set<Companion> {\n    const setting = getStringArraySetting(game, 'forceEnabledCompanionLeadershipBenefits')\n        .filter(isCompanionName);\n    return new Set<Companion>(setting);\n}","import {capitalize} from '../../utils';\nimport {allSkills} from './skills';\nimport {Modifier} from '../modifiers';\n\nexport interface KingdomFeat {\n    name: string;\n    level: number;\n    text: string;\n    prerequisites?: string;\n    automationNotes?: string;\n    modifiers?: Modifier[];\n}\n\n\nfunction generateForAllSkills(feat: KingdomFeat): KingdomFeat[] {\n    return allSkills.map(skill => {\n\n        return {\n            ...feat,\n            name: `${feat.name} (${capitalize(skill)})`,\n        };\n    });\n}\n\nexport const allFeats: KingdomFeat[] = [\n    {\n        name: '-',\n        level: 0,\n        text: '',\n    },\n    {\n        automationNotes: 'Vacancy role penalty removal is not automated',\n        name: 'Civil Service',\n        level: 1,\n        text: `Everyone has a place and a role, and as long as those roles are filled, the government functions. When you\nselect this feat, choose one leadership role; that role is now supported by your efficient civil servants, so its vacancy penalty is no longer applicable. If you wish to change the leadership role to which Civil Service applies, you can do so using the New Leadership activity at the start of a Kingdom turn. You gain a +2 circumstance bonus to New Leadership checks.`,\n        modifiers: [{\n            name: 'Swapping Civil Service',\n            enabled: false,\n            value: 2,\n            type: 'circumstance',\n            activities: ['new-leadership'],\n        }],\n    },\n    {\n        name: 'Cooperative Leadership',\n        level: 1,\n        text: `Your leaders are skilled at working with one another. When a leader uses the Focused Attention kingdom\nactivity to aid another leaders kingdom check, the circumstance bonus granted by a success is increased to +3.\nAt 11th level, your leaders collaborative style leads them to ever greater successes when they work together. When a leader uses the Focused Attention kingdom activity to aid another leaders check, treat a critical failure on the aided check as a failure. If your kingdom has at least the expert rank in the skill used in the aided check, treat a failure on the check as a success. (This\ndoes not allow you to ever improve a critical failure to a success.)`,\n    },\n    {\n        name: 'Crush Dissent',\n        level: 1,\n        prerequisites: 'Trained in Warfare',\n        text: `Your rule brooks no dissent and stamps out traitors, making harsh examples of them. Once per Kingdom\nturn when you gain Unrest, you can attempt to crush the dissent by attempting a basic Warfare check. On a success, the Unrest increase is canceled, but on a critical failure, the Unrest increase is doubled. In addition, you gain a +1 circumstance bonus to checks to resolve dangerous kingdom events that involve internal bickering, such as Feud.`,\n        modifiers: [{\n            name: 'Dangerous Kingdom Event involving internal bickering',\n            enabled: false,\n            value: 1,\n            type: 'circumstance',\n            phases: ['event'],\n        }],\n    },\n    {\n        name: 'Fortified Fiefs',\n        level: 1,\n        prerequisites: 'Trained in Defense',\n        text: `Your vassals take their duty to protect those under their stewardship seriously, and your engineers emphasize\nthe value of a strong defense when it comes to building settlements and fortifications. You gain a +2 circumstance bonus to checks attempted as part of the Fortify Hex activity and on activities to build or repair a Barracks, Castle, Garrison, Keep, Stone Wall, or Wooden Wall. In addition, you gain a +1 circumstance bonus to all kingdom checks attempted during dangerous events that directly impact\nyour settlements defenses.`,\n        modifiers: [{\n            name: 'Fortified Fiefs',\n            type: 'circumstance',\n            activities: ['fortify-hex'],\n            enabled: true,\n            value: 2,\n        }, {\n            name: 'Build or repair a Barracks, Castle, Garrison, Keep, Stone Wall, or Wooden Wall',\n            type: 'circumstance',\n            activities: ['build-structure'],\n            enabled: false,\n            value: 2,\n        }, {\n            name: 'Dangerous Event impacting settlement defenses',\n            type: 'circumstance',\n            phases: ['event'],\n            enabled: false,\n            value: 1,\n        }],\n    },\n    {\n        name: 'Insider Trading',\n        level: 1,\n        prerequisites: 'Trained in Industry',\n        text: `Your leading citizens share valuable business information with one another and with associates in\nother lands, and they hire one anothers workers to supply the labor they need to fuel their production. You gain a +1 circumstance bonus to Establish Work Site, Establish Trade Agreement, and Trade Commodities activities. In addition, gain 1 bonus Resource Die at the start of each Kingdom turn.`,\n        modifiers: [{\n            name: 'Insider Trading',\n            type: 'circumstance',\n            activities: ['establish-work-site-quarry', 'establish-work-site-lumber', 'establish-work-site-mine', 'establish-trade-agreement', 'trade-commodities'],\n            enabled: true,\n            value: 1,\n        }],\n    },\n    {\n        automationNotes: 'You need to manually increase the ruin thresholds',\n        name: 'Muddle Through',\n        level: 1,\n        prerequisites: 'Trained in Wilderness',\n        text: 'Your people are independent-minded and take care of the small things around the kingdom, not letting them pile up into bigger problems. Increase two of your Ruin thresholds by 1 and one of them by 2.',\n    },\n    {\n        automationNotes: 'Hire Adventurers RP reduction is not implemented',\n        name: 'Practical Magic',\n        level: 1,\n        prerequisites: 'Trained in Magic',\n        text: `Magic has an honored place in your society, and your people incorporate it into their everyday work to make\nlife easier. You gain a +1 circumstance bonus to Magic checks, and you can use Magic checks in place of Engineering checks. In addition, as magic-wielding NPCs find your nation a comfortable place to live and work, you reduce the cost of using the Hire Adventurers activity to 1 RP.`,\n        modifiers: [{\n            name: 'Practical Magic',\n            type: 'circumstance',\n            skills: ['magic'],\n            enabled: true,\n            value: 1,\n        }],\n    },\n    {\n        automationNotes: 'Nothing automated',\n        name: 'Pull Together',\n        level: 1,\n        prerequisites: 'Trained in Politics',\n        text: `Your people are very reliable, and their swift decisionmaking keeps most projects from getting too\nfar off track. Once per Kingdom turn when you roll a critical failure on a Kingdom skill check, attempt a DC 11 flat check. If this succeeds, your citizens heed the call to put in extra work to mitigate the disaster; treat the Kingdom skill check result as failure instead. The DC of this flat check increases by 5 each time you subsequently use it, but it decreases by 1 (to a minimum of 11) for each Kingdom turn that passes when you do not use it.`,\n    },\n    ...generateForAllSkills({\n        // not automated: choose skill\n        automationNotes: 'You need to manually increase the skill proficiency',\n        name: 'Skill Training',\n        level: 1,\n        text: `Your kingdom receives the trained proficiency rank in a Kingdom skill of your choice. You can select this feat\nmultiple times, choosing a new skill each time.`,\n    }),\n    {\n        automationNotes: 'If your kingdoms Unrest is 6 or higher and you use a kingdom activity that decreases Unrest, decrease the Unrest by an additional 1 is not automated.',\n        name: 'Endure Anarchy',\n        level: 3,\n        prerequisites: 'Loyalty 14',\n        text: 'Your kingdom holds together even in the midst of extreme peril. If your kingdoms Unrest is 6 or higher and you use a kingdom activity that decreases Unrest, decrease the Unrest by an additional 1. You do not fall into anarchy unless your kingdoms Unrest reaches 24',\n    },\n    {\n        name: 'Inspiring Entertainment',\n        level: 3,\n        prerequisites: 'Culture 14',\n        text: `Your kingdoms artists and entertainers are talented and prolific, and theres never a shortage of new plays, operas, novels, music, sculptures, paintings, or other forms of distraction to entertain the citizens, even during\ntimes of upheaval. Your kingdom gains a +2 circumstance bonus to all Culture-based skill checks whenever your kingdom has at least 1 Unrest.`,\n        modifiers: [{\n            name: 'Inspiring Entertainment',\n            type: 'circumstance',\n            enabled: true,\n            abilities: ['culture'],\n            value: 2,\n        }],\n    },\n    ...generateForAllSkills({\n        name: 'Kingdom Assurance',\n        automationNotes: 'You need to manually choose Assurance in the modifier popup',\n        level: 1,\n        text: `Even when things go poorly in other areas, you can count on consistency in carrying out kingdom activities\nwith a chosen skill. Choose one Kingdom skill in which your kingdom is trained. Once per Kingdom turn, when you would attempt a skill check for that skill, you can forgo rolling and instead take a result equal to 10 + your proficiency bonus; do not apply any other bonuses, penalties, or modifiers to this result. Special You can select this feat multiple times. Each time, choose a different skill and gain the benefits of this feat for that skill.`,\n    }),\n    {\n        automationNotes: 'Not automated',\n        name: 'Liquidate Resources',\n        level: 3,\n        prerequisites: 'Economy 14',\n        text: `Your kingdoms economy can liquidate resources in an emergency when funding runs out. The first time during\na Kingdom turn in which you are forced to spend RP as the result of a failed skill check or a dangerous event, and that expense reduces you to 0 RP, you may instead reduce your RP to 1 and treat the expense as if it were paid in full. At the start of your next Kingdom turn, roll 4 fewer Resource Dice than normal.`,\n    },\n    {\n        name: 'Quick Recovery',\n        level: 3,\n        prerequisites: 'Stability 14',\n        text: 'Your kingdom recovers more quickly from danger and disaster. Whenever you attempt a skill check to end an ongoing harmful kingdom event, you gain a +4 circumstance bonus to the check.',\n        modifiers: [{\n            name: 'Ongoing Harmful Event',\n            type: 'circumstance',\n            enabled: false,\n            phases: ['event'],\n            value: 4,\n        }],\n    },\n    {\n        automationNotes: 'Re-rolling a failure or crit failure for 2 RP is not automated',\n        name: 'Free and Fair',\n        level: 7,\n        text: 'Your reputation for transparency and fairness in conducting elections, appointments, and other changes in government inspires tremendous public trust. You gain a +2 circumstance bonus to Loyalty-based checks attempted as part of the New Leadership and Pledge of Fealty activities. If you fail or critically fail such a check, you can spend 2 RP to reroll the check (but without the +2 circumstance bonus); attempting this adds the Fortune trait. You must take the result of the second roll, even if it is worse than the original roll.',\n        modifiers: [{\n            name: 'Loyalty Based Skill',\n            type: 'circumstance',\n            abilities: ['loyalty'],\n            activities: ['new-leadership'],\n            enabled: true,\n            value: 2,\n        }, {\n            name: 'Loyalty Based Skill',\n            type: 'circumstance',\n            abilities: ['loyalty'],\n            activities: ['pledge-of-fealty'],\n            enabled: true,\n            value: 2,\n        }],\n    },\n    {\n        automationNotes: 'First time you get luxuries is not automated',\n        name: 'Quality of Life',\n        level: 7,\n        text: 'Your kingdoms robust economy makes the creature comforts of civilization more readily available to all, and even finer luxuries are more easily had. The first time you gain Luxury Commodities in a Kingdom turn, increase the total gained by 1. All of your settlements are treated as 1 level higher than their actual level for the purposes of determining what sorts of magic items might be offered for sale at their markets and shops.',\n    },\n    {\n        automationNotes: 'You do not get 1 extra RP at the start of your next turn on a critical success',\n        name: 'Fame and Fortune',\n        level: 11,\n        text: 'Your kingdoms reputation has spread far and wide, bringing in visitors to behold the spectacle of your greatness and pay their respects. Whenever you achieve a critical success on any Kingdom skill check during the Activity phase of a Kingdom turn, gain 1 bonus Resource Die at the start of your next Kingdom turn.',\n    },\n];\n\nexport const allFeatsByName = Object.fromEntries((allFeats)\n    .map((feat) => [feat.name, feat]));\n\n","import {distinctBy, groupBy} from '../../utils';\n\ninterface KingdomFeature {\n    level: number;\n    name: string;\n    description: string;\n}\n\nfunction kingdomFeat(level: number): KingdomFeature {\n    return {\n        level,\n        name: 'Kingdom Feat',\n        description: 'At 2nd level, and then every 2 levels thereafter, the kingdom gains a Kingdom feat.',\n    };\n}\n\nfunction skillIncrease(level: number): KingdomFeature {\n    return {\n        level,\n        name: 'Skill Increase',\n        description: 'your kingdom gains a skill increase. You can use this to increase your rank to trained in one skill in which your kingdom is untrained, or to increase your rank to expert in one skill in which your kingdom is trained. Starting at 7th level, you can use your skill increases to increase your kingdoms proficiency to master in a skill in which your kingdom is already an expert. Beginning at 15th level, you can use them to increase your proficiency to legendary in a skill in which your kingdom is already a master.',\n    };\n}\n\nfunction abilityBoosts(level: number): KingdomFeature {\n    return {\n        level,\n        name: 'Ability Boosts',\n        description: 'At 5th level and every 5 levels thereafter, you boost two different kingdom ability scores. You can use these ability boosts to increase your kingdoms ability scores above 18. Boosting an ability score increases it by 2 if it starts out below 18, or by 1 if its already 18 or above.',\n    };\n}\n\nfunction settlementConstruction(level: number, type: string): KingdomFeature {\n    return {\n        level,\n        name: `Settlement Construction (${type})`,\n        description: 'You can establish villages in your kingdom immediately. At 3rd level, you can expand villages into towns. At 9th level, you can expand towns into cities. expand towns into cities. And at 15th level, you can expand cities into metropolises. As villages grow into larger settlements, you not only gain more room to build, but the maximum item bonus you can gain from that settlements structures increases as well',\n    };\n}\n\nfunction ruinResistance(level: number): KingdomFeature {\n    return {\n        level,\n        name: 'Ruin Resistance',\n        description: 'At 5th level and every 3 levels thereafter, your kingdom becomes more resistant to Ruin. Choose one of the four Ruin categories and increase its threshold by 2. When you do so, reset that Ruins penalty to 0. See page 38 for more information about Ruin.',\n    };\n}\n\nfunction expansionExpert(level: number, hexes: number): KingdomFeature {\n    return {\n        level,\n        name: `Expansion Expert (+${hexes})`,\n        description: 'Your kingdom is better at expanding its territory. You gain a +2 circumstance bonus to skill checks made to Claim Hex and can attempt to Claim Hex up to twice during a Kingdom turn. At 9th level, you can attempt to Claim Hex up to three times during a Kingdom turn.',\n    };\n}\n\nfunction experiencedLeadership(level: number, bonus: number): KingdomFeature {\n    return {\n        level,\n        name: `Experienced Leadership (+${bonus})`,\n        description: 'Invested leadership roles in your kingdom now grant a +2 status bonus to kingdom checks associated with their leadership roles key ability. At 16th level, this increases to a +3 status bonus.',\n    };\n}\n\n\nexport const features: KingdomFeature[] = [\n    // 1\n    {\n        level: 1,\n        name: 'Charter',\n        description: 'Your kingdom gains the benefits of your selected charter',\n    },\n    {\n        level: 1,\n        name: 'Government',\n        description: 'Your kingdom gains the benefits of your selected government',\n    },\n    {\n        level: 1,\n        name: 'Government',\n        description: 'Your kingdom gains the benefits of your selected heartland',\n    },\n    {\n        level: 1,\n        name: 'Initial Proficiencies',\n        description: 'At 1st level, a kingdom receives the trained proficiency rank in two Kingdom skills gained from your initial choice of government and in up to four additional Kingdom skills determined by your invested leaders, giving you a proficiency bonus to checks using these skills equal to your kingdom level plus 2. Proficiencies cannot be changed, even if the kingdoms government or leaders later change.',\n    },\n    {\n        level: 1,\n        name: 'Favored Land',\n        description: 'Your heartlands terrain becomes your kingdoms favored landthe wilderness terrain that your people feel the strongest emotional ties to and to which your resource gatherers tend to flock. Once per Kingdom turn, during the Region Activities step of the Activity phase, you can attempt two Region activities simultaneously as long as both activities take place in the same hex and that hex contains the same terrain as your heartland. You take a 2 penalty to Kingdom skill checks made during these two activities.',\n    },\n    settlementConstruction(1, 'Village'),\n    // 2\n    kingdomFeat(2),\n    // 3\n    settlementConstruction(3, 'Town'),\n    skillIncrease(3),\n    // 4\n    expansionExpert(4, 2),\n    {\n        level: 4,\n        name: 'Fine Living',\n        description: 'Your people celebrate by indulging you with feasts and finery. All PCs associated with the kingdom enjoy a Fine standard of living at no cost whenever theyre in the kingdom. Any PCs in hostile wilderness, a monsterfilled dungeon, or otherwise cut off from their citizens must provide their own sustenance as usual even if they are within the boundaries of their kingdom. You gain a +1 circumstance bonus to all checks made to Craft or Earn Income while in your kingdom.',\n    },\n    kingdomFeat(4),\n    // 5\n    abilityBoosts(5),\n    ruinResistance(5),\n    skillIncrease(5),\n    // 6\n    kingdomFeat(6),\n    // 7\n    skillIncrease(7),\n    // 8\n    experiencedLeadership(8, 2),\n    kingdomFeat(8),\n    ruinResistance(8),\n    // 9\n    expansionExpert(9, 3),\n    settlementConstruction(9, 'City'),\n    skillIncrease(9),\n    // 10\n    abilityBoosts(10),\n    kingdomFeat(10),\n    {\n        level: 10,\n        name: 'Life of Luxury',\n        description: 'Your people lavish you with every creature comfort. This is identical to Fine Living, but all PC leaders enjoy an Extravagant standard of living at no cost whenever theyre in the kingdom. You gain a +2 circumstance bonus to all checks made to Craft or Earn Income while in your kingdom.',\n    },\n    // 11\n    ruinResistance(11),\n    skillIncrease(11),\n    // 12\n    {\n        level: 12,\n        name: 'Civic Planning',\n        description: 'During the Civic Activities step of the Activities phase of a Kingdom turn, one settlement of the partys choice can attempt two Civic activities rather than one. The second Civic activity occurs after all other settlements have taken their individual Civic activities.',\n    },\n    kingdomFeat(12),\n    // 13\n    skillIncrease(13),\n    // 14\n    kingdomFeat(14),\n    ruinResistance(14),\n    // 15\n    abilityBoosts(15),\n    settlementConstruction(15, 'Metropolis'),\n    skillIncrease(15),\n    // 16\n    experiencedLeadership(16, 3),\n    kingdomFeat(16),\n    // 17\n    ruinResistance(17),\n    skillIncrease(17),\n    // 18\n    kingdomFeat(18),\n    // 19\n    skillIncrease(19),\n    // 20\n    abilityBoosts(20),\n    {\n        level: 20,\n        name: 'Envy of the World',\n        description: 'Your kingdom is one of the worlds prominent nations. The first time in a Kingdom turn when your kingdom would gain Unrest or Ruin, ignore that increase. You can ignore additional increases to Unrest or Ruin later in the same turn as well, but you must spend a Fame or Infamy point each time you do so. Your maximum Fame or Infamy point total increases by 1.',\n    },\n    kingdomFeat(20),\n    ruinResistance(20),\n];\n\nexport const featuresByLevel = groupBy(features, f => f.level);\nexport const uniqueFeatures = distinctBy(features, f => f.name);\n","import {ActorTypes} from './companions';\nimport {Leader} from './leaders';\nimport {getKingdomActivities, KingdomActivity} from './activityData';\nimport {AbilityScores} from './abilities';\nimport {Modifier} from '../modifiers';\n\nexport type ResourceDieSize = 'd4' | 'd6' | 'd8' | 'd10' | 'd12';\n\nexport interface KingdomSizeData {\n    sizeFrom: number;\n    sizeTo?: number;\n    type: 'territory' | 'province' | 'state' | 'country' | 'dominion';\n    resourceDieSize: ResourceDieSize;\n    controlDCModifier: number;\n    commodityCapacity: number;\n}\n\nexport type Leaders = Record<Leader, LeaderValues>;\n\nexport interface LeaderValues {\n    name: string;\n    invested: boolean;\n    type: ActorTypes;\n    vacant: boolean;\n}\n\nexport interface RuinValues {\n    value: number;\n    penalty: number;\n    threshold: number;\n}\n\nexport interface Ruin {\n    corruption: RuinValues;\n    crime: RuinValues;\n    decay: RuinValues;\n    strife: RuinValues;\n}\n\n\nexport interface WorkSite {\n    quantity: number;\n    resources: number;\n}\n\nexport interface WorkSites {\n    farmlands: WorkSite;\n    lumberCamps: WorkSite;\n    mines: WorkSite;\n    quarries: WorkSite;\n    luxurySources: WorkSite;\n}\n\nexport interface Resources {\n    now: number;\n    next: number;\n}\n\nexport interface Commodities {\n    food: number;\n    lumber: number;\n    luxuries: number;\n    ore: number;\n    stone: number;\n}\n\nexport interface Group {\n    name: string;\n    negotiationDC: number;\n    atWar: boolean;\n    relations: 'none' | 'diplomatic-relations' | 'trade-agreement';\n}\n\nexport interface SkillRanks {\n    agriculture: number;\n    arts: number;\n    boating: number;\n    defense: number;\n    engineering: number;\n    exploration: number;\n    folklore: number;\n    industry: number;\n    intrigue: number;\n    magic: number;\n    politics: number;\n    scholarship: number;\n    statecraft: number;\n    trade: number;\n    warfare: number;\n    wilderness: number;\n}\n\nexport const allHeartlands = [\n    'forest-or-swamp',\n    'hill-or-plain',\n    'lake-or-river',\n    'mountain-or-ruins',\n] as const;\n\nexport type Heartland = typeof allHeartlands[number];\n\nexport const allFameTypes = ['famous', 'infamous'] as const;\n\nexport type FameType = typeof allFameTypes[number];\n\nexport interface Feat {\n    id: string;\n    level: number;\n}\n\nexport interface BonusFeat {\n    id: string;\n}\n\nexport interface MileStone {\n    name: string;\n    xp: number;\n    completed: boolean;\n    homebrew: boolean;\n}\n\nexport interface OngoingEvent {\n    name: string;\n}\n\nexport interface Settlement {\n    sceneId: string;\n    lots: number;\n    level: number;\n    type: 'capital' | 'settlement';\n    secondaryTerritory: boolean;\n    manualSettlementLevel?: boolean;\n    waterBorders: number;\n}\n\nexport interface Kingdom {\n    name: string;\n    atWar: boolean;\n    charter: string;\n    government: string;\n    fame: {\n        now: number;\n        next: number;\n        type: FameType;\n    };\n    level: number;\n    xpThreshold: number;\n    xp: number;\n    size: number;\n    unrest: number;\n    resourcePoints: Resources;\n    resourceDice: Resources;\n    workSites: WorkSites;\n    heartland: Heartland;\n    realmSceneId: string | null;\n    consumption: {\n        armies: number;\n        now: number;\n        next: number;\n    };\n    notes: {\n        public: string;\n        gm: string;\n    };\n    homebrewActivities: KingdomActivity[];\n    supernaturalSolutions: number;\n    turnsWithoutCultEvent: number;\n    creativeSolutions: number;\n    leaders: Leaders;\n    commodities: {\n        now: Commodities;\n        next: Commodities;\n    };\n    groups: Group[];\n    feats: Feat[];\n    bonusFeats: BonusFeat[];\n    skillRanks: SkillRanks;\n    abilityScores: AbilityScores;\n    ruin: Ruin;\n    activeSettlement: string;\n    milestones: MileStone[];\n    ongoingEvents: OngoingEvent[];\n    turnsWithoutEvent: number;\n    activityBlacklist: string[];\n    modifiers: Modifier[];\n    settlements: Settlement[];\n}\n\n\ninterface KingdomLevelData {\n    claimHexAttempts: number;\n    claimHexCircumstanceBonus: number;\n    investedLeadershipBonus: number;\n    resourceDice: number;\n}\n\nexport function getLevelData(kingdomLevel: number): KingdomLevelData {\n    const claimHexAttempts = kingdomLevel < 4 ? 1 : (kingdomLevel < 9 ? 2 : 3);\n    const claimHexCircumstanceBonus = kingdomLevel < 4 ? 0 : 2;\n    const investedLeadershipBonus = kingdomLevel < 8 ? 1 : (kingdomLevel < 16 ? 2 : 3);\n    return {\n        claimHexAttempts,\n        claimHexCircumstanceBonus,\n        investedLeadershipBonus,\n        resourceDice: kingdomLevel + 4,\n    };\n}\n\nexport const kingdomSizeData: KingdomSizeData[] = [{\n    sizeFrom: 0,\n    sizeTo: 9,\n    type: 'territory',\n    resourceDieSize: 'd4',\n    controlDCModifier: 0,\n    commodityCapacity: 4,\n}, {\n    sizeFrom: 10,\n    sizeTo: 24,\n    type: 'province',\n    resourceDieSize: 'd6',\n    controlDCModifier: 1,\n    commodityCapacity: 8,\n}, {\n    sizeFrom: 25,\n    sizeTo: 49,\n    type: 'state',\n    resourceDieSize: 'd8',\n    controlDCModifier: 2,\n    commodityCapacity: 12,\n}, {\n    sizeFrom: 50,\n    sizeTo: 99,\n    type: 'country',\n    resourceDieSize: 'd10',\n    controlDCModifier: 3,\n    commodityCapacity: 16,\n}, {\n    sizeFrom: 100,\n    type: 'dominion',\n    resourceDieSize: 'd12',\n    controlDCModifier: 4,\n    commodityCapacity: 20,\n}];\n\nexport function getSizeData(kingdomSize: number): KingdomSizeData {\n    return kingdomSizeData.find(d => kingdomSize >= d.sizeFrom\n        && kingdomSize <= (d.sizeTo ?? Number.MAX_SAFE_INTEGER))!;\n}\n\nexport function getControlDC(level: number, size: number, leaderVacant: boolean): number {\n    const sizeModifier = getSizeData(size).controlDCModifier;\n    const adjustedLevel = level < 5 ? level - 1 : level;\n    const vacancyPenalty = leaderVacant ? 2 : 0;\n    return 14 + adjustedLevel + Math.floor(adjustedLevel / 3) + sizeModifier + vacancyPenalty;\n}\n\nfunction getDefaultMilestones(): MileStone[] {\n    return [\n        {name: 'Build Roads for the first time', xp: 20, completed: false, homebrew: true},\n        {name: 'Build your first Famous/Infamous Structure', xp: 20, completed: false, homebrew: true},\n        {\n            name: 'Build your first seat of government (Town Hall, Castle, or Palace)',\n            xp: 20,\n            completed: false,\n            homebrew: true,\n        },\n        {\n            name: 'Build your first Structure requiring Expert in a Kingdom Skill',\n            xp: 20,\n            completed: false,\n            homebrew: true,\n        },\n        {name: 'Celebrate your first successful Holiday', xp: 20, completed: false, homebrew: true},\n        {name: 'Claim your first new Hex (2nd hex overall)', xp: 20, completed: false, homebrew: true},\n        {name: 'Complete your First successful Infiltration', xp: 20, completed: false, homebrew: true},\n        {name: 'Create your first Masterpiece', xp: 20, completed: false, homebrew: true},\n        {name: 'Establish your first Farmland', xp: 20, completed: false, homebrew: true},\n        {name: 'Establish your first Lumber Camp', xp: 20, completed: false, homebrew: true},\n        {name: 'Establish your first Mine', xp: 20, completed: false, homebrew: true},\n        {name: 'Establish your first Quarry', xp: 20, completed: false, homebrew: true},\n        {name: 'Fortify your first hex', xp: 20, completed: false, homebrew: true},\n        {name: 'Successfully use your first Creative Solution', xp: 20, completed: false, homebrew: true},\n        {name: 'Successfully use your first Supernatural Solution', xp: 20, completed: false, homebrew: true},\n\n        {name: 'Claim your first Landmark', xp: 40, completed: false, homebrew: false},\n        {name: 'Claim your first Refuge', xp: 40, completed: false, homebrew: false},\n        {name: 'Establish your first village', xp: 40, completed: false, homebrew: false},\n        {name: 'Establish your second Village', xp: 40, completed: false, homebrew: true},\n        {name: 'Reach kingdom Size 10', xp: 40, completed: false, homebrew: false},\n        {name: 'Recruit your first regular Army', xp: 40, completed: false, homebrew: true},\n        {name: 'Successfully resolve a random Kingdom Event', xp: 40, completed: false, homebrew: true},\n\n        {name: 'Achieve your first successful Pledge of Fealty', xp: 60, completed: false, homebrew: true},\n        {name: 'All eight leadership roles are assigned', xp: 60, completed: false, homebrew: false},\n        {\n            name: 'Build your first Structure requiring Master in a Kingdom Skill',\n            xp: 60,\n            completed: false,\n            homebrew: true,\n        },\n        {name: 'Establish diplomatic relations for the first time', xp: 60, completed: false, homebrew: false},\n        {name: 'Expand a village into your first town', xp: 60, completed: false, homebrew: false},\n        {name: 'Reach kingdom Size 25', xp: 60, completed: false, homebrew: false},\n        {name: 'Recruit your first Specialized Army', xp: 60, completed: false, homebrew: true},\n        {name: 'Win your first War Encounter', xp: 60, completed: false, homebrew: true},\n\n        {name: 'Establish your first trade agreement', xp: 80, completed: false, homebrew: false},\n        {name: 'Expand a town into your first city', xp: 80, completed: false, homebrew: false},\n        {name: 'Reach kingdom Size 50', xp: 80, completed: false, homebrew: false},\n        {name: 'Spend 100 RP during a Kingdom turn', xp: 80, completed: false, homebrew: false},\n        ...getCultEventMilestones(),\n        {name: 'Expand a city into your first metropolis', xp: 120, completed: false, homebrew: false},\n        {name: 'Reach kingdom Size 100', xp: 120, completed: false, homebrew: false},\n    ];\n}\n\nexport function getCultEventMilestones(): MileStone[] {\n    return [\n        {name: 'Cult Event (Chapter 5): Cult Activity', xp: 80, completed: false, homebrew: false},\n        {name: 'Cult Event (Chapter 5): Public Outburst', xp: 80, completed: false, homebrew: false},\n        {name: 'Cult Event (Chapter 5): Too Close to Home', xp: 80, completed: false, homebrew: false},\n        {name: 'Cult Event (Chapter 5): Urban Outburst', xp: 80, completed: false, homebrew: false},\n    ];\n}\n\nexport function getDefaultKingdomData(): Kingdom {\n    return {\n        turnsWithoutEvent: 0,\n        turnsWithoutCultEvent: 0,\n        name: '',\n        atWar: false,\n        charter: '',\n        government: '',\n        activeSettlement: '',\n        notes: {\n            public: '',\n            gm: '',\n        },\n        fame: {\n            type: 'famous',\n            now: 0,\n            next: 0,\n        },\n        supernaturalSolutions: 0,\n        creativeSolutions: 0,\n        level: 1,\n        xpThreshold: 1000,\n        xp: 0,\n        size: 1,\n        unrest: 0,\n        settlements: [],\n        feats: [],\n        bonusFeats: [],\n        ongoingEvents: [],\n        groups: [],\n        milestones: getDefaultMilestones(),\n        realmSceneId: null,\n        workSites: {\n            farmlands: {\n                quantity: 0,\n                resources: 0,\n            },\n            quarries: {\n                quantity: 0,\n                resources: 0,\n            },\n            lumberCamps: {\n                quantity: 0,\n                resources: 0,\n            },\n            mines: {\n                quantity: 0,\n                resources: 0,\n            },\n            luxurySources: {\n                quantity: 0,\n                resources: 0,\n            },\n        },\n        commodities: {\n            now: {\n                food: 0,\n                ore: 0,\n                lumber: 0,\n                stone: 0,\n                luxuries: 0,\n            },\n            next: {\n                food: 0,\n                ore: 0,\n                lumber: 0,\n                stone: 0,\n                luxuries: 0,\n            },\n        },\n        resourceDice: {\n            now: 0,\n            next: 0,\n        },\n        resourcePoints: {\n            next: 0,\n            now: 0,\n        },\n        heartland: 'hill-or-plain',\n        consumption: {\n            armies: 0,\n            now: 0,\n            next: 0,\n        },\n        leaders: {\n            ruler: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            counselor: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            general: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            emissary: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            magister: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            treasurer: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            viceroy: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n            warden: {\n                invested: false,\n                type: 'pc',\n                vacant: false,\n                name: '',\n            },\n        },\n        skillRanks: {\n            agriculture: 0,\n            arts: 0,\n            boating: 0,\n            defense: 0,\n            engineering: 0,\n            exploration: 0,\n            folklore: 0,\n            industry: 0,\n            intrigue: 0,\n            magic: 0,\n            politics: 0,\n            scholarship: 0,\n            statecraft: 0,\n            trade: 0,\n            warfare: 0,\n            wilderness: 0,\n        },\n        abilityScores: {\n            culture: 10,\n            economy: 10,\n            loyalty: 10,\n            stability: 10,\n        },\n        ruin: {\n            corruption: {\n                penalty: 0,\n                threshold: 10,\n                value: 0,\n            },\n            crime: {\n                penalty: 0,\n                threshold: 10,\n                value: 0,\n            },\n            decay: {\n                penalty: 0,\n                threshold: 10,\n                value: 0,\n            },\n            strife: {\n                penalty: 0,\n                threshold: 10,\n                value: 0,\n            },\n        },\n        activityBlacklist: getKingdomActivities([])\n            .filter((data) => !data.enabled && !data.companion)\n            .map((data) => data.id),\n        modifiers: [],\n        homebrewActivities: [],\n    };\n}\n\nexport function hasFeat(kingdom: Kingdom, id: string): boolean {\n    return [...kingdom.feats, ...kingdom.bonusFeats].map(f => f.id).includes(id);\n}\n","import {Ability} from './abilities';\nimport {getLevelData, Leaders} from './kingdom';\n\nexport const allLeaders = [\n    'ruler',\n    'counselor',\n    'general',\n    'emissary',\n    'magister',\n    'treasurer',\n    'viceroy',\n    'warden',\n] as const;\n\nexport type Leader = typeof allLeaders[number];\n\nexport const leaderAbilities: Record<Leader, Ability> = {\n    ruler: 'loyalty',\n    counselor: 'culture',\n    general: 'stability',\n    emissary: 'loyalty',\n    magister: 'culture',\n    treasurer: 'economy',\n    viceroy: 'economy',\n    warden: 'stability',\n};\n\nexport const abilityLeaders: Record<Ability, [Leader, Leader]> = {\n    loyalty: ['ruler', 'emissary'],\n    culture: ['counselor', 'magister'],\n    stability: ['general', 'warden'],\n    economy: ['treasurer', 'viceroy'],\n};\n\nexport function isInvested(ability: Ability, leaders: Leaders): boolean {\n    const relevantLeaders = abilityLeaders[ability];\n    return leaders[relevantLeaders[0]].invested || leaders[relevantLeaders[1]].invested;\n}\n\nexport function calculateInvestedBonus(\n    kingdomLevel: number,\n    ability: Ability,\n    leaders: Leaders,\n): number {\n    const levelData = getLevelData(kingdomLevel);\n    return isInvested(ability, leaders) ? levelData.investedLeadershipBonus : 0;\n}\n","import {Ability} from './abilities';\n\nexport const allRuins = [\n    'corruption',\n    'crime',\n    'decay',\n    'strife',\n] as const;\n\nexport type Ruin = typeof allRuins[number];\n\nexport const ruinAbilities: Record<Ruin, Ability> = {\n    corruption: 'culture',\n    crime: 'economy',\n    decay: 'stability',\n    strife: 'loyalty',\n};\n\nexport const abilityRuins: Record<Ability, Ruin> = {\n    culture: 'corruption',\n    economy: 'crime',\n    stability: 'decay',\n    loyalty: 'strife',\n};\n","import {Ability} from './abilities';\n\nexport const allSkills = [\n    'agriculture',\n    'arts',\n    'boating',\n    'defense',\n    'engineering',\n    'exploration',\n    'folklore',\n    'industry',\n    'intrigue',\n    'magic',\n    'politics',\n    'scholarship',\n    'statecraft',\n    'trade',\n    'warfare',\n    'wilderness',\n] as const;\n\nexport type Skill = typeof allSkills[number];\n\nexport const skillAbilities: Record<Skill, Ability> = {\n    agriculture: 'stability',\n    arts: 'culture',\n    boating: 'economy',\n    defense: 'stability',\n    engineering: 'stability',\n    exploration: 'economy',\n    folklore: 'culture',\n    industry: 'economy',\n    intrigue: 'loyalty',\n    magic: 'culture',\n    politics: 'loyalty',\n    scholarship: 'culture',\n    statecraft: 'loyalty',\n    trade: 'economy',\n    warfare: 'loyalty',\n    wilderness: 'stability',\n};\n\nexport const allSkillRanks = ['untrained', 'trained', 'expert', 'master', 'legendary'] as const;\nexport const allTrainedSkillRanks = ['trained', 'expert', 'master', 'legendary'] as const;\n\nexport const allActorSkills = [\n    'perception',\n    'acrobatics',\n    'athletics',\n    'arcana',\n    'crafting',\n    'deception',\n    'diplomacy',\n    'intimidation',\n    'medicine',\n    'nature',\n    'occultism',\n    'performance',\n    'religion',\n    'society',\n    'stealth',\n    'survival',\n    'thievery',\n] as const;\n\nexport type CharacterSkill = typeof allActorSkills[number];","import {Skill} from './skills';\n\n\nexport interface ActivityBonusRule {\n    value: number;\n    activity: string;\n}\n\nexport interface SkillBonusRule {\n    value: number;\n    skill: Skill;\n    // e.g. 'quell-unrest'\n    activity?: string;\n}\n\nexport interface AvailableItemsRule {\n    value: number;\n    // e.g. 'alchemical' or 'magic'\n    group?: ItemGroup;\n    maximumStacks?: number;\n}\n\nexport interface SettlementEventsRule {\n    value: number;\n}\n\nexport interface LeadershipActivityRule {\n    value: number;\n}\n\nexport interface CommodityStorage {\n    ore: number;\n    food: number;\n    lumber: number;\n    stone: number;\n    luxuries: number;\n}\n\ninterface ConstructionSkill {\n    skill: Skill;\n    proficiencyRank?: number;\n}\n\ninterface Construction {\n    skills: ConstructionSkill[];\n    lumber?: number;\n    luxuries?: number;\n    ore?: number;\n    stone?: number;\n    rp: number;\n    dc: number;\n}\n\nexport interface Structure {\n    name: string;\n    stacksWith?: string;\n    construction?: Construction;\n    notes?: string;\n    preventItemLevelPenalty?: boolean;\n    enableCapitalInvestment?: boolean,\n    skillBonusRules?: SkillBonusRule[];\n    activityBonusRules?: ActivityBonusRule[];\n    availableItemsRules?: AvailableItemsRule[];\n    settlementEventRules?: SettlementEventsRule[];\n    leadershipActivityRules?: LeadershipActivityRule[];\n    storage?: Partial<CommodityStorage>;\n    increaseLeadershipActivities?: boolean;\n    isBridge?: boolean;\n    consumptionReduction?: number;\n    unlockActivities?: string[];\n    traits?: BuildingTrait[];\n    lots?: number;\n    affectsEvents?: boolean;\n    affectsDowntime?: boolean;\n    reducesUnrest?: boolean;\n    reducesRuin?: boolean;\n    level?: number;\n    upgradeFrom?: string[];\n}\n\nexport const allBuildingTraits = ['edifice', 'yard', 'building', 'famous', 'infamous', 'residential', 'infrastructure'];\n\nexport type BuildingTrait = typeof allBuildingTraits[number];\n\nexport type ActivityBonuses = Partial<Record<string, number>>;\n\nexport interface SkillItemBonus {\n    value: number;\n    activities: ActivityBonuses;\n}\n\nexport type SkillItemBonuses = Record<Skill, SkillItemBonus>;\n\nexport type ItemGroup = 'divine'\n    | 'alchemical'\n    | 'primal'\n    | 'occult'\n    | 'arcane'\n    | 'luxury'\n    | 'magical'\n    | 'other';\n\nexport const magicalItemGroups: ItemGroup[] = ['magical', 'divine', 'occult', 'primal', 'arcane'];\n\nexport const mundaneItemGroups: ItemGroup[] = ['alchemical', 'luxury', 'other'];\nexport const itemGroups: ItemGroup[] = mundaneItemGroups.concat(magicalItemGroups);\n\nexport type ItemLevelBonuses = {\n    alchemical: number;\n    magical: number;\n    divine: number;\n    occult: number;\n    primal: number;\n    arcane: number;\n    luxuryMagical: number;\n    luxuryDivine: number;\n    luxuryPrimal: number;\n    luxuryArcane: number;\n    luxuryOccult: number;\n    other: number;\n};\n\nconst structures: Structure[] = [\n    {\n        name: 'Academy',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'creative-solution',\n        }],\n        notes: 'While in a settlement with an Academy, you gain a +2 item bonus to Lore checks made to Recall Knowledge while Investigate, to all checks made while Researching, and to Decipher Writing.',\n        traits: ['building', 'edifice'],\n        affectsDowntime: true,\n        level: 10,\n        upgradeFrom: ['Library'],\n        construction: {\n            skills: [{\n                skill: 'scholarship',\n                proficiencyRank: 2,\n            }],\n            dc: 27,\n            rp: 52,\n            lumber: 12,\n            luxuries: 6,\n            stone: 12,\n        },\n    },\n    {\n        name: 'Alchemy Laboratory',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'demolish',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'alchemical',\n            maximumStacks: 3,\n        }],\n        notes: 'Checks attempted to Identify Alchemy in any settlement with at least one alchemy laboratory gain a +1 item bonus.',\n        traits: ['building'],\n        affectsDowntime: true,\n        level: 3,\n        construction: {\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            rp: 18,\n            ore: 2,\n            stone: 5,\n            dc: 16,\n        },\n    },\n    {\n        name: 'Arcanist\\'s Tower',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'magic',\n            activity: 'quell-unrest',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'arcane',\n            maximumStacks: 3,\n        }],\n        notes: 'While in a settlement with an arcanist\\'s tower, you gain a +1 item bonus to checks made to Borrow an Arcane Spell or Learn a Spell.',\n        traits: ['building'],\n        affectsDowntime: true,\n        level: 5,\n        construction: {\n            skills: [{\n                skill: 'magic',\n                proficiencyRank: 1,\n            }],\n            rp: 30,\n            stone: 6,\n            dc: 20,\n        },\n    },\n    {\n        name: 'Arena',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'celebrate-holiday',\n        }],\n        skillBonusRules: [{\n            value: 1,\n            skill: 'warfare',\n            activity: 'quell-unrest',\n        }],\n        notes: 'An arena lets you to retrain combat-themed feats more efficiently while in the settlement; doing so takes only 5 days rather than a week of downtime.',\n        traits: ['edifice', 'yard'],\n        affectsDowntime: true,\n        level: 9,\n        construction: {\n            skills: [{\n                skill: 'warfare',\n                proficiencyRank: 2,\n            }],\n            dc: 26,\n            rp: 40,\n            lumber: 6,\n            stone: 12,\n        },\n    },\n    {\n        name: 'Bank',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'tap-treasury',\n        }],\n        enableCapitalInvestment: true,\n        traits: ['building'],\n        level: 5,\n        construction: {\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n            rp: 28,\n            ore: 4,\n            stone: 6,\n        },\n    },\n    {\n        name: 'Barracks',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'garrison-army',\n        }, {\n            value: 1,\n            activity: 'recover-army',\n        }, {\n            value: 1,\n            activity: 'recruit-army',\n        }],\n        traits: ['building', 'residential'],\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            skills: [{\n                skill: 'defense',\n            }],\n            dc: 16,\n            rp: 6,\n            lumber: 2,\n            stone: 1,\n        },\n    },\n    {\n        name: 'Brewery',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-trade-agreement',\n        }],\n        traits: ['building'],\n        reducesUnrest: true,\n        level: 1,\n        construction: {\n            skills: [{\n                skill: 'agriculture',\n            }],\n            dc: 15,\n            rp: 6,\n            lumber: 2,\n        },\n    },\n    {\n        name: 'Bridge',\n        isBridge: true,\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 2,\n        construction: {\n            skills: [{\n                skill: 'engineering',\n            }],\n            dc: 16,\n            rp: 6,\n            lumber: 1,\n        },\n    },\n    {\n        name: 'Bridge, Stone',\n        isBridge: true,\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 2,\n        construction: {\n            skills: [{\n                skill: 'engineering',\n            }],\n            dc: 16,\n            rp: 6,\n            stone: 1,\n        },\n    },\n    {\n        name: 'Castle',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'new-leadership',\n        }, {\n            value: 2,\n            activity: 'pledge-of-fealty',\n        }, {\n            value: 2,\n            activity: 'send-diplomatic-envoy',\n        }, {\n            value: 2,\n            activity: 'garrison-army',\n        }, {\n            value: 2,\n            activity: 'recruit-army',\n        }, {\n            value: 2,\n            activity: 'recover-army',\n        }],\n        increaseLeadershipActivities: true,\n        traits: ['building', 'edifice', 'famous', 'infamous'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 9,\n        upgradeFrom: ['Town Hall'],\n        construction: {\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 2,\n            }, {\n                skill: 'industry',\n                proficiencyRank: 2,\n            }, {\n                skill: 'magic',\n                proficiencyRank: 2,\n            }, {\n                skill: 'statecraft',\n                proficiencyRank: 2,\n            }],\n            rp: 54,\n            dc: 26,\n            lumber: 12,\n            stone: 12,\n        },\n    },\n    {\n        name: 'Cathedral',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'celebrate-holiday',\n        }, {\n            value: 3,\n            activity: 'provide-care',\n        }, {\n            value: 3,\n            activity: 'repair-reputation-corruption',\n        }],\n        availableItemsRules: [{\n            value: 3,\n            group: 'divine',\n            maximumStacks: 3,\n        }],\n        notes: 'While in a settlement with a cathedral, you gain a +3 item bonus to Lore and Religion checks made to Recall Knowledge while Investigating, and to all faith-themed checks made while Researching.',\n        traits: ['building', 'edifice', 'famous', 'infamous'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 15,\n        upgradeFrom: ['Temple'],\n        construction: {\n            skills: [{\n                skill: 'folklore',\n                proficiencyRank: 3,\n            }],\n            rp: 58,\n            dc: 34,\n            lumber: 20,\n            stone: 20,\n        },\n    },\n    {\n        name: 'Cemetery',\n        traits: ['yard'],\n        affectsEvents: true,\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 1,\n        construction: {\n            skills: [{\n                skill: 'folklore',\n            }],\n            dc: 15,\n            rp: 4,\n            stone: 1,\n        },\n    },\n    {\n        name: 'Construction Yard',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'build-structure',\n        }, {\n            value: 1,\n            activity: 'repair-reputation-decay',\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 10,\n        construction: {\n            skills: [{\n                skill: 'engineering',\n            }],\n            dc: 27,\n            rp: 40,\n            lumber: 10,\n            stone: 10,\n        },\n    },\n    {\n        name: 'Dump',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'demolish',\n        }],\n        traits: ['yard'],\n        affectsEvents: true,\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 2,\n        construction: {\n            skills: [{\n                skill: 'industry',\n            }],\n            dc: 16,\n            rp: 4,\n        },\n    },\n    {\n        name: 'Embassy',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'send-diplomatic-envoy',\n        }, {\n            value: 1,\n            activity: 'request-foreign-aid',\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 8,\n        construction: {\n            skills: [{\n                skill: 'politics',\n            }],\n            dc: 24,\n            rp: 26,\n            lumber: 10,\n            stone: 4,\n            luxuries: 6,\n        },\n    },\n    {\n        name: 'Festival Hall',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'celebrate-holiday',\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            skills: [{\n                skill: 'arts',\n            }],\n            dc: 18,\n            rp: 7,\n            lumber: 3,\n        },\n    },\n    {\n        name: 'Foundry',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-work-site-mine',\n        }],\n        storage: {\n            ore: 1,\n        },\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n            rp: 16,\n            lumber: 5,\n            stone: 3,\n            ore: 2,\n        },\n    },\n    {\n        name: 'Garrison',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'outfit-army',\n        }, {\n            value: 1,\n            activity: 'train-army',\n        }],\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 5,\n        upgradeFrom: ['Barracks'],\n        construction: {\n            skills: [{\n                skill: 'warfare',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n            rp: 28,\n            lumber: 6,\n            stone: 3,\n        },\n    },\n    {\n        name: 'General Store',\n        preventItemLevelPenalty: true,\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        construction: {\n            skills: [{\n                skill: 'trade',\n            }],\n            dc: 15,\n            rp: 8,\n            lumber: 1,\n        },\n    },\n    {\n        name: 'Gladiatorial Arena',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'celebrate-holiday',\n        }, {\n            value: 3,\n            activity: 'hire-adventurers',\n        }],\n        skillBonusRules: [{\n            value: 3,\n            skill: 'warfare',\n            activity: 'quell-unrest',\n        }],\n        notes: 'A gladiatorial arena allows a PC in the settlement to retrain combat-themed feats (at the GM\\'s discretion) more efficiently; doing so takes only 4 days rather than a week of downtime.',\n        traits: ['edifice', 'famous', 'infamous', 'yard'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 15,\n        construction: {\n            rp: 58,\n            lumber: 10,\n            stone: 30,\n            skills: [{\n                skill: 'warfare',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Houses',\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        upgradeFrom: ['Tenement'],\n        construction: {\n            rp: 3,\n            lumber: 1,\n            skills: [{\n                skill: 'industry',\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Granary',\n        storage: {\n            food: 1,\n        },\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        construction: {\n            rp: 12,\n            lumber: 2,\n            skills: [{\n                skill: 'agriculture',\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Guildhall',\n        notes: 'While in a settlement with a guildhall, you gain a +1 item bonus to all related skill checks to Earn Income or to Repair.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 5,\n        construction: {\n            rp: 34,\n            lumber: 8,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 2,\n            }],\n            dc: 20,\n        },\n        upgradeFrom: ['Trade Shop'],\n    },\n    {\n        name: 'Herbalist',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'provide-care',\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        construction: {\n            rp: 10,\n            lumber: 1,\n            skills: [{\n                skill: 'wilderness',\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Hospital',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'provide-care',\n        }, {\n            value: 1,\n            activity: 'quell-unrest',\n        }],\n        notes: 'While in a settlement with a hospital, you gain a +2 item bonus to Medicine checks to Treat Disease and Treat Wounds.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 9,\n        upgradeFrom: ['Herbalist'],\n        construction: {\n            rp: 30,\n            lumber: 10,\n            stone: 6,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 2,\n            }],\n            dc: 26,\n        },\n    },\n    {\n        name: 'Illicit Market',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'clandestine-business',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            maximumStacks: 3,\n        }],\n        traits: ['building', 'infamous'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 6,\n        construction: {\n            rp: 50,\n            lumber: 5,\n            skills: [{\n                skill: 'intrigue',\n                proficiencyRank: 1,\n            }],\n            dc: 22,\n        },\n    },\n    {\n        name: 'Inn',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'hire-adventurers',\n        }],\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        construction: {\n            rp: 10,\n            lumber: 2,\n            skills: [{\n                skill: 'trade',\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Jail',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'intrigue',\n            activity: 'quell-unrest',\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 2,\n        construction: {\n            rp: 14,\n            lumber: 4,\n            stone: 4,\n            ore: 2,\n            skills: [{\n                skill: 'defense',\n            }],\n            dc: 16,\n        },\n    },\n    {\n        name: 'Keep',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'deploy-army',\n        }, {\n            value: 1,\n            activity: 'garrison-army',\n        }, {\n            value: 1,\n            activity: 'train-army',\n        }],\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            rp: 32,\n            lumber: 8,\n            stone: 8,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Library',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'scholarship',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'While in a settlement with a library, you gain a +1 item bonus to Lore checks made to Recall Knowledge while Investigating, as well as to Researching checks, and to Decipher Writing checks.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 2,\n        construction: {\n            rp: 6,\n            lumber: 4,\n            stone: 2,\n            skills: [{\n                skill: 'scholarship',\n                proficiencyRank: 1,\n            }],\n            dc: 16,\n        },\n    },\n    {\n        name: 'Lumberyard',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-work-site-lumber',\n        }],\n        storage: {\n            lumber: 1,\n        },\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 16,\n            lumber: 5,\n            ore: 1,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Luxury Store',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-trade-agreement',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'luxury',\n            maximumStacks: 3,\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 6,\n        upgradeFrom: ['General Store'],\n        construction: {\n            rp: 28,\n            lumber: 10,\n            luxuries: 6,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 2,\n            }],\n            dc: 22,\n        },\n    },\n    {\n        name: 'Magic Shop',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'supernatural-solution',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'magical',\n            maximumStacks: 3,\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 8,\n        upgradeFrom: ['Luxury Store'],\n        construction: {\n            rp: 44,\n            lumber: 8,\n            stone: 6,\n            luxuries: 6,\n            skills: [{\n                skill: 'magic',\n                proficiencyRank: 2,\n            }],\n            dc: 24,\n        },\n    },\n    {\n        name: 'Magical Streetlamps',\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesRuin: true,\n        level: 5,\n        construction: {\n            rp: 20,\n            skills: [{\n                skill: 'magic',\n                proficiencyRank: 2,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Mansion',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'improve-lifestyle',\n        }],\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 5,\n        upgradeFrom: ['Houses'],\n        construction: {\n            rp: 10,\n            lumber: 6,\n            stone: 3,\n            luxuries: 6,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Marketplace',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-trade-agreement',\n        }],\n        preventItemLevelPenalty: true,\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 4,\n        upgradeFrom: ['General Store'],\n        construction: {\n            rp: 48,\n            lumber: 4,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 1,\n            }],\n            dc: 19,\n        },\n    },\n    {\n        name: 'Menagerie',\n        skillBonusRules: [{\n            value: 2,\n            skill: 'wilderness',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'A menagerie typically contains a selection of level 5 or lower animals. If your party captures a living creature of level 6 or higher and can transport the creature back to a settlement with a menagerie, you can add that creature to the menagerie as long as your kingdom level is at least 4 higher than the creature\\'s level. Each time such a creature is added to a menagerie, gain 1 Fame or Infamy point (as appropriate) or reduce one Ruin of your choice by 1.\\n' +\n            'Only creatures with Intelligence modifiers of 4 or 5 are appropriate to place in a menagerie. A kingdom gains 1 Unrest at the start of a Kingdom turn for each sapient creature (anything with an Intelligence modifier of 3 or higher) on display in a menagerie.',\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        reducesRuin: true,\n        level: 12,\n        upgradeFrom: ['Park'],\n        construction: {\n            rp: 26,\n            lumber: 14,\n            stone: 10,\n            ore: 10,\n            skills: [{\n                skill: 'wilderness',\n                proficiencyRank: 2,\n            }],\n            dc: 30,\n        },\n    },\n    {\n        name: 'Military Academy',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'train-army',\n        }],\n        skillBonusRules: [{\n            value: 2,\n            skill: 'warfare',\n            activity: 'pledge-of-fealty',\n        }],\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 12,\n        upgradeFrom: ['Academy'],\n        construction: {\n            rp: 36,\n            lumber: 12,\n            stone: 10,\n            ore: 6,\n            skills: [{\n                skill: 'warfare',\n                proficiencyRank: 2,\n            }],\n            dc: 30,\n        },\n    },\n    {\n        name: 'Mill',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'harvest-crops',\n        }],\n        consumptionReduction: 1,\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 2,\n        construction: {\n            rp: 6,\n            lumber: 2,\n            stone: 1,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 16,\n        },\n    },\n    {\n        name: 'Mint',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'capital-investment',\n        }, {\n            value: 3,\n            activity: 'collect-taxes',\n        }, {\n            value: 3,\n            activity: 'repair-reputation-crime',\n        }],\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 15,\n        construction: {\n            rp: 30,\n            lumber: 12,\n            stone: 16,\n            ore: 20,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Monument',\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            rp: 6,\n            stone: 1,\n            skills: [{\n                skill: 'arts',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Museum',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'arts',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'A magic item of level 6 or higher that has a particular import or bears significant historical or regional value (at the GM\\'s discretion) can be donated to a museum. Each time such an item is donated, reduce Unrest by 1. If that item is later removed from display, increase Unrest by 1.',\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 5,\n        construction: {\n            rp: 30,\n            lumber: 6,\n            stone: 2,\n            skills: [{\n                skill: 'exploration',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Noble Villa',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'improve-lifestyle',\n        }],\n        skillBonusRules: [{\n            value: 1,\n            skill: 'politics',\n            activity: 'quell-unrest',\n        }],\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 9,\n        upgradeFrom: ['Mansion'],\n        construction: {\n            rp: 24,\n            lumber: 10,\n            stone: 8,\n            luxuries: 6,\n            skills: [{\n                skill: 'politics',\n                proficiencyRank: 2,\n            }],\n            dc: 19,\n        },\n    },\n    {\n        name: 'Occult Shop',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'prognostication',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'occult',\n            maximumStacks: 3,\n        }],\n        notes: 'While in a settlement with an occult shop, you gain a +2 item bonus to all checks made to Research esoteric subjects or to Recall Knowledge about the same.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 13,\n        construction: {\n            rp: 68,\n            lumber: 12,\n            stone: 6,\n            luxuries: 12,\n            skills: [{\n                skill: 'magic',\n                proficiencyRank: 3,\n            }],\n            dc: 32,\n        },\n    },\n    {\n        name: 'Opera House',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'celebrate-holiday',\n        }, {\n            value: 3,\n            activity: 'create-a-masterpiece',\n        }],\n        notes: 'While in a settlement with an opera house, you gain a +3 item bonus to Performance checks made to Earn Income.',\n        traits: ['building', 'edifice', 'famous', 'infamous'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 15,\n        upgradeFrom: ['Theater'],\n        construction: {\n            rp: 40,\n            lumber: 20,\n            stone: 16,\n            luxuries: 18,\n            skills: [{\n                skill: 'arts',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Orphanage',\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 2,\n        upgradeFrom: ['Houses'],\n        construction: {\n            rp: 6,\n            lumber: 2,\n            skills: [{\n                skill: 'industry',\n            }],\n            dc: 16,\n        },\n    },\n    {\n        name: 'Palace',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'new-leadership',\n        }, {\n            value: 3,\n            activity: 'pledge-of-fealty',\n        }, {\n            value: 3,\n            activity: 'send-diplomatic-envoy',\n        }, {\n            value: 3,\n            activity: 'garrison-army',\n        }, {\n            value: 3,\n            activity: 'recover-army',\n        }, {\n            value: 3,\n            activity: 'recruit-army',\n        }],\n        leadershipActivityRules: [{\n            value: 3,\n        }],\n        increaseLeadershipActivities: true,\n        traits: ['building', 'edifice', 'famous', 'infamous'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 15,\n        upgradeFrom: ['Castle'],\n        construction: {\n            rp: 108,\n            lumber: 20,\n            stone: 20,\n            ore: 15,\n            luxuries: 12,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 3,\n            }, {\n                skill: 'industry',\n                proficiencyRank: 3,\n            }, {\n                skill: 'magic',\n                proficiencyRank: 3,\n            }, {\n                skill: 'statecraft',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Park',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'wilderness',\n            activity: 'rest-and-relax',\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            rp: 5,\n            skills: [{\n                skill: 'wilderness',\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Paved Streets',\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 4,\n        construction: {\n            rp: 12,\n            stone: 6,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 19,\n        },\n    },\n    {\n        name: 'Pier',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'go-fishing',\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 16,\n            lumber: 2,\n            skills: [{\n                skill: 'boating',\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Rubble',\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 0,\n    },\n    {\n        name: 'Printing House',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'improve-lifestyle',\n        }, {\n            value: 2,\n            activity: 'quell-unrest',\n        }],\n        notes: 'A PC in a settlement with a printing house gains a +2 item bonus to checks to Gather Information or to Research any topic in a library or similar structure.',\n        unlockActivities: ['read-all-about-it'],\n        traits: ['building', 'edifice'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 10,\n        construction: {\n            rp: 48,\n            lumber: 14,\n            luxuries: 12,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 3,\n            }],\n            dc: 27,\n        },\n    },\n    {\n        name: 'Sacred Grove',\n        skillBonusRules: [{\n            value: 1,\n            skill: 'folklore',\n            activity: 'quell-unrest',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'primal',\n            maximumStacks: 3,\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 5,\n        construction: {\n            rp: 36,\n            skills: [{\n                skill: 'wilderness',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Secure Warehouse',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'craft-luxuries',\n        }],\n        storage: {\n            luxuries: 1,\n        },\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 6,\n        construction: {\n            rp: 24,\n            lumber: 6,\n            stone: 6,\n            ore: 4,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 2,\n            }],\n            dc: 22,\n        },\n    },\n    {\n        name: 'Sewer System',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'clandestine-business',\n        }],\n        consumptionReduction: 1,\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsEvents: true,\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 7,\n        construction: {\n            rp: 24,\n            lumber: 8,\n            stone: 8,\n            skills: [{\n                skill: 'engineering',\n                proficiencyRank: 2,\n            }],\n            dc: 23,\n        },\n    },\n    {\n        name: 'Shrine',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'celebrate-holiday',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'divine',\n            maximumStacks: 3,\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 1,\n        construction: {\n            rp: 8,\n            lumber: 2,\n            stone: 1,\n            skills: [{\n                skill: 'folklore',\n                proficiencyRank: 1,\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Smithy',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'trade-commodities',\n        }, {\n            value: 1,\n            activity: 'outfit-army',\n        }],\n        notes: 'While in a settlement with a smithy, you gain a +1 item bonus to Craft checks made to work with metal.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 8,\n            lumber: 2,\n            stone: 1,\n            ore: 1,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Specialized Artisan',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'craft-luxuries',\n        }],\n        notes: 'While in a settlement with a specialized artisan, you gain a +1 item bonus to Craft checks made to craft specialized goods like jewelry.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 4,\n        construction: {\n            rp: 10,\n            lumber: 4,\n            luxuries: 1,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 2,\n            }],\n            dc: 19,\n        },\n    },\n    {\n        name: 'Stable',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-trade-agreement',\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 10,\n            lumber: 2,\n            skills: [{\n                skill: 'wilderness',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Stockyard',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'gather-livestock',\n        }],\n        consumptionReduction: 1,\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 20,\n            lumber: 4,\n            skills: [{\n                skill: 'industry',\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Stonemason',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'establish-work-site-quarry',\n        }],\n        storage: {\n            stone: 1,\n        },\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 16,\n            lumber: 2,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Tannery',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'trade-commodities',\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 6,\n            lumber: 2,\n            skills: [{\n                skill: 'industry',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Tavern, Dive',\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 1,\n        construction: {\n            rp: 12,\n            lumber: 1,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 1,\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Tavern, Luxury',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'hire-adventurers',\n        }],\n        skillBonusRules: [{\n            value: 2,\n            skill: 'trade',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'If attempt a Performance check to Earn Income in a settlement with a luxury tavern, you gain a +2 item bonus to the check. All checks made to Gather Information in a settlement with at least one luxury tavern gain a +2 item bonus.',\n        traits: ['building', 'famous'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 9,\n        upgradeFrom: ['Tavern, Popular'],\n        construction: {\n            rp: 48,\n            lumber: 10,\n            stone: 8,\n            luxuries: 8,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 3,\n            }],\n            dc: 26,\n        },\n    },\n    {\n        name: 'Tavern, Popular',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'hire-adventurers',\n        }],\n        skillBonusRules: [{\n            value: 1,\n            skill: 'trade',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'If you attempt a Performance check to Earn Income in a settlement with a popular tavern, you gain a +1 item bonus to the check. All checks made to Gather Information in a settlement with at least one popular tavern gain a +1 item bonus.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 3,\n        upgradeFrom: ['Tavern, Dive'],\n        construction: {\n            rp: 24,\n            lumber: 6,\n            stone: 2,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 2,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Tavern, World-Class',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'hire-adventurers',\n        }, {\n            value: 3,\n            activity: 'repair-reputation-strife',\n        }],\n        skillBonusRules: [{\n            value: 3,\n            skill: 'trade',\n            activity: 'rest-and-relax',\n        }],\n        notes: 'If you attempt a Performance check to Earn Income in a settlement with a world-class tavern, you gain a +3 item bonus to the check. All checks made to Gather Information in a settlement with a world-class tavern gain a +3 item bonus.',\n        traits: ['building', 'edifice', 'famous'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 15,\n        upgradeFrom: ['Tavern, Luxury'],\n        construction: {\n            rp: 64,\n            lumber: 18,\n            stone: 15,\n            luxuries: 15,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Temple',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'celebrate-holiday',\n        }, {\n            value: 1,\n            activity: 'provide-care',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            group: 'divine',\n            maximumStacks: 3,\n        }],\n        traits: ['building', 'famous', 'infamous'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 7,\n        upgradeFrom: ['Shrine'],\n        construction: {\n            rp: 32,\n            lumber: 6,\n            stone: 6,\n            skills: [{\n                skill: 'folklore',\n                proficiencyRank: 1,\n            }],\n            dc: 23,\n        },\n    },\n    {\n        name: 'Tenement',\n        traits: ['building', 'residential'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 0,\n        construction: {\n            rp: 1,\n            lumber: 1,\n            skills: [{\n                skill: 'industry',\n            }],\n            dc: 14,\n        },\n    },\n    {\n        name: 'Theater',\n        activityBonusRules: [{\n            value: 2,\n            activity: 'celebrate-holiday',\n        }],\n        notes: 'While in a settlement with a theater, you gain a +2 item bonus to Performance checks made to Earn Income.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: true,\n        level: 9,\n        upgradeFrom: ['Festival Hall'],\n        construction: {\n            rp: 24,\n            lumber: 8,\n            stone: 3,\n            skills: [{\n                skill: 'arts',\n                proficiencyRank: 2,\n            }],\n            dc: 26,\n        },\n    },\n    {\n        name: 'Thieves\\' Guild',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'infiltration',\n        }],\n        notes: 'While in a settlement with a thieves\\' guild, you gain a +1 item bonus to Create Forgeries.',\n        traits: ['building', 'infamous'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 5,\n        construction: {\n            rp: 25,\n            lumber: 4,\n            skills: [{\n                skill: 'intrigue',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Town Hall',\n        increaseLeadershipActivities: true,\n        traits: ['building', 'edifice'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 2,\n        construction: {\n            rp: 22,\n            lumber: 4,\n            stone: 4,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 1,\n            }, {\n                skill: 'industry',\n                proficiencyRank: 1,\n            }, {\n                skill: 'magic',\n                proficiencyRank: 1,\n            }, {\n                skill: 'statecraft',\n                proficiencyRank: 1,\n            }],\n            dc: 16,\n        },\n    },\n    {\n        name: 'Trade Shop',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'purchase-commodities',\n        }],\n        notes: 'When you build a trade shop, indicate the kind of shop it is, such as a bakery, carpenter, tailor, and so on. While in a settlement with a trade shop, you gain a +1 item bonus to all associated Crafting checks.',\n        traits: ['building'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 3,\n        construction: {\n            rp: 10,\n            lumber: 2,\n            skills: [{\n                skill: 'trade',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'University',\n        activityBonusRules: [{\n            value: 3,\n            activity: 'creative-solution',\n        }],\n        notes: 'While in a settlement with a university, you gain a +3 item bonus to Lore checks made to Recall Knowledge while Investigating, to Research checks (Gamemastery Guide 154), and to Decipher Writing.',\n        traits: ['building', 'edifice', 'famous'],\n        affectsDowntime: true,\n        reducesUnrest: false,\n        level: 15,\n        upgradeFrom: ['Academy'],\n        construction: {\n            rp: 78,\n            lumber: 18,\n            stone: 18,\n            luxuries: 18,\n            skills: [{\n                skill: 'scholarship',\n                proficiencyRank: 3,\n            }],\n            dc: 34,\n        },\n    },\n    {\n        name: 'Wall, Stone',\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 5,\n        upgradeFrom: ['Wall, Wooden'],\n        construction: {\n            rp: 4,\n            stone: 8,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 1,\n            }],\n            dc: 20,\n        },\n    },\n    {\n        name: 'Wall, Wooden',\n        traits: ['infrastructure'],\n        lots: 0,\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 1,\n        construction: {\n            rp: 2,\n            lumber: 4,\n            skills: [{\n                skill: 'defense',\n            }],\n            dc: 15,\n        },\n    },\n    {\n        name: 'Watchtower',\n        settlementEventRules: [{\n            value: 1,\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            rp: 12,\n            lumber: 4,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Watchtower, Stone',\n        stacksWith: 'Watchtower',\n        settlementEventRules: [{\n            value: 1,\n        }],\n        traits: ['building'],\n        affectsDowntime: false,\n        reducesUnrest: true,\n        level: 3,\n        construction: {\n            rp: 12,\n            stone: 4,\n            skills: [{\n                skill: 'defense',\n                proficiencyRank: 1,\n            }],\n            dc: 18,\n        },\n    },\n    {\n        name: 'Waterfront',\n        activityBonusRules: [{\n            value: 1,\n            activity: 'go-fishing',\n        }, {\n            value: 1,\n            activity: 'establish-trade-agreement',\n        }],\n        availableItemsRules: [{\n            value: 1,\n            maximumStacks: 1,\n        }],\n        traits: ['yard'],\n        affectsDowntime: false,\n        reducesUnrest: false,\n        level: 8,\n        upgradeFrom: ['Pier'],\n        construction: {\n            rp: 90,\n            lumber: 10,\n            skills: [{\n                skill: 'boating',\n                proficiencyRank: 2,\n            }],\n            dc: 24,\n        },\n    },\n];\n\nexport const structuresByName = new Map<string, Structure>();\nstructures.forEach(s => structuresByName.set(s.name, s));\n\ninterface VKAdjustment {\n    skillBonusRules?: SkillBonusRule[];\n    activityBonusRules?: ActivityBonusRule[];\n}\n\n// add v&k adjustments\nconst vkAdjustments: Record<string, VKAdjustment> = {\n    'Bank': {activityBonusRules: [{value: 1, activity: 'capital-investment'}, {value: 1, activity: 'collect-taxes'}]},\n    'Castle': {\n        activityBonusRules: [\n            {\n                value: 2,\n                activity: 'manage-trade-agreements',\n            }, {\n                value: 2,\n                activity: 'relocate-capital',\n            }],\n    },\n    'Construction Yard': {\n        activityBonusRules: [{\n            value: 1,\n            activity: 'build-roads',\n        }, {\n            value: 1,\n            activity: 'irrigation',\n        }],\n    },\n    'Festival Hall': {skillBonusRules: [{activity: 'quell-unrest', skill: 'arts', value: 1}]},\n    'Garrison': {activityBonusRules: [{value: 1, activity: 'fortify-hex'}]},\n    'Granary': {activityBonusRules: [{value: 1, activity: 'establish-farmland'}]},\n    'Inn': {skillBonusRules: [{value: 1, activity: 'clear-hex', skill: 'exploration'}]},\n    'Library': {activityBonusRules: [{value: 1, activity: 'creative-solution'}]},\n    'Magic Shop': {activityBonusRules: [{value: 1, activity: 'prognostication'}]},\n    'Monument': {activityBonusRules: [{value: 1, activity: 'create-a-masterpiece'}]},\n    'Occult Shop': {activityBonusRules: [{value: 2, activity: 'supernatural-solution'}]},\n    'Palace': {\n        activityBonusRules: [{value: 3, activity: 'manage-trade-agreements'}, {\n            value: 3,\n            activity: 'relocate-capital',\n        }],\n    },\n    'Smithy': {skillBonusRules: [{value: 1, activity: 'clear-hex', skill: 'engineering'}]},\n    'Tavern, Dive': {skillBonusRules: [{value: 1, activity: 'clear-hex', skill: 'exploration'}]},\n    'Tavern, Luxury': {activityBonusRules: [{value: 2, activity: 'reconnoiter-hex'}]},\n    'Tavern, Popular': {activityBonusRules: [{value: 1, activity: 'reconnoiter-hex'}]},\n    'Tavern, World-Class': {activityBonusRules: [{value: 3, activity: 'reconnoiter-hex'}]},\n    'Town Hall': {activityBonusRules: [{value: 1, activity: 'manage-trade-agreements'}]},\n};\n\nArray.from(Object.entries(vkAdjustments))\n    .forEach(([name, adjustment]) => {\n        const existing = structuresByName.get(name);\n        if (existing === undefined) {\n            throw new Error(`VK Adjustment typo: ${name}`);\n        }\n        const copy = JSON.parse(JSON.stringify(existing)) as Structure;\n        // hardcode granary proficiency requirement because it's too difficult otherwise\n        if (name === 'Granary') {\n            copy.construction!.skills![0]!.proficiencyRank = 1;\n        }\n        adjustment.skillBonusRules?.forEach(rule => {\n            if (copy.skillBonusRules === undefined) {\n                copy.skillBonusRules = [];\n            }\n            copy.skillBonusRules?.push(rule);\n        });\n        adjustment.activityBonusRules?.forEach(rule => {\n            if (copy.activityBonusRules === undefined) {\n                copy.activityBonusRules = [];\n            }\n            copy.activityBonusRules?.push(rule);\n        });\n        copy.name = `${copy.name} (V&K)`;\n        structuresByName.set(copy.name, copy);\n    });\n","export function calculateUnrestPenalty(unrest: number): number {\n    if (unrest < 1) {\n        return 0;\n    } else if (unrest < 5) {\n        return 1;\n    } else if (unrest < 10) {\n        return 2;\n    } else if (unrest < 15) {\n        return 3;\n    } else {\n        return 4;\n    }\n}\n","import {listenClick} from '../../utils';\nimport {getKingdom, saveKingdom} from '../storage';\nimport {Kingdom} from '../data/kingdom';\nimport {getKingdomActivities, KingdomActivity} from '../data/activityData';\nimport {addActivityDialog} from './add-activity-dialog';\n\n\ninterface ManageKingdomActivitiesOptions {\n    game: Game;\n    actor: Actor;\n}\n\ninterface ActivityData {\n    activities: ViewActivity[];\n}\n\ninterface ViewActivity {\n    enabled: boolean;\n    isHomebrew: boolean;\n    id: string;\n    title: string;\n}\n\nclass ManageKingdomActivitiesDialog extends FormApplication<FormApplicationOptions & ManageKingdomActivitiesOptions, object, null> {\n    private game: Game;\n    private actor: Actor;\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-manage-kingdom-activities';\n        options.title = 'Manage Kingdom Activities';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/manage-activities.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & ManageKingdomActivitiesOptions) {\n        super(object, options);\n        this.game = options.game;\n        this.actor = options.actor;\n    }\n\n    override getData(): Promise<ActivityData> | ActivityData {\n        const kingdom = getKingdom(this.actor);\n        return {\n            activities: this.buildActivities(kingdom),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: Record<string, boolean>): Promise<void> {\n        await saveKingdom(this.actor, {\n            activityBlacklist: Object.entries(formData)\n                .filter(([, enabled]) => !enabled)\n                .map(([id]) => id),\n        });\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.add-activity', async (): Promise<void> => {\n            const kingdom = getKingdom(this.actor);\n            addActivityDialog({\n                onOk: this.onSave.bind(this),\n                homebrewActivities: kingdom.homebrewActivities,\n            });\n        });\n        listenClick($html, '.edit-activity', async (ev: Event): Promise<void> => {\n            const kingdom = getKingdom(this.actor);\n            const target = ev.currentTarget as HTMLButtonElement;\n            const id = target.dataset.id!;\n            const activity = kingdom.homebrewActivities.find(a => a.id === id);\n            addActivityDialog({\n                onOk: this.onSave.bind(this),\n                activity: activity,\n                homebrewActivities: kingdom.homebrewActivities,\n            });\n        });\n        listenClick($html, '.delete-activity', async (ev: Event): Promise<void> => {\n            const target = ev.currentTarget as HTMLButtonElement;\n            const id = target.dataset.id!;\n            const kingdom = getKingdom(this.actor);\n            await saveKingdom(this.actor, {\n                homebrewActivities: kingdom.homebrewActivities.filter(a => a.id !== id),\n            });\n            this.render();\n        });\n    }\n\n    private async onSave(activity: KingdomActivity): Promise<void> {\n        const kingdom = getKingdom(this.actor);\n        const homebrewActivities = [\n            ...kingdom.homebrewActivities.filter(a => a.id !== activity.id),\n            activity,\n        ];\n        await saveKingdom(this.actor, {\n            homebrewActivities,\n        });\n        this.render();\n    }\n\n    private buildActivities(kingdom: Kingdom): ViewActivity[] {\n        const blacklist = new Set(kingdom.activityBlacklist);\n        const homebrewIds = new Set(kingdom.homebrewActivities.map(a => a.id));\n        const kingdomActivities = getKingdomActivities(kingdom.homebrewActivities);\n        return kingdomActivities\n            .map(a => {\n                return {\n                    enabled: !blacklist.has(a.id),\n                    title: a.title,\n                    id: a.id,\n                    isHomebrew: homebrewIds.has(a.id),\n                };\n            })\n            .sort((a, b) => a.title.localeCompare(b.title));\n    }\n}\n\n\nexport function manageKingdomActivitiesDialog(game: Game, actor: Actor): void {\n    new ManageKingdomActivitiesDialog(null, {game, actor}).render(true);\n}","import {ActivityResult, KingdomActivity} from '../data/activityData';\nimport {blankToUndefined, capitalize, isBlank, LabelAndValue, listenClick, range} from '../../utils';\nimport {KingdomPhase} from '../data/activities';\nimport {allSkills} from '../data/skills';\nimport {skillDialog, SkillView} from '../../common/skills-dialog';\nimport {proficiencyToRank, rankToProficiency} from '../modifiers';\n\n\ninterface AddActivityData {\n    id: string;\n    edit: boolean;\n    title: string;\n    description: string;\n    hint: string;\n    special: string;\n    requirement: string;\n    phase: KingdomPhase;\n    phases: LabelAndValue[];\n    skills: SkillView[];\n    dc: 'control' | 'custom' | 'none' | number;\n    dcs: LabelAndValue[];\n    dcAdjustment: number;\n    oncePerRound: boolean;\n    fortune: boolean;\n    criticalSuccess: string;\n    success: string;\n    failure: string;\n    criticalFailure: string;\n    errors: string[];\n}\n\ninterface ActivityFormData {\n    id: string;\n    title: string;\n    description: string;\n    hint: string;\n    special: string;\n    requirement: string;\n    phase: KingdomPhase;\n    dc: 'control' | 'custom' | 'none' | string;\n    dcAdjustment: number;\n    oncePerRound: boolean;\n    fortune: boolean;\n    criticalSuccess: string;\n    success: string;\n    failure: string;\n    criticalFailure: string;\n}\n\ninterface AddKingdomActivityOptions {\n    onOk: (activity: KingdomActivity) => Promise<void>,\n    activity?: KingdomActivity,\n    homebrewActivities: KingdomActivity[];\n}\n\nfunction parseDc(value: string): 'control' | 'custom' | 'none' | number {\n    if (value === 'control' || value === 'custom' || value === 'none') {\n        return value;\n    } else {\n        return parseInt(value, 10) || 0;\n    }\n}\n\n\nfunction parseOutcome(value: string): ActivityResult | undefined {\n    if (isBlank(value)) {\n        return undefined;\n    } else {\n        return {\n            msg: value,\n        };\n    }\n}\n\n\nclass AddKingdomActivities extends FormApplication<FormApplicationOptions & AddKingdomActivityOptions, object, null> {\n    private onSubmitCallback: (activity: KingdomActivity) => Promise<void>;\n    private activity: KingdomActivity;\n    private edit: boolean;\n    private homebrewActivities: KingdomActivity[];\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-add-kingdom-activities';\n        options.title = 'Manage Kingdom Activities';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/add-activity-dialog.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        options.width = 400;\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & AddKingdomActivityOptions) {\n        super(object, options);\n        this.onSubmitCallback = options.onOk;\n        this.edit = options.activity !== undefined;\n        this.activity = {\n            special: options.activity?.special ?? '',\n            requirement: options.activity?.requirement ?? '',\n            description: options.activity?.description ?? '',\n            dcAdjustment: options.activity?.dcAdjustment ?? 0,\n            fortune: options.activity?.fortune ?? false,\n            failure: {msg: options.activity?.failure?.msg ?? ''},\n            success: {msg: options.activity?.success?.msg ?? ''},\n            criticalFailure: {msg: options.activity?.criticalFailure?.msg ?? ''},\n            criticalSuccess: {msg: options.activity?.criticalSuccess?.msg ?? ''},\n            dc: options.activity?.dc ?? 'control',\n            title: options.activity?.title ?? '',\n            hint: options.activity?.hint ?? '',\n            id: options.activity?.id ?? '',\n            skills: options.activity?.skills ?? {agriculture: 0},\n            phase: options.activity?.phase ?? 'leadership',\n            oncePerRound: options.activity?.oncePerRound ?? false,\n            enabled: options.activity?.enabled ?? true,\n        };\n        this.homebrewActivities = options.homebrewActivities;\n    }\n\n    override async getData(): Promise<AddActivityData> {\n        return {\n            phases: ['army', 'leadership', 'region'].map(p => {\n                return {\n                    label: capitalize(p),\n                    value: p,\n                };\n            }),\n            phase: this.activity.phase,\n            dc: this.activity.dc,\n            fortune: this.activity.fortune,\n            edit: this.edit,\n            hint: this.activity.hint ?? '',\n            id: this.activity.id,\n            title: this.activity.title,\n            special: this.activity.special ?? '',\n            requirement: this.activity.requirement ?? '',\n            description: this.activity.description,\n            oncePerRound: this.activity.oncePerRound,\n            dcAdjustment: this.activity.dcAdjustment ?? 0,\n            criticalSuccess: this.activity.criticalSuccess?.msg ?? '',\n            success: this.activity.success?.msg ?? '',\n            failure: this.activity.failure?.msg ?? '',\n            criticalFailure: this.activity.criticalFailure?.msg ?? '',\n            dcs: ['none', 'control', 'custom', ...range(14, 51).map(i => i.toString())]\n                .map(v => {\n                    return {\n                        value: v,\n                        label: capitalize(v),\n                    };\n                }),\n            skills: Array.from(Object.entries(this.activity.skills))\n                .map(([key, rank]) => {\n                    return {\n                        proficiency: rankToProficiency(rank),\n                        id: key,\n                        label: capitalize(key),\n                    };\n                }),\n            errors: await this.validate(this.activity),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: ActivityFormData): Promise<void> {\n        console.log(formData);\n        if (!this.edit) {\n            this.activity.id = formData.id;\n        }\n        this.activity.title = formData.title;\n        this.activity.description = formData.description;\n        this.activity.hint = blankToUndefined(formData.hint);\n        this.activity.special = blankToUndefined(formData.special);\n        this.activity.requirement = blankToUndefined(formData.requirement);\n        this.activity.phase = formData.phase;\n        this.activity.dc = parseDc(formData.dc);\n        this.activity.dcAdjustment = formData.dcAdjustment;\n        this.activity.oncePerRound = formData.oncePerRound;\n        this.activity.fortune = formData.fortune;\n        this.activity.criticalSuccess = parseOutcome(formData.criticalSuccess);\n        this.activity.success = parseOutcome(formData.success);\n        this.activity.failure = parseOutcome(formData.failure);\n        this.activity.criticalFailure = parseOutcome(formData.criticalFailure);\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '.save', async (): Promise<void> => {\n            await this.onSubmitCallback(this.activity);\n            await this.close();\n        });\n        listenClick($html, '.edit-skills', async (): Promise<void> => {\n            const skills = this.activity.skills;\n            const selectedSkills = Object.entries(skills)\n                .map(([s, rank]) => {\n                    return {\n                        id: s,\n                        proficiency: rankToProficiency(rank),\n                    };\n                }) || undefined;\n            skillDialog({\n                selectedSkills,\n                atLeastOne: true,\n                onSave: (data) => {\n                    this.activity.skills = Object.fromEntries(data.selectedSkills.map(skill => {\n                        return [skill.id, proficiencyToRank(skill.proficiency)];\n                    }));\n                    this.render();\n                },\n                availableSkills: [...allSkills],\n            });\n        });\n    }\n\n    private async validate(activity: KingdomActivity): Promise<string[]> {\n        const result = [];\n        if (!/^[a-z\\\\-]+$/.test(activity.id)) {\n            result.push('ID must only contain lower case English letters and hyphens!');\n        }\n        if (this.homebrewActivities.find(a => activity.id === a.id) && !this.edit) {\n            result.push(`Homebrew activity with id ${activity.id} exists already, can not add another one`);\n        }\n        if (isBlank(activity.title)) {\n            result.push('Title must not be blank');\n        }\n        return result;\n    }\n}\n\nexport function addActivityDialog(\n    options: AddKingdomActivityOptions,\n): void {\n    new AddKingdomActivities(null, options).render(true);\n}","import {KingdomFeat} from '../data/feats';\nimport {BonusFeat} from '../data/kingdom';\n\n\ntype AddBonusFeatOptions = {\n    feats: KingdomFeat[]\n    onOk: (feat: BonusFeat) => void;\n};\n\nexport class AddBonusFeatDialog extends FormApplication<FormApplicationOptions & AddBonusFeatOptions, object, null> {\n    private feats: KingdomFeat[];\n    private onOk: (feat: BonusFeat) => void;\n    private selected = '-';\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-add-bonus-feat';\n        options.title = 'Kingdom';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/add-bonus-feat.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & AddBonusFeatOptions) {\n        super(object, options);\n        this.feats = options.feats;\n        this.onOk = options.onOk;\n    }\n\n    override getData(options?: Partial<FormApplicationOptions & { feats: KingdomFeat[] }>): Promise<object> | object {\n        return {\n            feats: this.feats,\n            selected: this.selected,\n            feat: this.feats.find(feat => feat.name === this.selected),\n            ...super.getData(options),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: { selected: string }): Promise<void> {\n        this.selected = formData.selected;\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        $html.querySelector('button')?.addEventListener('click', async () => {\n            const selectedFeat = this.feats.find(feat => feat.name === this.selected)!;\n            this.onOk({\n                id: selectedFeat.name,\n            });\n            await this.close();\n        });\n    }\n}\n","import {allKingdomPhases, KingdomPhase} from '../data/activities';\nimport {allModifierTypes, Modifier, ModifierType} from '../modifiers';\nimport {capitalize, createLabels, parseCheckbox, parseNumberInput, parseSelect, parseTextInput} from '../../utils';\nimport {allSkills, Skill} from '../data/skills';\nimport {Ability, allAbilities} from '../data/abilities';\n\nconst types = allModifierTypes.flatMap(type => {\n    if (type === 'vacancy') {\n        return [{\n            label: capitalize(type) + ' Penalty',\n            value: `${type}-penalty`,\n        }];\n    } else {\n        return [{\n            label: capitalize(type) + ' Bonus',\n            value: `${type}-bonus`,\n        }, {\n            label: capitalize(type) + ' Penalty',\n            value: `${type}-penalty`,\n        }];\n    }\n});\nconst phases = createLabels(allKingdomPhases);\nconst skills = createLabels(allSkills);\nconst abilities = createLabels(allAbilities);\n\nfunction tpl(allActivities: string[]): string {\n    const activities = createLabels(allActivities, true);\n    return `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-effect-name\">Name</label>\n                <input type=\"text\" name=\"name\" id=\"km-effect-name\">\n            </div>\n            <div>\n                <label for=\"km-effect-type\"></label>\n                <select name=\"type\" id=\"km-effect-type\">\n                    ${types.map(t => `<option value=\"${t.value}\">${t.label}</option>`)}\n                </select>\n            </div>\n            <div>\n                <label for=\"km-effect-value\">Value</label>\n                <input type=\"number\" name=\"value\" id=\"km-effect-value\">\n            </div>\n            <div>\n                <label for=\"km-effect-phase\">Phase</label>\n                <select name=\"phase\" id=\"km-effect-phase\">\n                    <option value=\"-\">-</option>\n                    ${phases.map(t => `<option value=\"${t.value}\">${t.label}</option>`)}\n                </select>\n            </div>\n            <div>\n                <label for=\"km-effect-activity\">Activity</label>\n                <select name=\"activity\" id=\"km-effect-activity\">\n                    <option value=\"-\">-</option>\n                    ${activities.map(t => `<option value=\"${t.value}\">${t.label}</option>`)}\n                </select>\n            </div>\n            <div>\n                <label for=\"km-effect-ability\">Ability</label>\n                <select name=\"ability\" id=\"km-effect-ability\">\n                    <option value=\"-\">-</option>\n                    ${abilities.map(t => `<option value=\"${t.value}\">${t.label}</option>`)}\n                </select>\n            </div>\n            <div>\n                <label for=\"km-effect-skill\">Skill</label>\n                <select name=\"skill\" id=\"km-effect-skill\">\n                    <option value=\"-\">-</option>\n                    ${skills.map(t => `<option value=\"${t.value}\">${t.label}</option>`)}\n                </select>\n            </div>\n            <div>\n                <label for=\"km-effect-enabled\">Enabled</label>\n                <input type=\"checkbox\" name=\"enabled\" id=\"km-effect-enabled\" checked>\n            </div>\n            <div>\n                <label for=\"km-effect-turns\">Turns (0 for indefinite)</label>\n                <input type=\"number\" name=\"turns\" id=\"km-effect-turns\" value=\"1\">\n            </div>\n            <div>\n                <label for=\"km-effect-consumable\">Consume after Use</label>\n                <input type=\"checkbox\" name=\"consumable\" id=\"km-effect-consumable\">\n            </div>\n        </form>\n        `;\n}\n\nfunction parseModifierType(typeSlug: string, value: number): { type: ModifierType, value: number } {\n    const [type, bonusOrPenalty] = typeSlug.split('-');\n    if (bonusOrPenalty === 'penalty') {\n        return {type: type as ModifierType, value: -Math.abs(value)};\n    } else {\n        return {type: type as ModifierType, value: Math.abs(value)};\n    }\n}\n\nfunction parseOptionalSelect<T extends string>($html: HTMLElement, name: string): T[] | undefined {\n    const value = parseSelect($html, name);\n    if (value === '-') {\n        return undefined;\n    } else {\n        return [value as T];\n    }\n}\n\nexport function addEffectDialog(\n    activities: string[],\n    onOk: (modifier: Modifier) => void,\n): void {\n    new Dialog({\n        title: 'Add Effect',\n        content: tpl(activities),\n        buttons: {\n            add: {\n                icon: '<i class=\"fa-solid fa-plus\"></i>',\n                label: 'Add',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const turns = parseNumberInput($html, 'turns');\n                    const {type, value} = parseModifierType(\n                        parseSelect($html, 'type'),\n                        parseNumberInput($html, 'value'),\n                    );\n                    const phases = parseOptionalSelect($html, 'phase') as KingdomPhase[] | undefined;\n                    const activities = parseOptionalSelect($html, 'activity');\n                    const skills = parseOptionalSelect($html, 'skill') as Skill[] | undefined;\n                    const abilities = parseOptionalSelect($html, 'ability') as Ability[] | undefined;\n                    onOk({\n                        name: parseTextInput($html, 'name'),\n                        type,\n                        value,\n                        enabled: parseCheckbox($html, 'enabled'),\n                        consumeId: parseCheckbox($html, 'consumable') ? crypto.randomUUID() : undefined,\n                        phases,\n                        activities,\n                        skills,\n                        abilities,\n                        turns: turns === 0 ? undefined : turns,\n                    });\n                },\n            },\n        },\n        default: 'add',\n    }, {\n        jQuery: false,\n        width: 400,\n    }).render(true);\n}\n","import {Group} from '../data/kingdom';\n\nexport function addGroupDialog(onOk: (group: Group) => void): void {\n    new Dialog({\n        title: 'Add Group',\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label>Name</label> \n                <input name=\"name\" type=\"text\">\n            </div>\n            <div>\n                <label>Negotiation DC</label>\n                <input name=\"negotiationDC\" type=\"number\">\n            </div>\n        </form>\n        `,\n        buttons: {\n            add: {\n                icon: '<i class=\"fa-solid fa-plus\"></i>',\n                label: 'Add',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const name = $html.querySelector('input[name=name]') as HTMLInputElement;\n                    const negotiationDC = $html.querySelector('input[name=negotiationDC]') as HTMLInputElement;\n                    const dc = parseInt(negotiationDC.value, 10);\n                    const group: Group = {\n                        name: name.value,\n                        negotiationDC: isNaN(dc) ? 0 : dc,\n                        atWar: false,\n                        relations: 'none',\n                    };\n                    onOk(group);\n                },\n            },\n        },\n        default: 'add',\n    }, {\n        jQuery: false,\n        width: 380,\n    }).render(true);\n}\n","export function addOngoingEventDialog(onOk: (name: string) => void): void {\n    new Dialog({\n        title: 'Add Ongoing Event',\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label>Name</label> \n                <input name=\"name\" type=\"text\">\n            </div>\n        </form>\n        `,\n        buttons: {\n            add: {\n                icon: '<i class=\"fa-solid fa-plus\"></i>',\n                label: 'Add',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const name = $html.querySelector('input[name=name]') as HTMLInputElement;\n                    onOk(name.value);\n                },\n            },\n        },\n        default: 'add',\n    }, {\n        jQuery: false,\n        width: 380,\n    }).render(true);\n}\n","import {KingdomFeat} from '../data/feats';\nimport {\n    calculateModifiers,\n    createActiveSettlementModifiers,\n    getUntrainedProficiencyMode,\n    Modifier,\n    ModifierTotal,\n    ModifierTotals,\n    ModifierType,\n    ModifierWithId,\n} from '../modifiers';\nimport {getActivitySkills, KingdomPhase} from '../data/activities';\nimport {Skill, skillAbilities} from '../data/skills';\nimport {createSkillModifiers} from '../skills';\nimport {getControlDC, hasFeat, Kingdom, SkillRanks} from '../data/kingdom';\nimport {getCompanionSkillUnlocks, getOverrideUnlockCompanionNames} from '../data/companions';\nimport {capitalize, encodeJson, unslugify} from '../../utils';\nimport {getKingdomActivitiesById, KingdomActivityById} from '../data/activityData';\nimport {cooperativeLeadership, rollCheck} from '../rolls';\nimport {\n    ActiveSettlementStructureResult,\n    getActiveSettlementStructureResult,\n    getSettlement,\n    getSettlementsWithoutLandBorders,\n    getStolenLandsData,\n    ResourceAutomationMode,\n} from '../scene';\nimport {getBooleanSetting, getStringSetting} from '../../settings';\nimport {DegreeOfSuccess} from '../../degree-of-success';\n\nexport type CheckType = 'skill' | 'activity';\n\nexport interface CheckDialogFeatOptions {\n    type: CheckType;\n    activity?: string;\n    dc?: number;\n    dcAdjustment?: number;\n    skill?: Skill;\n    game: Game;\n    kingdom: Kingdom;\n    actor: Actor;\n    overrideSkills?: Partial<SkillRanks>;\n    onRoll: (consumeModifiers: Set<string>) => Promise<void>;\n    afterRoll?: (degree: DegreeOfSuccess) => Promise<void>;\n}\n\ninterface CheckFormData {\n    phase: KingdomPhase | '-';\n    dc: number;\n    selectedSkill: Skill;\n    customModifiers: CustomModifiers;\n    overrideModifiers: Record<string, string>;\n    consumeModifiers: Record<string, boolean>;\n}\n\ninterface TotalAndModifiers {\n    total: ModifierTotals;\n    modifiers: ModifierWithId[];\n}\n\nexport interface ModifierBreakdown {\n    name: string;\n    type: ModifierType;\n    value: number;\n}\n\nexport interface ModifierBreakdowns {\n    creativeSolution: ModifierBreakdown[],\n    supernaturalSolution: ModifierBreakdown[],\n    selected: ModifierBreakdown[],\n}\n\ntype TotalFields = 'circumstance' | 'untyped' | 'item' | 'status';\ntype CustomModifiers = Pick<ModifierTotals, TotalFields>;\n\nfunction createModifierList(modifiers: TotalAndModifiers): ModifierBreakdown[] {\n    return modifiers.modifiers\n        .filter(m => m.enabled)\n        .map(m => {\n            return {\n                type: m.type,\n                value: m.value,\n                name: m.name,\n            };\n        });\n}\n\nexport class CheckDialog extends FormApplication<FormApplicationOptions & CheckDialogFeatOptions, object, null> {\n    private type: CheckType;\n    private activity: string | undefined;\n    private skill: Skill | undefined;\n    private game: Game;\n    private kingdom: Kingdom;\n    private selectedSkill: Skill;\n    private dc: number;\n    private phase: KingdomPhase | undefined;\n    private customModifiers: CustomModifiers = {\n        item: {bonus: 0, penalty: 0},\n        circumstance: {bonus: 0, penalty: 0},\n        status: {bonus: 0, penalty: 0},\n        untyped: {bonus: 0, penalty: 0},\n    };\n    private modifierOverrides: Record<string, boolean> = {};\n    private consumeModifiers: Set<string> = new Set();\n    private onRoll: (consumeModifiers: Set<string>) => Promise<void>;\n    private actor: Actor;\n    private overrideSkills: Partial<SkillRanks> | undefined;\n    private afterRoll: (degree: DegreeOfSuccess) => Promise<void>;\n    private rollOptions: string[] = [];\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-check';\n        options.title = 'Skill Check';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/check.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & CheckDialogFeatOptions) {\n        super(object, options);\n        this.type = options.type;\n        this.activity = options.activity;\n        this.skill = options.skill;\n        this.game = options.game;\n        this.kingdom = options.kingdom;\n        this.actor = options.actor;\n        this.onRoll = options.onRoll;\n        this.afterRoll = options.afterRoll ?? (async (): Promise<void> => {\n        });\n        this.overrideSkills = options.overrideSkills;\n        const automateResourceMode = getStringSetting(this.game, 'automateResources') as ResourceAutomationMode;\n        const {size: kingdomSize} = getStolenLandsData(this.game, automateResourceMode, this.kingdom);\n        const controlDC = getControlDC(this.kingdom.level, kingdomSize, this.kingdom.leaders.ruler.vacant);\n        if (this.type === 'skill') {\n            this.selectedSkill = options.skill!;\n            this.dc = options.dc ?? controlDC;\n        } else {\n            const activityData = getKingdomActivitiesById(this.kingdom.homebrewActivities);\n            this.phase = activityData[this.activity!].phase;\n            this.selectedSkill = this.getActivitySkills(options.kingdom.skillRanks, activityData)[0];\n            const data = activityData[this.activity!];\n            const activityDCType = data.dc;\n            if (options.dc !== undefined) {\n                this.dc = options.dc;\n            } else if (activityDCType === 'control') {\n                this.dc = controlDC;\n            } else if (activityDCType === 'custom') {\n                this.dc = 0;\n            } else if (activityDCType === 'none') {\n                throw Error('Can not perform activity with no DC');\n            } else {\n                this.dc = activityDCType;\n            }\n            // increase DC by adjustment if present\n            this.dc = this.dc + (data.dcAdjustment ?? 0);\n        }\n    }\n\n    private getActivitySkills(ranks: SkillRanks, activities: KingdomActivityById): Skill[] {\n        const activity = this.activity!;\n        const companionSkillUnlocks = getCompanionSkillUnlocks(this.kingdom.leaders, getOverrideUnlockCompanionNames(this.game));\n        const companionUnlockSkills = (Object.entries(companionSkillUnlocks) as [Skill, string[]][])\n            .filter(([, activities]) => activities.includes(activity))\n            .map(([skill]) => skill);\n        const ignoreSkillRequirements = getBooleanSetting(this.game, 'kingdomIgnoreSkillRequirements');\n        const skillRankFilters = ignoreSkillRequirements ? undefined : ranks;\n        const activitySkills = getActivitySkills(this.overrideSkills ?? activities[activity].skills, skillRankFilters);\n        const practicalMagic: Skill[] = activitySkills.includes('engineering') && hasFeat(this.kingdom, 'Practical Magic') ? ['magic'] : [];\n        return Array.from(new Set([...activitySkills, ...companionUnlockSkills, ...practicalMagic]));\n    }\n\n    override getData(options?: Partial<FormApplicationOptions & { feats: KingdomFeat[] }>): Promise<object> | object {\n        const activeSettlementStructureResult = getActiveSettlementStructureResult(this.game, this.kingdom);\n        const activeSettlement = getSettlement(this.game, this.kingdom, this.kingdom.activeSettlement);\n        const activities = getKingdomActivitiesById(this.kingdom.homebrewActivities);\n        const applicableSkills = this.type === 'skill' ? [this.skill!] : this.getActivitySkills(this.kingdom.skillRanks, activities);\n        const additionalModifiers: Modifier[] = createActiveSettlementModifiers(\n            this.kingdom,\n            activeSettlement?.settlement,\n            activeSettlementStructureResult,\n            getSettlementsWithoutLandBorders(this.game, this.kingdom),\n        );\n        const convertedCustomModifiers: Modifier[] = this.createCustomModifiers(this.customModifiers);\n        const skillModifiers = this.calculateModifiers(\n            applicableSkills,\n            activeSettlementStructureResult,\n            additionalModifiers,\n            convertedCustomModifiers,\n            activities,\n        );\n        const creativeSolutionModifier = this.calculateModifiers(\n            applicableSkills,\n            activeSettlementStructureResult,\n            [...additionalModifiers, {enabled: true, type: 'circumstance', value: 2, name: 'Creative Solution'}],\n            convertedCustomModifiers,\n            activities,\n        )[this.selectedSkill];\n        const supernaturalSolutionModifier = this.calculateModifiers(\n            ['magic'],\n            activeSettlementStructureResult,\n            additionalModifiers,\n            convertedCustomModifiers,\n            activities,\n        )['magic'];\n        const selectedSkillModifier = skillModifiers[this.selectedSkill];\n        // set all modifiers as consumed that have a consumeId and are enabled\n        this.rollOptions = selectedSkillModifier.total.rollOptions;\n        this.consumeModifiers = new Set(selectedSkillModifier.modifiers\n            .filter(modifier => modifier.enabled && modifier.consumeId !== undefined)\n            .map(modifier => modifier.consumeId!));\n        const modifierBreakdown = encodeJson({\n            creativeSolution: createModifierList(creativeSolutionModifier),\n            supernaturalSolution: createModifierList(supernaturalSolutionModifier),\n            selected: createModifierList(selectedSkillModifier),\n        });\n        return {\n            ...super.getData(options),\n            invalid: this.selectedSkill === undefined,\n            dc: this.dc,\n            title: this.activity ? unslugify(this.activity) : capitalize(this.skill!),\n            activity: this.activity,\n            selectableSkills: this.createSelectableSkills(skillModifiers),\n            selectedSkill: this.selectedSkill,\n            modifiers: this.createModifiers(selectedSkillModifier),\n            phase: this.phase,\n            customModifiers: this.customModifiers,\n            creativeSolutionModifier: creativeSolutionModifier.total.value,\n            supernaturalSolutionModifier: supernaturalSolutionModifier.total.value,\n            modifierBreakdown,\n        };\n    }\n\n    private calculateModifiers(\n        applicableSkills: Skill[],\n        activeSettlementStructureResult: ActiveSettlementStructureResult | undefined,\n        additionalModifiers: Modifier[],\n        convertedCustomModifiers: Modifier[],\n        activities: KingdomActivityById,\n    ): Record<Skill, TotalAndModifiers> {\n        return Object.fromEntries(applicableSkills.map(skill => {\n            const modifiers = createSkillModifiers({\n                ruin: this.kingdom.ruin,\n                unrest: this.kingdom.unrest,\n                skillRank: (this.kingdom.skillRanks)[skill],\n                abilityScores: this.kingdom.abilityScores,\n                leaders: this.kingdom.leaders,\n                kingdomLevel: this.kingdom.level,\n                untrainedProficiencyMode: getUntrainedProficiencyMode(this.game),\n                ability: skillAbilities[skill],\n                skillItemBonus: activeSettlementStructureResult?.merged?.skillBonuses?.[skill],\n                additionalModifiers: [...additionalModifiers, ...convertedCustomModifiers],\n                activity: this.activity,\n                phase: this.phase,\n                skill,\n                overrides: this.modifierOverrides,\n                activities,\n            });\n            const total = calculateModifiers(modifiers);\n            return [skill, {total, modifiers}];\n        })) as Record<Skill, TotalAndModifiers>;\n    }\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    protected async _updateObject(event: Event, formData: any): Promise<void> {\n        const data = expandObject(formData) as CheckFormData;\n        console.log(data);\n        this.selectedSkill = data.selectedSkill;\n        this.dc = data.dc;\n        this.phase = data.phase === '-' ? undefined : data.phase;\n        this.customModifiers = this.homogenize(data.customModifiers);\n        this.modifierOverrides = (Object.entries(data.overrideModifiers ?? {}) as [string, string][])\n            .filter(([, state]) => state !== '-')\n            .map(([id, state]) => {\n                return {[id]: state === 'enabled'};\n            })\n            .reduce((a, b) => Object.assign(a, b), {});\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        $html.querySelector('#km-roll-skill-assurance')?.addEventListener('click', async (event) => {\n            const target = event.currentTarget as HTMLButtonElement;\n            const dc = parseInt(target.dataset.dc ?? '0', 10);\n            const modifier = parseInt(target.dataset.modifier ?? '0', 10);\n            const creativeSolutionModifier = parseInt(target.dataset.creativeSolutionModifier ?? '0', 10);\n            const supernaturalSolutionModifier = parseInt(target.dataset.supernaturalSolutionModifier ?? '0', 10);\n            const activity = target.dataset.activity;\n            const label = target.dataset.type!;\n            const skill = target.dataset.skill as Skill;\n            const formula = `${modifier}`;\n\n            const degree = await rollCheck({\n                formula,\n                label,\n                activity: activity ? getKingdomActivitiesById(this.kingdom.homebrewActivities)[activity] : undefined,\n                dc,\n                skill,\n                modifier,\n                actor: this.actor,\n                adjustDegreeOfSuccess: cooperativeLeadership(\n                    hasFeat(this.kingdom, 'Cooperative Leadership'),\n                    this.kingdom.level,\n                    this.kingdom.skillRanks[skill],\n                    [...this.rollOptions],\n                ),\n                rollOptions: this.rollOptions,\n                creativeSolutionModifier,\n                supernaturalSolutionModifier,\n                rollType: 'selected',\n            });\n            await this.onRoll(this.consumeModifiers);\n            await this.afterRoll(degree);\n            await this.close();\n        });\n\n        $html.querySelector('#km-roll-skill')?.addEventListener('click', async (event) => {\n            const target = event.currentTarget as HTMLButtonElement;\n            const dc = parseInt(target.dataset.dc ?? '0', 10);\n            const modifier = parseInt(target.dataset.modifier ?? '0', 10);\n            const activity = target.dataset.activity;\n            const label = target.dataset.type!;\n            const modifierBreakdown = target.dataset.modifierBreakdown as string;\n            const skill = target.dataset.skill as Skill;\n            const creativeSolutionModifier = parseInt(target.dataset.creativeSolutionModifier ?? '0', 10);\n            const supernaturalSolutionModifier = parseInt(target.dataset.supernaturalSolutionModifier ?? '0', 10);\n\n            const formula = `1d20+${modifier}`;\n            const degree = await rollCheck({\n                formula,\n                label,\n                activity: activity ? getKingdomActivitiesById(this.kingdom.homebrewActivities)[activity] : undefined,\n                dc,\n                skill,\n                modifier,\n                modifierBreakdown,\n                actor: this.actor,\n                adjustDegreeOfSuccess: cooperativeLeadership(\n                    hasFeat(this.kingdom, 'Cooperative Leadership'),\n                    this.kingdom.level,\n                    this.kingdom.skillRanks[skill],\n                    [...this.rollOptions],\n                ),\n                rollOptions: this.rollOptions,\n                creativeSolutionModifier,\n                supernaturalSolutionModifier,\n                rollType: 'selected',\n            });\n            await this.onRoll(this.consumeModifiers);\n            await this.afterRoll(degree);\n            await this.close();\n        });\n    }\n\n\n    private createSelectableSkills(skillModifiers: Record<Skill, TotalAndModifiers>): object {\n        return Object.entries(skillModifiers).map(([skill, data]) => {\n            const value = data.total.value;\n            const modifier = value >= 0 ? `+${value}` : value;\n            return {label: `${capitalize(skill)} ${modifier}`, value: skill};\n        });\n    }\n\n    private createCustomModifiers(customModifiers: CustomModifiers): Modifier[] {\n        return (Object.entries(customModifiers) as [TotalFields, ModifierTotal][])\n            .flatMap(([type, values]) => {\n                return [{\n                    value: values.bonus,\n                    type,\n                    name: capitalize(type) + ' Bonus',\n                    enabled: true,\n                }, {\n                    value: -values.penalty,\n                    type,\n                    name: capitalize(type) + ' Penalty',\n                    enabled: true,\n                }];\n            });\n    }\n\n    private createModifiers(skillModifier: TotalAndModifiers | undefined): object | undefined {\n        if (skillModifier) {\n            const total = skillModifier.total.value;\n            const totalLabel = total >= 0 ? `+${total}` : total;\n            return {\n                total,\n                totalLabel,\n                assurance: skillModifier.total.assurance,\n                modifiers: skillModifier.modifiers.map(modifier => {\n                    const type = capitalize(modifier.type);\n                    const override = this.modifierOverrides[modifier.id];\n                    return {\n                        name: modifier.name,\n                        type: modifier.value < 0 ? `${type} Penalty` : `${type} Bonus`,\n                        value: modifier.value,\n                        enabled: modifier.enabled,\n                        override: override === undefined ? '-' : (override ? 'enabled' : 'disabled'),\n                        id: modifier.id,\n                        consumable: modifier.consumeId !== undefined &&\n                            this.consumeModifiers.has(modifier.consumeId),\n                    };\n                }),\n            };\n        }\n    }\n\n    /**\n     * Make all bonuses and penalties positive\n     * @param customModifiers\n     * @private\n     */\n    private homogenize(customModifiers: CustomModifiers): CustomModifiers {\n        return Object.fromEntries((Object.entries(customModifiers) as [TotalFields, ModifierTotal][])\n            .map(([type, values]) => {\n                const x: [TotalFields, ModifierTotal] = [type, {\n                    bonus: Math.abs(values.bonus),\n                    penalty: Math.abs(values.penalty),\n                }];\n                return x;\n            })) as CustomModifiers;\n    }\n}\n","import {Settlement} from '../data/kingdom';\nimport {parseCheckbox, parseNumberInput, parseSelect} from '../../utils';\n\nexport function editSettlementDialog(autoLevel: boolean, name: string, data: Settlement, onOk: (data: Settlement) => void): void {\n    const showLevelConfig = data.manualSettlementLevel === true || !autoLevel;\n    new Dialog({\n        title: `Edit Settlement: ${name}`,\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label>Type</label>\n                <select name=\"type\">\n                    <option value=\"capital\" ${data.type === 'capital' ? 'selected' : ''}>Capital</option>\n                    <option value=\"settlement\" ${data.type === 'settlement' ? 'selected' : ''}>Settlement</option>\n                </select>\n            </div>\n            <div ${showLevelConfig ? '' : 'hidden'}>\n                <label>Occupied Blocks</label>\n                <input name=\"lots\" type=\"number\" value=\"${data.lots}\">\n            </div>\n            <div ${showLevelConfig ? '' : 'hidden'}>\n                <label>Level</label>\n                <input name=\"level\" type=\"number\" value=\"${data.level}\">\n            </div>\n            <div>\n                <label>Water Borders</label>\n                <input name=\"waterBorders\" type=\"number\" value=\"${data.waterBorders}\">\n            </div>\n            <div>\n                <label>Secondary Territory</label>\n                <input name=\"secondaryTerritory\" type=\"checkbox\" ${data.secondaryTerritory ? 'checked' : ''}>\n            </div>\n            <div>\n                <label>Manual Settlement Level (reopen dialog after saving)</label>\n                <input name=\"manualSettlementLevel\" type=\"checkbox\" ${data.manualSettlementLevel === true ? 'checked' : ''}>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    onOk({\n                        level: parseNumberInput($html, 'level'),\n                        secondaryTerritory: parseCheckbox($html, 'secondaryTerritory'),\n                        type: parseSelect($html, 'type') as 'capital' | 'settlement',\n                        lots: parseNumberInput($html, 'lots'),\n                        waterBorders: parseNumberInput($html, 'waterBorders'),\n                        sceneId: data.sceneId,\n                        manualSettlementLevel: parseCheckbox($html, 'manualSettlementLevel'),\n                    });\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 580,\n    }).render(true);\n}\n","function editTemplate(structureData: object | undefined): string {\n    const root = document.createElement('form');\n    const textarea = document.createElement('textarea');\n    textarea.name = 'json';\n    textarea.innerHTML = structureData ? JSON.stringify(structureData, null, 2) : '';\n    root.appendChild(textarea);\n    return root.outerHTML;\n}\n\nexport async function showStructureEditDialog(game: Game, actor: Actor): Promise<void> {\n    const structureData = actor!.getFlag('pf2e-kingmaker-tools', 'structureData') ?? undefined;\n    new Dialog({\n        title: 'Edit Structure Data',\n        content: editTemplate(structureData),\n        buttons: {\n            roll: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const json = $html.querySelector('textarea[name=json]') as HTMLInputElement;\n                    const value = json.value.trim() === '' ? null : JSON.parse(json.value);\n                    await actor.unsetFlag('pf2e-kingmaker-tools', 'structureData');\n                    await actor.setFlag('pf2e-kingmaker-tools', 'structureData', value);\n                },\n            },\n        },\n        default: 'roll',\n    }, {\n        jQuery: false,\n    }).render(true, {width: 400, classes: ['edit-structure-json', 'kingmaker-tools-app']});\n}\n","import {getBooleanSetting, getNumberSetting, getStringArraySetting, getStringSetting, setSetting} from '../../settings';\nimport {isCompanionName} from '../data/companions';\nimport {updateKingdomArmyConsumption} from '../../armies/utils';\nimport {ResourceAutomationMode} from '../scene';\n\ninterface CompanionData {\n    amiri: boolean,\n    ekunday: boolean,\n    harrim: boolean,\n    jaethal: boolean,\n    jubilost: boolean,\n    kalikke: boolean,\n    kanerah: boolean,\n    linzi: boolean,\n    noknok: boolean,\n    octavia: boolean,\n    regongar: boolean,\n    tristian: boolean,\n    valerie: boolean,\n}\n\ntype UntrainedSkillProficiency = 'level' | 'halfLevel' | 'none';\n\ninterface KingdomSettingData {\n    companions: CompanionData;\n    vkXpRules: boolean;\n    rpToXPConversionRate: number;\n    rpToXpConversionLimit: number;\n    doubleSkillIncreases: boolean;\n    untrainedSkillProficiency: UntrainedSkillProficiency;\n    allStructuresItemBonusesStack: boolean;\n    automaticallyCalculateArmyConsumption: boolean;\n    xpPerClaimedHex: number;\n    cultOfTheBloomEvents: boolean;\n    kingdomEventRollMode: string;\n    kingdomEventsTable: string;\n    kingdomCultTable: string;\n    ignoreSkillRequirements: boolean;\n    autoCalculateSettlementLevel: boolean;\n    capitalInvestmentInCapital: boolean;\n    reduceDCToBuildLumberStructures: boolean;\n    automateResources: ResourceAutomationMode;\n}\n\ninterface KingdomSettingOptions {\n    game: Game;\n    sheetActor: Actor;\n    onSave: () => void;\n}\n\nclass KingdomSettings extends FormApplication<FormApplicationOptions & KingdomSettingOptions, object, null> {\n    private game: Game;\n    private onSave: () => void;\n    private data: KingdomSettingData;\n    private actor: Actor;\n\n    constructor(options: KingdomSettingOptions) {\n        super(null, options);\n        this.game = options.game;\n        this.onSave = options.onSave;\n        this.actor = options.sheetActor;\n        this.data = {\n            companions: this.getCompanionBenefits(),\n            allStructuresItemBonusesStack: getBooleanSetting(this.game, 'kingdomAllStructureItemBonusesStack'),\n            ignoreSkillRequirements: getBooleanSetting(this.game, 'kingdomIgnoreSkillRequirements'),\n            automaticallyCalculateArmyConsumption: getBooleanSetting(this.game, 'autoCalculateArmyConsumption'),\n            doubleSkillIncreases: getBooleanSetting(this.game, 'kingdomSkillIncreaseEveryLevel'),\n            rpToXpConversionLimit: getNumberSetting(this.game, 'rpToXpConversionLimit'),\n            rpToXPConversionRate: getNumberSetting(this.game, 'rpToXpConversionRate'),\n            untrainedSkillProficiency: this.getUntrainedProficiency(),\n            vkXpRules: getBooleanSetting(this.game, 'vanceAndKerensharaXP'),\n            xpPerClaimedHex: getNumberSetting(this.game, 'xpPerClaimedHex'),\n            cultOfTheBloomEvents: getBooleanSetting(this.game, 'cultOfTheBloomEvents'),\n            autoCalculateSettlementLevel: getBooleanSetting(this.game, 'autoCalculateSettlementLevel'),\n            kingdomEventsTable: getStringSetting(this.game, 'kingdomEventsTable'),\n            kingdomCultTable: getStringSetting(this.game, 'kingdomCultTable'),\n            kingdomEventRollMode: getStringSetting(this.game, 'kingdomEventRollMode'),\n            capitalInvestmentInCapital: getBooleanSetting(this.game, 'capitalInvestmentInCapital'),\n            reduceDCToBuildLumberStructures: getBooleanSetting(this.game, 'reduceDCToBuildLumberStructures'),\n            automateResources: getStringSetting(this.game, 'automateResources') as ResourceAutomationMode,\n        };\n    }\n\n    private getUntrainedProficiency(): UntrainedSkillProficiency {\n        if (getBooleanSetting(this.game, 'kingdomAlwaysAddLevel')) {\n            return 'level';\n        } else if (getBooleanSetting(this.game, 'kingdomAlwaysAddHalfLevel')) {\n            return 'halfLevel';\n        } else {\n            return 'none';\n        }\n    }\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-settings';\n        options.title = 'Kingdom Settings';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/settings.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = [];\n        options.height = 'auto';\n        options.width = 600;\n        return options;\n    }\n\n    override getData(): Promise<KingdomSettingData> | KingdomSettingData {\n        return this.data;\n    }\n\n    private getCompanionBenefits(): CompanionData {\n        const settings = new Set(getStringArraySetting(this.game, 'forceEnabledCompanionLeadershipBenefits')\n            .filter(isCompanionName));\n        return {\n            amiri: settings.has('Amiri'),\n            ekunday: settings.has('Ekundayo'),\n            harrim: settings.has('Harrim'),\n            jaethal: settings.has('Jaethal'),\n            jubilost: settings.has('Jubilost'),\n            kalikke: settings.has('Kalikke'),\n            kanerah: settings.has('Kanerah'),\n            linzi: settings.has('Linzi'),\n            noknok: settings.has('Nok-Nok'),\n            octavia: settings.has('Octavia'),\n            regongar: settings.has('Regongar'),\n            tristian: settings.has('Tristian'),\n            valerie: settings.has('Valerie'),\n        };\n    }\n\n    protected async _updateObject(event: Event, formData: object): Promise<void> {\n        this.data = {\n            ...this.data,\n            ...expandObject(formData) as KingdomSettingData,\n        };\n        this.render();\n        console.log(this.data);\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        $html.querySelector('.save')\n            ?.addEventListener('click', async (): Promise<void> => {\n                await this.save();\n                await this.close();\n                this.onSave();\n            });\n    }\n\n    private async save(): Promise<void> {\n        await setSetting(this.game, 'forceEnabledCompanionLeadershipBenefits', [\n            ...(this.data.companions.amiri ? ['Amiri'] : []),\n            ...(this.data.companions.ekunday ? ['Ekundayo'] : []),\n            ...(this.data.companions.harrim ? ['Harrim'] : []),\n            ...(this.data.companions.jaethal ? ['Jaethal'] : []),\n            ...(this.data.companions.jubilost ? ['Jubilost'] : []),\n            ...(this.data.companions.kalikke ? ['Kalikke'] : []),\n            ...(this.data.companions.kanerah ? ['Kanerah'] : []),\n            ...(this.data.companions.linzi ? ['Linzi'] : []),\n            ...(this.data.companions.noknok ? ['Nok-Nok'] : []),\n            ...(this.data.companions.octavia ? ['Octavia'] : []),\n            ...(this.data.companions.regongar ? ['Regongar'] : []),\n            ...(this.data.companions.tristian ? ['Tristian'] : []),\n            ...(this.data.companions.valerie ? ['Valerie'] : []),\n        ]);\n        await setSetting(this.game, 'kingdomAllStructureItemBonusesStack', this.data.allStructuresItemBonusesStack);\n        await setSetting(this.game, 'autoCalculateArmyConsumption', this.data.automaticallyCalculateArmyConsumption);\n        await setSetting(this.game, 'kingdomSkillIncreaseEveryLevel', this.data.doubleSkillIncreases);\n        await setSetting(this.game, 'rpToXpConversionLimit', this.data.rpToXpConversionLimit);\n        await setSetting(this.game, 'rpToXpConversionRate', this.data.rpToXPConversionRate);\n        await setSetting(this.game, 'vanceAndKerensharaXP', this.data.vkXpRules);\n        await setSetting(this.game, 'xpPerClaimedHex', this.data.xpPerClaimedHex);\n        await setSetting(this.game, 'cultOfTheBloomEvents', this.data.cultOfTheBloomEvents);\n        await setSetting(this.game, 'kingdomEventsTable', this.data.kingdomEventsTable);\n        await setSetting(this.game, 'kingdomCultTable', this.data.kingdomCultTable);\n        await setSetting(this.game, 'kingdomEventRollMode', this.data.kingdomEventRollMode);\n        await setSetting(this.game, 'kingdomIgnoreSkillRequirements', this.data.ignoreSkillRequirements);\n        await setSetting(this.game, 'autoCalculateSettlementLevel', this.data.autoCalculateSettlementLevel);\n        await setSetting(this.game, 'capitalInvestmentInCapital', this.data.capitalInvestmentInCapital);\n        await setSetting(this.game, 'reduceDCToBuildLumberStructures', this.data.reduceDCToBuildLumberStructures);\n        await setSetting(this.game, 'automateResources', this.data.automateResources);\n        if (this.data.untrainedSkillProficiency === 'level') {\n            await setSetting(this.game, 'kingdomAlwaysAddLevel', true);\n            await setSetting(this.game, 'kingdomAlwaysAddHalfLevel', false);\n        } else if (this.data.untrainedSkillProficiency === 'halfLevel') {\n            await setSetting(this.game, 'kingdomAlwaysAddLevel', false);\n            await setSetting(this.game, 'kingdomAlwaysAddHalfLevel', true);\n        } else {\n            await setSetting(this.game, 'kingdomAlwaysAddLevel', false);\n            await setSetting(this.game, 'kingdomAlwaysAddHalfLevel', false);\n        }\n        if (this.data.automaticallyCalculateArmyConsumption) {\n            await updateKingdomArmyConsumption({\n                kingdomActor: this.actor,\n                game: this.game,\n                forceUpdate: true,\n            });\n        }\n    }\n}\n\n\nexport function showKingdomSettings(options: KingdomSettingOptions): void {\n    new KingdomSettings(options).render(true);\n}","import {kingdomSizeData} from '../data/kingdom';\nimport {capitalize} from '../../utils';\n\nclass KingdomSizeDialog extends Application {\n\n    /** @inheritdoc */\n    static get defaultOptions(): ApplicationOptions {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: 'modules/pf2e-kingmaker-tools/templates/kingdom/kingdom-size-help.hbs',\n            classes: ['dialog'],\n            width: 'auto',\n            jQuery: false,\n        });\n    }\n\n    getData(): object | Promise<object> {\n        return {\n            data: kingdomSizeData.map(s => {\n                return {\n                    size: s.sizeFrom + (s.sizeTo ? '-' + s.sizeTo : ''),\n                    type: capitalize(s.type),\n                    dice: '1' + s.resourceDieSize,\n                    modifier: '+' + s.controlDCModifier,\n                    storage: s.commodityCapacity,\n                };\n            }),\n        };\n    }\n}\n\nexport function kingdomSizeDialog(): void {\n    new KingdomSizeDialog().render(true);\n}","import {parseNullableSelect} from '../../utils';\nimport {RealmTileData} from '../scene';\n\nexport function realmTileDialog(game: Game): void {\n    const drawings = (game.canvas.drawings?.controlled?.map(d => d.document) ?? []) as DrawingDocument[];\n    const tiles = (game.canvas.tiles?.controlled?.map(d => d.document) ?? []) as TileDocument[];\n    if (drawings.length === 0 && tiles.length === 0) {\n        ui.notifications?.error('Please select drawings or tiles!');\n    } else {\n        const data = (drawings[0]?.getFlag('pf2e-kingmaker-tools', 'realmTile')\n            ?? tiles[0]?.getFlag('pf2e-kingmaker-tools', 'realmTile')) as RealmTileData | undefined;\n        new Dialog({\n            title: 'Edit Selected Realm Tiles/Drawings',\n            content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label>Realm Tile Type</label>\n                <select name=\"type\">\n                    <option value=\"-\">-</option>\n                    <option value=\"mine\" ${data?.type === 'mine' ? 'selected' : ''}>Mine</option>\n                    <option value=\"ore\" ${data?.type === 'ore' ? 'selected' : ''}>Ore</option>\n                    <option value=\"lumber\" ${data?.type === 'lumber' ? 'selected' : ''}>Lumber</option>\n                    <option value=\"lumberCamp\" ${data?.type === 'lumberCamp' ? 'selected' : ''}>Lumber Camp</option>\n                    <option value=\"quarry\" ${data?.type === 'quarry' ? 'selected' : ''}>Quarry</option>\n                    <option value=\"stone\" ${data?.type === 'stone' ? 'selected' : ''}>Stone</option>\n                    <option value=\"luxury\" ${data?.type === 'luxury' ? 'selected' : ''}>Luxuries</option>\n                    <option value=\"luxuryWorksite\" ${data?.type === 'luxuryWorksite' ? 'selected' : ''}>Luxuries Worksite</option>\n                    <option value=\"farmland\" ${data?.type === 'farmland' ? 'selected' : ''}>Farmland</option>\n                    <option value=\"food\" ${data?.type === 'food' ? 'selected' : ''}>Food</option>\n                    <option value=\"claimed\" ${data?.type === 'claimed' ? 'selected' : ''}>Claimed Hex</option>\n                </select>\n            </div>\n        </form>\n        `,\n            buttons: {\n                save: {\n                    icon: '<i class=\"fa-solid fa-save\"></i>',\n                    label: 'Save',\n                    callback: async (html): Promise<void> => {\n                        const $html = html as HTMLElement;\n                        const type = parseNullableSelect($html, 'type');\n                        if (type === undefined) {\n                            await Promise.all(drawings.map(d => d.unsetFlag('pf2e-kingmaker-tools', 'realmTile')));\n                            await Promise.all(tiles.map(d => d.unsetFlag('pf2e-kingmaker-tools', 'realmTile')));\n                        } else {\n                            await Promise.all(drawings.map(d => d.setFlag('pf2e-kingmaker-tools', 'realmTile', {type})));\n                            await Promise.all(tiles.map(d => d.setFlag('pf2e-kingmaker-tools', 'realmTile', {type})));\n                        }\n                    },\n                },\n            },\n            default: 'save',\n        }, {\n            jQuery: false,\n            width: 300,\n        }).render(true);\n    }\n}\n","import {settlementTypeData} from '../structures';\n\nclass SettlementSizeDialog extends Application {\n\n    /** @inheritdoc */\n    static get defaultOptions(): ApplicationOptions {\n        return foundry.utils.mergeObject(super.defaultOptions, {\n            template: 'modules/pf2e-kingmaker-tools/templates/kingdom/settlement-size-help.hbs',\n            classes: ['dialog'],\n            width: 'auto',\n            jQuery: false,\n        });\n    }\n\n    getData(): object | Promise<object> {\n        return {\n            data: settlementTypeData.map(s => {\n                return {\n                    type: s.type,\n                    blocks: s.maximumLots,\n                    population: s.population,\n                    level: s.levelFrom && s.levelTo ? (s.levelFrom !== s.levelTo ? s.levelFrom + '-' + s.levelTo : s.levelFrom) : s.levelFrom + '+',\n                    consumption: s.consumption,\n                    maxItemBonus: '+' + s.maxItemBonus,\n                    influence: s.influence === 1 ? '1 hex' : s.influence + ' hexes',\n                };\n            }),\n        };\n    }\n}\n\n\nexport function settlementSizeDialog(): void {\n    new SettlementSizeDialog().render(true);\n}","import {ActivityBonuses, ItemLevelBonuses, SkillItemBonuses} from '../data/structures';\nimport {capitalize, createUUIDLink, unslugify} from '../../utils';\nimport {calculateAvailableItems, countStructureOccurrences, groupAvailableItems, StructureResult} from '../structures';\nimport {hasFeat, Kingdom} from '../data/kingdom';\nimport {\n    ActorStructure,\n    getCapitalSettlement,\n    getSceneActorStructures,\n    getSettlement,\n    getSettlementInfo,\n    getStructureResult,\n    getStructureStackMode,\n    SettlementAndScene,\n} from '../scene';\nimport {getBooleanSetting} from '../../settings';\nimport {getKingdomActivitiesById} from '../data/activityData';\n\ninterface SettlementOptions {\n    game: Game;\n    settlementId: string;\n    kingdom: Kingdom;\n}\n\ninterface LabeledData<T = string> {\n    label: string;\n    value: T;\n}\n\ninterface SkillBonusData extends LabeledData<number> {\n    actions: LabeledData<number>[];\n}\n\ninterface ItemLevelBonusData {\n    label: string;\n    value: number;\n}\n\ninterface StructureList {\n    link: string;\n    occurrences: number;\n}\n\ntype SettlementTab = 'status' | 'effects' | 'bonuses' | 'buildings' | 'shopping' | 'storage';\n\nclass SettlementApp extends Application<ApplicationOptions & SettlementOptions> {\n    private kingdom: Kingdom;\n\n    static override get defaultOptions(): ApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'settlement-app';\n        options.title = 'Settlement';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/settlement.hbs';\n        options.classes = ['kingmaker-tools-app', 'settlement-app'];\n        options.width = 400;\n        options.height = 'auto';\n        return options;\n    }\n\n    private readonly game: Game;\n    private readonly settlementId: string;\n    private nav: SettlementTab = 'status';\n\n    constructor(options: Partial<ApplicationOptions> & SettlementOptions) {\n        super(options);\n        this.game = options.game;\n        this.settlementId = options.settlementId;\n        this.kingdom = options.kingdom;\n    }\n\n    override async getData(): Promise<object> {\n        const settlement = getSettlement(this.game, this.kingdom, this.settlementId)!;\n        const capital = getCapitalSettlement(this.game, this.kingdom);\n        const structureStackMode = getStructureStackMode(this.game);\n        const autoCalculateSettlementLevel = getBooleanSetting(this.game, 'autoCalculateSettlementLevel');\n        const activities = getKingdomActivitiesById(this.kingdom.homebrewActivities);\n        const structureData = getStructureResult(structureStackMode, autoCalculateSettlementLevel, activities, settlement, capital);\n        const builtStructures = await this.getBuiltStructures(settlement);\n        const storage = this.getStorage(structureData);\n        const settlementInfo = getSettlementInfo(settlement, autoCalculateSettlementLevel);\n        const skillItemBonuses = this.getSkillBonuses(structureData.skillBonuses);\n        const hasEffects = structureData.notes.length > 0;\n        const hasStorage = Object.keys(storage).length > 0;\n        const hasBonuses = skillItemBonuses.map(b => b.value > 0 || b.actions.some(a => a.value > 0));\n        const hasBuildings = builtStructures.length > 0;\n        // reset active tab if not active anymore\n        if (this.nav === 'effects' && !hasEffects) this.nav = 'status';\n        if (this.nav === 'storage' && !hasStorage) this.nav = 'status';\n        if (this.nav === 'bonuses' && !hasBonuses) this.nav = 'status';\n        if (this.nav === 'buildings' && !hasBuildings) this.nav = 'status';\n        return {\n            name: settlement.scene.name,\n            type: capitalize(settlement.settlement.type),\n            secondaryTerritory: settlement.settlement.secondaryTerritory,\n            hasBridge: structureData.hasBridge,\n            waterBorders: settlement.settlement.waterBorders,\n            ...settlementInfo,\n            ...this.getActiveTabs(),\n            config: structureData.config,\n            builtStructures,\n            hasStorage,\n            hasEffects,\n            hasBonuses,\n            hasBuildings,\n            overcrowded: settlementInfo.lots > structureData.residentialLots,\n            residentialLots: structureData.residentialLots,\n            consumption: structureData.consumption,\n            consumptionSurplus: structureData.consumptionSurplus,\n            capitalInvestmentPossible: structureData.allowCapitalInvestment ? 'yes' : 'no',\n            settlementEventBonus: structureData.settlementEventBonus,\n            leadershipActivityBonus: structureData.leadershipActivityBonus,\n            notes: structureData.notes,\n            leadershipActivities: structureData.increaseLeadershipActivities ? 3 : 2,\n            availableItems: this.getAvailableItems(settlementInfo.level, structureData.itemLevelBonuses),\n            storage,\n            skillItemBonuses,\n        };\n    }\n\n    public sceneChange(): void {\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        Hooks.on('createToken', this.sceneChange.bind(this));\n        Hooks.on('sightRefresh', this.sceneChange.bind(this)); // end of drag movement\n        Hooks.on('deleteToken', this.sceneChange.bind(this));\n        const $html = html[0];\n        $html.querySelectorAll('.km-nav a')?.forEach(el => {\n            el.addEventListener('click', (event) => {\n                const tab = event.currentTarget as HTMLAnchorElement;\n                this.nav = tab.dataset.tab as SettlementTab;\n                this.render();\n            });\n        });\n    }\n\n    override close(options?: FormApplication.CloseOptions): Promise<void> {\n        Hooks.off('createToken', this.sceneChange);\n        Hooks.off('sightRefresh', this.sceneChange); // end of drag movement\n        Hooks.off('deleteToken', this.sceneChange);\n        return super.close(options);\n    }\n\n    private getAvailableItems(settlementLevel: number, itemLevelBonuses: ItemLevelBonuses): ItemLevelBonusData[] {\n        const qualityOfLifeBonus = hasFeat(this.kingdom, 'Quality of Life') ? 1 : 0;\n        const bonuses = calculateAvailableItems(itemLevelBonuses, settlementLevel, qualityOfLifeBonus);\n        const groupedBonuses = groupAvailableItems(bonuses);\n        return (Array.from(Object.entries(groupedBonuses)) as [keyof ItemLevelBonuses, number][])\n            .map(([key, value]) => {\n                return {label: itemBonusLabels[key], value};\n            });\n    }\n\n    private getStorage(structures: StructureResult): LabeledData[] {\n        return Object.entries(structures.storage)\n            .filter(([, bonus]) => bonus > 0)\n            .map(([type, bonus]) => {\n                return {\n                    label: capitalize(type),\n                    value: bonus,\n                };\n            });\n    }\n\n    private getSkillBonuses(skillBonuses: SkillItemBonuses): SkillBonusData[] {\n        return Object.entries(skillBonuses)\n            .filter(([, bonus]) => bonus.value > 0 || (bonus.activities && Object.keys(bonus.activities).length > 0))\n            .map(([skill, bonus]) => {\n                return {\n                    label: capitalize(skill),\n                    value: bonus.value,\n                    actions: (Object.entries(bonus.activities) as ([keyof ActivityBonuses, number])[])\n                        .map(([action, value]) => {\n                            return {\n                                label: unslugify(action),\n                                value: value,\n                            };\n                        }),\n                };\n            });\n    }\n\n    private async getBuiltStructures(settlement: SettlementAndScene): Promise<StructureList[]> {\n        const sceneActorStructures = getSceneActorStructures(settlement.scene);\n        const countedStructures = countStructureOccurrences(sceneActorStructures);\n        return await Promise.all(Array.from(countedStructures.entries())\n            .sort(([a], [b]) => a.localeCompare(b))\n            .map(([, value]): [ActorStructure, number] => [value.item, value.count])\n            .map(async ([structure, occurrences]) => {\n                return {\n                    link: await TextEditor.enrichHTML(createUUIDLink(structure.actor.uuid, structure.name)),\n                    occurrences: occurrences,\n                };\n            }));\n    }\n\n    private getActiveTabs(): Record<string, boolean> {\n        return {\n            statusTab: this.nav === 'status',\n            bonusesTab: this.nav === 'bonuses',\n            effectsTab: this.nav === 'effects',\n            shoppingTab: this.nav === 'shopping',\n            buildingsTab: this.nav === 'buildings',\n            storageTab: this.nav === 'storage',\n        };\n    }\n}\n\nexport async function showSettlement(game: Game, settlementId: string, kingdom: Kingdom): Promise<void> {\n    new SettlementApp({game, settlementId, kingdom}).render(true);\n}\n\nconst itemBonusLabels: Record<keyof ItemLevelBonuses, string> = {\n    'alchemical': 'Alchemical',\n    'magical': 'Magical',\n    'luxuryMagical': 'Magical (Luxury)',\n    'arcane': 'Arcane',\n    'luxuryArcane': 'Arcane (Luxury)',\n    'divine': 'Divine',\n    'luxuryDivine': 'Divine (Luxury)',\n    'occult': 'Occult',\n    'luxuryOccult': 'Occult (Luxury)',\n    'primal': 'Primal',\n    'luxuryPrimal': 'Primal (Luxury)',\n    'other': 'Other',\n};","export function setupDialog(game: Game, sheet: 'Kingdom' | 'Camping', actorId: string, onOk: () => void): void {\n    new Dialog({\n        title: `${sheet} Sheet Setup`,\n        content: `\n        <p>No ${sheet} Sheet found! Click \"Import\" which creates an NPC actor called \"${sheet} Sheet\" which will be used to store your data. Adjust permissions as usual to give your players access</p>\n        `,\n        buttons: {\n            importSheet: {\n                icon: '<i class=\"fa-solid fa-plus\"></i>',\n                label: 'Import',\n                callback: async (): Promise<void> => {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    const pack = game.packs.get('pf2e-kingmaker-tools.kingmaker-tools-sheets') as any;\n                    await game?.actors?.importFromCompendium(pack, actorId);\n                    onOk();\n                },\n            },\n        },\n        default: 'importSheet',\n    }, {\n        jQuery: false,\n        width: 380,\n    }).render(true);\n}\n","import {getKingdomActivitiesById} from '../data/activityData';\nimport {capitalize} from '../../utils';\nimport {rankToLabel} from '../modifiers';\nimport {updateResources} from '../resources';\nimport {getKingdom} from '../storage';\n\ninterface HelpOptions {\n    activity: string;\n    game: Game;\n    actor: Actor;\n}\n\nclass HelpApplication extends Application<ApplicationOptions & HelpOptions> {\n    private activity: string;\n    private game: Game;\n    private actor: Actor;\n\n    static override get defaultOptions(): ApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'help-app';\n        options.title = 'Help';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/help.hbs';\n        options.classes = ['kingmaker-tools-app', 'help-app'];\n        options.width = 500;\n        options.height = 'auto';\n        return options;\n    }\n\n    constructor(options: Partial<ApplicationOptions> & HelpOptions) {\n        super(options);\n        this.activity = options.activity;\n        this.game = options.game;\n        this.actor = options.actor;\n    }\n\n    async getData(): Promise<unknown> {\n        const kingdom = getKingdom(this.actor);\n        const data = getKingdomActivitiesById(kingdom.homebrewActivities)[this.activity]!;\n        const traits = (data.fortune ? [capitalize(data.phase), 'Downtime', 'Fortune'] : [capitalize(data.phase), 'Downtime'])\n            .join(', ');\n        const skills = Object.entries(data.skills)\n            .map(([skill, rank]) => {\n                if (rank === 0) {\n                    return capitalize(skill);\n                } else {\n                    return `${capitalize(skill)}: ${rankToLabel(rank)}`;\n                }\n            })\n            .join(', ');\n        return {\n            ...data,\n            criticalSuccess: await this.enrichIfDefined(data.criticalSuccess?.msg),\n            success: await this.enrichIfDefined(data.success?.msg),\n            failure: await this.enrichIfDefined(data.failure?.msg),\n            criticalFailure: await this.enrichIfDefined(data.criticalFailure?.msg),\n            description: await this.enrichIfDefined(data.description),\n            requirement: await this.enrichIfDefined(data.requirement),\n            companion: await this.enrichIfDefined(data.companion),\n            title: data.title,\n            special: data.special,\n            traits,\n            skills,\n        };\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        $html.querySelector('#km-close-help')\n            ?.addEventListener('click', async () => {\n                await this.close();\n            });\n        $html.querySelectorAll('.km-gain-lose')?.forEach(el => {\n            el.addEventListener('click', async (event) => {\n                event.preventDefault();\n                const target = event.currentTarget as HTMLButtonElement;\n                await updateResources(this.game, this.actor, target);\n            });\n        });\n        // bind pf2e flat checks :/\n        $html.querySelectorAll('[data-pf2-check]')?.forEach(el => {\n            el.addEventListener('click', async (event) => {\n                event.preventDefault();\n                const target = event.currentTarget as HTMLSpanElement;\n                const dc = target.dataset.pf2Dc ?? 1;\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                const pf2eGame = this.game as any;\n                const checkModifier = new pf2eGame.pf2e.CheckModifier('Flat Check', {modifiers: []});\n                await pf2eGame.pf2e.Check.roll(checkModifier, {type: 'flat-check', dc: {value: dc}});\n            });\n        });\n    }\n\n    private async enrichIfDefined(msg: string | undefined): Promise<string | undefined> {\n        if (msg) {\n            /* eslint-disable @typescript-eslint/no-explicit-any */\n            const mode = {async: true} as any;\n            return await TextEditor.enrichHTML(msg, mode);\n        }\n    }\n}\n\nexport async function showHelpDialog(game: Game, actor: Actor, activity: string): Promise<void> {\n    new HelpApplication({activity, actor, game}).render(true);\n}\n","import {Structure} from '../data/structures';\nimport {capitalize, createUUIDLink, escapeHtml, isBlank, isNonNullable, listenClick, unslugify} from '../../utils';\nimport {rankToLabel} from '../modifiers';\nimport {Kingdom} from '../data/kingdom';\nimport {CheckDialog} from './check-dialog';\nimport {getBooleanSetting} from '../../settings';\nimport {getKingdom, saveKingdom} from '../storage';\nimport {DegreeOfSuccess} from '../../degree-of-success';\nimport {ActorStructure, getStructuresFromActors} from '../scene';\n\ninterface StructureBrowserOptions {\n    game: Game;\n    kingdom: Kingdom;\n    structureActors: Actor[];\n    sheetActor: Actor;\n    onRoll: (consumeModifiers: Set<string>) => Promise<void>,\n}\n\ninterface ActivityFilter {\n    name: string;\n    enabled: boolean;\n}\n\ninterface StructureData {\n    lots?: number;\n    name: string;\n    skills: string[];\n    dc?: number;\n    rp?: number;\n    lumber?: number;\n    luxuries?: number;\n    ore?: number;\n    stone?: number;\n}\n\ninterface StructureBrowserData {\n    housing: boolean;\n    affectsDowntime: boolean;\n    affectsEvents: boolean;\n    items: boolean;\n    storage: boolean;\n    consumption: boolean;\n    reducesRuin: boolean;\n    reducesUnrest: boolean;\n    infrastructure: boolean;\n    upgradeFrom: boolean;\n    upgradeTo: boolean;\n    ignoreProficiencyRequirements: boolean;\n    structures: StructureData[];\n    activities: Partial<Record<string, ActivityFilter>>;\n    level: number;\n    lots: number;\n    noStructures: boolean;\n    ignoreStructureCost: boolean;\n    search: string;\n}\n\ntype StructureFilters = Omit<StructureBrowserData, 'structures' | 'noStructures'>;\n\nfunction checkProficiency(structure: Structure, kingdom: Kingdom): boolean {\n    return structure.construction?.skills === undefined ||\n        structure.construction.skills.length === 0 ||\n        structure.construction.skills.some(requirement => {\n            return kingdom.skillRanks[requirement.skill] >= (requirement.proficiencyRank ?? 0);\n        });\n}\n\nfunction checkRpCost(structure: Structure, kingdom: Kingdom): boolean {\n    return (structure.construction?.rp ?? 0) <= kingdom.resourcePoints.now;\n}\n\nfunction checkLumberCost(structure: Structure, kingdom: Kingdom): boolean {\n    return (structure.construction?.lumber ?? 0) <= kingdom.commodities.now.lumber;\n}\n\nfunction checkOreCost(structure: Structure, kingdom: Kingdom): boolean {\n    return (structure.construction?.ore ?? 0) <= kingdom.commodities.now.ore;\n}\n\nfunction checkStoneCost(structure: Structure, kingdom: Kingdom): boolean {\n    return (structure.construction?.stone ?? 0) <= kingdom.commodities.now.stone;\n}\n\nfunction checkLuxuriesCost(structure: Structure, kingdom: Kingdom): boolean {\n    return (structure.construction?.luxuries ?? 0) <= kingdom.commodities.now.luxuries;\n}\n\n\nfunction checkBuildingCost(structure: Structure, kingdom: Kingdom): boolean {\n    return checkLumberCost(structure, kingdom)\n        && checkRpCost(structure, kingdom)\n        && checkLuxuriesCost(structure, kingdom)\n        && checkOreCost(structure, kingdom)\n        && checkStoneCost(structure, kingdom);\n}\n\nclass StructureBrowserApp extends FormApplication<\n    FormApplicationOptions & StructureBrowserOptions,\n    object,\n    null\n> {\n    private level: number;\n    private structureActors: Actor[];\n    private kingdom: Kingdom;\n\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'structure-browser-app';\n        options.title = 'Structure Browser';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/structure-browser.hbs';\n        options.classes = ['kingmaker-tools-app', 'structure-browser-app'];\n        options.width = 960;\n        options.height = 600;\n        options.height = 'auto';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.scrollY = ['#km-structure-browser-content', '#km-structure-browser-sidebar'];\n        return options;\n    }\n\n    private readonly game: Game;\n    private filters?: StructureFilters;\n    private sheetActor: Actor;\n    private onRoll: (consumeModifiers: Set<string>) => Promise<void>;\n\n    constructor(options: Partial<ApplicationOptions> & StructureBrowserOptions) {\n        super(null, options);\n        this.game = options.game;\n        this.level = options.kingdom.level;\n        this.structureActors = options.structureActors;\n        this.kingdom = options.kingdom;\n        this.sheetActor = options.sheetActor;\n        this.onRoll = options.onRoll;\n    }\n\n    private async resetFilters(): Promise<StructureFilters> {\n        const structures = getStructuresFromActors(this.structureActors);\n        const activities = getAllStructureActivities(structures);\n        return {\n            search: '',\n            reducesUnrest: false,\n            housing: false,\n            affectsDowntime: false,\n            affectsEvents: false,\n            items: false,\n            storage: false,\n            consumption: false,\n            reducesRuin: false,\n            upgradeFrom: false,\n            upgradeTo: false,\n            infrastructure: false,\n            ignoreProficiencyRequirements: false,\n            ignoreStructureCost: false,\n            lots: 4,\n            activities: Object.fromEntries(activities.map(activity => {\n                return [activity, {name: unslugify(activity), enabled: false}];\n            })),\n            level: this.level,\n        };\n    }\n\n    override async getData(): Promise<StructureBrowserData> {\n        this.kingdom = getKingdom(this.sheetActor);\n        if (this.filters === undefined) {\n            this.filters = await this.resetFilters();\n        }\n        const structureActors = getStructuresFromActors(this.structureActors)\n            .filter(a => a.name !== 'Rubble');\n        const structures = this.filterStructures(structureActors, this.filters);\n        const viewStructures = await this.toViewStructures(structures);\n        return {\n            ...this.filters,\n            structures: viewStructures,\n            activities: this.filters.activities,\n            noStructures: structureActors.length === 0,\n        };\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        const $html = html[0];\n        listenClick($html, '#km-structure-browser-clear', async (): Promise<void> => {\n            this.filters = undefined;\n            this.render();\n        });\n        $html.querySelectorAll('.km-structure-link')\n            .forEach(el => el.addEventListener('click', async (ev): Promise<void> => {\n                ev.preventDefault();\n                ev.stopPropagation();\n                const target = ev.currentTarget as HTMLElement;\n                const uuid = target.dataset.uuid!;\n                const actor = await fromUuid(uuid) as Actor | null;\n                actor?.sheet?.render(true);\n            }));\n        $html.querySelectorAll('.km-build-structure-dialog')\n            .forEach(el => el.addEventListener('click', (ev) => this.buildStructure(ev)));\n    }\n\n    private filterStructures(structures: ActorStructure[], filters: StructureFilters): ActorStructure[] {\n        const enabledFilters: ((structure: Structure) => boolean)[] = [];\n        if (filters.storage) enabledFilters.push((x) => x.storage !== undefined);\n        if (filters.affectsEvents) enabledFilters.push((x) => x.affectsEvents === true);\n        if (filters.affectsDowntime) enabledFilters.push((x) => x.affectsDowntime === true);\n        if (filters.housing) enabledFilters.push((x) => x.traits?.includes('residential') === true);\n        if (filters.infrastructure) enabledFilters.push((x) => x.traits?.includes('infrastructure') === true);\n        if (filters.reducesUnrest) enabledFilters.push((x) => x.reducesUnrest === true);\n        if (filters.reducesRuin) enabledFilters.push((x) => x.reducesRuin === true);\n        if (filters.consumption) enabledFilters.push((x) => x.consumptionReduction !== undefined && x.consumptionReduction > 0);\n        if (filters.items) enabledFilters.push((x) => x.availableItemsRules !== undefined && x.availableItemsRules.length > 0);\n        if (filters.upgradeFrom) enabledFilters.push((x) => x.upgradeFrom !== undefined && x.upgradeFrom.length > 0);\n        if (filters.upgradeTo) enabledFilters.push((x) => this.hasUpgradeTo(x, structures));\n        if (!filters.ignoreProficiencyRequirements) enabledFilters.push(x => checkProficiency(x, this.kingdom));\n        if (!filters.ignoreStructureCost) enabledFilters.push(x => checkBuildingCost(x, this.kingdom));\n        if (!isBlank(filters.search)) enabledFilters.push(x => x.name.toLowerCase().includes(filters.search.trim().toLowerCase()));\n        enabledFilters.push((x) => hasActivities(x, filters.activities));\n        enabledFilters.push((x) => (x.level ?? 0) <= filters.level);\n        enabledFilters.push((x) => (x.lots ?? 0) <= filters.lots);\n        return structures\n            .filter(structure => enabledFilters.every(filter => filter(structure)))\n            .sort((a, b) => a.name.localeCompare(b.name));\n    }\n\n    private async toViewStructures(structures: ActorStructure[]): Promise<StructureData[]> {\n        return await Promise.all(structures.map(async (structure) => {\n            const link = await TextEditor.enrichHTML(createUUIDLink(structure.actor.uuid, structure.name));\n            const lacksProficiency = !checkProficiency(structure, this.kingdom);\n            return {\n                link: link,\n                name: structure.name,\n                uuid: structure.actor.uuid,\n                dc: this.getStructureDC(structure),\n                skills: structure.construction?.skills.map(s => {\n                    const rank = s.proficiencyRank ? ' (' + rankToLabel(s.proficiencyRank) + ')' : '';\n                    const label = unslugify(s.skill);\n                    return label + rank;\n                }) ?? [],\n                lacksProficiency,\n                disableBuild: lacksProficiency && !getBooleanSetting(this.game, 'kingdomIgnoreSkillRequirements'),\n                lumber: structure.construction?.lumber,\n                ore: structure.construction?.ore,\n                stone: structure.construction?.stone,\n                luxuries: structure.construction?.luxuries,\n                rp: structure.construction?.rp,\n                insufficientStone: !checkStoneCost(structure, this.kingdom),\n                insufficientLumber: !checkLumberCost(structure, this.kingdom),\n                insufficientRp: !checkRpCost(structure, this.kingdom),\n                insufficientLuxuries: !checkLuxuriesCost(structure, this.kingdom),\n                insufficientOre: !checkOreCost(structure, this.kingdom),\n                lots: structure.lots === 0 ? undefined : structure.lots,\n                id: structure.actor.id,\n                img: structure.actor.img,\n            };\n        }));\n    }\n\n    private getStructureDC(structure: Structure): number | undefined {\n        const adjustment = getBooleanSetting(this.game, 'reduceDCToBuildLumberStructures')\n        && (structure.construction?.lumber ?? 0) > 0 ? -2 : 0;\n        const dc = structure.construction?.dc;\n        return dc === undefined ? undefined : dc + adjustment;\n    }\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    protected async _updateObject(event: Event, formData: any): Promise<void> {\n        console.log(formData);\n        this.filters = {\n            search: formData.search,\n            housing: formData.housing,\n            affectsDowntime: formData.affectsDowntime,\n            affectsEvents: formData.affectsEvents,\n            items: formData.items,\n            storage: formData.storage,\n            consumption: formData.consumption,\n            reducesRuin: formData.reducesRuin,\n            reducesUnrest: formData.reducesUnrest,\n            infrastructure: formData.infrastructure,\n            upgradeFrom: formData.upgradeFrom,\n            upgradeTo: formData.upgradeTo,\n            ignoreStructureCost: formData.ignoreStructureCost,\n            ignoreProficiencyRequirements: formData.ignoreProficiencyRequirements,\n            level: formData.level,\n            lots: formData.lots,\n            activities: Object.fromEntries(\n                Object.keys(formData)\n                    .filter(d => d.startsWith('activity-'))\n                    .map(d => d.replace('activity-', ''))\n                    .map(activity => {\n                        return [activity, {\n                            name: unslugify(activity),\n                            enabled: formData['activity-' + activity],\n                        }];\n                    }),\n            ),\n        };\n        this.render();\n    }\n\n    private async buildStructure(ev: Event): Promise<void> {\n        const button = ev.currentTarget as HTMLElement;\n        const id = button.dataset.id!;\n        const structureActors = getStructuresFromActors(this.structureActors);\n        const structure = structureActors.find(a => a.actor.id === id);\n        if (structure) {\n            const applicableSkills = structure.construction?.skills?.map(s => {\n                return [s.skill, s.proficiencyRank ?? 0];\n            });\n            new CheckDialog(null, {\n                activity: 'build-structure',\n                kingdom: this.kingdom,\n                dc: this.getStructureDC(structure),\n                overrideSkills: applicableSkills === undefined ? undefined : Object.fromEntries(applicableSkills),\n                game: this.game,\n                type: 'activity',\n                onRoll: this.onRoll,\n                actor: this.sheetActor,\n                afterRoll: async (degree): Promise<void> => {\n                    await this.payStructure(structure, degree);\n                    await this.close();\n                },\n            }).render(true);\n        }\n    }\n\n    private async getPaymentChatData(structure: ActorStructure, degree: DegreeOfSuccess): Promise<{\n        upgradeCosts: { name: string, costs: Costs }[],\n        costs: Costs,\n        structureLink?: string,\n    }> {\n        const structureActors = getStructuresFromActors(this.structureActors);\n        const upgradeFromStructures = (structure.upgradeFrom\n                ?.map(name => structureActors.find(a => a.actor.name === name))\n                ?.filter(structure => isNonNullable(structure))\n            ?? []) as ActorStructure[];\n        const costMode = degree === DegreeOfSuccess.CRITICAL_SUCCESS ? 'half' : 'full';\n        const upgradeCosts: { name: string, costs: Costs }[] = upgradeFromStructures.map(upgradeFrom => {\n            const costs = {\n                rp: Math.max(0, (structure.construction?.rp ?? 0) - (upgradeFrom.construction?.rp ?? 0)),\n                lumber: Math.max(0, (structure.construction?.lumber ?? 0) - (upgradeFrom.construction?.lumber ?? 0)),\n                stone: Math.max(0, (structure.construction?.stone ?? 0) - (upgradeFrom.construction?.stone ?? 0)),\n                ore: Math.max(0, (structure.construction?.ore ?? 0) - (upgradeFrom.construction?.ore ?? 0)),\n                luxuries: Math.max(0, (structure.construction?.luxuries ?? 0) - (upgradeFrom.construction?.luxuries ?? 0)),\n            };\n            return {\n                name: upgradeFrom.name,\n                costs: calculateCosts(costs, costMode),\n            };\n        });\n        const costs = calculateCosts(structure.construction ?? {}, costMode);\n        const structureToLink = degree === DegreeOfSuccess.CRITICAL_FAILURE\n            ? structureActors.find(a => a.actor.name === 'Rubble')?.actor\n            : structure?.actor;\n        const structureLink = structureToLink\n            ? await TextEditor.enrichHTML(createUUIDLink(structureToLink.uuid, structureToLink.name!))\n            : undefined;\n        return {\n            structureLink,\n            costs,\n            upgradeCosts,\n        };\n    }\n\n    private async payStructure(structure: ActorStructure, degree: DegreeOfSuccess): Promise<void> {\n        const {\n            structureLink,\n            costs,\n            upgradeCosts,\n        } = await this.getPaymentChatData(structure, degree);\n        const upgradeButtons = upgradeCosts.map(costs => {\n            const title = `<p><b>Upgrade from ${escapeHtml(costs.name)}:</b></p>`;\n            return title + createPayButton(costs.costs);\n        }).join('');\n        const header = `<h3>Constructing ${escapeHtml(structure.name)}</h3>`;\n        const title = '<p><b>Build Directly:</b></p>';\n        const payButton = title + createPayButton(costs);\n        const linkNote = degree === DegreeOfSuccess.FAILURE\n            ? ' and apply the @UUID[Compendium.pf2e.conditionitems.Item.xYTAsEpcJE1Ccni3]{Slowed} condition to signal that the structure is under construction' : '';\n        const link = structureLink ? `<p><b>Drag onto scene to build${linkNote}:</b></p><p>${structureLink}</p>` : '';\n        await ChatMessage.create({\n            content: header + upgradeButtons + payButton + link,\n        });\n    }\n\n    private hasUpgradeTo(structure: Structure, structures: ActorStructure[]): boolean {\n        return structures.some(s => s.upgradeFrom?.includes(structure.name) ?? false);\n    }\n}\n\nfunction getStructureActivities(structure: Structure): Set<string> {\n    const activityBonuses = structure.activityBonusRules?.map(r => r.activity) ?? [];\n    const skillBonuses = (structure.skillBonusRules\n        ?.filter(r => r.activity !== undefined)\n        ?.map(r => r.activity) ?? []) as string[];\n    return new Set([...activityBonuses, ...skillBonuses]);\n}\n\nfunction hasActivities(structure: Structure, activities: Partial<Record<string, ActivityFilter>>): boolean {\n    const allActivityBonuses = getStructureActivities(structure);\n    const enabledActivities = Array.from(Object.entries(activities))\n        .filter(([, filter]) => filter?.enabled)\n        .map(([activity]) => activity) as string[];\n    return enabledActivities.length === 0 || enabledActivities.every(a => allActivityBonuses.has(a));\n}\n\n\nfunction getAllStructureActivities(structures: Structure[]): string[] {\n    return Array.from(new Set(structures.flatMap(structure => Array.from(getStructureActivities(structure)))))\n        .sort((a, b) => a.localeCompare(b));\n}\n\n\nexport interface Costs {\n    rp: number;\n    ore: number;\n    stone: number;\n    lumber: number;\n    luxuries: number;\n}\n\nfunction createPayButton(costs: Costs): string {\n    return `<button type=\"button\" \n                data-rp=\"${costs.rp}\" \n                data-lumber=\"${costs.lumber}\"\n                data-luxuries=\"${costs.luxuries}\"\n                data-stone=\"${costs.stone}\"\n                data-ore=\"${costs.ore}\"\n                class=\"km-pay-structure\"><b>Pay</b>: ${formatCosts(costs)}</button>`;\n}\n\nexport function parsePayButton(el: HTMLElement): Costs {\n    return {\n        rp: parseInt(el.dataset.rp ?? '0', 10),\n        lumber: parseInt(el.dataset.lumber ?? '0', 10),\n        luxuries: parseInt(el.dataset.luxuries ?? '0', 10),\n        stone: parseInt(el.dataset.stone ?? '0', 10),\n        ore: parseInt(el.dataset.ore ?? '0', 10),\n    };\n}\n\nexport async function payStructure(sheetActor: Actor, costs: Costs): Promise<void> {\n    const kingdom = getKingdom(sheetActor);\n    await saveKingdom(sheetActor, {\n        commodities: {\n            ...kingdom.commodities,\n            now: {\n                ...kingdom.commodities.now,\n                ore: Math.max(0, kingdom.commodities.now.ore - costs.ore),\n                lumber: Math.max(0, kingdom.commodities.now.lumber - costs.lumber),\n                luxuries: Math.max(0, kingdom.commodities.now.luxuries - costs.luxuries),\n                stone: Math.max(0, kingdom.commodities.now.stone - costs.stone),\n            },\n        },\n        resourcePoints: {\n            ...kingdom.resourcePoints,\n            now: Math.max(0, kingdom.resourcePoints.now - costs.rp),\n        },\n    });\n    await ChatMessage.create({\n        content: `<b>Paid:</b> ${formatCosts(costs)}`,\n    });\n}\n\nfunction calculateCosts(costs: Partial<Costs>, mode: 'half' | 'full'): Costs {\n    const zeroedCosts: Costs = {\n        rp: costs.rp ?? 0,\n        ore: costs.ore ?? 0,\n        lumber: costs.lumber ?? 0,\n        luxuries: costs.luxuries ?? 0,\n        stone: costs.stone ?? 0,\n    };\n    if (mode === 'full') {\n        return zeroedCosts;\n    } else {\n        return {\n            rp: zeroedCosts.rp,\n            ore: Math.ceil(zeroedCosts.ore / 2),\n            lumber: Math.ceil(zeroedCosts.lumber / 2),\n            luxuries: Math.ceil(zeroedCosts.luxuries / 2),\n            stone: Math.ceil(zeroedCosts.stone / 2),\n        };\n    }\n}\n\nfunction formatCosts(costs: Costs): string {\n    return (Object.entries(costs) as [string, number][])\n        .filter(([, value]) => value > 0)\n        .map(([key, value]) => {\n            return `${capitalize(key)}: ${value}`;\n        })\n        .join(', ');\n}\n\nexport async function showStructureBrowser(\n    game: Game,\n    structureActors: Actor[],\n    kingdom: Kingdom,\n    sheetActor: Actor,\n    onRoll: (consumeModifiers: Set<string>) => Promise<void>,\n): Promise<void> {\n    new StructureBrowserApp({game, structureActors, kingdom, sheetActor, onRoll}).render(true);\n}\n","import {isStructureActor} from '../scene';\nimport {createUUIDLink, groupBy, isBlank, parseRadio, parseTextInput} from '../../utils';\n\nconst officialMappings: Mapping[] = [{\n    'name': 'Academy',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/academy.webp',\n}, {\n    'name': 'Alchemy Laboratory',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/alchemy-laboratory.webp',\n}, {\n    'name': 'Arcanist\\'s Tower',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/arcanists-tower.webp',\n}, {'name': 'Arena', 'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/arena.webp'}, {\n    'name': 'Bank',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/bank.webp',\n}, {\n    'name': 'Bank (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/bank.webp',\n}, {\n    'name': 'Barracks',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/barracks.webp',\n}, {\n    'name': 'Brewery',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/brewery.webp',\n}, {'name': 'Bridge', 'img': 'pf2e-kingmaker-tools-tokens/structures/Bridge.webp'}, {\n    'name': 'Bridge, Stone',\n    'img': 'pf2e-kingmaker-tools-tokens/structures/Bridge.webp',\n}, {\n    'name': 'Castle',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/castle.webp',\n}, {\n    'name': 'Castle (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/castle.webp',\n}, {\n    'name': 'Cathedral',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/cathedral.webp',\n}, {\n    'name': 'Cemetary',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/cemetery.webp',\n}, {\n    'name': 'Construction Yard',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/construction-yard.webp',\n}, {\n    'name': 'Construction Yard (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/construction-yard.webp',\n}, {'name': 'Dump', 'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/dump.webp'}, {\n    'name': 'Embassy',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/embassy.webp',\n}, {\n    'name': 'Festival Hall',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/festival-hall.webp',\n}, {\n    'name': 'Festival Hall (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/festival-hall.webp',\n}, {\n    'name': 'Foundry',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/foundry.webp',\n}, {\n    'name': 'Garrison',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/garrison.webp',\n}, {\n    'name': 'Garrison (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/garrison.webp',\n}, {\n    'name': 'General Store',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/general-store.webp',\n}, {\n    'name': 'Gladiatorial Arena',\n    'img': 'pf2e-kingmaker-tools-tokens/structures/Gladiatorial%20Arena.webp',\n}, {\n    'name': 'Granary',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/granary.webp',\n}, {\n    'name': 'Granary (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/granary.webp',\n}, {\n    'name': 'Guildhall',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/guildhall.webp',\n}, {\n    'name': 'Herbalist',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/herbalist.webp',\n}, {\n    'name': 'Hospital',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/hospital.webp',\n}, {\n    'name': 'Houses',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/houses.webp',\n}, {\n    'name': 'Illicit Market',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/illicit-market.webp',\n}, {'name': 'Inn', 'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/inn.webp'}, {\n    'name': 'Inn (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/inn.webp',\n}, {'name': 'Jail', 'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/jail.webp'}, {\n    'name': 'Keep',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/keep.webp',\n}, {\n    'name': 'Library',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/library.webp',\n}, {\n    'name': 'Library (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/library.webp',\n}, {\n    'name': 'Lumberyard',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/lumberyard.webp',\n}, {\n    'name': 'Luxury Store',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/luxury-store.webp',\n}, {\n    'name': 'Magic Shop',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/magic-shop.webp',\n}, {\n    'name': 'Magic Shop (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/magic-shop.webp',\n}, {\n    'name': 'Magical Streetlamps',\n    'img': 'pf2e-kingmaker-tools-tokens/structures/Magical%20Streetlamps.webp',\n}, {\n    'name': 'Mansion',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/mansion.webp',\n}, {\n    'name': 'Marketplace',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/marketplace.webp',\n}, {\n    'name': 'Menagerie',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/menagerie.webp',\n}, {\n    'name': 'Military Academy',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/military-academy.webp',\n}, {'name': 'Mill', 'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/mill.webp'}, {\n    'name': 'Mint',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/mint.webp',\n}, {\n    'name': 'Monument',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/monument.webp',\n}, {\n    'name': 'Monument (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/monument.webp',\n}, {\n    'name': 'Museum',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/museum.webp',\n}, {\n    'name': 'Noble Villa',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/noble-villa.webp',\n}, {\n    'name': 'Occult Shop',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/occult-shop.webp',\n}, {\n    'name': 'Occult Shop (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/occult-shop.webp',\n}, {\n    'name': 'Opera House',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/opera-house.webp',\n}, {\n    'name': 'Orphanage',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/orphanage.webp',\n}, {\n    'name': 'Palace',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/palace.webp',\n}, {\n    'name': 'Palace (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/palace.webp',\n}, {\n    'name': 'Park',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/park.webp',\n}, {'name': 'Paved Streets', 'img': 'pf2e-kingmaker-tools-tokens/structures/Paved%20Streets.webp'}, {\n    'name': 'Pier',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/pier.webp',\n}, {'name': 'Printing House', 'img': 'pf2e-kingmaker-tools-tokens/structures/Printing%20Press.webp'}, {\n    'name': 'Rubble',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/rubble.webp',\n}, {\n    'name': 'Sacred Grove',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/sacred-grove.webp',\n}, {\n    'name': 'Secure Warehouse',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/secure-warehouse.webp',\n}, {'name': 'Sewer System', 'img': 'pf2e-kingmaker-tools-tokens/structures/Sewer%20System.webp'}, {\n    'name': 'Shrine',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/shrine.webp',\n}, {\n    'name': 'Smithy',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/smithy.webp',\n}, {\n    'name': 'Smithy (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/smithy.webp',\n}, {\n    'name': 'Specialized Artisan',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/special-artisan.webp',\n}, {\n    'name': 'Stable',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/stable.webp',\n}, {\n    'name': 'Stockyard',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/stockyard.webp',\n}, {\n    'name': 'Stonemason',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/stonemason.webp',\n}, {\n    'name': 'Tannery',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tannery.webp',\n}, {\n    'name': 'Tavern, Dive',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-dive.webp',\n}, {\n    'name': 'Tavern, Dive (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-dive.webp',\n}, {\n    'name': 'Tavern, Luxury',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-luxury.webp',\n}, {\n    'name': 'Tavern, Luxury (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-luxury.webp',\n}, {\n    'name': 'Tavern, Popular',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-popular.webp',\n}, {\n    'name': 'Tavern, Popular (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-popular.webp',\n}, {\n    'name': 'Tavern, World-Class',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-worldclass.webp',\n}, {\n    'name': 'Tavern, World-Class (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tavern-worldclass.webp',\n}, {\n    'name': 'Temple',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/temple.webp',\n}, {\n    'name': 'Tenement',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/tenement.webp',\n}, {\n    'name': 'Theater',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/theatre.webp',\n}, {\n    'name': 'Thieves\\' Guild',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/thieves-guild.webp',\n}, {\n    'name': 'Town Hall',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/town-hall.webp',\n}, {\n    'name': 'Town Hall (V&K)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/town-hall.webp',\n}, {\n    'name': 'Trade Shop',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/trade-shop.webp',\n}, {\n    'name': 'University',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/university.webp',\n}, {\n    'name': 'Wall, Stone',\n    'img': 'pf2e-kingmaker-tools-tokens/structures/Wall%2C%20Stone.webp',\n}, {\n    'name': 'Wall, Wooden',\n    'img': 'pf2e-kingmaker-tools-tokens/structures/Wall%2C%20Wooden.webp',\n}, {\n    'name': 'Watchtower',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/watchtower.webp',\n}, {\n    'name': 'Watchtower, Stone',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/watchtower.webp',\n}, {\n    'name': 'Waterfront (Corner)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/waterfront.webp',\n}, {\n    'name': 'Waterfront (Side)',\n    'img': 'modules/pf2e-kingmaker/assets/maps-settlements/buildings/waterfront-2.webp',\n}];\n\nconst customMappings: Mapping[] = [{\n    'name': 'Academy',\n    'img': 'structures/Academy.webp',\n}, {\n    'name': 'Alchemy Laboratory',\n    'img': 'structures/Alchemy%20Laboratory.webp',\n}, {\n    'name': 'Arcanist\\'s Tower',\n    'img': 'structures/Arcanist%20Tower.webp',\n}, {'name': 'Arena', 'img': 'structures/Arena.webp'}, {\n    'name': 'Bank',\n    'img': 'structures/Bank.webp',\n}, {'name': 'Bank (V&K)', 'img': 'structures/Bank.webp'}, {\n    'name': 'Barracks',\n    'img': 'structures/Barracks.webp',\n}, {'name': 'Brewery', 'img': 'structures/Brewery.webp'}, {\n    'name': 'Bridge',\n    'img': 'structures/Bridge.webp',\n}, {'name': 'Bridge, Stone', 'img': 'structures/Bridge.webp'}, {\n    'name': 'Castle',\n    'img': 'structures/Castle.webp',\n}, {'name': 'Castle (V&K)', 'img': 'structures/Castle.webp'}, {\n    'name': 'Cathedral',\n    'img': 'structures/Cathedral.webp',\n}, {'name': 'Cemetary', 'img': 'structures/Cemetery.webp'}, {\n    'name': 'Construction Yard',\n    'img': 'structures/Construction%20Yard.webp',\n}, {\n    'name': 'Construction Yard (V&K)',\n    'img': 'structures/Construction%20Yard.webp',\n}, {'name': 'Dump', 'img': 'structures/Dump.webp'}, {\n    'name': 'Embassy',\n    'img': 'structures/Embassy.webp',\n}, {\n    'name': 'Festival Hall',\n    'img': 'structures/Festival%20Hall.webp',\n}, {\n    'name': 'Festival Hall (V&K)',\n    'img': 'structures/Festival%20Hall.webp',\n}, {'name': 'Foundry', 'img': 'structures/Foundry.webp'}, {\n    'name': 'Garrison',\n    'img': 'structures/Garrison.webp',\n}, {'name': 'Garrison (V&K)', 'img': 'structures/Garrison.webp'}, {\n    'name': 'General Store',\n    'img': 'structures/General%20Store.webp',\n}, {\n    'name': 'Gladiatorial Arena',\n    'img': 'structures/Gladiatorial%20Arena.webp',\n}, {'name': 'Granary', 'img': 'structures/Granary.webp'}, {\n    'name': 'Granary (V&K)',\n    'img': 'structures/Granary.webp',\n}, {'name': 'Guildhall', 'img': 'structures/Guildhall.webp'}, {\n    'name': 'Herbalist',\n    'img': 'structures/Herbalist.webp',\n}, {'name': 'Hospital', 'img': 'structures/Hospital.webp'}, {\n    'name': 'Houses',\n    'img': 'structures/Houses.webp',\n}, {'name': 'Illicit Market', 'img': 'structures/Illicit%20Market.webp'}, {\n    'name': 'Inn',\n    'img': 'structures/Inn.webp',\n}, {'name': 'Inn (V&K)', 'img': 'structures/Inn.webp'}, {\n    'name': 'Jail',\n    'img': 'structures/Jail.webp',\n}, {'name': 'Keep', 'img': 'structures/Keep.webp'}, {\n    'name': 'Library',\n    'img': 'structures/Library.webp',\n}, {'name': 'Library (V&K)', 'img': 'structures/Library.webp'}, {\n    'name': 'Lumberyard',\n    'img': 'structures/Lumberyard.webp',\n}, {'name': 'Luxury Store', 'img': 'structures/Luxury%20Store.webp'}, {\n    'name': 'Magic Shop',\n    'img': 'structures/Magic%20Shop.webp',\n}, {\n    'name': 'Magic Shop (V&K)',\n    'img': 'structures/Magic%20Shop.webp',\n}, {\n    'name': 'Magical Streetlamps',\n    'img': 'structures/Magical%20Streetlamps.webp',\n}, {'name': 'Mansion', 'img': 'structures/Mansion.webp'}, {\n    'name': 'Marketplace',\n    'img': 'structures/Marketplace.webp',\n}, {'name': 'Menagerie', 'img': 'structures/Menagerie.webp'}, {\n    'name': 'Military Academy',\n    'img': 'structures/Military%20Academy.webp',\n}, {'name': 'Mill', 'img': 'structures/Mill.webp'}, {\n    'name': 'Mint',\n    'img': 'structures/Mint.webp',\n}, {'name': 'Monument', 'img': 'structures/Monument.webp'}, {\n    'name': 'Monument (V&K)',\n    'img': 'structures/Monument.webp',\n}, {'name': 'Museum', 'img': 'structures/Museum.webp'}, {\n    'name': 'Noble Villa',\n    'img': 'structures/Noble%20Villa.webp',\n}, {\n    'name': 'Occult Shop',\n    'img': 'structures/Occult%20Shop.webp',\n}, {\n    'name': 'Occult Shop (V&K)',\n    'img': 'structures/Occult%20Shop.webp',\n}, {'name': 'Opera House', 'img': 'structures/Opera%20House.webp'}, {\n    'name': 'Orphanage',\n    'img': 'structures/Orphanage.webp',\n}, {'name': 'Palace', 'img': 'structures/Palace.webp'}, {\n    'name': 'Palace (V&K)',\n    'img': 'structures/Palace.webp',\n}, {'name': 'Park', 'img': 'structures/Park.webp'}, {\n    'name': 'Paved Streets',\n    'img': 'structures/Paved%20Streets.webp',\n}, {'name': 'Pier', 'img': 'structures/Pier.webp'}, {\n    'name': 'Printing House',\n    'img': 'structures/Printing%20Press.webp',\n}, {'name': 'Rubble', 'img': 'structures/Rubble.webp'}, {\n    'name': 'Sacred Grove',\n    'img': 'structures/Sacred%20Grove.webp',\n}, {\n    'name': 'Secure Warehouse',\n    'img': 'structures/Secure%20Warehouse.webp',\n}, {'name': 'Sewer System', 'img': 'structures/Sewer%20System.webp'}, {\n    'name': 'Shrine',\n    'img': 'structures/Shrine.webp',\n}, {'name': 'Smithy', 'img': 'structures/Smithy.webp'}, {\n    'name': 'Smithy (V&K)',\n    'img': 'structures/Smithy.webp',\n}, {\n    'name': 'Specialized Artisan',\n    'img': 'structures/Special%20Artisan.webp',\n}, {'name': 'Stable', 'img': 'structures/Stable.webp'}, {\n    'name': 'Stockyard',\n    'img': 'structures/Stockyard.webp',\n}, {'name': 'Stonemason', 'img': 'structures/Stonemason.webp'}, {\n    'name': 'Tannery',\n    'img': 'structures/Tannery.webp',\n}, {\n    'name': 'Tavern, Dive',\n    'img': 'structures/Tavern%2C%20Dive.webp',\n}, {\n    'name': 'Tavern, Dive (V&K)',\n    'img': 'structures/Tavern%2C%20Dive.webp',\n}, {\n    'name': 'Tavern, Luxury',\n    'img': 'structures/Tavern%2C%20Luxury.webp',\n}, {\n    'name': 'Tavern, Luxury (V&K)',\n    'img': 'structures/Tavern%2C%20Luxury.webp',\n}, {\n    'name': 'Tavern, Popular',\n    'img': 'structures/Tavern%2C%20Popular.webp',\n}, {\n    'name': 'Tavern, Popular (V&K)',\n    'img': 'structures/Tavern%2C%20Popular.webp',\n}, {\n    'name': 'Tavern, World-Class',\n    'img': 'structures/Tavern%2C%20World%20Class.webp',\n}, {\n    'name': 'Tavern, World-Class (V&K)',\n    'img': 'structures/Tavern%2C%20World%20Class.webp',\n}, {'name': 'Temple', 'img': 'structures/Temple.webp'}, {\n    'name': 'Tenement',\n    'img': 'structures/Tenement.webp',\n}, {'name': 'Theater', 'img': 'structures/Theater.webp'}, {\n    'name': 'Thieves\\' Guild',\n    'img': 'structures/Thieves%20Guild.webp',\n}, {'name': 'Town Hall', 'img': 'structures/Town%20Hall.webp'}, {\n    'name': 'Town Hall (V&K)',\n    'img': 'structures/Town%20Hall.webp',\n}, {'name': 'Trade Shop', 'img': 'structures/Trade%20Shop.webp'}, {\n    'name': 'University',\n    'img': 'structures/University.webp',\n}, {\n    'name': 'Wall, Stone',\n    'img': 'structures/Wall%2C%20Stone.webp',\n}, {\n    'name': 'Wall, Wooden',\n    'img': 'structures/Wall%2C%20Wooden.webp',\n}, {\n    'name': 'Watchtower',\n    'img': 'structures/Watchtower.webp',\n}, {\n    'name': 'Watchtower, Stone',\n    'img': 'structures/Watchtower.webp',\n}, {\n    'name': 'Waterfront (Corner)',\n    'img': 'structures/Waterfront%20(Corner).webp',\n}, {\n    'name': 'Waterfront (Side)',\n    'img': 'structures/Waterfront%20(Side).webp',\n}];\n\ninterface Mapping {\n    name: string;\n    img: string;\n}\n\nasync function migrateActors(actors: Actor[], migrateToMappings: Mapping[]): Promise<void> {\n    const mappingPerName = groupBy(migrateToMappings, (m) => m.name);\n    await (Promise.all(actors.map(async (actor) => {\n        const mapping = mappingPerName.get(actor.name ?? '')?.[0];\n        if (mapping) {\n            const img = mapping.img;\n            await actor.update({'prototypeToken.texture.src': img, img});\n        }\n    })));\n}\n\nfunction getCustomMappings(baseDirectory = 'pf2e-kingmaker-tools-tokens/'): Mapping[] {\n    return customMappings.map(m => {\n        return {\n            name: m.name,\n            img: baseDirectory + m.img,\n        };\n    });\n}\n\nexport async function structureTokenMappingDialog(game: Game): Promise<void> {\n    const importedStructures = game.actors?.filter(a => isStructureActor(a)) ?? [];\n    const journalLink = await TextEditor.enrichHTML(createUUIDLink('Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.iAQCUYEAq4Dy8uCY', 'Kingmaker Tools Manual'));\n    new Dialog({\n        title: 'Change Structure Token Images',\n        content: `\n        <p>Run this macro to change all images of imported structures. The <b>Unofficial Module</b> mapping will use the folder structure described in the ${journalLink} Tokens section.</p> \n        <p>You can change the base directory from <b>pf2e-kingmaker-tools-tokens/</b> to a different folder by adding a different value in the Custom Directory input. That way you can make use of token modules which offers tokens organized in the same folder structure as the Unofficial Module.</p>\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-token-mapping-official\">Official Module</label>\n                <input type=\"radio\" value=\"official\" name=\"mapping\" id=\"km-token-mapping-official\" checked>\n            </div>\n            <div>\n                <label for=\"km-token-mapping-unofficial\">Unofficial Module</label>\n                <input type=\"radio\" value=\"unofficial\" name=\"mapping\" id=\"km-token-mapping-unofficial\">\n            </div>\n            <div>\n                <label for=\"km-token-mapping-custom\">Custom</label>\n                <input type=\"radio\" value=\"custom\" name=\"mapping\" id=\"km-token-mapping-custom\">\n            </div>\n            <div>\n                <label for=\"km-token-mapping-custom\">Custom Directory</label>\n                <input type=\"text\" name=\"customDirectory\" placeholder=\"modules/token-module/img/\">\n            </div>\n        </form>\n        `,\n        buttons: {\n            migrate: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Migrate',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const value = parseRadio($html, 'mapping');\n                    const custom = parseTextInput($html, 'customDirectory');\n                    if (value === 'custom') {\n                        if (isBlank(custom)) {\n                            ui.notifications?.error('Custom Directory can not be empty!');\n                        } else {\n                            // ensure trailing slash\n                            const folder = custom.replace(/\\/$/, '') + '/';\n                            await migrateActors(importedStructures, getCustomMappings(folder));\n                        }\n                    } else if (value === 'official') {\n                        await migrateActors(importedStructures, officialMappings);\n                    } else if (value === 'unofficial') {\n                        await migrateActors(importedStructures, getCustomMappings());\n                    }\n                },\n            },\n        },\n        default: 'migrate',\n    }, {\n        jQuery: false,\n        width: 380,\n    }).render(true);\n}","import {CommodityStorage} from './data/structures';\nimport {Commodities, getSizeData, Kingdom} from './data/kingdom';\nimport {getAllMergedSettlements, getStolenLandsData, ResourceAutomationMode} from './scene';\nimport {clamped} from '../utils';\nimport {getStringSetting} from '../settings';\n\nfunction calculateStorageCapacity(capacity: number, storage: CommodityStorage): Commodities {\n    return {\n        food: capacity + storage.food,\n        ore: capacity + storage.ore,\n        luxuries: capacity + storage.luxuries,\n        lumber: capacity + storage.lumber,\n        stone: capacity + storage.stone,\n    };\n}\n\nexport function getCapacity(game: Game, kingdom: Kingdom): Commodities {\n    const automateResourceMode = getStringSetting(game, 'automateResources') as ResourceAutomationMode;\n    const {size: kingdomSize} = getStolenLandsData(game, automateResourceMode, kingdom);\n    const commodityCapacity = getSizeData(kingdomSize).commodityCapacity;\n    const {storage} = getAllMergedSettlements(game, kingdom);\n    return calculateStorageCapacity(commodityCapacity, storage);\n}\n\nexport function getConsumption(game: Game, kingdom: Kingdom): { current: number, surplus: number } {\n    const allMergedSettlements = getAllMergedSettlements(game, kingdom);\n    const settlementConsumption = allMergedSettlements.settlementConsumption;\n    const resourceMode = getStringSetting(game, 'automateResources') as ResourceAutomationMode;\n    const farmlands = getStolenLandsData(game, resourceMode, kingdom).workSites.farmlands;\n    const farmlandsCount = farmlands.resources + farmlands.quantity;\n    const combinedConsumption = kingdom.consumption.armies + kingdom.consumption.now + settlementConsumption;\n    const current = Math.max(0, combinedConsumption - farmlandsCount);\n    const surplus = Math.max(0, farmlandsCount - combinedConsumption);\n    return {current, surplus};\n}\n\nexport function gainFame(kingdom: Kingdom, fame: number): Partial<Kingdom> {\n    return {\n        fame: {\n            ...kingdom.fame,\n            now: clamped(kingdom.fame.now + fame, 0, 3),\n        },\n    };\n}\n","import {KingdomPhase} from './data/activities';\nimport {capitalize, groupBy, unslugify} from '../utils';\nimport {getLevelData, Kingdom, Leaders, Ruin, Settlement} from './data/kingdom';\nimport {allFeatsByName} from './data/feats';\nimport {Skill, skillAbilities} from './data/skills';\nimport {Ability, AbilityScores, calculateAbilityModifier} from './data/abilities';\nimport {applyLeaderCompanionRules} from './data/companions';\nimport {isInvested} from './data/leaders';\nimport {calculateUnrestPenalty} from './data/unrest';\nimport {abilityRuins} from './data/ruin';\nimport {ActivityBonuses, SkillItemBonus} from './data/structures';\nimport {ActiveSettlementStructureResult} from './scene';\nimport {getBooleanSetting} from '../settings';\nimport {KingdomActivityById} from './data/activityData';\nimport {Proficiency} from '../camping/data';\n\nexport type UntrainedProficiencyMode = 'half' | 'full' | 'none';\n\nexport function getUntrainedProficiencyMode(game: Game): UntrainedProficiencyMode {\n    if (getBooleanSetting(game, 'kingdomAlwaysAddLevel')) {\n        return 'full';\n    } else if (getBooleanSetting(game, 'kingdomAlwaysAddHalfLevel')) {\n        return 'half';\n    } else {\n        return 'none';\n    }\n}\n\nexport const allModifierTypes = [\n    'ability',\n    'proficiency',\n    'item',\n    'status',\n    'circumstance',\n    'vacancy',\n    'untyped',\n] as const;\n\nexport type ModifierType = typeof allModifierTypes[number];\n\nexport interface Modifier {\n    type: ModifierType;\n    value: number;\n    name: string;\n    phases?: KingdomPhase[];\n    activities?: string[];\n    skills?: Skill[];\n    abilities?: Ability[];\n    enabled: boolean;\n    turns?: number;\n    consumeId?: string;\n    rollOptions?: string[];\n}\n\nfunction createPredicateName(values: string[] | undefined, label: string): string | undefined {\n    return values ? `${label}: ${values.map(v => unslugify(v)).join(', ')}` : undefined;\n}\n\nexport function modifierToLabel(modifier: Modifier): string {\n    const value = modifier.value >= 0 ? `+${modifier.value}` : `${modifier.value}`;\n    const type = modifier.value >= 0 ? capitalize(modifier.type) + ' Bonus' : capitalize(modifier.type) + ' Penalty';\n    const to = modifier.skills || modifier.abilities || modifier.activities || modifier.phases ? ' to: ' : '';\n    const predicates = [\n        createPredicateName(modifier.phases, 'Phases'),\n        createPredicateName(modifier.activities, 'Activities'),\n        createPredicateName(modifier.abilities, 'Abilities'),\n        createPredicateName(modifier.skills, 'Skills'),\n    ]\n        .filter(v => v !== undefined)\n        .join('; ');\n    return `${value} ${type}${to}${predicates}`;\n}\n\nexport interface ModifierWithId extends Modifier {\n    id: string;\n}\n\nexport function removeUninterestingZeroModifiers(modifiers: ModifierWithId[]): ModifierWithId[] {\n    return modifiers.filter(modifier => modifier.value !== 0);\n}\n\n/**\n * Deletes all modifiers that are not in a given phase or activity\n */\nexport function removePredicatedModifiers(\n    modifiers: ModifierWithId[],\n    phase: KingdomPhase | undefined,\n    activity: string | undefined,\n    skill: Skill,\n    rank: number,\n    activities: KingdomActivityById,\n): ModifierWithId[] {\n    return modifiers\n        .filter(modifier => {\n            const predicates: ((modifier: Modifier) => boolean)[] = [];\n            if (modifier.abilities) {\n                predicates.push((m) => m.abilities?.includes(skillAbilities[skill]) === true);\n            }\n            if (modifier.skills) {\n                predicates.push((m) => m.skills?.includes(skill) === true);\n            }\n\n            // if we aren't running in a phase, remove all modifiers relevant to a phase\n            if (phase && modifier.phases) {\n                predicates.push((m) => m.phases?.includes(phase) === true);\n            }\n            // if we aren't running in an activity, remove all modifiers not matching the activity\n            if (activity && modifier.activities) {\n                predicates.push((m) => m.activities?.includes(activity) === true);\n            }\n\n            // regardless of if we are running in an activity, we need to check\n            // if it is actually possible to skill check for the given skill and rank\n            if (modifier.activities) {\n                predicates.push((m) => m.activities!\n                    .some(activity => {\n                        const data = activities[activity];\n                        const activitySkillRank = data.skills[skill];\n                        if (activitySkillRank === undefined) {\n                            return false;\n                        } else {\n                            return activitySkillRank <= rank;\n                        }\n                    }),\n                );\n            }\n            let keepModifier = true;\n            for (const predicate of predicates) {\n                keepModifier = keepModifier && predicate(modifier);\n            }\n            return keepModifier;\n        }).map(modifier => {\n            let enabled = modifier.enabled;\n            // modifiers that are running outside a phase or activity should be\n            // disabled by default if they belong to one\n            if (!phase && modifier.phases) {\n                enabled = false;\n            }\n            if (!activity && modifier.activities) {\n                enabled = false;\n            }\n            return {\n                ...modifier,\n                enabled,\n            };\n        });\n}\n\n/**\n * Disables all modifiers that do not have the highest/lowest number\n * @param modifiers\n */\nexport function removeLowestModifiers(modifiers: ModifierWithId[]): ModifierWithId[] {\n    const groupedModifiers = groupBy(modifiers, (modifier) => {\n        if (modifier.value > 0) {\n            return modifier.type;\n        } else {\n            return modifier.type + '-penalty';\n        }\n    });\n    const result: ModifierWithId[] = [];\n    for (const [type, modifiers] of groupedModifiers.entries()) {\n        if (type === 'untyped' || type === 'untyped-penalty') {\n            modifiers.forEach(m => result.push(m));\n        } else {\n            const highestEnabledValue = Math.max(0, ...modifiers\n                .filter(modifier => modifier.enabled)\n                .map(modifier => Math.abs(modifier.value)));\n            const hasEnabled = modifiers.some(modifier => modifier.enabled);\n            // only take the highest modifier of a type if there is an enabled one\n            // if no modifier is enabled, offer all as a choice#\n            if (hasEnabled) {\n                // only keep first one active, disable all other modifiers\n                const highest = modifiers.find(m => m.enabled && Math.abs(m.value) === highestEnabledValue)!;\n                modifiers.forEach(modifier => {\n                    if (modifier.id !== highest.id) {\n                        result.push({\n                            ...modifier,\n                            enabled: false,\n                        });\n                    } else {\n                        result.push(modifier);\n                    }\n                });\n            } else {\n                modifiers.forEach(mod => result.push(mod));\n            }\n        }\n    }\n    return result;\n}\n\nexport interface ModifierTotal {\n    bonus: number;\n    penalty: number;\n}\n\nexport interface ModifierTotals {\n    item: ModifierTotal;\n    circumstance: ModifierTotal;\n    status: ModifierTotal;\n    ability: ModifierTotal;\n    proficiency: ModifierTotal;\n    untyped: ModifierTotal;\n    vacancyPenalty: number;\n    value: number;\n    assurance: number;\n    rollOptions: string[];\n}\n\nexport function calculateModifiers(modifiers: Modifier[]): ModifierTotals {\n    const result: ModifierTotals = {\n        item: {\n            bonus: 0,\n            penalty: 0,\n        },\n        circumstance: {\n            bonus: 0,\n            penalty: 0,\n        },\n        status: {\n            bonus: 0,\n            penalty: 0,\n        },\n        ability: {\n            bonus: 0,\n            penalty: 0,\n        },\n        proficiency: {\n            bonus: 0,\n            penalty: 0,\n        },\n        untyped: {\n            bonus: 0,\n            penalty: 0,\n        },\n        vacancyPenalty: 0,\n        value: 0,\n        assurance: 10,\n        rollOptions: [],\n    };\n    const enabledModifiers = modifiers.filter(modifier => modifier.enabled && modifier.value !== 0);\n    for (const modifier of enabledModifiers) {\n        modifier.rollOptions?.forEach(option => result.rollOptions.push(option));\n        if (modifier.type === 'vacancy') {\n            result.vacancyPenalty = modifier.value;\n        } else {\n            const part = result[modifier.type];\n            const key = modifier.value > 0 ? 'bonus' : 'penalty';\n            if (modifier.type === 'untyped') {\n                part[key] += modifier.value;\n            } else {\n                part[key] = modifier.value;\n            }\n        }\n    }\n    result.assurance = 10 + enabledModifiers\n        .filter(m => {\n            return m.type === 'proficiency' && (m.value > 0 || m.value < 0);\n        })\n        .map(m => m.value)\n        .reduce((a, b) => a + b, 0);\n    result.value = enabledModifiers\n        .map(m => m.value)\n        .reduce((a, b) => a + b, 0);\n    return result;\n}\n\n/**\n * Add modifiers from feats or other rules\n */\nexport function createActiveSettlementModifiers(\n    kingdom: Kingdom,\n    activeSettlement: Settlement | undefined,\n    activeSettlementStructureResult: ActiveSettlementStructureResult | undefined,\n    settlementsWithoutLandBorders: number,\n): Modifier[] {\n    const levelData = getLevelData(kingdom.level);\n    const feats = new Set([...kingdom.feats.map(f => f.id), ...kingdom.feats.map(f => f.id)]);\n    const result: Modifier[] = Array.from(feats)\n        .flatMap(feat => allFeatsByName[feat]?.modifiers ?? []);\n    kingdom.modifiers.forEach(modifier => result.push(modifier));\n    const isSecondaryTerritory = activeSettlement?.secondaryTerritory;\n    if (settlementsWithoutLandBorders > 0) {\n        result.push({\n            name: 'Settlements Without Land Borders',\n            value: settlementsWithoutLandBorders * -1,\n            type: 'item',\n            skills: ['trade'],\n            enabled: true,\n        });\n    }\n    if (isSecondaryTerritory) {\n        result.push({\n            name: 'Check in Secondary Territory',\n            type: 'circumstance',\n            value: -4,\n            enabled: true,\n        });\n    }\n    if (kingdom.level >= 4) {\n        result.push({\n            name: 'Expansion Expert',\n            type: 'circumstance',\n            activities: ['claim-hex'],\n            value: 2,\n            enabled: true,\n        });\n    }\n    const settlementEventBonus = activeSettlementStructureResult?.active.settlementEventBonus ?? 0;\n    if (settlementEventBonus > 0) {\n        result.push({\n            name: 'Event Phase Structure Bonus',\n            type: 'circumstance',\n            value: settlementEventBonus,\n            enabled: true,\n            phases: ['event'],\n        });\n    }\n    const leadershipBonus = activeSettlementStructureResult?.merged.leadershipActivityBonus ?? 0;\n    if (leadershipBonus > 0) {\n        result.push({\n            name: 'Ruler performs Leadership Activity',\n            type: 'item',\n            value: leadershipBonus,\n            enabled: false,\n            phases: ['leadership'],\n        });\n    }\n    result.push({\n        name: 'Invested, Non-Vacant Leader Handles Event',\n        type: 'circumstance',\n        value: levelData.investedLeadershipBonus,\n        enabled: false,\n        phases: ['event'],\n    });\n    return result;\n}\n\nexport function processModifiers(\n    {\n        modifiers,\n        skill,\n        rank,\n        phase,\n        activity,\n        overrides = {},\n        activities,\n    }: {\n        modifiers: Modifier[];\n        skill: Skill;\n        rank: number;\n        phase?: KingdomPhase;\n        activity?: string;\n        overrides?: Record<string, boolean>;\n        activities: KingdomActivityById;\n    },\n): ModifierWithId[] {\n    const copied = modifiers.map((modifier, index) => {\n        // make a copy and assign every modifier an id\n        return {\n            ...(deepClone(modifier)),\n            id: `${index}`,\n        };\n    });\n    const withoutZeroes = removeUninterestingZeroModifiers(copied);\n    const withoutMismatchedPhaseOrActivity = removePredicatedModifiers(withoutZeroes, phase, activity, skill, rank, activities);\n    // enable/disable overrides\n    const withOverrides = withoutMismatchedPhaseOrActivity\n        .map(modifier => {\n            const override = overrides[modifier.id];\n            if (override === undefined) {\n                return modifier;\n            } else {\n                return {\n                    ...modifier,\n                    enabled: override,\n                };\n            }\n        });\n    return removeLowestModifiers(withOverrides);\n}\n\n\nfunction createVacancyModifier(value: number, name: string, rulerVacant: boolean, phase?: KingdomPhase): Modifier {\n    return {\n        name,\n        value: -(rulerVacant ? value + 1 : value),\n        phases: phase ? [phase] : undefined,\n        type: 'vacancy',\n        enabled: true,\n    };\n}\n\nexport function createVacancyModifiers(\n    ability: Ability,\n    leaders: Leaders,\n): Modifier[] {\n    const modifiers = [];\n    const rulerVacant = leaders.ruler.vacant;\n    if (leaders.counselor.vacant && ability === 'culture') {\n        modifiers.push(createVacancyModifier(1, 'Vacancy: Counselor', rulerVacant));\n    }\n    if (leaders.general.vacant) {\n        modifiers.push(createVacancyModifier(4, 'Vacancy: General', rulerVacant, 'army'));\n    }\n    if (leaders.emissary.vacant && ability === 'loyalty') {\n        modifiers.push(createVacancyModifier(1, 'Vacancy: Emissary', rulerVacant));\n    }\n    if (leaders.magister.vacant) {\n        modifiers.push(createVacancyModifier(4, 'Vacancy: Magister', rulerVacant, 'army'));\n    }\n    if (leaders.treasurer.vacant && ability === 'economy') {\n        modifiers.push(createVacancyModifier(1, 'Vacancy: Treasurer', rulerVacant));\n    }\n    if (leaders.viceroy.vacant && ability === 'stability') {\n        modifiers.push(createVacancyModifier(1, 'Vacancy: Viceroy', rulerVacant));\n    }\n    if (leaders.warden.vacant) {\n        modifiers.push(createVacancyModifier(4, 'Vacancy: Warden', rulerVacant, 'region'));\n    }\n    if (rulerVacant) {\n        modifiers.push(createVacancyModifier(0, 'Vacancy: Ruler', rulerVacant));\n    }\n    return modifiers;\n}\n\nexport function createInvestedModifier(\n    kingdomLevel: number,\n    ability: Ability,\n    leaders: Leaders,\n): Modifier | undefined {\n    const appliedLeaders = applyLeaderCompanionRules(leaders);\n    if (isInvested(ability, appliedLeaders)) {\n        return {\n            value: getLevelData(kingdomLevel).investedLeadershipBonus,\n            enabled: true,\n            name: 'Invested Leadership Role',\n            type: 'status',\n        };\n    }\n}\n\nexport function createAbilityModifier(ability: Ability, abilityScores: AbilityScores): Modifier {\n    return {\n        type: 'ability',\n        name: capitalize(ability),\n        enabled: true,\n        value: calculateAbilityModifier(abilityScores[ability]),\n    };\n}\n\nexport function rankToLabel(rank: number): string {\n    if (rank === 0) {\n        return 'Untrained';\n    } else if (rank === 1) {\n        return 'Trained';\n    } else if (rank === 2) {\n        return 'Expert';\n    } else if (rank === 3) {\n        return 'Master';\n    } else {\n        return 'Legendary';\n    }\n}\n\nexport function rankToProficiency(rank: number): Proficiency | undefined {\n    if (rank === 1) {\n        return 'trained';\n    } else if (rank === 2) {\n        return 'expert';\n    } else if (rank === 3) {\n        return 'master';\n    } else if (rank === 4) {\n        return 'legendary';\n    }\n}\n\nexport function proficiencyToRank(proficiency: Proficiency | undefined): number {\n    if (proficiency === 'trained') {\n        return 1;\n    } else if (proficiency === 'expert') {\n        return 2;\n    } else if (proficiency === 'master') {\n        return 3;\n    } else if (proficiency === 'legendary') {\n        return 4;\n    } else {\n        return 0;\n    }\n}\n\nfunction calculateUntrainedProficiency(rank: number, kingdomLevel: number, untrainedProficiencyMode: UntrainedProficiencyMode): number {\n    if (rank > 0) {\n        return kingdomLevel + rank * 2;\n    } else if (untrainedProficiencyMode === 'full') {\n        return kingdomLevel;\n    } else if (untrainedProficiencyMode === 'half') {\n        return Math.floor(kingdomLevel / 2);\n    } else {\n        return 0;\n    }\n}\n\nexport function createProficiencyModifier(rank: number, untrainedProficiencyMode: UntrainedProficiencyMode, kingdomLevel: number): Modifier {\n    const value = calculateUntrainedProficiency(rank, kingdomLevel, untrainedProficiencyMode);\n    const name = rank > 0 ? rankToLabel(rank) : 'Kingdom Level';\n    return {\n        value,\n        enabled: true,\n        name,\n        type: 'proficiency',\n    };\n}\n\nexport function createUnrestModifier(unrest: number): Modifier | undefined {\n    const penalty = calculateUnrestPenalty(unrest);\n    if (penalty > 0) {\n        return {\n            type: 'status',\n            name: 'Unrest',\n            enabled: true,\n            value: -penalty,\n        };\n    }\n}\n\nexport function createRuinModifier(ability: Ability, ruin: Ruin): Modifier | undefined {\n    const ruinAbility = abilityRuins[ability];\n    const itemPenalty = ruin[ruinAbility].penalty;\n    if (itemPenalty > 0) {\n        return {\n            value: -itemPenalty,\n            enabled: true,\n            name: 'Ruin',\n            type: 'item',\n        };\n    }\n}\n\nfunction createSkillModifier(value: number): Modifier | undefined {\n    if (value > 0) {\n        return {\n            value,\n            enabled: true,\n            name: 'Structure',\n            type: 'item',\n        };\n    }\n}\n\nfunction createActivityModifiers(activities: ActivityBonuses, kingdomActivities: KingdomActivityById): Modifier[] {\n    return (Object.entries(activities) as ([string, number])[])\n        .map(([activity, value]) => {\n            const phases = [kingdomActivities[activity].phase];\n            return {\n                type: 'item',\n                enabled: true,\n                value,\n                name: `Structure - ${unslugify(activity)}`,\n                activities: [activity],\n                phases,\n            };\n        });\n}\n\nexport function createStructureModifiers(skillItemBonus: SkillItemBonus, kingdomActivities: KingdomActivityById): Modifier[] {\n    const result = createActivityModifiers(skillItemBonus.activities, kingdomActivities);\n    const skillBonus = createSkillModifier(skillItemBonus.value);\n    if (skillBonus) {\n        result.push(skillBonus);\n    }\n    return result;\n}\n","import {unslugify} from '../utils';\nimport {getSizeData, Kingdom} from './data/kingdom';\nimport {getKingdom, saveKingdom} from './storage';\nimport {getCapacity} from './kingdom-utils';\nimport {getStringSetting} from '../settings';\nimport {getStolenLandsData, ResourceAutomationMode} from './scene';\n\ninterface ResourceValues {\n    value: number;\n    message: string;\n    missingMessage?: string;\n}\n\nexport function calculateNewValue(\n    {\n        currentValue,\n        newValue,\n        type,\n        turn,\n        mode,\n        limit,\n    }: {\n        currentValue: number,\n        newValue: number,\n        type: RolledResources,\n        turn: ResourceTurn,\n        mode: ResourceMode,\n        limit?: number,\n    },\n): ResourceValues {\n    const value = mode === 'gain' ? currentValue + newValue : currentValue - newValue;\n    const missing = value < 0 ? Math.abs(value) : 0;\n    const limitedValue = limit === undefined ? value : Math.min(limit, value);\n    const label = type === 'rolled-resource-dice' ? 'Resource Points' : unslugify(type);\n    const turnLabel = turn === 'now' ? 'this turn' : 'next turn';\n    const message = `${mode === 'gain' ? 'Gaining' : 'Losing'} ${Math.abs(newValue)} ${label} ${turnLabel}`;\n    const missingMessage = missing > 0 && turn === 'now' ? `Missing ${missing} ${label}` : '';\n    return {\n        value: turn === 'now' ? Math.max(0, limitedValue) : limitedValue,\n        message,\n        missingMessage,\n    };\n}\n\nexport function getCurrentValue(kingdom: Kingdom, type: RolledResources, turn: ResourceTurn): number {\n    if (type === 'food' || type === 'luxuries' || type === 'ore' || type === 'lumber' || type === 'stone') {\n        return kingdom.commodities[turn][type];\n    } else if (type === 'unrest') {\n        return kingdom.unrest;\n    } else if (type === 'resource-dice') {\n        return kingdom.resourceDice[turn];\n    } else if (type === 'resource-points' || type === 'rolled-resource-dice') {\n        return kingdom.resourcePoints[turn];\n    } else if (type === 'crime' || type === 'decay' || type === 'strife' || type === 'corruption') {\n        return kingdom.ruin[type].value;\n    } else if (type === 'xp') {\n        return kingdom.xp;\n    } else if (type === 'fame') {\n        return kingdom.fame[turn];\n    } else if (type === 'supernatural-solution') {\n        return kingdom.supernaturalSolutions;\n    } else if (type === 'creative-solution') {\n        return kingdom.creativeSolutions;\n    } else {\n        throw Error(`Unhandled type ${type}`);\n    }\n}\n\nexport function getLimit(game: Game, kingdom: Kingdom, type: RolledResources, turn: ResourceTurn): number | undefined {\n    if (turn === 'now' && (type === 'food' || type === 'luxuries' || type === 'lumber' || type === 'ore' || type === 'stone')) {\n        return (getCapacity(game, kingdom))[type];\n    } else if (type === 'fame') {\n        return 3;\n    } else {\n        return undefined;\n    }\n}\n\n\nexport async function evaluateValue(game: Game, kingdom: Kingdom, resources: RolledResources, value: string): Promise<number> {\n    if (resources === 'rolled-resource-dice') {\n        const num = value.includes('d') ? `(${value})` : value;\n        const automateResourceMode = getStringSetting(game, 'automateResources') as ResourceAutomationMode;\n        const {size: kingdomSize} = getStolenLandsData(game, automateResourceMode, kingdom);\n        const dice = getSizeData(kingdomSize).resourceDieSize;\n        const roll = await new Roll(`${num}${dice}`).roll();\n        await roll.toMessage({flavor: 'Rolling Resource Dice'});\n        return roll.total;\n    } else if (value.includes('d')) {\n        const roll = await new Roll(value).roll();\n        await roll.toMessage({flavor: `Rolling ${unslugify(resources)}`});\n        return roll.total;\n    } else {\n        return parseInt(value, 10);\n    }\n}\n\nexport function createUpdate(kingdom: Kingdom, type: RolledResources, turn: ResourceTurn, value: number): Partial<Kingdom> {\n    if (type === 'rolled-resource-dice' || type === 'resource-points') {\n        return {\n            resourcePoints: {\n                ...kingdom.resourcePoints,\n                [turn]: value,\n            },\n        };\n    } else if (type === 'xp') {\n        return {xp: value};\n    } else if (type === 'fame') {\n        return {\n            fame: {\n                ...kingdom.fame,\n                [turn]: value,\n            },\n        };\n    } else if (type === 'supernatural-solution') {\n        return {supernaturalSolutions: value};\n    } else if (type === 'creative-solution') {\n        return {creativeSolutions: value};\n    } else if (type === 'resource-dice') {\n        return {\n            resourceDice: {\n                ...kingdom.resourceDice,\n                [turn]: value,\n            },\n        };\n    } else if (type === 'unrest') {\n        return {\n            unrest: value,\n        };\n    } else if (type === 'strife' || type === 'crime' || type === 'decay' || type === 'corruption') {\n        return {\n            ruin: {\n                ...kingdom.ruin,\n                [type]: {\n                    ...kingdom.ruin[type],\n                    value: value,\n                },\n            },\n        };\n    } else if (type === 'lumber' || type === 'ore' || type === 'stone' || type === 'food' || type === 'luxuries') {\n        return {\n            commodities: {\n                ...kingdom.commodities,\n                [turn]: {\n                    ...kingdom.commodities[turn],\n                    [type]: value,\n                },\n            },\n        };\n    } else {\n        throw Error(`Unhandled type ${type}`);\n    }\n}\n\n\nexport type ResourceMode = 'gain' | 'lose';\nexport type RolledResources = 'resource-dice'\n    | 'crime'\n    | 'decay'\n    | 'corruption'\n    | 'strife'\n    | 'resource-points'\n    | 'food'\n    | 'luxuries'\n    | 'unrest'\n    | 'ore'\n    | 'lumber'\n    | 'fame'\n    | 'stone'\n    | 'xp'\n    | 'supernatural-solution'\n    | 'creative-solution'\n    | 'rolled-resource-dice'; // TODO: add ruin, commodities\nexport type ResourceTurn = 'now' | 'next';\n\ninterface ResourceButton {\n    type: RolledResources,\n    mode: ResourceMode,\n    turn: ResourceTurn,\n    value: string,\n}\n\nexport function parseResourceButton(element: HTMLButtonElement): ResourceButton {\n    const type = element.dataset.type! as RolledResources;\n    const mode = element.dataset.mode! as 'gain' | 'lose';\n    const turn = element.dataset.turn! as 'now' | 'next';\n    const value = element.dataset.value!;\n    return {\n        type,\n        mode,\n        turn,\n        value,\n    };\n}\n\n\nexport async function updateResources(game: Game, actor: Actor, target: HTMLButtonElement): Promise<void> {\n    const {type, mode, turn, value: parsedValue} = parseResourceButton(target);\n    const kingdom = getKingdom(actor);\n\n    const evaluatedValue = await evaluateValue(game, kingdom, type, parsedValue);\n    const currentValue = getCurrentValue(kingdom, type, turn);\n    const limit = getLimit(game, kingdom, type, turn);\n    const {missingMessage, message, value} = calculateNewValue({\n        mode,\n        limit,\n        turn,\n        newValue: evaluatedValue,\n        type,\n        currentValue,\n    });\n\n    await ChatMessage.create({'content': `${message}`});\n    if (missingMessage) {\n        await ChatMessage.create({'content': `${missingMessage}`});\n    }\n\n    const update = createUpdate(kingdom, type, turn, value);\n    await saveKingdom(actor, update);\n}\n","import {DegreeOfSuccess, degreeToProperty, determineDegreeOfSuccess, StringDegreeOfSuccess} from '../degree-of-success';\nimport {Skill} from './data/skills';\nimport {decodeJson, isNotBlank, postDegreeOfSuccessMessage, unslugify} from '../utils';\nimport {ActivityResults, getKingdomActivitiesById, KingdomActivity} from './data/activityData';\nimport {Modifier, modifierToLabel} from './modifiers';\nimport {getKingdom, saveKingdom} from './storage';\nimport {gainFame} from './kingdom-utils';\nimport {hasFeat} from './data/kingdom';\nimport {ModifierBreakdown, ModifierBreakdowns} from './dialogs/check-dialog';\n\nexport interface RollMeta {\n    formula: string;\n    activity: string | undefined;\n    degree: StringDegreeOfSuccess;\n    skill: Skill;\n    dc: number;\n    total: number;\n    modifier: number;\n    rollOptions: string[];\n    creativeSolutionModifier: number;\n    supernaturalSolutionModifier: number;\n    modifierBreakdown?: string;\n    rollType: RollType;\n}\n\nexport function parseMeta(el: HTMLElement): RollMeta {\n    const meta = el.querySelector('.km-roll-meta') as HTMLElement;\n    const rollOptions = meta.dataset.rollOptions;\n    return {\n        total: parseInt(meta.dataset.total ?? '0', 10),\n        dc: parseInt(meta.dataset.dc ?? '0', 10),\n        activity: (meta.dataset.activity ?? undefined),\n        skill: meta.dataset.skill as Skill,\n        degree: meta.dataset.degree as StringDegreeOfSuccess,\n        formula: meta.dataset.formula as string,\n        modifier: parseInt(meta.dataset.modifier ?? '0', 10),\n        rollType: meta.dataset.rollType as RollType,\n        rollOptions: isNotBlank(rollOptions) ? JSON.parse(atob(rollOptions)) : [],\n        creativeSolutionModifier: parseInt(meta.dataset.creativeSolutionModifier ?? '0', 10),\n        supernaturalSolutionModifier: parseInt(meta.dataset.supernaturalSolutionModifier ?? '0', 10),\n        modifierBreakdown: isNotBlank(meta.dataset.modifierBreakdown) ? meta.dataset.modifierBreakdown : undefined,\n    };\n}\n\nexport interface ActivityResultMeta {\n    activity: string;\n    degree: StringDegreeOfSuccess;\n}\n\nexport function parseUpgradeMeta(el: HTMLElement): ActivityResultMeta {\n    const meta = el.querySelector('.km-upgrade-result') as HTMLElement;\n    return {\n        activity: meta.dataset.activity!,\n        degree: meta.dataset.degree as StringDegreeOfSuccess,\n    };\n}\n\nexport function cooperativeLeadership(\n    hasCooperativeLeadership: boolean,\n    kingdomLevel: number,\n    skillRank: number,\n    rollOptions: string[],\n): (degree: DegreeOfSuccess) => DegreeOfSuccess {\n    return (degree) => {\n        if (hasCooperativeLeadership && rollOptions.includes('focused-attention')) {\n            if (kingdomLevel >= 11) {\n                if (degree === DegreeOfSuccess.CRITICAL_FAILURE) {\n                    degree = DegreeOfSuccess.FAILURE;\n                } else if (degree === DegreeOfSuccess.FAILURE && skillRank >= 2) {\n                    degree = DegreeOfSuccess.SUCCESS;\n                }\n            }\n        }\n        return degree;\n    };\n}\n\nexport async function reRoll(\n    actor: Actor,\n    el: HTMLElement,\n    type: 'fame' | 're-roll' | 'keep-higher' | 'keep-lower' | 'creative-solution' | 'supernatural-solution',\n): Promise<void> {\n    const {\n        total,\n        formula,\n        activity,\n        skill,\n        dc,\n        modifier,\n        rollOptions,\n        creativeSolutionModifier,\n        supernaturalSolutionModifier,\n        modifierBreakdown,\n        rollType,\n    } = parseMeta(el);\n    const label = activity ? unslugify(activity) : unslugify(skill);\n    let reRollFormula = formula;\n    const kingdom = getKingdom(actor);\n    let overrideRollType: RollType | undefined;\n    if (type === 'fame') {\n        // deduct points from sheet\n        await saveKingdom(actor, gainFame(kingdom, -1));\n    } else if (type === 'creative-solution') {\n        reRollFormula = `1d20+${creativeSolutionModifier}`;\n        overrideRollType = 'creative-solution';\n        await saveKingdom(actor, {\n            creativeSolutions: kingdom.creativeSolutions - 1,\n        });\n    } else if (type === 'supernatural-solution') {\n        overrideRollType = 'supernatural-solution';\n        reRollFormula = `1d20+${supernaturalSolutionModifier}`;\n        await saveKingdom(actor, {\n            supernaturalSolutions: kingdom.supernaturalSolutions - 1,\n        });\n    } else if (type === 'keep-higher') {\n        reRollFormula = `{${formula},${total}}kh`;\n    } else if (type === 'keep-lower') {\n        reRollFormula = `{${formula},${total}}kl`;\n    }\n\n    await rollCheck({\n        formula: reRollFormula,\n        label,\n        activity: activity ? getKingdomActivitiesById(kingdom.homebrewActivities)[activity] : undefined,\n        dc,\n        skill,\n        modifier,\n        modifierBreakdown,\n        actor,\n        adjustDegreeOfSuccess: cooperativeLeadership(\n            hasFeat(kingdom, 'Cooperative Leadership'),\n            kingdom.level,\n            kingdom.skillRanks[skill],\n            rollOptions,\n        ),\n        rollOptions,\n        rollType: overrideRollType ?? rollType,\n        supernaturalSolutionModifier,\n        creativeSolutionModifier,\n    });\n}\n\nfunction upgradeDegree(degree: StringDegreeOfSuccess): StringDegreeOfSuccess {\n    if (degree === 'success') {\n        return 'criticalSuccess';\n    } else if (degree === 'failure') {\n        return 'success';\n    } else if (degree === 'criticalFailure') {\n        return 'failure';\n    } else {\n        return degree;\n    }\n}\n\nfunction downgradeDegree(degree: StringDegreeOfSuccess): StringDegreeOfSuccess {\n    if (degree === 'criticalSuccess') {\n        return 'success';\n    } else if (degree === 'success') {\n        return 'failure';\n    } else if (degree === 'failure') {\n        return 'criticalFailure';\n    } else {\n        return degree;\n    }\n}\n\nexport async function changeDegree(actor: Actor, el: HTMLElement, type: 'upgrade' | 'downgrade'): Promise<void> {\n    const {activity, degree} = parseUpgradeMeta(el);\n    const kingdom = getKingdom(actor);\n    const kingdomActivity = getKingdomActivitiesById(kingdom.homebrewActivities)[activity];\n    const newDegree = type === 'upgrade' ? upgradeDegree(degree) : downgradeDegree(degree);\n    const degreeEnum = getDegreeFromKey(newDegree);\n    await postComplexDegreeOfSuccess(actor, kingdomActivity, degreeEnum, degreeEnum);\n}\n\ninterface RollCheckOptions {\n    formula: string,\n    label: string,\n    activity: KingdomActivity | undefined,\n    dc: number,\n    skill: Skill,\n    modifier: number,\n    actor: Actor,\n    adjustDegreeOfSuccess?: (degree: DegreeOfSuccess) => DegreeOfSuccess;\n    rollOptions: string[];\n    creativeSolutionModifier: number;\n    supernaturalSolutionModifier: number;\n    modifierBreakdown?: string;\n    rollType: RollType;\n}\n\ntype RollType = 'creative-solution' | 'supernatural-solution' | 'selected';\n\nfunction getModifiersByType(parsedBreakdown: ModifierBreakdowns, type: RollType): ModifierBreakdown[] {\n    if (type === 'supernatural-solution') {\n        return parsedBreakdown.supernaturalSolution;\n    } else if (type === 'creative-solution') {\n        return parsedBreakdown.creativeSolution;\n    } else {\n        return parsedBreakdown.selected;\n    }\n}\n\nfunction createModifierPills(\n    modifierBreakdown: string | undefined,\n    type: RollType,\n): string {\n    if (isNotBlank(modifierBreakdown)) {\n        const parsedBreakdown = decodeJson(modifierBreakdown) as ModifierBreakdowns;\n        const modifiers = getModifiersByType(parsedBreakdown, type);\n        console.log(parsedBreakdown, modifiers);\n        const mods = modifiers.map(m => {\n            const value = m.value;\n            return `<span class=\"km-modifier-pill\">${unslugify(m.name)} ${value >= 0 ? `+${value}` : value}</span>`;\n        }).join('');\n        return `<div class=\"km-modifier-breakdown\">${mods}</div>`;\n    }\n    return '';\n}\n\nexport async function rollCheck(\n    {\n        formula,\n        label,\n        activity,\n        dc,\n        skill,\n        modifier,\n        actor,\n        adjustDegreeOfSuccess = (degree): DegreeOfSuccess => degree,\n        rollOptions,\n        modifierBreakdown,\n        supernaturalSolutionModifier,\n        creativeSolutionModifier,\n        rollType,\n    }: RollCheckOptions,\n): Promise<DegreeOfSuccess> {\n    const roll = await new Roll(formula).roll();\n    const total = roll.total;\n    const dieNumber = total - modifier;\n    const previousDegree = determineDegreeOfSuccess(dieNumber, total, dc);\n    const degreeOfSuccess = adjustDegreeOfSuccess(previousDegree);\n    const meta = `\n        <div class=\"km-roll-meta\" hidden \n            data-formula=\"${formula}\" \n            ${activity === undefined ? '' : `data-activity=\"${activity.id}\"`}\n            data-degree=\"${degreeToProperty(degreeOfSuccess)}\"\n            data-skill=\"${skill}\"\n            data-roll-options=\"${rollOptions ? btoa(JSON.stringify(rollOptions)) : ''}\"\n            data-dc=\"${dc}\"\n            data-total=\"${total}\"\n            data-modifier-breakdown=\"${modifierBreakdown ?? ''}\"\n            data-modifier=\"${modifier}\"\n            data-roll-type=\"${rollType}\"\n            data-creative-solution-modifier=\"${creativeSolutionModifier}\"\n            data-supernatural-solution-modifier=\"${supernaturalSolutionModifier}\"\n        ></div>`;\n    const modifierPills = createModifierPills(modifierBreakdown, rollType);\n    await roll.toMessage({flavor: `<span class=\"km-skill-check-header\">Skill Check: ${label}, DC ${dc}</span>${meta}<hr>${modifierPills}`});\n    await postDegreeOfSuccess(\n        actor,\n        activity,\n        previousDegree,\n        degreeOfSuccess === previousDegree ? undefined : degreeOfSuccess,\n    );\n    return degreeOfSuccess;\n}\n\nasync function postDegreeOfSuccess(\n    actor: Actor,\n    activity: KingdomActivity | undefined,\n    degreeOfSuccess: DegreeOfSuccess,\n    upgradedDegreeOfSuccess?: DegreeOfSuccess,\n): Promise<void> {\n    if (activity) {\n        await postComplexDegreeOfSuccess(actor, activity, degreeOfSuccess, upgradedDegreeOfSuccess);\n    } else {\n        await postSimpleDegreeOfSuccess(degreeOfSuccess, upgradedDegreeOfSuccess);\n    }\n}\n\nasync function postSimpleDegreeOfSuccess(degreeOfSuccess: DegreeOfSuccess, upgradedDegreeOfSuccess?: DegreeOfSuccess): Promise<void> {\n    await postDegreeOfSuccessMessage({\n        degreeOfSuccess,\n        upgradedDegreeOfSuccess,\n        messageConfig: {\n            critSuccess: `${buildChatButtons([], 'criticalSuccess')}`,\n        },\n    });\n}\n\nfunction getResultKey(degreeOfSuccess: DegreeOfSuccess): keyof ActivityResults {\n    if (degreeOfSuccess === DegreeOfSuccess.CRITICAL_SUCCESS) {\n        return 'criticalSuccess';\n    } else if (degreeOfSuccess === DegreeOfSuccess.SUCCESS) {\n        return 'success';\n    } else if (degreeOfSuccess === DegreeOfSuccess.FAILURE) {\n        return 'failure';\n    } else {\n        return 'criticalFailure';\n    }\n}\n\nfunction getDegreeFromKey(degreeOfSuccess: keyof ActivityResults): DegreeOfSuccess {\n    if (degreeOfSuccess === 'criticalSuccess') {\n        return DegreeOfSuccess.CRITICAL_SUCCESS;\n    } else if (degreeOfSuccess === 'success') {\n        return DegreeOfSuccess.SUCCESS;\n    } else if (degreeOfSuccess === 'failure') {\n        return DegreeOfSuccess.FAILURE;\n    } else {\n        return DegreeOfSuccess.CRITICAL_FAILURE;\n    }\n}\n\nfunction buildChatButtons(modifiers: Modifier[], resultKey: keyof ActivityResults, activity?: string): string {\n    if (modifiers.length > 0 || resultKey === 'criticalSuccess') {\n        return `\n        <div class=\"km-chat-buttons\">\n            ${resultKey === 'criticalSuccess' ? '<button type=\"button\" class=\"km-gain-fame-button\">Gain 1 Fame</button>' : ''}\n            ${modifiers.map((modifier, index) => {\n            const label = modifierToLabel(modifier);\n            return `<button class=\"km-apply-modifier-effect\" \n                        data-activity=\"${activity}\" \n                        data-degree=\"${resultKey}\" \n                        data-index=\"${index}\">Apply Effect: ${label}</button>`;\n        }).join('')}    \n        </div>`;\n    } else {\n        return '';\n    }\n}\n\nasync function postComplexDegreeOfSuccess(\n    actor: Actor,\n    activity: KingdomActivity,\n    degreeOfSuccess: DegreeOfSuccess,\n    upgradedDegreeOfSuccess?: DegreeOfSuccess,\n): Promise<void> {\n    const resultKey = getResultKey(upgradedDegreeOfSuccess ?? degreeOfSuccess);\n    const results = activity[resultKey];\n    if (results) {\n        const kingdom = getKingdom(actor);\n        const modifiers = results.modifiers;\n        const message = results.msg;\n        const buttons = modifiers === undefined\n            ? buildChatButtons([], resultKey)\n            : buildChatButtons(modifiers(kingdom), resultKey, activity.id);\n        // div allows to upgrade/downgrade on right click\n        const upgrade = `<div class=\"km-upgrade-result\" data-activity=\"${activity.id}\" data-degree=\"${resultKey}\"></div>`;\n        const msg = message;\n        const tail = buttons + upgrade;\n        const description = `<h3>${activity.title}</h3>${activity.description.trimEnd()}<hr>`;\n        await postDegreeOfSuccessMessage({\n            degreeOfSuccess,\n            upgradedDegreeOfSuccess,\n            beforeHeader: description,\n            messageConfig: {\n                critSuccess: `${msg}${tail}`,\n                success: `${msg}${tail}`,\n                failure: `${msg}${tail}`,\n                critFailure: `${msg}${tail}`,\n            },\n        });\n    } else {\n        await postSimpleDegreeOfSuccess(degreeOfSuccess, upgradedDegreeOfSuccess);\n    }\n}\n\nexport async function addOngoingEvent(actor: Actor, uuid: string, label: string): Promise<void> {\n    const kingdom = getKingdom(actor);\n    const name = `@UUID[${uuid}]{${label}}`;\n    await saveKingdom(actor, {\n        ongoingEvents: [...kingdom.ongoingEvents, {name}],\n    });\n}\n","import {evaluateStructures, includeCapital, StructureResult, StructureStackRule} from './structures';\nimport {ruleSchema} from './schema';\nimport {CommodityStorage, Structure, structuresByName} from './data/structures';\nimport {Kingdom, Settlement, WorkSite, WorkSites} from './data/kingdom';\nimport {getBooleanSetting} from '../settings';\nimport {isKingmakerInstalled, isNonNullable} from '../utils';\nimport {allSkills} from './data/skills';\nimport {getKingdomActivitiesById, KingdomActivityById} from './data/activityData';\n\nclass StructureError extends Error {\n}\n\nfunction calculateLots(structure: Structure, tokenWidth: number, tokenHeight: number): Structure {\n    if (structure.lots !== undefined) {\n        return structure;\n    } else {\n        return {\n            ...structure,\n            lots: tokenWidth * tokenHeight,\n        };\n    }\n}\n\nfunction parseStructureData(\n    name: string | null,\n    data: unknown,\n    tokenWidth: number,\n    tokenHeight: number,\n    level: number | null,\n): Structure | undefined {\n    if (data === undefined || data === null) {\n        return undefined;\n    } else if (typeof data === 'object' && 'ref' in data) {\n        const refData = data as { ref: string };\n        const lookedUpStructure = structuresByName.get(refData.ref);\n        if (lookedUpStructure === undefined) {\n            console.log(refData, structuresByName);\n            throw new StructureError(`No predefined structure data found for actor with name ${name}, aborting`);\n        }\n        return calculateLots(lookedUpStructure, tokenWidth, tokenHeight);\n    } else if (isNonNullable(name) && isNonNullable(level)) {\n        const rule: Structure = {\n            name,\n            level,\n            // migrate older structures\n            construction: {\n                skills: allSkills.map(s => {\n                    return {skill: s};\n                }),\n                dc: 0,\n                rp: 0,\n            },\n            ...data,\n        };\n        const result = ruleSchema.validate(rule);\n        if (result.error) {\n            console.error(`Failed to validate structure with name ${name}`, data);\n            console.error('Validation Error', result.error);\n            throw new StructureError(`Structure with name ${name} failed to validate, aborting. See console log (F12) for more details`);\n        }\n        return calculateLots(rule, tokenWidth, tokenHeight);\n    } else {\n        const result: Structure = data as Structure;\n        return calculateLots(result, tokenWidth, tokenHeight);\n    }\n}\n\nexport interface ActorStructure extends Structure {\n    actor: Actor;\n}\n\nexport function getSceneActorStructures(scene: Scene): ActorStructure[] {\n    const actors = scene.tokens\n        .map(t => t.actor)\n        .filter(a => isNonNullable(a)) as Actor[];\n    return getStructuresFromActors(actors);\n}\n\nexport function getStructuresFromActors(actors: Actor[]): ActorStructure[] {\n    return actors\n        .map((actor) => {\n            const width = actor.token?.width ?? actor.prototypeToken?.width ?? 0;\n            const height = actor.token?.height ?? actor.prototypeToken?.height ?? 0;\n            const data = parseStructureData(\n                actor!.name,\n                actor!.getFlag('pf2e-kingmaker-tools', 'structureData'),\n                width,\n                height,\n                actor.level,\n            );\n            if (data) {\n                return {\n                    ...data,\n                    actor,\n                };\n            }\n            return null;\n        })\n        .filter(actor => actor !== null)! as ActorStructure[];\n}\n\nexport function isStructureActor(actor: Actor): boolean {\n    return isNonNullable(actor.getFlag('pf2e-kingmaker-tools', 'structureData'));\n}\n\nexport function isStructureActorActive(actor: Actor): boolean {\n    return actor.itemTypes.condition?.find(c => c.type === 'condition' && c.name.startsWith('Slowed')) === undefined;\n}\n\nfunction getBlockTiles(scene: Scene): TileDocument[] {\n    return scene.tiles.filter(d => isNonNullable(d.getFlag('pf2e-kingmaker-tools', 'settlementBlockDrawing')));\n}\n\nfunction tokenIsStructure(token: TokenDocument): boolean {\n    return token.actor !== null\n        && token.actor !== undefined\n        && isStructureActor(token.actor)\n        && isStructureActorActive(token.actor);\n}\n\ninterface ShapePosition {\n    xStart: number;\n    yStart: number;\n    xEnd: number;\n    yEnd: number;\n}\n\nfunction shapeContainsOtherShape(a: ShapePosition, b: ShapePosition, marginOfErrorPx: number): boolean {\n    return b.xStart >= (a.xStart - marginOfErrorPx)\n        && b.xEnd <= (a.xEnd + marginOfErrorPx)\n        && b.yStart >= (a.yStart - marginOfErrorPx)\n        && b.yEnd <= (a.yEnd + marginOfErrorPx);\n}\n\nfunction containsStructures(drawingPosition: ShapePosition, tokenPositions: ShapePosition[], marginOfErrorPx: number): boolean {\n    return tokenPositions.some(token => shapeContainsOtherShape(drawingPosition, token, marginOfErrorPx));\n}\n\n/**\n * Go through all rectangle drawings in a scene and check if any structure token on the scene is fully inside the\n * rectangle drawing enlarged by a margin of error\n * @param scene\n */\nfunction getFilledBlocks(scene: Scene): number {\n    const gridSize = scene.grid.size;\n    // increase rectangle by this many pixels to account for not placing the structure perfectly inside of it\n    const marginOfErrorPx = Math.floor(0.1 * gridSize);\n    const tokenPositions = scene.tokens\n        .filter(tokenIsStructure)\n        .map(token => {\n            return {\n                xStart: token.x,\n                yStart: token.y,\n                xEnd: token.x + (token.width * gridSize),\n                yEnd: token.y + (token.height * gridSize),\n            };\n        });\n    return getBlockTiles(scene)\n        .filter(d => {\n            // (0, 0) is the top left corner and x and y of the drawing is the top left corner of the drawing\n            const drawingPosition = {\n                xStart: d.x,\n                xEnd: d.x + d.width,\n                yStart: d.y,\n                yEnd: d.y + d.height,\n            };\n            return containsStructures(drawingPosition, tokenPositions, marginOfErrorPx);\n        })\n        .length || 1;\n}\n\nexport function getSettlementInfo(settlement: SettlementAndScene, autoCalculateSettlementLevel: boolean): {\n    level: number;\n    lots: number\n} {\n    if (autoCalculateSettlementLevel && !settlement.settlement.manualSettlementLevel) {\n        const blocks = getFilledBlocks(settlement.scene);\n        return {\n            level: Math.min(20, blocks),\n            lots: blocks,\n        };\n    } else {\n        return {\n            level: settlement.settlement.level,\n            lots: settlement.settlement.lots,\n        };\n    }\n}\n\nexport function getSceneStructures(scene: Scene): Structure[] {\n    try {\n        return scene.tokens\n            .filter(tokenIsStructure)\n            .map(t => {\n                const result: [Actor | null, number, number] = [t.actor, t.width ?? 1, t.height ?? 1];\n                return result;\n            })\n            .map(([actor, width, height]) =>\n                parseStructureData(\n                    actor!.name,\n                    actor!.getFlag('pf2e-kingmaker-tools', 'structureData'),\n                    width,\n                    height,\n                    actor!.level,\n                ))\n            .filter(data => data !== undefined) as Structure[] ?? [];\n    } catch (e: unknown) {\n        if (e instanceof StructureError) {\n            ui.notifications?.error(e.message);\n        } else {\n            throw e;\n        }\n    }\n    return [];\n}\n\nexport function getScene(game: Game, sceneId: string): Scene | undefined {\n    return game?.scenes?.find(scene => scene.id === sceneId);\n}\n\nexport function getCurrentScene(game: Game): Scene | undefined {\n    return game.scenes?.viewed;\n}\n\nexport interface SettlementAndScene {\n    settlement: Settlement;\n    scene: Scene;\n}\n\nexport function getCapitalSettlement(game: Game, kingdom: Kingdom): SettlementAndScene | undefined {\n    const settlement = kingdom.settlements.find(settlement => settlement.type === 'capital');\n    const scene = settlement ? getScene(game, settlement.sceneId) : undefined;\n    if (scene && settlement) {\n        return {\n            scene: scene,\n            settlement: settlement,\n        };\n    }\n}\n\nexport function getSettlement(game: Game, kingdom: Kingdom, sceneId: string): SettlementAndScene | undefined {\n    const settlement = kingdom.settlements.find(settlement => settlement.sceneId === sceneId);\n    const scene = getScene(game, sceneId);\n    if (scene && settlement) {\n        return {\n            settlement,\n            scene,\n        };\n    }\n}\n\nexport function getAllSettlements(game: Game, kingdom: Kingdom): SettlementAndScene[] {\n    return game.scenes\n        ?.map(scene => getSettlement(game, kingdom, scene.id))\n        ?.filter(scene => scene !== undefined) as SettlementAndScene[] ?? [];\n}\n\nfunction getSettlementStructureResult(\n    settlement: SettlementAndScene,\n    mode: StructureStackRule,\n    autoCalculateSettlementLevel: boolean,\n    activities: KingdomActivityById,\n): StructureResult {\n    const structures = getSceneStructures(settlement.scene);\n    const level = getSettlementInfo(settlement, autoCalculateSettlementLevel).level;\n    return evaluateStructures(structures, level, mode, activities);\n}\n\n\nexport function getStructureResult(\n    mode: StructureStackRule,\n    autoCalculateSettlementLevel: boolean,\n    activities: KingdomActivityById,\n    active: SettlementAndScene,\n    capital?: SettlementAndScene,\n): StructureResult {\n    if (capital && capital.scene.id !== active.scene.id) {\n        return includeCapital(\n            getSettlementStructureResult(capital, mode, autoCalculateSettlementLevel, activities),\n            getSettlementStructureResult(active, mode, autoCalculateSettlementLevel, activities));\n    } else {\n        return getSettlementStructureResult(active, mode, autoCalculateSettlementLevel, activities);\n    }\n}\n\ninterface MergedSettlements {\n    leadershipActivityNumber: number;\n    settlementConsumption: number;\n    storage: CommodityStorage;\n    unlockedActivities: Set<string>;\n}\n\nexport function getStructureStackMode(game: Game): StructureStackRule {\n    return getBooleanSetting(game, 'kingdomAllStructureItemBonusesStack') ? 'all-structures-stack' : 'same-structures-stack';\n}\n\nexport function getAllMergedSettlements(game: Game, kingdom: Kingdom): MergedSettlements {\n    const mode = getStructureStackMode(game);\n    const activities = getKingdomActivitiesById(kingdom.homebrewActivities);\n    const autoCalculateSettlementLevel = getBooleanSetting(game, 'autoCalculateSettlementLevel');\n    return getAllSettlements(game, kingdom)\n        .map(settlement => {\n            const structureResult = getSettlementStructureResult(settlement, mode, autoCalculateSettlementLevel, activities);\n            return {\n                leadershipActivityNumber: structureResult.increaseLeadershipActivities ? 3 : 2,\n                settlementConsumption: structureResult.consumption,\n                storage: structureResult.storage,\n                unlockedActivities: new Set(structureResult.unlockActivities),\n            };\n        })\n        .reduce((prev, curr) => {\n            return {\n                leadershipActivityNumber: Math.max(prev.leadershipActivityNumber, curr.leadershipActivityNumber),\n                settlementConsumption: prev.settlementConsumption + curr.settlementConsumption,\n                storage: {\n                    ore: prev.storage.ore + curr.storage.ore,\n                    stone: prev.storage.stone + curr.storage.stone,\n                    luxuries: prev.storage.luxuries + curr.storage.luxuries,\n                    lumber: prev.storage.lumber + curr.storage.lumber,\n                    food: prev.storage.food + curr.storage.food,\n                },\n                unlockedActivities: new Set<string>([...prev.unlockedActivities, ...curr.unlockedActivities]),\n            };\n        }, {\n            leadershipActivityNumber: 2,\n            settlementConsumption: 0,\n            storage: {ore: 0, stone: 0, luxuries: 0, lumber: 0, food: 0},\n            unlockedActivities: new Set<string>(),\n        });\n}\n\nexport interface ActiveSettlementStructureResult {\n    active: StructureResult;\n    merged: StructureResult;\n}\n\nexport function getActiveSettlementStructureResult(game: Game, kingdom: Kingdom): ActiveSettlementStructureResult | undefined {\n    const activeSettlement = getSettlement(game, kingdom, kingdom.activeSettlement);\n    const capitalSettlement = getCapitalSettlement(game, kingdom);\n    const activities = getKingdomActivitiesById(kingdom.homebrewActivities);\n    const autoCalculateSettlementLevel = getBooleanSetting(game, 'autoCalculateSettlementLevel');\n    if (activeSettlement) {\n        const mode = getStructureStackMode(game);\n        const activeSettlementStructures = getStructureResult(mode, autoCalculateSettlementLevel, activities, activeSettlement);\n        const mergedSettlementStructures = getStructureResult(mode, autoCalculateSettlementLevel, activities, activeSettlement, capitalSettlement);\n        return {\n            active: activeSettlementStructures,\n            merged: mergedSettlementStructures,\n        };\n    }\n}\n\nexport function getSettlementsWithoutLandBorders(game: Game, kingdom: Kingdom): number {\n    const mode = getStructureStackMode(game);\n    const autoCalculateSettlementLevel = getBooleanSetting(game, 'autoCalculateSettlementLevel');\n    const activities = getKingdomActivitiesById(kingdom.homebrewActivities);\n    return getAllSettlements(game, kingdom)\n        .filter(settlementAndScene => {\n            const structures = getStructureResult(mode, autoCalculateSettlementLevel, activities, settlementAndScene);\n            return (settlementAndScene.settlement?.waterBorders ?? 0) >= 4 && !structures.hasBridge;\n        })\n        .length;\n}\n\nexport interface StolenLandsData {\n    size: number;\n    workSites: WorkSites;\n}\n\nfunction parseWorksite(claimedHexes: HexState[], type: CampType, commodity: CommodityType): WorkSite {\n    return claimedHexes.filter(h => h.camp === type)\n        .reduce((prev, state) => {\n            const res = state.commodity === commodity ? 1 : 0;\n            // mines on luxuries don't count for ore but a single luxury\n            const quantity = type === 'mine' && state.commodity === 'luxuries' ? 0 : 1;\n            if (commodity === 'luxuries') {\n                return {\n                    quantity: prev.quantity + res,\n                    resources: prev.resources,\n                };\n            } else {\n                return {\n                    quantity: prev.quantity + quantity,\n                    resources: prev.resources + res,\n                };\n            }\n        }, {quantity: 0, resources: 0});\n}\n\nexport function parseKingmaker(kingmaker: KingmakerState): StolenLandsData {\n    const claimedHexes = Object.values(kingmaker.hexes)\n        .filter(h => h.claimed);\n    const farmHexes = claimedHexes.filter(h => h.features?.some(f => f.type === 'farmland'));\n    const food = claimedHexes.filter(h => h.commodity === 'food');\n    return {\n        size: claimedHexes.length,\n        workSites: {\n            farmlands: {\n                quantity: farmHexes.length,\n                resources: food.length,\n            },\n            quarries: parseWorksite(claimedHexes, 'quarry', 'stone'),\n            mines: parseWorksite(claimedHexes, 'mine', 'ore'),\n            lumberCamps: parseWorksite(claimedHexes, 'lumber', 'lumber'),\n            luxurySources: parseWorksite(claimedHexes, 'mine', 'luxuries'),\n        },\n    };\n}\n\nfunction findStolenLandsScene(game: Game, realmSceneId: string | null): Scene | undefined {\n    if (isNonNullable(realmSceneId)) {\n        return game.scenes?.find(s => s.id === realmSceneId);\n    }\n}\n\ntype RealmTileType =\n    'mine'\n    | 'ore'\n    | 'lumber'\n    | 'lumberCamp'\n    | 'quarry'\n    | 'stone'\n    | 'claimed'\n    | 'farmland'\n    | 'luxury'\n    | 'luxuryWorksite'\n    | 'food';\n\ninterface RealmTile {\n    type: RealmTileType;\n}\n\n\nexport interface RealmTileData extends RealmTile, ShapePosition {\n}\n\nfunction parseTileData<T extends TileDocument | DrawingDocument>(\n    tile: T,\n    parseDimensions: (tile: T) => { width: number; height: number },\n): RealmTileData | undefined {\n    const data = tile.getFlag('pf2e-kingmaker-tools', 'realmTile') as RealmTile | null | undefined;\n    if (data) {\n        const {width, height} = parseDimensions(tile);\n        return {\n            ...data,\n            xStart: tile.x,\n            xEnd: tile.x + width,\n            yStart: tile.y,\n            yEnd: tile.y + height,\n        };\n    }\n}\n\nfunction getWorksitesInTiles(worksiteType: 'lumberCamp' | 'mine' | 'quarry' | 'luxuryWorksite', tilesInPos: RealmTileData[]): WorkSite {\n    const commodityType = {\n        lumberCamp: 'lumber',\n        mine: 'ore',\n        quarry: 'stone',\n        luxuryWorksite: 'luxury',\n    }[worksiteType];\n    const quantity = tilesInPos.filter(t => t.type === worksiteType).length;\n    return {\n        quantity: quantity,\n        resources: quantity > 0 ? tilesInPos.filter(t => t.type === commodityType).length : 0,\n    };\n}\n\nfunction mergeWorksites(a: WorkSites, b: WorkSites): WorkSites {\n    return {\n        luxurySources: {\n            resources: a.luxurySources.resources + b.luxurySources.resources,\n            quantity: a.luxurySources.quantity + b.luxurySources.quantity,\n        },\n        lumberCamps: {\n            resources: a.lumberCamps.resources + b.lumberCamps.resources,\n            quantity: a.lumberCamps.quantity + b.lumberCamps.quantity,\n        },\n        quarries: {\n            resources: a.quarries.resources + b.quarries.resources,\n            quantity: a.quarries.quantity + b.quarries.quantity,\n        },\n        farmlands: {\n            resources: a.farmlands.resources + b.farmlands.resources,\n            quantity: a.farmlands.quantity + b.farmlands.quantity,\n        },\n        mines: {\n            resources: a.mines.resources + b.mines.resources,\n            quantity: a.mines.quantity + b.mines.quantity,\n        },\n    };\n}\n\nfunction emptyWorksites(): WorkSites {\n    return {\n        luxurySources: {resources: 0, quantity: 0},\n        lumberCamps: {resources: 0, quantity: 0},\n        quarries: {resources: 0, quantity: 0},\n        farmlands: {resources: 0, quantity: 0},\n        mines: {resources: 0, quantity: 0},\n    };\n}\n\nexport function parseSceneTiles(\n    objects: RealmTileData[],\n    marginOfErrorPx: number,\n): StolenLandsData {\n    const claimedPositions = objects.filter(o => o.type === 'claimed');\n    // try to reduce quadratic complexity a bit\n    const nonClaimedPositions = new Set(objects.filter(o => o.type !== 'claimed'));\n    const worksites = claimedPositions\n        .map(claimed => {\n            const tilesInPos = Array.from(nonClaimedPositions)\n                .filter(nonClaimed => shapeContainsOtherShape(claimed, nonClaimed, marginOfErrorPx));\n            tilesInPos.forEach(t => nonClaimedPositions.delete(t));\n            const farmlands = tilesInPos.filter(t => t.type === 'farmland').length;\n            return {\n                farmlands: {quantity: farmlands, resources: tilesInPos.filter(t => t.type === 'food').length},\n                lumberCamps: getWorksitesInTiles('lumberCamp', tilesInPos),\n                mines: getWorksitesInTiles('mine', tilesInPos),\n                quarries: getWorksitesInTiles('quarry', tilesInPos),\n                luxurySources: getWorksitesInTiles('luxuryWorksite', tilesInPos),\n            };\n        })\n        .reduce(mergeWorksites, emptyWorksites());\n    return {\n        size: claimedPositions.length,\n        workSites: worksites,\n    };\n}\n\nfunction parseSceneData(game: Game, realmSceneId: string | null): StolenLandsData {\n    const scene = findStolenLandsScene(game, realmSceneId);\n    if (scene) {\n        // increase rectangle by this many pixels to account for not placing the structure perfectly inside of it\n        const marginOfErrorPx = Math.floor(0.1 * scene.grid.size);\n        const objects = [\n            ...scene.tiles\n                .filter(t => t.visible)\n                .map(t => parseTileData(t, (tile) => {\n                    return {\n                        width: tile.width,\n                        height: tile.height,\n                    };\n                }))\n                .filter(t => isNonNullable(t)) as RealmTileData[],\n            ...scene.drawings\n                .filter(t => t.visible)\n                .map(t => parseTileData(t, (tile) => {\n                    return {\n                        width: tile.shape.width,\n                        height: tile.shape.height,\n                    };\n                }))\n                .filter(t => isNonNullable(t)) as RealmTileData[],\n        ];\n        return parseSceneTiles(objects, marginOfErrorPx);\n    } else {\n        return {\n            workSites: emptyWorksites(),\n            size: 0,\n        };\n    }\n}\n\nexport type ResourceAutomationMode = 'kingmaker' | 'tileBased' | 'manual';\n\nexport function getStolenLandsData(\n    game: Game,\n    mode: ResourceAutomationMode,\n    kingdom: Kingdom,\n): StolenLandsData {\n    if (mode === 'kingmaker' && isKingmakerInstalled(game)) {\n        return parseKingmaker(kingmaker.state);\n    } else if (mode === 'tileBased') {\n        return parseSceneData(game, kingdom.realmSceneId);\n    } else {\n        return {\n            size: kingdom.size,\n            workSites: kingdom.workSites,\n        };\n    }\n}\n\n\nexport async function makeResourceTileOrDrawing(tile: TileDocument, type: RealmTileType): Promise<void> {\n    await tile.setFlag('pf2e-kingmaker-tools', 'realmTile', {type});\n}\n\nexport async function makeResourceDrawing(tile: DrawingDocument, type: RealmTileType): Promise<void> {\n    await tile.setFlag('pf2e-kingmaker-tools', 'realmTile', {type});\n}","import Joi from 'joi';\nimport {allSkills} from './data/skills';\nimport {allBuildingTraits, itemGroups, structuresByName} from './data/structures';\n\nconst builtInRefs = structuresByName.keys();\nexport const refSchema = Joi.object({\n    ref: Joi.string()\n        .valid(...builtInRefs),\n});\n\nexport const ruleSchema = Joi.object({\n    name: Joi.string().required(),\n    notes: Joi.string().optional(),\n    preventItemLevelPenalty: Joi.boolean().optional(),\n    enableCapitalInvestment: Joi.boolean().optional(),\n    increaseLeadershipActivities: Joi.boolean().optional(),\n    consumptionReduction: Joi.number().optional(),\n    activityBonusRules: Joi.array().items(Joi.object({\n        value: Joi.number().required(),\n        activity: Joi.string().required(),\n    })).optional(),\n    skillBonusRules: Joi.array().items(Joi.object({\n        value: Joi.number().required(),\n        skill: Joi.string().valid(...allSkills).required(),\n        activity: Joi.string().optional(),\n    })).optional(),\n    availableItemsRules: Joi.array().items(Joi.object({\n        value: Joi.number().required(),\n        group: Joi.string().valid(...itemGroups).optional(),\n        maximumStacks: Joi.number().optional(),\n    })).optional(),\n    settlementEventRules: Joi.array().items(Joi.object({\n        value: Joi.number().required(),\n    })).optional(),\n    leadershipActivityRules: Joi.array().items(Joi.object({\n        value: Joi.number().required(),\n    })).optional(),\n    storage: Joi.object({\n        ore: Joi.number().optional(),\n        food: Joi.number().optional(),\n        lumber: Joi.number().optional(),\n        stone: Joi.number().optional(),\n        luxuries: Joi.number().optional(),\n    }).optional(),\n    unlockActivities: Joi.array().items(Joi.string()).optional(),\n    traits: Joi.array().items(Joi.string().valid(...allBuildingTraits)).optional(),\n    isBridge: Joi.boolean().optional(),\n    stacksWith: Joi.string().optional(),\n    lots: Joi.number().optional(),\n    level: Joi.number().optional(),\n    affectsEvents: Joi.boolean().optional(),\n    upgradeFrom: Joi.array().items(Joi.string()).optional(),\n    affectsDowntime: Joi.boolean().optional(),\n    reducesUnrest: Joi.boolean().optional(),\n    reducesRuin: Joi.boolean().optional(),\n    construction: Joi.object({\n        skills: Joi.array().items(Joi.object({\n            skill: Joi.array().valid(...allSkills),\n            proficiencyRank: Joi.number().valid(0, 1, 2, 3, 4).optional(),\n        })),\n        lumber: Joi.number().optional(),\n        luxuries: Joi.number().optional(),\n        ore: Joi.number().optional(),\n        stone: Joi.number().optional(),\n        rp: Joi.number(),\n        dc: Joi.number(),\n    }),\n});\n","import {getBooleanSetting, getNumberSetting, getStringSetting} from '../settings';\nimport {\n    allFameTypes,\n    allHeartlands,\n    BonusFeat,\n    Commodities,\n    FameType,\n    Feat,\n    getControlDC,\n    getDefaultKingdomData,\n    getLevelData,\n    getSizeData,\n    hasFeat,\n    Kingdom,\n    Leaders,\n    LeaderValues,\n    ResourceDieSize,\n    Ruin,\n    Settlement,\n    WorkSites,\n} from './data/kingdom';\nimport {capitalize, clamped, isNonNullable, unpackFormArray, unslugify} from '../utils';\nimport {\n    getActiveSettlementStructureResult,\n    getAllMergedSettlements,\n    getAllSettlements,\n    getCurrentScene,\n    getScene,\n    getSettlement,\n    getSettlementInfo,\n    getSettlementsWithoutLandBorders,\n    getStolenLandsData,\n    getStructureResult,\n    getStructureStackMode,\n    ResourceAutomationMode,\n    SettlementAndScene,\n} from './scene';\nimport {allFeats, allFeatsByName} from './data/feats';\nimport {addGroupDialog} from './dialogs/add-group-dialog';\nimport {AddBonusFeatDialog} from './dialogs/add-bonus-feat-dialog';\nimport {addOngoingEventDialog} from './dialogs/add-ongoing-event-dialog';\nimport {rollCultEvent, rollKingdomEvent} from '../kingdom-events';\nimport {calculateEventXP, calculateHexXP, calculateRpXP} from './xp';\nimport {setupDialog} from './dialogs/setup-dialog';\nimport {featuresByLevel, uniqueFeatures} from './data/features';\nimport {\n    allCompanions,\n    applyLeaderCompanionRules,\n    getCompanionUnlockActivities,\n    getOverrideUnlockCompanionNames,\n} from './data/companions';\nimport {\n    createActivityLabel,\n    enableCompanionActivities,\n    getPerformableActivities,\n    groupKingdomActivities,\n} from './data/activities';\nimport {AbilityScores, calculateAbilityModifier} from './data/abilities';\nimport {calculateSkills} from './skills';\nimport {calculateInvestedBonus, isInvested} from './data/leaders';\nimport {CheckDialog} from './dialogs/check-dialog';\nimport {Skill} from './data/skills';\nimport {showHelpDialog} from './dialogs/show-help-dialog';\nimport {showSettlement} from './dialogs/settlement';\nimport {createActiveSettlementModifiers, getUntrainedProficiencyMode, Modifier, modifierToLabel} from './modifiers';\nimport {addEffectDialog} from './dialogs/add-effect-dialog';\nimport {getKingdom, saveKingdom} from './storage';\nimport {gainFame, getCapacity, getConsumption} from './kingdom-utils';\nimport {calculateUnrestPenalty} from './data/unrest';\nimport {editSettlementDialog} from './dialogs/edit-settlement-dialog';\nimport {showKingdomSettings} from './dialogs/kingdom-settings';\nimport {openJournal} from '../foundry-utils';\nimport {showStructureBrowser} from './dialogs/structure-browser';\nimport {gainUnrest, getKingdomActivitiesById, loseRP} from './data/activityData';\nimport {manageKingdomActivitiesDialog} from './dialogs/activities-dialog';\nimport {kingdomSizeDialog} from './dialogs/kingdom-size-dialog';\nimport {settlementSizeDialog} from './dialogs/settlement-size-dialog';\n\ninterface KingdomOptions {\n    game: Game;\n    sheetActor: Actor;\n}\n\ntype KingdomTab = 'status' | 'skills' | 'turn' | 'feats' | 'groups' | 'notes' | 'settlements' | 'effects';\n\nconst levels = [...Array.from(Array(20).keys()).map(k => k + 1)];\n\ninterface Effect {\n    name: string;\n    effect: string;\n    turns: string;\n    consumable: boolean;\n}\n\nfunction createEffects(modifiers: Modifier[]): Effect[] {\n    return modifiers.map(modifier => {\n        return {\n            name: modifier.name,\n            effect: modifierToLabel(modifier),\n            turns: modifier.turns === undefined ? 'indefinite' : `${modifier.turns}`,\n            consumable: modifier.consumeId !== undefined,\n        };\n    });\n}\n\n\nclass KingdomApp extends FormApplication<FormApplicationOptions & KingdomOptions, object, null> {\n    static override get defaultOptions(): FormApplicationOptions {\n        const options = super.defaultOptions;\n        options.id = 'kingdom-app';\n        options.title = 'Kingdom';\n        options.template = 'modules/pf2e-kingmaker-tools/templates/kingdom/sheet.hbs';\n        options.submitOnChange = true;\n        options.closeOnSubmit = false;\n        options.classes = ['kingmaker-tools-app', 'kingdom-app'];\n        options.width = 850;\n        options.height = 'auto';\n        options.scrollY = ['.km-content', '.km-sidebar'];\n        return options;\n    }\n\n    private sheetActor: Actor;\n\n    private readonly game: Game;\n    private nav: KingdomTab = 'turn';\n\n    constructor(object: null, options: Partial<FormApplicationOptions> & KingdomOptions) {\n        super(object, options);\n        this.game = options.game;\n        this.sheetActor = options.sheetActor;\n        this.sheetActor.apps[this.appId] = this;\n    }\n\n    override async getData(): Promise<object> {\n        const isGM = this.game.user?.isGM ?? false;\n        const kingdomData = this.getKingdom();\n        const automateResourceMode = getStringSetting(this.game, 'automateResources') as ResourceAutomationMode;\n        const {size: kingdomSize, workSites} = getStolenLandsData(this.game, automateResourceMode, kingdomData);\n        const sizeData = getSizeData(kingdomSize);\n        const autoCalculateSettlementLevel = getBooleanSetting(this.game, 'autoCalculateSettlementLevel');\n        const {\n            leadershipActivityNumber,\n            settlementConsumption,\n            unlockedActivities: unlockedSettlementActivities,\n        } = getAllMergedSettlements(this.game, kingdomData);\n        const {current: totalConsumption, surplus: farmSurplus} = getConsumption(this.game, kingdomData);\n        const useXpHomebrew = getBooleanSetting(this.game, 'vanceAndKerensharaXP');\n        const homebrewSkillIncreases = getBooleanSetting(this.game, 'kingdomSkillIncreaseEveryLevel');\n        const activeSettlementStructureResult = getActiveSettlementStructureResult(this.game, kingdomData);\n        const activeSettlement = getSettlement(this.game, kingdomData, kingdomData.activeSettlement);\n\n        const unlockedActivities = new Set<string>([\n            ...unlockedSettlementActivities,\n            ...getCompanionUnlockActivities(kingdomData.leaders, getOverrideUnlockCompanionNames(this.game)),\n        ]);\n        const hideActivities = kingdomData.activityBlacklist\n            .map(activity => {\n                return {[activity]: true};\n            })\n            .reduce((a, b) => Object.assign(a, b), {});\n        const ignoreSkillRequirements = getBooleanSetting(this.game, 'kingdomIgnoreSkillRequirements');\n        const activities = getKingdomActivitiesById(kingdomData.homebrewActivities);\n        const enabledActivities = getPerformableActivities(\n            kingdomData.skillRanks,\n            activeSettlementStructureResult?.active?.allowCapitalInvestment === true\n            || (activeSettlement?.settlement.type === 'capital' && getBooleanSetting(this.game, 'capitalInvestmentInCapital')),\n            ignoreSkillRequirements,\n            activities,\n        );\n        const groupedActivities = groupKingdomActivities(activities);\n        const currentSceneId = getCurrentScene(this.game)?.id;\n        const canAddSettlement = kingdomData.settlements.find(settlement => settlement.sceneId === currentSceneId) === undefined;\n        const canAddRealm = isNonNullable(currentSceneId) && currentSceneId !== kingdomData.realmSceneId;\n        const structureStackMode = getStructureStackMode(this.game);\n        const automateResources = automateResourceMode !== 'manual';\n        const showAddRealmButton = isGM && automateResourceMode === 'tileBased';\n        const showRealmData = automateResourceMode === 'kingmaker'\n            || automateResourceMode === 'manual'\n            || (isNonNullable(kingdomData.realmSceneId) && this.game.scenes?.find(s => s.id === kingdomData.realmSceneId) !== undefined);\n        return {\n            notes: {\n                gm: await TextEditor.enrichHTML(kingdomData.notes.gm),\n                public: await TextEditor.enrichHTML(kingdomData.notes.public),\n            },\n            hideActivities,\n            isGM,\n            isUser: !isGM,\n            enabledActivities: enabledActivities,\n            leadershipActivityNumber: leadershipActivityNumber,\n            name: kingdomData.name,\n            size: kingdomSize,\n            xp: kingdomData.xp,\n            xpThreshold: kingdomData.xpThreshold,\n            level: kingdomData.level,\n            fame: kingdomData.fame,\n            charter: kingdomData.charter,\n            heartland: kingdomData.heartland,\n            heartlandLabel: unslugify(kingdomData.heartland),\n            government: kingdomData.government,\n            type: capitalize(sizeData.type),\n            controlDC: getControlDC(kingdomData.level, kingdomSize, kingdomData.leaders.ruler.vacant),\n            atWar: kingdomData.atWar,\n            unrest: kingdomData.unrest,\n            unrestPenalty: calculateUnrestPenalty(kingdomData.unrest),\n            anarchyAt: this.calculateAnarchy(kingdomData.feats, kingdomData.bonusFeats),\n            resourceDieSize: sizeData.resourceDieSize,\n            resourceDiceNum: this.getResourceDiceNum(kingdomData),\n            resourceDice: kingdomData.resourceDice,\n            resourcePoints: kingdomData.resourcePoints,\n            consumption: kingdomData.consumption,\n            activeSettlement: kingdomData.activeSettlement,\n            supernaturalSolutions: kingdomData.supernaturalSolutions,\n            creativeSolutions: kingdomData.creativeSolutions,\n            levels,\n            settlementConsumption,\n            totalConsumption,\n            farmSurplus,\n            ruin: this.getRuin(kingdomData.ruin),\n            commodities: this.getCommodities(kingdomData),\n            workSites: this.getWorkSites(workSites),\n            farmlands: workSites.farmlands.quantity,\n            food: workSites.farmlands.resources,\n            ...this.getActiveTabs(),\n            skills: calculateSkills({\n                ruin: kingdomData.ruin,\n                skillRanks: kingdomData.skillRanks,\n                leaders: kingdomData.leaders,\n                abilityScores: kingdomData.abilityScores,\n                unrest: kingdomData.unrest,\n                kingdomLevel: kingdomData.level,\n                untrainedProficiencyMode: getUntrainedProficiencyMode(this.game),\n                skillItemBonuses: activeSettlementStructureResult?.merged?.skillBonuses,\n                additionalModifiers: createActiveSettlementModifiers(\n                    kingdomData,\n                    activeSettlement?.settlement,\n                    activeSettlementStructureResult,\n                    getSettlementsWithoutLandBorders(this.game, kingdomData),\n                ),\n                activities,\n            }),\n            leaders: this.getLeaders(kingdomData.leaders),\n            abilities: this.getAbilities(kingdomData.abilityScores, kingdomData.leaders, kingdomData.level),\n            fameTypes: allFameTypes,\n            fameLabel: this.getFameLabel(kingdomData.fame.type),\n            groups: kingdomData.groups,\n            ...this.getFeats(kingdomData.feats, kingdomData.bonusFeats, kingdomData.level),\n            tradeAgreementsSize: kingdomData.groups.filter(t => t.relations === 'trade-agreement').length,\n            ranks: [\n                {label: 'Untrained', value: 0},\n                {label: 'Trained', value: 1},\n                {label: 'Expert', value: 2},\n                {label: 'Master', value: 3},\n                {label: 'Legendary', value: 4},\n            ],\n            heartlands: allHeartlands.map(heartland => {\n                return {label: unslugify(heartland), value: heartland};\n            }),\n            actorTypes: [\n                {label: 'PC', value: 'pc'},\n                {label: 'NPC', value: 'npc'},\n                {label: 'Companion', value: 'companion'},\n            ],\n            companions: allCompanions,\n            settlements: kingdomData.settlements\n                .map(settlement => getSettlement(this.game, kingdomData, settlement.sceneId))\n                .filter(settlement => settlement !== undefined)\n                .map(settlement => {\n                    const s = settlement as SettlementAndScene;\n                    const waterBorders = s.settlement.waterBorders ?? 0;\n                    return {\n                        ...s.settlement,\n                        ...getSettlementInfo(s, autoCalculateSettlementLevel),\n                        waterBorders,\n                        overcrowded: this.isOvercrowded(s),\n                        lacksBridge: waterBorders >= 4 && !getStructureResult(structureStackMode, autoCalculateSettlementLevel, activities, s).hasBridge,\n                        isCapital: settlement?.settlement.type === 'capital',\n                        name: s.scene.name ?? undefined,\n                    };\n                }),\n            groupRelationTypes: [\n                {label: 'None', value: 'none'},\n                {label: 'Diplomatic Relations', value: 'diplomatic-relations'},\n                {label: 'Trade Agreement', value: 'trade-agreement'},\n            ],\n            ongoingEvents: await Promise.all(kingdomData.ongoingEvents\n                .map(event => TextEditor.enrichHTML(event.name))),\n            milestones: kingdomData.milestones.map(m => {\n                return {...m, display: (useXpHomebrew || !m.homebrew) && (isGM || !m.name.startsWith('Cult Event'))};\n            }),\n            leadershipActivities: enableCompanionActivities('leadership', unlockedActivities, groupedActivities)\n                .map(activity => {\n                    return {label: createActivityLabel(groupedActivities, activity, kingdomData), value: activity};\n                })\n                .sort((a, b) => a.label.localeCompare(b.label)),\n            regionActivities: enableCompanionActivities('region', unlockedActivities, groupedActivities)\n                .map(activity => {\n                    return {label: createActivityLabel(groupedActivities, activity, kingdomData), value: activity};\n                }),\n            armyActivities: enableCompanionActivities('army', unlockedActivities, groupedActivities)\n                .map(activity => {\n                    return {label: createActivityLabel(groupedActivities, activity, kingdomData), value: activity};\n                }),\n            featuresByLevel: Array.from(featuresByLevel.entries())\n                .map(([level, features]) => {\n                    const featureNames = features.map(f => f.name);\n                    if (homebrewSkillIncreases && level % 2 == 0) {\n                        featureNames.push('Skill Increase');\n                    }\n                    return {level, features: featureNames.join(', ')};\n                }),\n            uniqueFeatures: uniqueFeatures,\n            canLevelUp: kingdomData.xp >= kingdomData.xpThreshold && kingdomData.level < 20,\n            turnsWithoutEvent: kingdomData.turnsWithoutEvent,\n            eventDC: this.calculateEventDC(kingdomData.turnsWithoutEvent),\n            turnsWithoutCultEvent: kingdomData.turnsWithoutCultEvent,\n            cultEventDC: this.calculateCultEventDC(kingdomData.turnsWithoutCultEvent),\n            civicPlanning: kingdomData.level >= 12,\n            useXpHomebrew,\n            canAddSettlement,\n            effects: createEffects(kingdomData.modifiers),\n            cultOfTheBloomEvents: getBooleanSetting(this.game, 'cultOfTheBloomEvents') && isGM,\n            automateResources,\n            canAddRealm,\n            showRealmData,\n            showAddRealmButton,\n        };\n    }\n\n    private getFameLabel(fameType: FameType): string {\n        return fameType === 'famous' ? 'Fame' : 'Infamy';\n    }\n\n    private getActiveTabs(): Record<string, boolean> {\n        return {\n            statusTab: this.nav === 'status',\n            skillsTab: this.nav === 'skills',\n            turnTab: this.nav === 'turn',\n            groupsTab: this.nav === 'groups',\n            featsTab: this.nav === 'feats',\n            notesTab: this.nav === 'notes',\n            settlementsTab: this.nav === 'settlements',\n            effectsTab: this.nav === 'effects',\n        };\n    }\n\n    protected _getHeaderButtons(): Application.HeaderButton[] {\n        const buttons = super._getHeaderButtons();\n        buttons.unshift({\n            label: 'Help',\n            class: 'pf2e-kingmaker-tools-hb1',\n            icon: 'fas fa-question',\n            onclick: () => openJournal('Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.iAQCUYEAq4Dy8uCY.JournalEntryPage.ty6BS5eSI7ScfVBk'),\n        });\n        if (this.game.user?.isGM ?? false) {\n            buttons.unshift({\n                label: 'Show Players',\n                class: 'something-made-up',\n                icon: 'fas fa-eye',\n                onclick: () => this.game.socket!.emit('module.pf2e-kingmaker-tools', {\n                    action: 'openKingdomSheet',\n                }),\n            });\n        }\n        return buttons;\n    }\n\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    override async _updateObject(event: Event, formData: any): Promise<void> {\n        console.log(formData);\n        const milestones = this.getKingdom().milestones;\n        const kingdom = expandObject(formData);\n        kingdom.groups = unpackFormArray(kingdom.groups);\n        kingdom.feats = unpackFormArray(kingdom.feats);\n        kingdom.bonusFeats = unpackFormArray(kingdom.bonusFeats);\n        kingdom.milestones = unpackFormArray(kingdom.milestones).map((milestone, index) => {\n            return {\n                ...milestones[index],\n                completed: (milestone as { completed: boolean }).completed,\n            };\n        });\n        await this.saveKingdom(kingdom);\n    }\n\n    public sceneChange(): void {\n        this.render();\n    }\n\n    override activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n        Hooks.on('closeKingmakerHexEdit', this.sceneChange.bind(this));\n        Hooks.on('deleteScene', this.sceneChange.bind(this));\n        Hooks.on('canvasReady', this.sceneChange.bind(this));\n        Hooks.on('createToken', this.sceneChange.bind(this));\n        Hooks.on('deleteToken', this.sceneChange.bind(this));\n        Hooks.on('sightRefresh', this.sceneChange.bind(this)); // end of drag movement\n        Hooks.on('applyTokenStatusEffect', this.sceneChange.bind(this));\n        Hooks.on('createTile', this.sceneChange.bind(this));\n        Hooks.on('updateTile', this.sceneChange.bind(this));\n        Hooks.on('deleteTile', this.sceneChange.bind(this));\n        Hooks.on('createDrawing', this.sceneChange.bind(this));\n        Hooks.on('updateDrawing', this.sceneChange.bind(this));\n        Hooks.on('deleteDrawing', this.sceneChange.bind(this));\n        const $html = html[0];\n        $html.querySelectorAll('.km-nav a')?.forEach(el => {\n            el.addEventListener('click', (event) => {\n                const tab = event.currentTarget as HTMLAnchorElement;\n                this.nav = tab.dataset.tab as KingdomTab;\n                this.render();\n            });\n        });\n        $html.querySelectorAll('.km-reduce-ruin')\n            .forEach(el => el.addEventListener('click', async (ev) => await this.reduceRuin(ev)));\n        $html.querySelector('#km-kingdom-size-help')\n            ?.addEventListener('click', async (ev) => {\n                ev.stopPropagation();\n                ev.preventDefault();\n                kingdomSizeDialog();\n            });\n        $html.querySelector('#km-settlement-size-help')\n            ?.addEventListener('click', async (ev) => {\n                ev.stopPropagation();\n                ev.preventDefault();\n                settlementSizeDialog();\n            });\n        $html.querySelector('#km-gain-fame')\n            ?.addEventListener('click', async () => await this.upkeepGainFame());\n        $html.querySelector('#km-adjust-unrest')\n            ?.addEventListener('click', async () => await this.adjustUnrest());\n        $html.querySelector('#km-collect-resources')\n            ?.addEventListener('click', async () => await this.collectResources());\n        $html.querySelector('#km-reduce-unrest')\n            ?.addEventListener('click', async () => await this.reduceUnrest());\n        $html.querySelector('#km-pay-consumption')\n            ?.addEventListener('click', async () => await this.payConsumption());\n        $html.querySelector('#km-check-event')\n            ?.addEventListener('click', async () => await this.checkForEvent());\n        $html.querySelector('#km-check-cult-event')\n            ?.addEventListener('click', async () => await this.checkForCultEvent());\n        $html.querySelector('#km-roll-event')\n            ?.addEventListener('click', async () => await rollKingdomEvent(this.game));\n        $html.querySelector('#km-roll-cult-event')\n            ?.addEventListener('click', async () => await rollCultEvent(this.game));\n        $html.querySelector('#claimed-refuge')\n            ?.addEventListener('click', async () => await this.claimedHexFeature('refuge'));\n        $html.querySelector('#km-open-structure-browser')\n            ?.addEventListener('click', async () => await this.showStructureBrowser());\n        $html.querySelectorAll('.km-view-settlement-scene')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev: Event): Promise<void> => {\n                    await this.viewSettlementScene((ev as MouseEvent));\n                });\n            });\n        $html.querySelector('#claimed-landmark')\n            ?.addEventListener('click', async () => await this.claimedHexFeature('landmark'));\n        $html.querySelector('#km-add-event')\n            ?.addEventListener('click', async () => addOngoingEventDialog((name) => {\n                const current = this.getKingdom();\n                this.saveKingdom({\n                    ongoingEvents: [...current.ongoingEvents, {name}],\n                });\n            }));\n        $html.querySelectorAll('.km-remove-event')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => await this.deleteKingdomPropertyAtIndex(ev, 'ongoingEvents'));\n            });\n        $html.querySelectorAll('.km-event-xp')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => {\n                    const target = ev.currentTarget as HTMLButtonElement;\n                    const modifier = parseInt(target.dataset.modifier ?? '0', 10);\n                    await this.increaseXP(calculateEventXP(modifier));\n                });\n            });\n        $html.querySelectorAll('.km-claimed-hexes-xp')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => {\n                    const target = ev.currentTarget as HTMLButtonElement;\n                    const hexes = parseInt(target.dataset.hexes ?? '0', 10);\n                    const current = this.getKingdom();\n                    const automateResourceMode = getStringSetting(this.game, 'automateResources') as ResourceAutomationMode;\n                    const {size: kingdomSize} = getStolenLandsData(this.game, automateResourceMode, current);\n                    const useHomeBrew = getBooleanSetting(this.game, 'vanceAndKerensharaXP');\n                    await this.increaseXP(calculateHexXP({\n                        hexes,\n                        kingdomSize,\n                        useVK: useHomeBrew,\n                        xpPerClaimedHex: getNumberSetting(this.game, 'xpPerClaimedHex'),\n                    }));\n                });\n            });\n        $html.querySelector('#km-rp-to-xp')\n            ?.addEventListener('click', async () => {\n                const current = this.getKingdom();\n                const useHomeBrew = getBooleanSetting(this.game, 'vanceAndKerensharaXP');\n                await this.increaseXP(calculateRpXP({\n                    useVK: useHomeBrew,\n                    kingdomLevel: current.level,\n                    rpToXpConversionLimit: getNumberSetting(this.game, 'rpToXpConversionLimit'),\n                    rpToXpConversionRate: getNumberSetting(this.game, 'rpToXpConversionRate'),\n                    rp: current.resourcePoints.now,\n                }));\n            });\n        $html.querySelector('#solutions-to-xp')\n            ?.addEventListener('click', async () => {\n                const current = this.getKingdom();\n                await this.increaseXP((current.supernaturalSolutions + current.creativeSolutions) * 10);\n            });\n        $html.querySelector('#km-level-up')\n            ?.addEventListener('click', async () => {\n                const current = this.getKingdom();\n                if (current.xp >= current.xpThreshold) {\n                    await this.saveKingdom({level: current.level + 1, xp: current.xp - current.xpThreshold});\n                } else {\n                    ui.notifications?.error('Can not level up, not enough XP');\n                }\n            });\n        $html.querySelector('#km-add-group')\n            ?.addEventListener('click', async () => {\n                addGroupDialog((group) => this.saveKingdom({\n                    groups: [...this.getKingdom().groups, group],\n                }));\n            });\n        $html.querySelectorAll('.km-delete-group')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => await this.deleteKingdomPropertyAtIndex(ev, 'groups'));\n            });\n        $html.querySelector('#km-add-bonus-feat')\n            ?.addEventListener('click', async () => {\n                new AddBonusFeatDialog(null, {\n                    feats: allFeats,\n                    onOk: (feat) => this.saveKingdom({\n                        bonusFeats: [...this.getKingdom().bonusFeats, feat],\n                    }),\n                }).render(true);\n            });\n        $html.querySelector('#manage-kingdom-activities')\n            ?.addEventListener('click', async () => {\n                manageKingdomActivitiesDialog(this.game, this.sheetActor);\n            });\n        $html.querySelectorAll('.km-delete-bonus-feat')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => await this.deleteKingdomPropertyAtIndex(ev, 'bonusFeats'));\n            });\n        $html.querySelectorAll('.kingdom-activity')\n            ?.forEach(el => {\n                el.addEventListener('click', async (el) => {\n                    const target = el.currentTarget as HTMLButtonElement;\n                    const activity = target.dataset.activity!;\n                    const kingdom = this.getKingdom();\n                    const activityData = getKingdomActivitiesById(kingdom.homebrewActivities);\n                    if (activityData[activity].dc === 'none') {\n                        await showHelpDialog(this.game, this.sheetActor, activity);\n                    } else {\n                        new CheckDialog(null, {\n                            activity,\n                            kingdom: kingdom,\n                            game: this.game,\n                            type: 'activity',\n                            onRoll: this.consumeModifiers.bind(this),\n                            actor: this.sheetActor,\n                        }).render(true);\n                    }\n                });\n            });\n        $html.querySelectorAll('.kingdom-skill')\n            ?.forEach(el => {\n                el.addEventListener('click', async (el) => {\n                    const target = el.currentTarget as HTMLButtonElement;\n                    const skill = target.dataset.skill;\n                    new CheckDialog(null, {\n                        kingdom: this.getKingdom(),\n                        game: this.game,\n                        skill: skill as Skill,\n                        type: 'skill',\n                        onRoll: this.consumeModifiers.bind(this),\n                        actor: this.sheetActor,\n                    }).render(true);\n                });\n            });\n        $html.querySelector('#km-end-turn')\n            ?.addEventListener('click', async () => await this.endTurn());\n        $html.querySelectorAll('.show-help')\n            ?.forEach(el => {\n                el.addEventListener('click', async (el) => {\n                    const target = el.currentTarget as HTMLButtonElement;\n                    const help = target.dataset.help!;\n                    if (help) {\n                        await showHelpDialog(this.game, this.sheetActor, help);\n                    }\n                });\n            });\n        $html.querySelector('#make-current-scene-realm')\n            ?.addEventListener('click', async () => {\n                const scene = getCurrentScene(this.game);\n                const realmSceneId = scene?.id;\n                if (realmSceneId) {\n                    await this.saveKingdom({realmSceneId});\n                }\n            });\n        $html.querySelector('#make-current-scene-settlement')\n            ?.addEventListener('click', async () => {\n                const scene = getCurrentScene(this.game);\n                const id = scene?.id;\n                if (id) {\n                    const newSettlement: Settlement = {\n                        sceneId: id,\n                        level: 0,\n                        type: 'settlement',\n                        lots: 0,\n                        secondaryTerritory: false,\n                        waterBorders: 0,\n                    };\n                    const current = this.getKingdom();\n                    await this.saveKingdom({\n                        settlements: [...current.settlements, newSettlement],\n                    });\n                }\n            });\n        $html.querySelectorAll('.km-delete-settlement')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => await this.deleteKingdomPropertyAtIndex(ev, 'settlements'));\n            });\n        $html.querySelectorAll('.inspect-settlement')\n            ?.forEach(el => {\n                el.addEventListener('click', async (el) => {\n                    const current = this.getKingdom();\n                    const target = el.currentTarget as HTMLButtonElement;\n                    const id = target.dataset.id!;\n                    await showSettlement(this.game, id, current);\n                });\n            });\n        $html.querySelector('#km-add-effect')\n            ?.addEventListener('click', async () => {\n                const allActivities = Object.keys(getKingdomActivitiesById(this.getKingdom().homebrewActivities));\n                addEffectDialog(allActivities, async (modifier) => {\n                    const current = this.getKingdom();\n                    current.modifiers.push(modifier);\n                    await this.saveKingdom(current);\n                });\n            });\n        $html.querySelectorAll('.km-delete-effect')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => await this.deleteKingdomPropertyAtIndex(ev, 'modifiers'));\n            });\n        $html.querySelector('.kingdom-settings')?.addEventListener('click', () => showKingdomSettings({\n            game: this.game,\n            sheetActor: this.sheetActor,\n            onSave: () => {\n                this.render();\n            },\n        }));\n        $html.querySelectorAll('.edit-settlement')\n            ?.forEach(el => {\n                el.addEventListener('click', async (ev) => {\n                    const target = ev?.currentTarget as HTMLButtonElement | null;\n                    const index = parseInt(target?.dataset?.index as string, 10);\n                    const current = this.getKingdom();\n                    const data = current.settlements[index];\n                    const name = getScene(this.game, data.sceneId)?.name as string;\n                    const autoLevel = getBooleanSetting(this.game, 'autoCalculateSettlementLevel');\n                    editSettlementDialog(autoLevel, name, data, (savedData) => {\n                        current.settlements[index] = savedData;\n                        this.saveKingdom({\n                            settlements: current.settlements,\n                        });\n                    });\n                });\n            });\n    }\n\n    private async upkeepGainFame(): Promise<void> {\n        await ChatMessage.create({content: 'Gaining 1 Fame'});\n        await this.saveKingdom(gainFame(this.getKingdom(), 1));\n    }\n\n    private async consumeModifiers(consumeIds: Set<string>): Promise<void> {\n        const current = this.getKingdom();\n        await this.saveKingdom({\n            modifiers: current.modifiers\n                .filter(modifier => {\n                    const id = modifier.consumeId;\n                    if (id === undefined || id === null) {\n                        return true;\n                    } else {\n                        return !consumeIds.has(id);\n                    }\n                }),\n        });\n    }\n\n    private async reduceRuin(event: Event): Promise<void> {\n        const button = event.currentTarget as HTMLButtonElement;\n        const ruin = button.dataset.ruin as keyof Ruin;\n        const roll = await new Roll('1d20').roll();\n        await roll.toMessage({flavor: `Reducing ${capitalize(ruin)} on a 16 or higher`});\n        if (roll.total >= 16) {\n            const current = this.getKingdom();\n            await this.saveKingdom({\n                ruin: {\n                    ...current.ruin,\n                    [ruin]: {\n                        ...current.ruin[ruin],\n                        penalty: Math.max(0, current.ruin[ruin].penalty - 1),\n                    },\n                },\n            });\n        }\n    }\n\n    private async increaseXP(xp: number): Promise<void> {\n        await ChatMessage.create({content: `Gained ${xp} Kingdom XP`});\n        await this.saveKingdom({xp: this.getKingdom().xp + xp});\n    }\n\n    private async endTurn(): Promise<void> {\n        const current = this.getKingdom();\n        const capacity = getCapacity(this.game, current);\n        await ChatMessage.create({\n            content: `<h2>Ending Turn</h2>\n            <ul>\n                <li>Setting Resource Points to 0</li>\n                <li>Reducing Effects' Turns by 1</li>\n                <li>Setting available Supernatural and Creative Solutions to 0</li>\n                <li>Adding values from the <b>next</b> columns to the <b>now</b> columns respecting their resource limits</li>\n            </ul>\n            `,\n        });\n        // tick down modifiers\n        const modifiers = current.modifiers\n            .map(modifier => {\n                const turns = modifier.turns === undefined ? undefined : modifier.turns - 1;\n                return {\n                    ...modifier,\n                    turns: turns,\n                };\n            })\n            .filter(modifier => (modifier?.turns ?? 1) > 0);\n        await this.saveKingdom({\n            modifiers,\n            fame: {\n                ...current.fame,\n                now: clamped(current.fame.next, 0, 3),\n                next: 0,\n            },\n            resourceDice: {\n                now: current.resourceDice.next,\n                next: 0,\n            },\n            supernaturalSolutions: 0,\n            creativeSolutions: 0,\n            resourcePoints: {\n                now: current.resourcePoints.next,\n                next: 0,\n            },\n            consumption: {\n                now: current.consumption.next,\n                next: 0,\n                armies: current.consumption.armies,\n            },\n            commodities: {\n                now: {\n                    food: Math.min(capacity.food, current.commodities.now.food + current.commodities.next.food),\n                    luxuries: Math.min(capacity.luxuries, current.commodities.now.luxuries + current.commodities.next.luxuries),\n                    stone: Math.min(capacity.stone, current.commodities.now.stone + current.commodities.next.stone),\n                    lumber: Math.min(capacity.lumber, current.commodities.now.lumber + current.commodities.next.lumber),\n                    ore: Math.min(capacity.ore, current.commodities.now.ore + current.commodities.next.ore),\n                },\n                next: {\n                    food: 0,\n                    luxuries: 0,\n                    stone: 0,\n                    lumber: 0,\n                    ore: 0,\n                },\n            },\n        });\n    }\n\n    private isOvercrowded(settlement: SettlementAndScene): boolean {\n        const structureStackMode = getStructureStackMode(this.game);\n        const autoCalculateSettlementLevel = getBooleanSetting(this.game, 'autoCalculateSettlementLevel');\n        const activities = getKingdomActivitiesById(this.getKingdom().homebrewActivities);\n        const structures = getStructureResult(structureStackMode, autoCalculateSettlementLevel, activities, settlement);\n        return getSettlementInfo(settlement, autoCalculateSettlementLevel).lots > structures.residentialLots;\n    }\n\n    private async adjustUnrest(): Promise<void> {\n        const current = this.getKingdom();\n        const data = getAllSettlements(this.game, current);\n        const overcrowdedSettlements = data.filter(s => this.isOvercrowded(s)).length;\n        const secondaryTerritories = data.some(s => s.settlement.secondaryTerritory) ? 1 : 0;\n        const atWar = current.atWar ? 1 : 0;\n        let rulerVacancyUnrest = 0;\n        if (current.leaders.ruler.vacant) {\n            const roll = await (new Roll('1d4').roll());\n            await roll.toMessage({flavor: 'Gaining Unrest because Leader is vacant'});\n            rulerVacancyUnrest = roll.total;\n        }\n        const newUnrest = atWar + overcrowdedSettlements + secondaryTerritories + rulerVacancyUnrest;\n        let unrest = newUnrest + current.unrest;\n        if (current.level >= 20 && unrest > 0) {\n            unrest = 0;\n            await ChatMessage.create({content: 'Ignoring any Unrest increase due to \"Envy of the World\" Kingdom Feature'});\n        } else {\n            await ChatMessage.create({\n                content: `<h2>Gaining Unrest</h2> \n                <ul>\n                    <li><b>Overcrowded Settlements</b>: ${overcrowdedSettlements}</li>\n                    <li><b>Secondary Territories</b>: ${secondaryTerritories}</li>\n                    <li><b>Kingdom At War</b>: ${atWar}</li>\n                    <li><b>Ruler Vacancy Penalty</b>: ${rulerVacancyUnrest}</li>\n                    <li><b>Total</b>: ${newUnrest}</li>\n                </ul>\n                `,\n            });\n        }\n        if (unrest >= 10) {\n            const ruinRoll = await (new Roll('1d10').roll());\n            await ruinRoll.toMessage({flavor: 'Gaining points to Ruin (distribute as you wish)'});\n            const roll = await (new Roll('1d20').roll());\n            await roll.toMessage({flavor: 'Check if losing a hex on DC 11'});\n            if (roll.total >= 11) {\n                await ChatMessage.create({content: 'You lose one hex of your choice'});\n            }\n        }\n        if (unrest >= this.calculateAnarchy(current.feats, current.bonusFeats)) {\n            await ChatMessage.create({content: 'Kingdom falls into anarchy, unless you spend all fame/infamy points. Only Quell Unrest leadership activities can be performed and all checks are worsened by a degree'});\n        }\n        await this.saveKingdom({\n            unrest,\n        });\n    }\n\n    private async checkForEvent(): Promise<void> {\n        const rollMode = getStringSetting(this.game, 'kingdomEventRollMode') as unknown as keyof CONFIG.Dice.RollModes;\n        const turnsWithoutEvent = this.getKingdom().turnsWithoutEvent;\n        const dc = this.calculateEventDC(turnsWithoutEvent);\n        const roll = await (new Roll('1d20').roll());\n        await roll.toMessage({flavor: `Checking for Event on DC ${dc}`}, {rollMode});\n        if (roll.total >= dc) {\n            await ChatMessage.create({\n                type: CONST.CHAT_MESSAGE_TYPES.ROLL,\n                content: 'An event occurs, roll a Kingdom Event!',\n                rollMode,\n            });\n            await this.saveKingdom({turnsWithoutEvent: 0});\n        } else {\n            await this.saveKingdom({turnsWithoutEvent: turnsWithoutEvent + 1});\n        }\n    }\n\n    private async checkForCultEvent(): Promise<void> {\n        const rollMode = getStringSetting(this.game, 'kingdomEventRollMode') as unknown as keyof CONFIG.Dice.RollModes;\n        const turnsWithoutCultEvent = this.getKingdom().turnsWithoutCultEvent;\n        const dc = this.calculateCultEventDC(turnsWithoutCultEvent);\n        const roll = await (new Roll('1d20').roll());\n        await roll.toMessage({flavor: `Checking for Cult Event on DC ${dc}`}, {rollMode});\n        if (roll.total >= dc) {\n            await ChatMessage.create({\n                type: CONST.CHAT_MESSAGE_TYPES.ROLL,\n                content: 'An event occurs, roll a Cult Event!',\n                rollMode,\n            });\n            await this.saveKingdom({turnsWithoutCultEvent: 0});\n        } else {\n            await this.saveKingdom({turnsWithoutCultEvent: turnsWithoutCultEvent + 1});\n        }\n    }\n\n    private async deleteKingdomPropertyAtIndex(ev: Event, property: keyof Kingdom): Promise<void> {\n        const target = ev.currentTarget as HTMLButtonElement;\n        const deleteIndex = target.dataset.deleteIndex;\n        if (deleteIndex) {\n            const deleteAt = parseInt(deleteIndex, 10);\n            const values = [...this.getKingdom()[property] as unknown[]];\n            values.splice(deleteAt, 1);\n            await this.saveKingdom({\n                [property]: values,\n            });\n        }\n    }\n\n    private async collectResources(): Promise<void> {\n        const current = this.getKingdom();\n        const automateResourceMode = getStringSetting(this.game, 'automateResources') as ResourceAutomationMode;\n        const {size: kingdomSize, workSites} = getStolenLandsData(this.game, automateResourceMode, current);\n        const sizeData = getSizeData(kingdomSize);\n        const capacity = getCapacity(this.game, current);\n        const dice = this.getResourceDiceNum(current);\n        const rolledPoints = await this.rollResourceDice(sizeData.resourceDieSize, dice);\n        const commodities = this.calculateCommoditiesThisTurn(workSites);\n        await ChatMessage.create({\n            content: `\n        <h2>Collecting Resources</h2>\n        <ul>\n            <li><b>Resource Points</b>: ${rolledPoints}</li>\n            <li><b>Ore</b>: ${commodities.ore}</li>\n            <li><b>Lumber</b>: ${commodities.lumber}</li>\n            <li><b>Stone</b>: ${commodities.stone}</li>\n            <li><b>Luxuries</b>: ${commodities.luxuries}</li>\n        </ul>\n        `,\n        });\n        await this.saveKingdom({\n            resourcePoints: {\n                now: current.resourcePoints.now + rolledPoints,\n                next: current.resourcePoints.next,\n            },\n            resourceDice: {\n                now: 0,\n                next: current.resourceDice.next,\n            },\n            commodities: {\n                now: {\n                    ore: Math.min(capacity.ore, current.commodities.now.ore + commodities.ore),\n                    lumber: Math.min(capacity.lumber, current.commodities.now.lumber + commodities.lumber),\n                    luxuries: Math.min(capacity.luxuries, current.commodities.now.luxuries + commodities.luxuries),\n                    stone: Math.min(capacity.stone, current.commodities.now.stone + commodities.stone),\n                    food: current.commodities.now.food,\n                },\n                next: current.commodities.next,\n            },\n        });\n    }\n\n    private getResourceDiceNum(kingdom: Kingdom): number {\n        const featDice = hasFeat(kingdom, 'Insider Trading') ? 1 : 0;\n        const levelData = getLevelData(kingdom.level);\n        return Math.max(0, levelData.resourceDice + kingdom.resourceDice.now + featDice);\n    }\n\n\n    private calculateCommoditiesThisTurn(sites: WorkSites): Omit<Commodities, 'food'> {\n        return {\n            ore: sites.mines.quantity + sites.mines.resources,\n            lumber: sites.lumberCamps.quantity + sites.lumberCamps.resources,\n            luxuries: sites.luxurySources.quantity + sites.luxurySources.resources,\n            stone: sites.quarries.quantity + sites.quarries.resources,\n        };\n    }\n\n    override close(options?: FormApplication.CloseOptions): Promise<void> {\n        Hooks.off('closeKingmakerHexEdit', this.sceneChange);\n        Hooks.off('deleteScene', this.sceneChange);\n        Hooks.off('canvasReady', this.sceneChange);\n        Hooks.off('createToken', this.sceneChange);\n        Hooks.off('sightRefresh', this.sceneChange); // end of drag movement\n        Hooks.off('deleteToken', this.sceneChange);\n        Hooks.off('applyTokenStatusEffect', this.sceneChange);\n        Hooks.off('createTile', this.sceneChange);\n        Hooks.off('updateTile', this.sceneChange);\n        Hooks.off('deleteTile', this.sceneChange);\n        Hooks.off('createDrawing', this.sceneChange);\n        Hooks.off('updateDrawing', this.sceneChange);\n        Hooks.off('deleteDrawing', this.sceneChange);\n        return super.close(options);\n    }\n\n    private getRuin(ruin: Ruin): object {\n        return Object.fromEntries(Object.entries(ruin)\n            .map(([ruin, values]) => [ruin, {\n                label: capitalize(ruin),\n                ...values,\n                canReduce: values.value === 0 && values.penalty > 0,\n            }]),\n        );\n    }\n\n    private getWorkSites(sites: WorkSites): object {\n        return {\n            lumberCamps: {\n                label: 'Lumber',\n                total: sites.lumberCamps.quantity + sites.lumberCamps.resources,\n                ...sites.lumberCamps,\n            },\n            mines: {\n                label: 'Ore',\n                total: sites.mines.quantity + sites.mines.resources,\n                ...sites.mines,\n            },\n            quarries: {\n                label: 'Stone',\n                total: sites.quarries.quantity + sites.quarries.resources,\n                ...sites.quarries,\n            },\n            luxurySources: {\n                label: 'Luxuries',\n                total: sites.luxurySources.quantity + sites.luxurySources.resources,\n                ...sites.luxurySources,\n            },\n        };\n    }\n\n    private getCommodities(kingdom: Kingdom): object {\n        const commodities = kingdom.commodities.now;\n        const commoditiesNextRound = kingdom.commodities.next;\n        const storageCapacity = getCapacity(this.game, kingdom);\n        return Object.fromEntries((Object.entries(commodities) as [keyof Commodities, number][])\n            .map(([commodity, value]) => [commodity, {\n                label: capitalize(commodity),\n                value: value,\n                capacity: storageCapacity[commodity],\n                next: commoditiesNextRound[commodity],\n            }]),\n        );\n    }\n\n    private getLeaders(leaders: Leaders): object {\n        const appliedLeaders = applyLeaderCompanionRules(leaders);\n        return Object.fromEntries((Object.entries(appliedLeaders) as [keyof Leaders, LeaderValues][])\n            .map(([leader, values]) => {\n                return [leader, {\n                    label: capitalize(leader),\n                    isCompanion: values.type === 'companion',\n                    ...values,\n                }];\n            }));\n    }\n\n    private getAbilities(abilityScores: AbilityScores, leaders: Leaders, kingdomLevel: number): object {\n        return Object.fromEntries((Object.entries(abilityScores) as [keyof AbilityScores, number][])\n            .map(([ability, score]) => {\n                return [ability, {\n                    label: capitalize(ability),\n                    score: score,\n                    modifier: calculateAbilityModifier(score),\n                    invested: isInvested(ability, leaders),\n                    investedBonus: calculateInvestedBonus(kingdomLevel, ability, leaders),\n                }];\n            }));\n    }\n\n    private getFeats(feats: Feat[], bonusFeats: BonusFeat[], kingdomLevel: number): object {\n        const levelFeats = [];\n        const takenFeatsByLevel = Object.fromEntries(feats.map(feat => [feat.level, feat]));\n        const noFeat = allFeatsByName['-'];\n        for (let featLevel = 2; featLevel <= kingdomLevel; featLevel += 2) {\n            const existingFeat = takenFeatsByLevel[featLevel];\n            if (existingFeat && existingFeat.id in allFeatsByName) {\n                levelFeats.push({...allFeatsByName[existingFeat.id], takenAt: featLevel});\n            } else {\n                levelFeats.push({...noFeat, takenAt: featLevel});\n            }\n        }\n        return {\n            featIds: Object.keys(allFeatsByName),\n            levelFeats: levelFeats,\n            bonusFeats: bonusFeats\n                .filter(feat => feat.id in allFeatsByName)\n                .map(feat => allFeatsByName[feat.id]),\n        };\n    }\n\n    private async rollResourceDice(resourceDieSize: ResourceDieSize, dice: number): Promise<number> {\n        const roll = await (new Roll(dice + resourceDieSize).roll());\n        await roll.toMessage({flavor: 'Rolling Resource Dice'});\n        return roll.total;\n    }\n\n    private async reduceUnrest(): Promise<void> {\n        const roll = await (new Roll('1d20').roll());\n        await roll.toMessage({flavor: 'Reducing Unrest by 1 on an 11 or higher'});\n        if (roll.total > 10) {\n            await this.saveKingdom({\n                unrest: Math.max(0, this.getKingdom().unrest - 1),\n            });\n        }\n    }\n\n    private calculateEventDC(turnsWithoutEvent: number): number {\n        return Math.max(1, 16 - (turnsWithoutEvent * 5));\n    }\n\n    private calculateCultEventDC(turnsWithoutEvent: number): number {\n        return Math.max(1, 20 - (turnsWithoutEvent * 2));\n    }\n\n    private calculateAnarchy(feats: Feat[], bonusFeats: BonusFeat[]): number {\n        const hasEndureAnarchy = feats.some(f => f.id === 'Endure Anarchy') ||\n            bonusFeats.some(f => f.id === 'Endure Anarchy');\n        return hasEndureAnarchy ? 24 : 20;\n    }\n\n    private async payConsumption(): Promise<void> {\n        const current = this.getKingdom();\n        const totalConsumption = getConsumption(this.game, current).current;\n        const currentFood = current.commodities.now.food;\n        const missingFood = totalConsumption - currentFood;\n        const pay = missingFood * 5;\n        if (totalConsumption > 0) {\n            await ChatMessage.create({\n                content: `<h2>Paying Consumption</h2>\n            <ul>\n                <li>Reducing food commodities by ${Math.min(currentFood, totalConsumption)}</li>\n                ${missingFood > 0 ? `<li>Missing ${missingFood} food commodities. Either pay ${loseRP(pay)} or gain ${gainUnrest('1d4')}</li>` : ''}\n            </ul>\n            `,\n            });\n            await this.saveKingdom({\n                commodities: {\n                    now: {\n                        ...current.commodities.now,\n                        food: Math.max(0, currentFood - totalConsumption),\n                    },\n                    next: current.commodities.next,\n                },\n            });\n        }\n    }\n\n    private async saveKingdom(kingdom: Partial<Kingdom>): Promise<void> {\n        await saveKingdom(this.sheetActor, kingdom);\n    }\n\n    private getKingdom(): Kingdom {\n        return getKingdom(this.sheetActor);\n    }\n\n    private async claimedHexFeature(feature: 'landmark' | 'refuge'): Promise<void> {\n        const current = this.getKingdom();\n        if (feature === 'refuge') {\n            await ChatMessage.create({content: 'Claimed a Refuge, please reduce a Ruin of your choice by 1'});\n            await this.saveKingdom({\n                modifiers: [...current.modifiers, {\n                    name: 'Claimed Refuge',\n                    enabled: true,\n                    value: 2,\n                    type: 'circumstance',\n                    abilities: ['loyalty', 'stability'],\n                    turns: 2,\n                }],\n            });\n        } else {\n            const unrestRoll = await (new Roll('1d4').roll());\n            await unrestRoll.toMessage({flavor: 'Claimed a Landmark, reducing Unrest by:'});\n            await this.saveKingdom({\n                unrest: Math.max(0, current.unrest - unrestRoll.total),\n                modifiers: [...current.modifiers, {\n                    name: 'Claimed Landmark',\n                    enabled: true,\n                    value: 2,\n                    type: 'circumstance',\n                    abilities: ['culture', 'economy'],\n                    turns: 2,\n                }],\n            });\n        }\n    }\n\n    private async viewSettlementScene(ev: MouseEvent): Promise<void> {\n        ev.preventDefault();\n        ev.stopPropagation();\n        const a = ev.currentTarget as HTMLElement;\n        const id = a.dataset.id;\n        const scene = this.game.scenes?.filter(scene => scene.id === id)?.[0];\n        if (scene) {\n            if (ev.ctrlKey) {\n                await scene.activate();\n            } else {\n                await scene.view();\n            }\n        }\n    }\n\n    private async showStructureBrowser(): Promise<void> {\n        const structureActors = this.game.actors\n                ?.filter(a => a.type === 'npc'\n                    && isNonNullable(a.getFlag('pf2e-kingmaker-tools', 'structureData')))\n            ?? [];\n        await showStructureBrowser(this.game, structureActors, this.getKingdom(), this.sheetActor, this.consumeModifiers.bind(this));\n    }\n}\n\n\nexport async function showKingdom(game: Game): Promise<void> {\n    const sheetActor = game?.actors?.find(a => a.name === 'Kingdom Sheet');\n    if (sheetActor) {\n        new KingdomApp(null, {game, sheetActor}).render(true);\n    } else {\n        setupDialog(game, 'Kingdom', 'dI12fgPwX9il8Fzu', async () => {\n            const sheetActor = game?.actors?.find(a => a.name === 'Kingdom Sheet');\n            await sheetActor?.setFlag('pf2e-kingmaker-tools', 'kingdom-sheet', getDefaultKingdomData());\n            await showKingdom(game);\n        });\n    }\n}\n","import {Leaders, Ruin, SkillRanks} from './data/kingdom';\nimport {capitalize} from '../utils';\nimport {Ability, AbilityScores} from './data/abilities';\nimport {allSkills, Skill, skillAbilities} from './data/skills';\nimport {KingdomPhase} from './data/activities';\nimport {\n    calculateModifiers,\n    createAbilityModifier,\n    createInvestedModifier,\n    createProficiencyModifier,\n    createRuinModifier,\n    createStructureModifiers,\n    createUnrestModifier,\n    createVacancyModifiers,\n    Modifier,\n    ModifierTotals,\n    processModifiers,\n    UntrainedProficiencyMode,\n} from './modifiers';\nimport {SkillItemBonus, SkillItemBonuses} from './data/structures';\nimport {KingdomActivityById} from './data/activityData';\n\n\ninterface SkillStats {\n    skill: Skill;\n    skillLabel: string;\n    ability: Ability;\n    abilityLabel: string;\n    rank: number;\n    total: ModifierTotals;\n}\n\nexport function createSkillModifiers(\n    {\n        skill,\n        ruin,\n        unrest,\n        skillRank,\n        abilityScores,\n        leaders,\n        kingdomLevel,\n        untrainedProficiencyMode,\n        skillItemBonus,\n        ability,\n        activity,\n        phase,\n        additionalModifiers = [],\n        overrides = {},\n        activities,\n    }: {\n        skill: Skill,\n        ability: Ability,\n        ruin: Ruin,\n        unrest: number,\n        skillRank: number,\n        abilityScores: AbilityScores,\n        kingdomLevel: number,\n        leaders: Leaders,\n        untrainedProficiencyMode: UntrainedProficiencyMode,\n        skillItemBonus?: SkillItemBonus,\n        activity?: string,\n        phase?: KingdomPhase,\n        additionalModifiers?: Modifier[],\n        overrides?: Record<string, boolean>;\n        activities: KingdomActivityById;\n    },\n): Modifier[] {\n    const abilityModifier = createAbilityModifier(ability, abilityScores);\n    const proficiencyModifier = createProficiencyModifier(skillRank, untrainedProficiencyMode, kingdomLevel);\n    const vacancyModifiers = createVacancyModifiers(ability, leaders);\n    // status bonus\n    const investedModifier = createInvestedModifier(kingdomLevel, ability, leaders);\n    // item bonus\n    const structureModifiers = skillItemBonus ? createStructureModifiers(skillItemBonus, activities) : [];\n    // status penalty\n    const unrestModifier = createUnrestModifier(unrest);\n    // item penalty\n    const ruinModifier = createRuinModifier(ability, ruin);\n    const result = [\n        abilityModifier,\n        proficiencyModifier,\n        ...vacancyModifiers,\n        ...structureModifiers,\n        ...additionalModifiers,\n    ];\n    if (ruinModifier) {\n        result.push(ruinModifier);\n    }\n    if (unrestModifier) {\n        result.push(unrestModifier);\n    }\n    if (investedModifier) {\n        result.push(investedModifier);\n    }\n    return processModifiers({\n        modifiers: result,\n        skill,\n        rank: skillRank,\n        phase,\n        activity,\n        overrides,\n        activities,\n    });\n}\n\nexport function calculateSkills(\n    {\n        ruin,\n        unrest,\n        skillRanks,\n        abilityScores,\n        leaders,\n        kingdomLevel,\n        untrainedProficiencyMode,\n        skillItemBonuses,\n        additionalModifiers,\n        activities,\n    }: {\n        ruin: Ruin,\n        unrest: number,\n        skillRanks: SkillRanks,\n        abilityScores: AbilityScores,\n        kingdomLevel: number,\n        leaders: Leaders,\n        untrainedProficiencyMode: UntrainedProficiencyMode,\n        skillItemBonuses?: SkillItemBonuses,\n        additionalModifiers?: Modifier[],\n        activities: KingdomActivityById,\n    },\n): SkillStats[] {\n    return allSkills.map(skill => {\n        const ability = skillAbilities[skill];\n        const modifiers = createSkillModifiers({\n            ruin,\n            unrest,\n            skillRank: skillRanks[skill],\n            abilityScores,\n            leaders,\n            kingdomLevel,\n            untrainedProficiencyMode,\n            ability,\n            skillItemBonus: skillItemBonuses?.[skill],\n            skill,\n            additionalModifiers,\n            activities,\n        });\n        const total = calculateModifiers(modifiers);\n        return {\n            skill,\n            rank: skillRanks[skill],\n            ability,\n            skillLabel: capitalize(skill),\n            abilityLabel: capitalize(ability),\n            total,\n        };\n    });\n}\n","import {Kingdom} from './data/kingdom';\nimport {groupBy} from '../utils';\n\nexport function getKingdom(sheetActor: Actor): Kingdom {\n    const kingdom = sheetActor.getFlag('pf2e-kingmaker-tools', 'kingdom-sheet') as Kingdom;\n    console.log(kingdom);\n    return kingdom;\n}\n\nfunction makeRuinPenaltiesPositive(kingdom: Partial<Kingdom>): void {\n    const ruin = kingdom.ruin;\n    if (ruin !== undefined) {\n        ruin.corruption.penalty = Math.abs(ruin.corruption.penalty);\n        ruin.crime.penalty = Math.abs(ruin.crime.penalty);\n        ruin.decay.penalty = Math.abs(ruin.decay.penalty);\n        ruin.strife.penalty = Math.abs(ruin.strife.penalty);\n    }\n}\n\nasync function giveMilestoneXP(kingdom: Partial<Kingdom>, existingKingdom: Kingdom): Promise<void> {\n    const milestones = kingdom.milestones;\n    if (milestones !== undefined) {\n        const existingMilestones = existingKingdom.milestones;\n        const existingMap = groupBy(existingMilestones, m => m.name);\n        const newMap = groupBy(milestones, m => m.name);\n        for (const key of existingMap.keys()) {\n            const existingVal = existingMap.get(key)?.[0];\n            const newVal = newMap.get(key)?.[0];\n            if (newVal !== undefined &&\n                existingVal !== undefined &&\n                newVal.completed !== existingVal.completed) {\n                const xp = newVal.completed ? newVal.xp : -newVal.xp;\n                const result = newVal.completed ? 'Gained' : 'Lost';\n                await ChatMessage.create({content: `${result} ${Math.abs(xp)} Kingdom XP`});\n                kingdom.xp = existingKingdom.xp + xp;\n            }\n        }\n    }\n}\n\nexport async function saveKingdom(sheetActor: Actor, kingdom: Partial<Kingdom>): Promise<void> {\n    const currentKingdom = getKingdom(sheetActor);\n    makeRuinPenaltiesPositive(kingdom);\n    await giveMilestoneXP(kingdom, currentKingdom);\n    console.info('Saving', kingdom);\n    await sheetActor.setFlag('pf2e-kingmaker-tools', 'kingdom-sheet', kingdom);\n}\n","import {mergeObjects, mergePartialObjects, sum} from '../utils';\nimport {getActivitySkills} from './data/activities';\nimport {\n    ActivityBonusRule,\n    CommodityStorage,\n    ItemGroup,\n    ItemLevelBonuses,\n    SkillBonusRule,\n    SkillItemBonus,\n    SkillItemBonuses,\n    Structure,\n} from './data/structures';\nimport {Skill} from './data/skills';\nimport {KingdomActivityById} from './data/activityData';\n\nexport interface StructureResult {\n    allowCapitalInvestment: boolean;\n    notes: string[];\n    skillBonuses: SkillItemBonuses;\n    itemLevelBonuses: ItemLevelBonuses;\n    settlementEventBonus: number;\n    leadershipActivityBonus: number;\n    storage: CommodityStorage;\n    increaseLeadershipActivities: boolean;\n    consumptionReduction: number;\n    consumption: number;\n    consumptionSurplus: number;\n    config: SettlementConfig;\n    unlockActivities: string[];\n    residentialLots: number;\n    hasBridge: boolean;\n    lots: number;\n}\n\nfunction count<T>(items: T[], idFunction: (item: T) => string): Map<string, { count: number, item: T }> {\n    return items.reduce((map, item) => {\n        const id = idFunction(item);\n        const count = (map.get(id)?.count ?? 0) + 1;\n        return map.set(id, {count, item});\n    }, new Map());\n}\n\nexport function countStructureOccurrences<T extends Structure>(structures: T[]): Map<string, {\n    count: number,\n    item: T\n}> {\n    return count(structures, s => s.stacksWith ?? s.name);\n}\n\n/**\n * Add up item bonuses of same structure\n */\nexport function groupStructures(structures: Structure[], maxItemBonus: number): Structure[] {\n    const structureOccurrences = countStructureOccurrences(structures);\n    return Array.from(structureOccurrences.values())\n        .map((data) => {\n            const structure = data.item;\n            const result: Structure = {\n                ...structure,\n                skillBonusRules: structure?.skillBonusRules?.map(rule => {\n                    return {\n                        ...rule,\n                        value: Math.min(rule.value * data.count, maxItemBonus),\n                    };\n                }),\n                availableItemsRules: structure?.availableItemsRules?.map(rule => {\n                    const count = rule.maximumStacks === undefined ? data.count : Math.min(data.count, rule.maximumStacks);\n                    const value = rule.value * count;\n                    return {\n                        ...rule,\n                        value,\n                    };\n                }),\n                settlementEventRules: structure?.settlementEventRules?.map(rule => {\n                    return {\n                        ...rule,\n                        value: Math.min(rule.value * data.count, maxItemBonus),\n                    };\n                }),\n                leadershipActivityRules: structure?.leadershipActivityRules?.map(rule => {\n                    return {\n                        ...rule,\n                        value: Math.min(rule.value * data.count, maxItemBonus),\n                    };\n                }),\n            };\n            return result;\n        });\n}\n\nfunction applySkillBonusRules(result: SkillItemBonuses, structures: Structure[]): void {\n    // apply skills\n    structures.forEach(structure => {\n        structure.skillBonusRules?.forEach(rule => {\n            const skill = result[rule.skill];\n            if (!rule.activity) {\n                if (rule.value > skill.value) {\n                    skill.value = rule.value;\n                }\n            }\n        });\n    });\n    // apply activities\n    structures.forEach(structure => {\n        structure.skillBonusRules?.forEach(rule => {\n            const skill = result[rule.skill];\n            const activity = rule.activity;\n            if (activity) {\n                if (rule.value > skill.value &&\n                    rule.value > (skill.activities[activity] ?? 0)) {\n                    skill.activities[activity] = rule.value;\n                }\n            }\n        });\n    });\n}\n\nfunction calculateItemLevelGroupBonus(\n    structures: Structure[],\n    group: ItemGroup | undefined,\n    stackMode: 'always-stack' | 'never-stack' = 'never-stack',\n): number {\n    const structureValues = structures\n        .flatMap(structures => structures.availableItemsRules ?? [])\n        .filter(rule => rule.group === group)\n        .map(rule => rule.value);\n    if (stackMode === 'always-stack') {\n        return sum(structureValues);\n    } else {\n        return Math.max(...structureValues, 0);\n    }\n}\n\nfunction applyItemLevelRules(itemLevelBonuses: ItemLevelBonuses, structures: Structure[]): void {\n    const defaultPenalty = structures.some(structure => structure.preventItemLevelPenalty === true) ? 0 : -2;\n\n    // calculate untyped bonuses\n    const otherBonuses = calculateItemLevelGroupBonus(structures, undefined, 'always-stack');\n    const alchemicalBonuses = calculateItemLevelGroupBonus(structures, 'alchemical');\n    const luxuryBonuses = calculateItemLevelGroupBonus(structures, 'luxury');\n    const magicalBonuses = calculateItemLevelGroupBonus(structures, 'magical');\n    const divineBonuses = calculateItemLevelGroupBonus(structures, 'divine');\n    const primalBonuses = calculateItemLevelGroupBonus(structures, 'primal');\n    const arcaneBonuses = calculateItemLevelGroupBonus(structures, 'arcane');\n    const occultBonuses = calculateItemLevelGroupBonus(structures, 'occult');\n\n    itemLevelBonuses.other = otherBonuses + defaultPenalty;\n    itemLevelBonuses.alchemical = alchemicalBonuses + itemLevelBonuses.other;\n    itemLevelBonuses.magical = magicalBonuses + itemLevelBonuses.other;\n    itemLevelBonuses.divine = itemLevelBonuses.magical + divineBonuses;\n    itemLevelBonuses.primal = itemLevelBonuses.magical + primalBonuses;\n    itemLevelBonuses.arcane = itemLevelBonuses.magical + arcaneBonuses;\n    itemLevelBonuses.occult = itemLevelBonuses.magical + occultBonuses;\n    itemLevelBonuses.luxuryMagical = itemLevelBonuses.magical + luxuryBonuses;\n    itemLevelBonuses.luxuryOccult = itemLevelBonuses.occult + luxuryBonuses;\n    itemLevelBonuses.luxuryArcane = itemLevelBonuses.arcane + luxuryBonuses;\n    itemLevelBonuses.luxuryPrimal = itemLevelBonuses.primal + luxuryBonuses;\n    itemLevelBonuses.luxuryDivine = itemLevelBonuses.divine + luxuryBonuses;\n}\n\nfunction applyLeadershipActivityBonuses(result: StructureResult, structures: Structure[]): void {\n    structures.forEach(structure => {\n        structure.leadershipActivityRules?.forEach(rule => {\n            if (rule.value > result.leadershipActivityBonus) {\n                result.leadershipActivityBonus = rule.value;\n            }\n        });\n    });\n}\n\nfunction applySettlementEventBonuses(result: StructureResult, structures: Structure[]): void {\n    structures.forEach(structure => {\n        structure.settlementEventRules?.forEach(rule => {\n            if (rule.value > result.settlementEventBonus) {\n                result.settlementEventBonus = rule.value;\n            }\n        });\n    });\n}\n\nfunction simplifyRules(rules: ActivityBonusRule[], activities: KingdomActivityById): SkillBonusRule[] {\n    return rules.flatMap(rule => {\n        const activity = rule.activity;\n        const skills = getActivitySkills(activities[activity].skills);\n        return skills.map(skill => {\n            return {\n                value: rule.value,\n                skill,\n                activity: activity,\n            };\n        });\n    });\n}\n\nfunction unionizeStructures(structures: Structure[], activities: KingdomActivityById): Structure[] {\n    return structures.map(structure => {\n        const simplifiedRules = simplifyRules(structure.activityBonusRules ?? [], activities);\n        return {\n            ...structure,\n            skillBonusRules: [...(structure.skillBonusRules ?? []), ...simplifiedRules],\n        };\n    });\n}\n\nfunction applyStorageIncreases(storage: CommodityStorage, structures: Structure[]): void {\n    structures\n        .filter(structures => structures.storage)\n        .forEach(structure => {\n            const keys = ['ore', 'lumber', 'food', 'stone', 'luxuries'] as (keyof CommodityStorage)[];\n            keys.forEach(key => {\n                const structureStorage = structure.storage;\n                if (structureStorage && key in structureStorage) {\n                    storage[key] += structureStorage[key] ?? 0;\n                }\n            });\n        });\n}\n\nfunction calculateConsumptionReduction(structures: Structure[]): number {\n    const consumptionPerUniqueBuilding = new Map<string, number>();\n    structures\n        .filter(structure => structure.consumptionReduction)\n        .forEach(structure => {\n            const id = structure.name;\n            const existingReduction = consumptionPerUniqueBuilding.get(id);\n            const newReduction = structure?.consumptionReduction ?? 0;\n            if (existingReduction === undefined || existingReduction < newReduction) {\n                consumptionPerUniqueBuilding.set(id, newReduction);\n            }\n        });\n    return Array.from(consumptionPerUniqueBuilding.values())\n        .reduce((a, b) => a + b, 0);\n}\n\nexport interface SettlementTypeData {\n    type: 'Village' | 'Town' | 'City' | 'Metropolis';\n    maximumLots: string;\n    requiredKingdomLevel: number;\n    population: string;\n    consumption: number;\n    maxItemBonus: number;\n    influence: number;\n    levelFrom: number;\n    levelTo?: number;\n}\n\nexport interface SettlementConfig extends SettlementTypeData {\n    level: number;\n}\n\nexport const settlementTypeData: SettlementTypeData[] = [{\n    type: 'Village',\n    consumption: 1,\n    influence: 0,\n    maximumLots: '1',\n    requiredKingdomLevel: 1,\n    levelFrom: 1,\n    levelTo: 1,\n    maxItemBonus: 1,\n    population: '400 or less',\n}, {\n    type: 'Town',\n    consumption: 2,\n    influence: 1,\n    requiredKingdomLevel: 3,\n    maximumLots: '4',\n    levelFrom: 2,\n    levelTo: 4,\n    maxItemBonus: 1,\n    population: '401-2000',\n}, {\n    type: 'City',\n    consumption: 4,\n    influence: 2,\n    requiredKingdomLevel: 9,\n    maximumLots: '9',\n    levelFrom: 5,\n    levelTo: 9,\n    maxItemBonus: 2,\n    population: '200125000',\n}, {\n    type: 'Metropolis',\n    consumption: 6,\n    influence: 3,\n    maximumLots: '10+',\n    requiredKingdomLevel: 15,\n    levelFrom: 10,\n    maxItemBonus: 3,\n    population: '25001+',\n}] as const;\n\nexport function getSettlementConfig(settlementLevel: number): SettlementConfig {\n    return {\n        ...settlementTypeData.find(d => settlementLevel >= d.levelFrom\n            && settlementLevel <= (d.levelTo ?? Number.MAX_SAFE_INTEGER))!,\n        level: settlementLevel,\n    };\n}\n\nfunction mergeBonuses(capital: SkillItemBonus, settlement: SkillItemBonus): SkillItemBonus {\n    const skillValue = capital.value > settlement.value ? capital.value : settlement.value;\n    const activities = mergePartialObjects(capital.activities, settlement.activities, (a: number | undefined, b: number | undefined) => Math.max(a ?? 0, b ?? 0));\n    const filteredActivities = Object.fromEntries(\n        Object.entries(activities)\n            .filter(([, value]) => (value ?? 0) > skillValue),\n    );\n    return {\n        value: skillValue,\n        activities: filteredActivities,\n    };\n}\n\nexport function includeCapital(capital: StructureResult, settlement: StructureResult): StructureResult {\n    return {\n        ...settlement,\n        increaseLeadershipActivities: capital.increaseLeadershipActivities,\n        unlockActivities: capital.unlockActivities.concat(settlement.unlockActivities),\n        leadershipActivityBonus: Math.max(capital.leadershipActivityBonus, settlement.leadershipActivityBonus),\n        skillBonuses: mergeObjects(capital.skillBonuses, settlement.skillBonuses, mergeBonuses) as SkillItemBonuses,\n    };\n}\n\nfunction applyUnlockedActivities(unlockActivities: string[], groupedStructures: Structure[]): void {\n    groupedStructures\n        .flatMap(structure => structure?.unlockActivities ?? [])\n        .forEach(activity => {\n            unlockActivities.push(activity);\n        });\n}\n\nexport type StructureStackRule = 'all-structures-stack' | 'same-structures-stack'\n\n// brainfuck ahead :(\nfunction stackAllStructureBonuses(groupedStructures: Structure[], maxItemBonus: number): Structure[] {\n    const allSkillBonusRules = groupedStructures.flatMap(s => s.skillBonusRules ?? []);\n    const activityBonusRules = allSkillBonusRules.filter(r => r.activity);\n    const skillOnlyBonusRules = allSkillBonusRules.filter(r => !r.activity);\n    // first calculate all skill modifiers\n    const skillOnlyBonuses: Map<Skill, number> = new Map();\n    skillOnlyBonusRules.forEach(rule => {\n        const existingValue = skillOnlyBonuses.get(rule.skill) ?? 0;\n        skillOnlyBonuses.set(rule.skill, Math.min(maxItemBonus, existingValue + rule.value));\n    });\n    // then calculate all modifiers only applicable for an activity\n    const activityBonuses: Map<Skill, Map<string, number>> = new Map();\n    activityBonusRules.forEach(rule => {\n        const skill = rule.skill;\n        activityBonuses.set(skill, activityBonuses.get(skill) ?? new Map());\n        const activity = rule.activity!;\n        const existingValue = activityBonuses.get(skill)?.get(activity) ?? 0;\n        const newValue = Math.min(maxItemBonus, existingValue + rule.value);\n        activityBonuses.get(skill)?.set(activity, newValue);\n    });\n    // then add skill modifiers to skill modifiers limited to an activity\n    Array.from(activityBonuses.keys()).forEach(skill => {\n        const map = activityBonuses.get(skill) ?? new Map();\n        Array.from(map.keys()).forEach(activity => {\n            const existingValue = map.get(activity) ?? 0;\n            const newValue = Math.min(maxItemBonus, existingValue + (skillOnlyBonuses.get(skill) ?? 0));\n            activityBonuses.get(skill)?.set(activity, newValue);\n        });\n    });\n    // finally, apply value overrides\n    return groupedStructures.map(s => {\n        return {\n            ...s,\n            skillBonusRules: s.skillBonusRules\n                ?.map(r => {\n                    const value = r.activity\n                        ? activityBonuses.get(r.skill)?.get(r.activity)\n                        : skillOnlyBonuses.get(r.skill);\n                    return {\n                        ...r,\n                        value: value ?? 0,\n                    };\n                }),\n        };\n    });\n}\n\n/**\n * Calculate all Bonuses of a settlement\n */\nexport function evaluateStructures(\n    structures: Structure[],\n    settlementLevel: number,\n    mode: StructureStackRule,\n    activities: KingdomActivityById,\n): StructureResult {\n    const settlementData = getSettlementConfig(settlementLevel);\n    const maxItemBonus = settlementData.maxItemBonus;\n    const allowCapitalInvestment = structures.some(structure => structure.enableCapitalInvestment === true);\n    const notes = Array.from(new Set(structures.flatMap(result => result.notes ?? [])));\n    const consumptionReduction = calculateConsumptionReduction(structures);\n    const result: StructureResult = {\n        config: settlementData,\n        allowCapitalInvestment,\n        notes,\n        skillBonuses: {\n            agriculture: {value: 0, activities: {}},\n            arts: {value: 0, activities: {}},\n            boating: {value: 0, activities: {}},\n            defense: {value: 0, activities: {}},\n            engineering: {value: 0, activities: {}},\n            exploration: {value: 0, activities: {}},\n            folklore: {value: 0, activities: {}},\n            industry: {value: 0, activities: {}},\n            intrigue: {value: 0, activities: {}},\n            magic: {value: 0, activities: {}},\n            politics: {value: 0, activities: {}},\n            scholarship: {value: 0, activities: {}},\n            statecraft: {value: 0, activities: {}},\n            trade: {value: 0, activities: {}},\n            warfare: {value: 0, activities: {}},\n            wilderness: {value: 0, activities: {}},\n        },\n        itemLevelBonuses: {\n            divine: 0,\n            alchemical: 0,\n            primal: 0,\n            occult: 0,\n            arcane: 0,\n            magical: 0,\n            other: 0,\n            luxuryOccult: 0,\n            luxuryArcane: 0,\n            luxuryDivine: 0,\n            luxuryMagical: 0,\n            luxuryPrimal: 0,\n        },\n        settlementEventBonus: 0,\n        leadershipActivityBonus: 0,\n        storage: {\n            ore: 0,\n            food: 0,\n            lumber: 0,\n            luxuries: 0,\n            stone: 0,\n        },\n        increaseLeadershipActivities: structures.some(structure => structure.increaseLeadershipActivities === true),\n        consumptionReduction,\n        consumption: Math.max(0, settlementData.consumption - consumptionReduction),\n        consumptionSurplus: Math.max(0, consumptionReduction - settlementData.consumption),\n        unlockActivities: [],\n        residentialLots: structures\n            .filter(structure => structure?.traits?.includes('residential'))\n            .map(s => s.lots ?? 1)\n            .reduce((a, b) => a + b, 0),\n        lots: structures.map(s => s.lots ?? 1).reduce((a, b) => a + b, 0),\n        hasBridge: structures.some(structure => structure.isBridge),\n    };\n    const unionizedStructures = unionizeStructures(structures, activities);\n    applyStorageIncreases(result.storage, structures);\n    const groupedStructures = groupStructures(unionizedStructures, maxItemBonus);\n    const allGroupedStructures = mode === 'all-structures-stack'\n        ? stackAllStructureBonuses(groupedStructures, maxItemBonus)\n        : groupedStructures;\n    applyUnlockedActivities(result.unlockActivities, allGroupedStructures);\n    applySettlementEventBonuses(result, allGroupedStructures);\n    applyLeadershipActivityBonuses(result, allGroupedStructures);\n    applySkillBonusRules(result.skillBonuses, allGroupedStructures);\n    applyItemLevelRules(result.itemLevelBonuses, allGroupedStructures);\n    return result;\n}\n\nexport function calculateAvailableItems(\n    itemLevelBonuses: ItemLevelBonuses,\n    settlementLevel: number,\n    additionalMagicItemLevel: number = 0,\n): ItemLevelBonuses {\n    return {\n        alchemical: itemLevelBonuses.alchemical + settlementLevel,\n        magical: itemLevelBonuses.magical + additionalMagicItemLevel + settlementLevel,\n        luxuryMagical: itemLevelBonuses.luxuryMagical + additionalMagicItemLevel + settlementLevel,\n        arcane: itemLevelBonuses.arcane + additionalMagicItemLevel + settlementLevel,\n        luxuryArcane: itemLevelBonuses.luxuryArcane + additionalMagicItemLevel + settlementLevel,\n        divine: itemLevelBonuses.divine + additionalMagicItemLevel + settlementLevel,\n        luxuryDivine: itemLevelBonuses.luxuryDivine + additionalMagicItemLevel + settlementLevel,\n        occult: itemLevelBonuses.occult + additionalMagicItemLevel + settlementLevel,\n        luxuryOccult: itemLevelBonuses.luxuryOccult + additionalMagicItemLevel + settlementLevel,\n        primal: itemLevelBonuses.primal + additionalMagicItemLevel + settlementLevel,\n        luxuryPrimal: itemLevelBonuses.luxuryPrimal + additionalMagicItemLevel + settlementLevel,\n        other: itemLevelBonuses.other + settlementLevel,\n    };\n}\n\nfunction groupByItemType(\n    itemLevelBonuses: ItemLevelBonuses,\n    superCategory: keyof ItemLevelBonuses,\n    categories: (keyof ItemLevelBonuses)[],\n): Partial<ItemLevelBonuses> {\n    const result: Partial<ItemLevelBonuses> = {};\n    const superCategoryBonus = itemLevelBonuses[superCategory];\n    categories.forEach(category => {\n        const itemLevelBonus = itemLevelBonuses[category];\n        if (itemLevelBonus !== superCategoryBonus) {\n            result[category] = itemLevelBonus;\n        }\n    });\n    return result;\n}\n\nexport function groupAvailableItems(itemLevelBonuses: ItemLevelBonuses): Partial<ItemLevelBonuses> {\n    return {\n        other: itemLevelBonuses.other,\n        ...groupByItemType(itemLevelBonuses, 'luxuryMagical',\n            ['luxuryArcane', 'luxuryDivine', 'luxuryOccult', 'luxuryPrimal']),\n        ...groupByItemType(itemLevelBonuses, 'magical',\n            ['arcane', 'divine', 'occult', 'primal', 'luxuryMagical']),\n        ...groupByItemType(itemLevelBonuses, 'other',\n            ['magical', 'alchemical']),\n    };\n}","export function calculateHexXP(\n    {\n        hexes,\n        kingdomSize,\n        useVK,\n        xpPerClaimedHex,\n    }: {\n        hexes: number,\n        xpPerClaimedHex: number,\n        kingdomSize: number,\n        useVK: boolean\n    },\n): number {\n    if (useVK) {\n        if (kingdomSize < 10) {\n            return hexes * 100;\n        } else if (kingdomSize < 25) {\n            return hexes * 50;\n        } else if (kingdomSize < 50) {\n            return hexes * 25;\n        } else if (kingdomSize < 100) {\n            return hexes * 10;\n        } else {\n            return hexes * 5;\n        }\n    } else {\n        return hexes * xpPerClaimedHex;\n    }\n}\n\nexport function calculateRpXP(\n    {\n        rp,\n        kingdomLevel,\n        rpToXpConversionRate,\n        rpToXpConversionLimit,\n        useVK,\n    }: {\n        rp: number,\n        kingdomLevel: number,\n        rpToXpConversionRate: number,\n        rpToXpConversionLimit: number,\n        useVK: boolean\n    },\n): number {\n    let xp = 0;\n    if (useVK) {\n        if (kingdomLevel < 5) {\n            xp = rp * 10;\n        } else if (kingdomLevel < 9) {\n            xp = rp * 7;\n        } else if (kingdomLevel < 13) {\n            xp = rp * 5;\n        } else if (kingdomLevel < 17) {\n            xp = rp * 2;\n        }\n    } else {\n        xp = rp * rpToXpConversionRate;\n    }\n    return Math.min(rpToXpConversionLimit, xp);\n}\n\nexport function calculateEventXP(modifier: number): number {\n    const xp: Record<string, number> = {\n        '-4': 10,\n        '-3': 15,\n        '-2': 20,\n        '-1': 30,\n        '0': 40,\n        '1': 60,\n        '2': 80,\n        '3': 120,\n        '4': 160,\n    };\n    const key = `${modifier}`;\n    if (key in xp) {\n        return xp[key];\n    } else {\n        return 0;\n    }\n}\n","import {parseNumberInput} from './utils';\n\nasync function resetPoints(game: Game, actors: Actor[]): Promise<void> {\n    for (const actor of actors) {\n        await actor.update({\n            'system.resources.heroPoints.value': 1,\n        });\n    }\n    await ChatMessage.create({\n        user: game?.user?.id,\n        speaker: ChatMessage.getSpeaker(),\n        content: 'Reset hero point values to 1',\n        type: CONST.CHAT_MESSAGE_TYPES.OTHER,\n    });\n}\n\nasync function awardPoints(game: Game, points: { actor: Actor, points: number }[]): Promise<void> {\n    for (const point of points) {\n        const actor = point.actor;\n        await actor.update({\n            'system.resources.heroPoints.value': actor.system.resources.heroPoints.value + point.points,\n        });\n    }\n    const content = `<p>Awarded Hero Points:</p><ul>${points.map(p => {\n        return `<li><b>${p.actor.name}</b>: ${p.points}</li>`;\n    }).join('\\n')}</ul>`;\n    await ChatMessage.create({\n        user: game?.user?.id,\n        speaker: ChatMessage.getSpeaker(),\n        content,\n        type: CONST.CHAT_MESSAGE_TYPES.OTHER,\n    });\n}\n\nexport async function awardHeroPoints(game: Game): Promise<void> {\n    const actors = game.actors?.contents\n        ?.filter(e => e.type === 'character' && e.hasPlayerOwner) ?? [];\n    new Dialog({\n        title: 'Award Hero Points',\n        content: `<form class=\"simple-dialog-form\">\n                <div>\n                    <label for=\"km-award-all\">All</label>\n                    <input type=\"number\" value=\"0\" name=\"award-all\" id=\"km-award-all\">\n                </div>\n            ${actors.map(a => `<div>\n                    <label for=\"km-award-hero-point-${a.uuid}\">${a.name}</label>\n                    <input type=\"number\" value=\"0\" name=\"${a.uuid}\" id=\"km-award-hero-point-${a.uuid}\">\n                </div>`,\n        ).join('\\n')}\n        </form>`,\n        buttons: {\n            confirm: {\n                icon: '<i class=\"fas fa-check\"></i>',\n                label: 'Award',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const all = parseNumberInput($html, 'award-all');\n                    const points = actors\n                        .map(actor => {\n                            return {\n                                actor,\n                                points: parseNumberInput($html, actor.uuid) + all,\n                            };\n                        })\n                        .filter(point => point.points > 0);\n                    if (points.length > 0) {\n                        await awardPoints(game, points);\n                    }\n                },\n            },\n        },\n        default: 'confirm',\n    }).render(true, {jQuery: false, width: 300});\n}\n\nexport async function resetHeroPoints(game: Game): Promise<void> {\n    const actors = game.actors?.contents\n        ?.filter(e => e.type === 'character' && e.hasPlayerOwner) ?? [];\n    new Dialog({\n        title: 'Reset Hero Points to 1?',\n        content: '',\n        buttons: {\n            cancel: {\n                icon: '<i class=\"fas fa-times\"></i>',\n                label: 'Cancel',\n            },\n            confirm: {\n                icon: '<i class=\"fas fa-check\"></i>',\n                label: 'Confirm',\n                callback: async (): Promise<void> => {\n                    await resetPoints(game, actors);\n                },\n            },\n        },\n        default: 'confirm',\n    }).render(true, {jQuery: false});\n}\n\n\nasync function awardXP(game: Game, actors: Actor[], amount: number): Promise<void> {\n    for (const actor of actors) {\n        const currentXP = actor.system.details.xp.value;\n        const xpThreshold = actor.system.details.xp.max;\n        const currentLevel = actor.system.details.level.value;\n        const addLevels = Math.floor((currentXP + amount) / xpThreshold);\n        const xpGain = (currentXP + amount) % xpThreshold;\n        await actor.update({\n            'system.details.xp.value': xpGain,\n            'system.details.level.value': currentLevel + addLevels,\n        });\n    }\n    await ChatMessage.create({\n        user: game?.user?.id,\n        speaker: ChatMessage.getSpeaker(),\n        content: `Players gained ${amount} XP!`,\n        type: CONST.CHAT_MESSAGE_TYPES.OTHER,\n    });\n}\n\nasync function awardXPDialog(game: Game, actors: Actor[]): Promise<void> {\n    new Dialog({\n        title: 'Award Party XP',\n        content: `\n     <form>\n      <div class=\"form-group\">\n       <label>Amount</label>\n       <input type=\"number\" name=\"amount\">\n      </div>\n     </form>\n     `,\n        buttons: {\n            cancel: {\n                icon: '<i class=\"fas fa-times\"></i>',\n                label: 'Cancel',\n            },\n            confirm: {\n                icon: '<i class=\"fas fa-check\"></i>',\n                label: 'Confirm',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const amount = parseNumberInput($html, 'amount') || 0;\n                    await awardXP(game, actors, amount);\n                },\n            },\n        },\n        default: 'confirm',\n    }).render(true, {jQuery: false});\n}\n\nexport async function showAwardXPDialog(game: Game): Promise<void> {\n    const actors = game?.actors?.contents\n        ?.filter(e => e.type === 'character' && e.hasPlayerOwner) ?? [];\n    await awardXPDialog(game, actors);\n}\n\n","import {getKingdom, saveKingdom} from './kingdom/storage';\nimport {getNumberSetting, setSetting} from './settings';\nimport {getCamping, saveCamping} from './camping/storage';\nimport {isFirstGm} from './utils';\nimport {Migration} from './migrations/migration';\nimport {Migration2} from './migrations/migration2';\nimport {Migration3} from './migrations/migration3';\nimport {Migration4} from './migrations/migration4';\nimport {Migration5} from './migrations/migration5';\nimport {Migration6} from './migrations/migration6';\nimport {Migration7} from './migrations/migration7';\nimport {Migration8} from './migrations/migration8';\n\n\nconst migrations: Migration[] = [\n    new Migration2(),\n    new Migration3(),\n    new Migration4(),\n    new Migration5(),\n    new Migration6(),\n    new Migration7(),\n    new Migration8(),\n];\n\ninterface BackupParams {\n    game: Game;\n    kingdomActor: Actor | undefined | null;\n    campingActor: Actor | null | undefined;\n    currentVersion: number;\n}\n\nasync function createBackups(params: BackupParams): Promise<void> {\n    const backup = {\n        version: params.currentVersion,\n        camping: params.campingActor ? getCamping(params.campingActor) : null,\n        kingdom: params.kingdomActor ? getKingdom(params.kingdomActor) : null,\n    };\n    await setSetting(params.game, 'latestMigrationBackup', JSON.stringify(backup));\n}\n\nexport async function migrate(game: Game, kingdomActor: Actor | undefined | null, campingActor: Actor | null | undefined): Promise<void> {\n    const currentVersion = getNumberSetting(game, 'schemaVersion');\n    const latestMigration = Math.max(1, ...migrations.map(m => m.version));\n    if (isFirstGm(game) && currentVersion < latestMigration) {\n        ui.notifications?.info('Running Kingmaker Tools Migrations, please do not close the window');\n        await createBackups({game, kingdomActor, campingActor, currentVersion});\n\n        const migrationsToRun = migrations.filter(m => m.version > currentVersion);\n\n        if (kingdomActor) {\n            const kingdom = getKingdom(kingdomActor);\n            for (const migration of migrationsToRun) {\n                await migration.migrateKingdom(game, kingdom);\n            }\n            await saveKingdom(kingdomActor, kingdom);\n        }\n\n        if (campingActor) {\n            const camping = getCamping(campingActor);\n            for (const migration of migrationsToRun) {\n                await migration.migrateCamping(game, camping);\n            }\n            await saveCamping(game, campingActor, camping);\n        }\n\n        for (const migration of migrationsToRun) {\n            await migration.migrateOther(game);\n        }\n\n        await setSetting(game, 'schemaVersion', latestMigration);\n        ui.notifications?.info('Successfully migrated Kingmaker tools');\n    }\n}","import {Kingdom} from '../kingdom/data/kingdom';\nimport {Camping} from '../camping/camping';\n\nexport abstract class Migration {\n    protected constructor(public readonly version: number) {\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async migrateCamping(game: Game, camping: Camping): Promise<void> {\n\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async migrateOther(game: Game): Promise<void> {\n\n    }\n}","import {FameType, getCultEventMilestones, Kingdom} from '../kingdom/data/kingdom';\nimport {Camping} from '../camping/camping';\nimport {Migration} from './migration';\n\nexport class Migration2 extends Migration {\n    constructor() {\n        super(2);\n    }\n\n    override async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n        if (typeof kingdom.fame === 'number' && 'fameNext' in kingdom && 'fameType' in kingdom) {\n            const current = kingdom as Kingdom & { fame: number, fameNext: number, fameType: FameType };\n            kingdom.fame = {\n                now: current.fame,\n                next: current?.fameNext ?? 0,\n                type: current?.fameType ?? 'famous',\n            };\n        }\n        if (!kingdom.milestones.some(milestone => milestone.name.startsWith('Cult Event'))) {\n            getCultEventMilestones().forEach(milestone => kingdom.milestones.push(milestone));\n        }\n        if (kingdom.supernaturalSolutions === undefined) {\n            kingdom.supernaturalSolutions = 0;\n        }\n        if (kingdom.turnsWithoutCultEvent === undefined) {\n            kingdom.turnsWithoutCultEvent = 0;\n        }\n        if (kingdom.creativeSolutions === undefined) {\n            kingdom.creativeSolutions = 0;\n        }\n        if (kingdom.modifiers === undefined) {\n            kingdom.modifiers = [];\n        }\n        if (kingdom.settlements === undefined) {\n            kingdom.settlements = [];\n            kingdom.activeSettlement = '';\n        }\n        kingdom.settlements.forEach(settlement => {\n            settlement.level = parseInt(`${settlement.level}`, 10);\n            settlement.lots = parseInt(`${settlement.lots}`, 10);\n            settlement.waterBorders = parseInt(`${settlement.waterBorders}`, 10);\n        });\n    }\n\n    override async migrateCamping(game: Game, camping: Camping): Promise<void> {\n        if (camping.increaseWatchActorNumber === undefined) {\n            camping.increaseWatchActorNumber = 0;\n        }\n        if (camping.actorUuidsNotKeepingWatch === undefined) {\n            camping.actorUuidsNotKeepingWatch = [];\n        }\n        if (camping.ignoreSkillRequirements === undefined) {\n            camping.ignoreSkillRequirements = false;\n        }\n    }\n}","import {Migration} from './migration';\nimport {setSetting} from '../settings';\n\nexport class Migration3 extends Migration {\n    constructor() {\n        super(3);\n    }\n\n    override async migrateOther(game: Game): Promise<void> {\n        await setSetting(game, 'kingdomEventsTable', 'Random Kingdom Events');\n    }\n}","import {Migration} from './migration';\nimport {Kingdom} from '../kingdom/data/kingdom';\n\nexport class Migration4 extends Migration {\n    constructor() {\n        super(4);\n    }\n\n    override async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n        kingdom.activityBlacklist.push('take-charge');\n        kingdom.activityBlacklist.push('reconnoiter-hex');\n    }\n}","import {Camping} from '../camping/camping';\nimport {Migration} from './migration';\nimport {ActivityEffect} from '../camping/activities';\n\nexport class Migration5 extends Migration {\n    constructor() {\n        super(5);\n    }\n\n    override async migrateCamping(game: Game, camping: Camping): Promise<void> {\n        camping.homebrewCampingActivities.forEach(activity => {\n            if (activity.criticalSuccess && activity.criticalSuccess.effectUuids) {\n                this.migrateActivity(activity.criticalSuccess.effectUuids);\n            }\n            if (activity.success && activity.success.effectUuids) {\n                this.migrateActivity(activity.success.effectUuids);\n            }\n            if (activity.failure && activity.failure.effectUuids) {\n                this.migrateActivity(activity.failure.effectUuids);\n            }\n            if (activity.criticalFailure && activity.criticalFailure.effectUuids) {\n                this.migrateActivity(activity.criticalFailure.effectUuids);\n            }\n            if (activity.effectUuids) {\n                this.migrateActivity(activity.effectUuids);\n            }\n        });\n    }\n\n    private migrateActivity(effectUuids: ActivityEffect[]): void {\n        effectUuids.forEach(activity => {\n            if ('targetAll' in activity) {\n                if (activity.targetAll === false) {\n                    activity.target = 'self';\n                } else {\n                    activity.target = 'all';\n                }\n                delete activity.targetAll;\n            }\n        });\n    }\n}","import {Kingdom} from '../kingdom/data/kingdom';\nimport {Migration} from './migration';\nimport {isNullable} from '../utils';\n\nexport class Migration6 extends Migration {\n    constructor() {\n        super(6);\n    }\n\n    override async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n        if (isNullable(kingdom.homebrewActivities)) {\n            kingdom.homebrewActivities = [];\n        }\n    }\n}","import {Kingdom} from '../kingdom/data/kingdom';\nimport {Migration} from './migration';\nimport {isNullable} from '../utils';\n\nexport class Migration7 extends Migration {\n    constructor() {\n        super(7);\n    }\n\n    override async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n        if (isNullable(kingdom.notes)) {\n            kingdom.notes = {\n                public: '',\n                gm: '',\n            };\n        }\n    }\n}","import {Kingdom} from '../kingdom/data/kingdom';\nimport {Migration} from './migration';\nimport {isNullable} from '../utils';\n\nexport class Migration8 extends Migration {\n    constructor() {\n        super(8);\n    }\n\n    override async migrateKingdom(game: Game, kingdom: Kingdom): Promise<void> {\n        if (isNullable(kingdom.realmSceneId)) {\n            kingdom.realmSceneId = null;\n        }\n    }\n}","export interface RollTableResult {\n    table: RollTable;\n    draw: RollTableDraw;\n}\n\nexport async function findRollTableUuidWithFallback(\n    game: Game,\n    tableName: string,\n    compendiumName = 'pf2e-kingmaker-tools.kingmaker-tools-rolltables',\n): Promise<string | undefined> {\n    const worldUuid = findWorldTableUuid(game, tableName);\n    const compendiumUuid = await findCompendiumTableUuid(game, tableName, compendiumName);\n    // first look through world tables, then fall back to compendium tables\n    console.log(`Looking up ${tableName} in ${compendiumName}, world: ${worldUuid}, compendium: ${compendiumUuid}`);\n    return worldUuid ?? compendiumUuid;\n}\n\nexport function getWorldTables(game: Game): RollTable[] {\n    return game?.tables?.map(t => t) ?? [];\n}\n\nexport function getWorldTableUuidMappings(game: Game): Record<string, string> {\n    const tables = getWorldTables(game);\n    return Object.fromEntries(tables.map((t: RollTable) => [`RollTable.${t.id!}`, t.name!]));\n}\n\nexport function findWorldTableUuid(game: Game, tableName: string): string | undefined {\n    return Object.entries(getWorldTableUuidMappings(game))\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        .filter(([_, value]) => value === tableName)\n        .map(([key]) => key)[0];\n}\n\nexport async function findCompendiumTableUuid(\n    game: Game,\n    tableName: string,\n    compendiumName = 'pf2e-kingmaker-tools.kingmaker-tools-rolltables',\n): Promise<string | undefined> {\n    const compendiumUuids = await buildUuids(game, compendiumName);\n    return compendiumUuids[tableName];\n}\n\nexport async function rollRollTable(\n    game: Game,\n    tableUuid: string,\n    rollOptions: Partial<RollTable.DrawOptions>,\n): Promise<RollTableResult> {\n    const table = await fromUuid(tableUuid);\n    if (table && table instanceof RollTable) {\n        return {\n            table,\n            draw: await table.draw(rollOptions),\n        };\n    } else {\n        throw new Error(`Could not find table with uuid ${tableUuid}`);\n    }\n}\n\nexport async function buildUuids(\n    game: Game,\n    compendiumName = 'pf2e-kingmaker-tools.kingmaker-tools-rolltables',\n): Promise<Record<string, string>> {\n    const compendium = await game.packs.get(compendiumName, {strict: true});\n    const documents = await compendium.getDocuments({});\n    return Object.fromEntries(documents.map(document => [document.name, `Compendium.${compendiumName}.${document.id}`]));\n}\n","export type RollMode = keyof CONFIG.Dice.RollModes\n\nconst namespace = 'pf2e-kingmaker-tools';\n\nexport function getRollMode(game: Game, settingsKey: string): RollMode {\n    const rollMode = getStringSetting(game, settingsKey) as RollMode;\n    return rollMode ?? 'publicroll';\n\n}\n\nexport function getNumberSetting(game: Game, settingsKey: string): number {\n    return game.settings.get(namespace, settingsKey) as number | undefined ?? 0;\n\n}\n\nexport function getStringSetting(game: Game, settingsKey: string): string {\n    return game.settings.get(namespace, settingsKey) as string | undefined ?? '';\n}\n\nexport function getStringArraySetting(game: Game, settingsKey: string): string[] {\n    return game.settings.get(namespace, settingsKey) as string[] | undefined ?? [];\n}\n\nexport function getBooleanSetting(game: Game, settingsKey: string): boolean {\n    return game.settings.get(namespace, settingsKey) as boolean | undefined ?? false;\n}\n\nexport async function setSetting<T>(game: Game, settingsKey: string, value: T): Promise<void> {\n    await game.settings.set(namespace, settingsKey, value);\n}\n","async function rollSkillCheck(\n    actors: Actor[],\n    skill: string,\n    dc: number | undefined = undefined,\n): Promise<void> {\n    const checkDc = dc === undefined ? undefined : {value: dc};\n    for (const actor of actors) {\n        const check = skill === 'perception' ? actor.perception : actor.skills[skill];\n        await check.roll({\n            rollMode: 'gmroll',\n            dc: checkDc,\n        });\n    }\n}\n\nfunction getActiveExplorationEffects(actor: Actor): Set<string> {\n    const explorationActionItemIds = actor.system.exploration ?? [];\n    const names = explorationActionItemIds\n        .map(id => actor.items.get(id)?.name)\n        .filter(name => name !== undefined && name !== null) as string[];\n    return new Set(names);\n}\n\nexport async function rollExplorationSkillCheck(\n    game: Game,\n    skill: string,\n    effect: string,\n    dc: number | undefined = undefined,\n): Promise<void> {\n    const actors = game.actors\n        ?.filter(a =>\n            (a.type === 'character' || a.type === 'familiar')\n            && a.hasPlayerOwner\n            && getActiveExplorationEffects(a).has(effect)) ?? [];\n    if (effect === 'Search' && skill === 'perception') {\n        game.pf2e.actions.get('seek')?.use({actors});\n    } else if (effect === 'Avoid Notice' && skill === 'stealth') {\n        game.pf2e.actions.get('avoid-notice')?.use({actors});\n    } else {\n        await rollSkillCheck(actors, skill, dc);\n    }\n}\n\nfunction tpl(): string {\n    return `\n    <div style=\"display: table; border-spacing: 10px\">\n        <div style=\"display: table-row\">\n            <label style=\"display: table-cell\">Skill</label> \n            <select name=\"skill\" style=\"display: table-cell\">\n                <option value=\"perception\">Perception</option>\n                <option value=\"nature\">Nature</option>\n                <option value=\"survival\">Survival</option>\n            </select>\n        </div>\n        <div style=\"display: table-row\">\n            <label style=\"display: table-cell\">DC</label>\n            <input name=\"dc\" type=\"number\" value=\"0\" style=\"display: table-cell\">\n        </div>\n    </div>\n    `;\n}\n\nexport async function rollSkillDialog(actors: Actor[]): Promise<void> {\n    new Dialog({\n        title: 'Roll Skill for PCs',\n        content: tpl(),\n        buttons: {\n            roll: {\n                icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n                label: 'Roll',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const skillInput = $html.querySelector('select[name=skill]') as HTMLSelectElement;\n                    const dcInput = $html.querySelector('input[name=dc]') as HTMLInputElement;\n                    const skill = skillInput.value;\n                    const dc = parseInt(dcInput.value, 10);\n                    await rollSkillCheck(actors, skill, dc);\n                },\n            },\n        },\n        default: 'roll',\n    }, {\n        jQuery: false,\n    }).render(true, {width: 200});\n}\n","import {getWorldTime, TimeChangeMode, TimeOfDay} from './calculation';\nimport {DateTime, HourNumbers, MinuteNumbers, SecondNumbers} from 'luxon';\n\nfunction tpl(previousTime: string): string {\n    return `<form>\n        <input type=\"time\" value=\"${previousTime}\">\n    </form>`;\n}\n\n\nasync function toTimeOfDay(game: Game, body: HTMLElement, mode: TimeChangeMode): Promise<void> {\n    const timeInput = body.querySelector('input[type=time]') as HTMLInputElement;\n    const timeValue = DateTime.fromFormat(timeInput.value, 'HH:mm');\n    const currentTime = getWorldTime(game);\n    const diff = new TimeOfDay({\n        hour: timeValue.hour as HourNumbers,\n        minute: timeValue.minute as MinuteNumbers,\n        second: timeValue.second as SecondNumbers,\n    });\n    const seconds = diff.diffSeconds(currentTime, mode);\n    await game.time.advance(seconds);\n    localStorage.setItem('kingmaker-tools.time-input', timeInput.value);\n}\n\nexport async function toTimeOfDayMacro(game: Game): Promise<void> {\n    const previousTime = localStorage.getItem('kingmaker-tools.time-input') ?? '00:00';\n    new Dialog({\n        title: 'Advance/Retract to Time of Day',\n        content: tpl(previousTime),\n        buttons: {\n            retract: {\n                icon: '<i class=\"fa-solid fa-backward\"></i>',\n                label: 'Retract',\n                callback: async (html): Promise<void> => {\n                    await toTimeOfDay(game, html as HTMLElement, TimeChangeMode.RETRACT);\n                },\n            },\n            advance: {\n                icon: '<i class=\"fa-solid fa-forward\"></i>',\n                label: 'Advance',\n                callback: async (html): Promise<void> => {\n                    await toTimeOfDay(game, html as HTMLElement, TimeChangeMode.ADVANCE);\n                },\n            },\n        },\n        default: 'yes',\n    }, {\n        jQuery: false,\n    }).render(true);\n}\n\nexport function formatHours(seconds: number, isNegative = false): string {\n    const padZero = (num: number): string => `${num}`.padStart(2, '0');\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    return `${isNegative ? '-' : ''}${padZero(hours)}:${padZero(minutes)}`;\n}\n","import {DateTime, DayNumbers, DurationLikeObject, HourNumbers, MinuteNumbers, MonthNumbers, SecondNumbers} from 'luxon';\n\n\nexport enum TimeChangeMode {\n    ADVANCE,\n    RETRACT,\n}\n\nexport function getWorldTime(game: Game): DateTime {\n    const value = game.settings.get('pf2e', 'worldClock.worldCreatedOn') as string;\n    return DateTime.fromISO(value)\n        .toUTC()\n        .plus({seconds: game.time.worldTime});\n}\n\nexport interface TimeDiff {\n    /**\n     * Returns positive or negative number of seconds to add to current\n     * game time advance function https://foundryvtt.com/api/GameTime.html#advance\n     * @param worldTime the current time as luxon DateTime\n     * @param mode whether to go back to that point in time or to advance\n     */\n    diffSeconds(worldTime: DateTime, mode: TimeChangeMode): number;\n}\n\n/**\n * Use this to represent a time unit that you want to advance or retract, e.g. 1 day or 10 minutes\n */\nexport class TimeUnit implements TimeDiff {\n    constructor(public readonly unit: DurationLikeObject) {\n    }\n\n    diffSeconds(worldTime: DateTime, mode: TimeChangeMode): number {\n        const targetTime = mode == TimeChangeMode.ADVANCE ? worldTime.plus(this.unit) : worldTime.minus(this.unit);\n        return targetTime.diff(worldTime, 'seconds').seconds;\n    }\n}\n\n/**\n * Use this to represent a date. Golarion calendar not included since\n * that is only used for rendering\n */\nexport class TimeOfYear implements TimeDiff {\n    public readonly year: number;\n    public readonly month: MonthNumbers;\n    public readonly day: DayNumbers;\n    public readonly hour: HourNumbers;\n    public readonly minute: MinuteNumbers;\n    public readonly second: SecondNumbers;\n\n    constructor(\n        {\n            year,\n            month,\n            day,\n            hour = 0,\n            minute = 0,\n            second = 0,\n        }: {\n            year: number,\n            month: MonthNumbers,\n            day: DayNumbers,\n            hour: HourNumbers,\n            minute: MinuteNumbers,\n            second: SecondNumbers,\n        },\n    ) {\n        this.year = year;\n        this.month = month;\n        this.day = day;\n        this.hour = hour;\n        this.minute = minute;\n        this.second = second;\n    }\n\n    public diffSeconds(worldTime: DateTime): number {\n        const targetTime = DateTime.fromObject({\n            year: this.year,\n            month: this.month,\n            day: this.day,\n            hour: this.hour,\n            minute: this.minute,\n            second: this.second,\n        });\n\n        return targetTime.diff(worldTime, 'seconds').seconds;\n    }\n}\n\n/**\n * Use this if you want to advance or retract to a time of day, e.g. advance to 16:00.\n * Automatically figures out if you need to advance or retract a day\n */\nexport class TimeOfDay implements TimeDiff {\n    public readonly hour: HourNumbers;\n    public readonly minute: MinuteNumbers;\n    public readonly second: SecondNumbers;\n\n    constructor(\n        {\n            hour = 0,\n            minute = 0,\n            second = 0,\n        }: {\n            hour: HourNumbers,\n            minute: MinuteNumbers,\n            second: SecondNumbers,\n        },\n    ) {\n        this.hour = hour;\n        this.minute = minute;\n        this.second = second;\n    }\n\n    /** Point in morning twilight where dim light begins */\n    static DAWN = new TimeOfDay({hour: 4, minute: 58, second: 54});\n\n    static NOON = new TimeOfDay({hour: 12, minute: 0, second: 0});\n\n    /** Point in evening twilight where dim light begins */\n    static DUSK = new TimeOfDay({hour: 18, minute: 34, second: 6});\n\n    static MIDNIGHT = new TimeOfDay({hour: 0, minute: 0, second: 0});\n\n    public diffSeconds(worldTime: DateTime, mode: TimeChangeMode): number {\n        const targetTime = worldTime.set({\n            hour: this.hour,\n            minute: this.minute,\n            second: this.second,\n        });\n        const targetDayDifference = TimeOfDay.diffDays(worldTime, targetTime, mode);\n        const targetDay = worldTime.plus({day: targetDayDifference});\n\n        return targetDay.set(this).diff(worldTime, 'seconds').seconds;\n    }\n\n    private static diffDays(currentTime: DateTime, targetTime: DateTime, mode: TimeChangeMode): -1 | 0 | 1 {\n        // if we have the same point in time, we always want to either skip or rewind a full day\n        if (currentTime >= targetTime && mode === TimeChangeMode.ADVANCE) {\n            // case: now: 12:01 and advance to 12:00 -> we need to add 1 day to calculate the difference\n            return 1;\n        } else if (currentTime <= targetTime && mode === TimeChangeMode.RETRACT) {\n            // case: now: 12:00 and retract to 12:01 -> we need to subtract 1 day to calculate the difference\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n}\n\nexport function getTimeOfDayPercent(time: DateTime): number {\n    const elapsedSeconds = time.second + time.minute * 30 + time.hour * 3600;\n    return Math.floor(elapsedSeconds/(36*24));\n}\n\nexport function isDayOrNight(time: DateTime): 'day' | 'night' {\n    if (time.hour >= 6 && time.hour <18) {\n        return 'day';\n    } else {\n        return 'night';\n    }\n}\n","import {DateTime} from 'luxon';\n\nconst timeFormats = {\n    AR: {\n        yearOffset: 2700,\n        Era: 'AR',\n        Months: {\n            'January': 'Abadius',\n            'February': 'Calistril',\n            'March': 'Pharast',\n            'April': 'Gozran',\n            'May': 'Desnus',\n            'June': 'Sarenith',\n            'July': 'Erastus',\n            'August': 'Arodus',\n            'September': 'Rova',\n            'October': 'Lamashan',\n            'November': 'Neth',\n            'December': 'Kuthona',\n        },\n        'Weekdays': {\n            'Monday': 'Moonday',\n            'Tuesday': 'Toilday',\n            'Wednesday': 'Wealday',\n            'Thursday': 'Oathday',\n            'Friday': 'Fireday',\n            'Saturday': 'Starday',\n            'Sunday': 'Sunday',\n        },\n    },\n};\n\nconst pr = new Intl.PluralRules('en-US', {\n    type: 'ordinal',\n});\nconst suffixes = new Map([\n    ['one', 'st'],\n    ['two', 'nd'],\n    ['few', 'rd'],\n    ['other', 'th'],\n]);\n\nfunction formatOrdinals(n: number): string {\n    const rule = pr.select(n);\n    const suffix = suffixes.get(rule);\n    return `${n}${suffix}`;\n}\n\nexport function calculateYear(dateTime: DateTime, mode: 'AR'): number {\n    return dateTime.year + timeFormats[mode].yearOffset;\n}\n\nexport function formatWorldDateTime(worldTime: DateTime, mode: 'AR'): string {\n    const format = timeFormats[mode];\n    // convert to map to get TS to like indexing config\n    const weekday = new Map(Object.entries(format.Weekdays)).get(worldTime.weekdayLong!);\n    const month = new Map(Object.entries(format.Months)).get(worldTime.monthLong!);\n    const year = calculateYear(worldTime, mode);\n    const time = worldTime.toFormat('hh:mm:ss');\n    const era = format.Era;\n    const day = formatOrdinals(worldTime.day);\n    return `${weekday}, ${day} of ${month}, ${year} ${era} (${time})`;\n}\n\nexport function formatWorldTime(worldTime: DateTime): string {\n    return worldTime.toLocaleString({...DateTime.TIME_24_SIMPLE});\n}\n","import {DegreeOfSuccess} from './degree-of-success';\n\nexport function addOf(name: string): string {\n    if (name.endsWith('s')) {\n        return name + '\\'';\n    } else {\n        return name + '\\'s';\n    }\n}\n\nexport function escapeHtml(html: string): string {\n    const text = document.createTextNode(html);\n    const p = document.createElement('p');\n    p.appendChild(text);\n    return p.innerHTML;\n}\n\nexport function isFirstGm(game: Game): boolean {\n    return game?.user?.id === game.users?.find((u) => u.isGM && u.active)?.id;\n}\n\nexport function getLevelBasedDC(level: number): number {\n    return 14 + level + Math.floor(level / 3);\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport function getSelectedCharacter(game: Game): any {\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    return game.user?.character as unknown as any;\n}\n\nexport function createUUIDLink(uuid: string, label?: string): string {\n    if (label === undefined) {\n        return `@UUID[${uuid}]`;\n    } else {\n        return `@UUID[${uuid}]{${label}}`;\n    }\n}\n\nexport async function roll(expression: string, flavor?: string): Promise<number> {\n    const roll = await (new Roll(expression).evaluate());\n    await roll.toMessage({flavor});\n    return roll.total;\n}\n\nexport interface DegreeOfSuccessMessageConfig {\n    critSuccess?: string;\n    success?: string;\n    failure?: string;\n    critFailure?: string;\n    isPrivate?: boolean;\n}\n\nfunction getDegreePart(degreeOfSuccess: DegreeOfSuccess, strikeThrough = false): string {\n    if (degreeOfSuccess === DegreeOfSuccess.CRITICAL_SUCCESS) {\n        return `<span class=\"${strikeThrough ? 'strike-through' : ''}\">Critical Success</span>`;\n    } else if (degreeOfSuccess === DegreeOfSuccess.SUCCESS) {\n        return `<span class=\"${strikeThrough ? 'strike-through' : ''}\">Success</span>`;\n    } else if (degreeOfSuccess === DegreeOfSuccess.FAILURE) {\n        return `<span class=\"${strikeThrough ? 'strike-through' : ''}\">Failure</span>`;\n    } else {\n        return `<span class=\"${strikeThrough ? 'strike-through' : ''}\">Critical Failure</span>`;\n    }\n}\n\nfunction getDegreeHeader(\n    degreeOfSuccess: DegreeOfSuccess,\n    upgradedDegreeOfSuccess?: DegreeOfSuccess,\n): string {\n    if (upgradedDegreeOfSuccess === undefined) {\n        return `<b>${getDegreePart(degreeOfSuccess)}</b>`;\n    } else {\n        return `<b>${getDegreePart(degreeOfSuccess, true)} ${getDegreePart(upgradedDegreeOfSuccess)}</b>`;\n    }\n}\n\ninterface DegreeOfSuccessConfig {\n    degreeOfSuccess: DegreeOfSuccess,\n    upgradedDegreeOfSuccess?: DegreeOfSuccess,\n    messageConfig: DegreeOfSuccessMessageConfig,\n    beforeHeader?: string;\n}\n\nexport async function postDegreeOfSuccessMessage(\n    {\n        degreeOfSuccess,\n        upgradedDegreeOfSuccess,\n        messageConfig,\n        beforeHeader,\n    }: DegreeOfSuccessConfig,\n): Promise<void> {\n    const header = getDegreeHeader(degreeOfSuccess, upgradedDegreeOfSuccess);\n    const degree = upgradedDegreeOfSuccess ?? degreeOfSuccess;\n    let description = '';\n    if (degree === DegreeOfSuccess.CRITICAL_SUCCESS && messageConfig.critSuccess !== undefined) {\n        description = `${messageConfig.critSuccess}`;\n    } else if (degree === DegreeOfSuccess.SUCCESS && messageConfig.success !== undefined) {\n        description = `${messageConfig.success}`;\n    } else if (degree === DegreeOfSuccess.FAILURE && messageConfig.failure !== undefined) {\n        description = `${messageConfig.failure}`;\n    } else if (degree === DegreeOfSuccess.CRITICAL_FAILURE && messageConfig.critFailure !== undefined) {\n        description = `${messageConfig.critFailure}`;\n    }\n    const message = (beforeHeader ?? '') + [header, description]\n        .filter(m => isNotBlank(m))\n        .join(': ');\n    if (isNotBlank(message)) {\n        await ChatMessage.create({\n            type: CONST.CHAT_MESSAGE_TYPES.ROLL,\n            content: message.trimEnd(),\n            rollMode: messageConfig.isPrivate ? 'blindroll' : 'publicroll',\n        });\n    }\n}\n\nexport function capitalize(word: string): string {\n    return word[0].toUpperCase() + word.substring(1);\n}\n\nexport function uncapitalize(word: string): string {\n    return word[0].toLowerCase() + word.substring(1);\n}\n\nexport function unpackFormArray<T>(obj: Record<string, T> | undefined | null): T[] {\n    if (obj) {\n        return Object.keys(obj)\n            .map(index => parseInt(index, 10))\n            .sort((a, b) => a - b)\n            .map(index => `${index}`)\n            .map(index => obj[index]);\n    } else {\n        return [];\n    }\n}\n\nexport function isSlug(word: string): boolean {\n    return /^([a-zA-Z0-9]+)(-[a-zA-Z0-9]+)*$/.test(word);\n}\n\nexport function slugify(word: string): string {\n    return word\n        .trim()\n        .replaceAll(' ', '-')\n        .toLowerCase();\n}\n\nexport function loreToLoreSkill(value: string): string {\n    return slugify(value.replace(/\\s[lL]ore$/, ''));\n}\n\nexport function unslugify(word: string): string {\n    return word\n        .replaceAll('action:', '')\n        .split('-')\n        .map(part => capitalize(part))\n        .join(' ');\n}\n\nexport function mergeObjects<A extends Record<string, V>, B extends Record<string, V>, V>(\n    obj1: A,\n    obj2: B,\n    conflictFunction: (a: V, b: V) => V,\n): Record<string, V> {\n    const entries: [string, V][] = [];\n    for (const key of [...Object.keys(obj1), ...Object.keys(obj2)]) {\n        if (key in obj1 && key in obj2) {\n            entries.push([key, conflictFunction(obj1[key], obj2[key])]);\n        } else if (key in obj1) {\n            entries.push([key, obj1[key]]);\n        } else if (key in obj2) {\n            entries.push([key, obj2[key]]);\n        }\n    }\n    return Object.fromEntries(entries);\n}\n\nexport function mergePartialObjects<A extends Partial<Record<string, V>>, B extends Partial<Record<string, V>>, V>(\n    obj1: A,\n    obj2: B,\n    conflictFunction: (a: V | undefined, b: V | undefined) => V,\n): Partial<Record<string, V>> {\n    const entries: [string, V | undefined][] = [];\n    for (const key of [...Object.keys(obj1), ...Object.keys(obj2)]) {\n        if (key in obj1 && key in obj2) {\n            entries.push([key, conflictFunction(obj1[key], obj2[key])]);\n        } else if (key in obj1) {\n            entries.push([key, obj1[key]]);\n        } else if (key in obj2) {\n            entries.push([key, obj2[key]]);\n        }\n    }\n    return Object.fromEntries(entries);\n}\n\nexport function range(start: number, end: number): number[] {\n    const result = [];\n    for (let i = start; i < end; i += 1) {\n        result.push(i);\n    }\n    return result;\n}\n\nexport function groupBy<T, R>(array: T[], criterion: (value: T) => R): Map<R, T[]> {\n    const result = new Map<R, T[]>();\n    for (const elem of array) {\n        const key = criterion(elem);\n        const group = result.get(key);\n        if (group) {\n            group.push(elem);\n        } else {\n            result.set(key, [elem]);\n        }\n    }\n    return result;\n}\n\nexport function groupBySingle<T, R>(array: T[], criterion: (value: T) => R): Map<R, T> {\n    return new Map(\n        array.map(elem => [criterion(elem), elem]),\n    );\n}\n\n\nexport function distinctBy<T, R>(array: T[], criterion: (value: T) => R): T[] {\n    const existing = new Set();\n    const result = [];\n\n    for (const elem of array) {\n        const key = criterion(elem);\n        if (!existing.has(key)) {\n            result.push(elem);\n            existing.add(key);\n        }\n    }\n    return result;\n}\n\nexport interface LabelAndValue {\n    label: string;\n    value: string;\n}\n\nexport function createLabel(value: string, slug = false): LabelAndValue {\n    return {\n        label: slug ? unslugify(value) : capitalize(value),\n        value: value,\n    };\n}\n\nexport function listenClick(html: HTMLElement, selector: string, callback: (ev: Event) => Promise<void>): void {\n    html.querySelectorAll(selector)\n        .forEach(el => {\n            el.addEventListener('click', async (ev) => await callback(ev));\n        });\n}\n\nexport function createLabels(values: readonly string[], slug = false): LabelAndValue[] {\n    return values.map(value => createLabel(value, slug));\n}\n\nexport function parseNumberInput($html: HTMLElement, name: string): number {\n    const input = $html.querySelector(`input[name=\"${name}\"]`) as HTMLInputElement;\n    return parseInt(input.value, 10);\n}\n\nexport function parseTextInput($html: HTMLElement, name: string): string {\n    const input = $html.querySelector(`input[name=\"${name}\"]`) as HTMLInputElement;\n    return input.value?.trim();\n}\n\nexport function parseTextArea($html: HTMLElement, name: string): string {\n    const input = $html.querySelector(`textarea[name=\"${name}\"]`) as HTMLTextAreaElement;\n    return input.value?.trim();\n}\n\nexport function parseNumberSelect($html: HTMLElement, name: string): number {\n    const input = $html.querySelector(`select[name=\"${name}\"]`) as HTMLSelectElement;\n    return parseInt(input.value, 10);\n}\n\nexport function parseNullableSelect($html: HTMLElement, name: string): string | undefined {\n    const value = parseSelect($html, name);\n    return value === '-' ? undefined : value;\n}\n\nexport function parseSelect($html: HTMLElement, name: string): string {\n    const input = $html.querySelector(`select[name=\"${name}\"]`) as HTMLSelectElement;\n    return input.value;\n}\n\nexport function parseRadio($html: HTMLElement, name: string): string | null {\n    const input = Array.from($html.querySelectorAll(`input[name=\"${name}\"]`)) as HTMLInputElement[];\n    return input.find(i => i.checked)?.value ?? null;\n}\n\nexport function parseCheckbox($html: HTMLElement, name: string): boolean {\n    const input = $html.querySelector(`input[name=\"${name}\"]`) as HTMLInputElement;\n    return input.checked;\n}\n\nexport function clamped(value: number, min: number, max: number): number {\n    return Math.min(Math.max(value, min), max);\n}\n\nexport function camelCase(value: string): string {\n    return uncapitalize(value.trim().split(' ')\n        .map(s => capitalize(s))\n        .join(''));\n}\n\nexport function deCamelCase(value: string): string {\n    const val = value.trim();\n    if (val === '') return '';\n    return val.replace(/([a-z])([A-Z])/g, '$1 $2')\n        .split(' ')\n        .map(capitalize)\n        .join(' ');\n}\n\nexport function usableInForms(value: string): boolean {\n    return /^[^'\"<>\\\\]+$/.test(value);\n}\n\nexport function slugifyable(value: string): boolean {\n    return /^([a-zA-Z0-9]*)(\\s[a-zA-Z0-9]*)*$/.test(value);\n}\n\nexport function isNotBlank(value: string | null | undefined): value is string {\n    return !isBlank(value);\n}\n\nexport function isBlank(value: string | null | undefined): boolean {\n    if (value === null || value === undefined) {\n        return true;\n    } else {\n        return value.trim().length === 0;\n    }\n}\n\nexport function blankToUndefined<T extends string>(value: T): T | undefined {\n    if (isBlank(value)) {\n        return undefined;\n    }\n    return value;\n}\n\nexport function isKingmakerInstalled(game: Game): boolean {\n    return game.modules.get('pf2e-kingmaker')?.active === true;\n}\n\nexport function sum(values: number[]): number {\n    return values.reduce((a, b) => a + b, 0);\n}\n\nexport function isNonNullable<T>(value: T | undefined | null): value is T {\n    return value !== undefined && value !== null;\n}\n\nexport function isNullable<T>(value: T | undefined | null): boolean {\n    return !isNonNullable(value);\n}\n\nexport function splitByWhitespace(text: string): string[] {\n    return text.split(/\\s+/);\n}\n\nexport function encodeJson(object: object): string {\n    return btoa(JSON.stringify(object));\n}\n\nexport function decodeJson(jsonString: string): object {\n    return JSON.parse(atob(jsonString));\n}\n\nexport const rollModeChoices = {\n    publicroll: 'Public Roll',\n    gmroll: 'Private GM Roll',\n    blindroll: 'Blind GM Roll',\n    selfroll: 'Self Roll',\n};","export const allWeatherNames = [\n    'snow',\n    'rain',\n    'sunny',\n    'leaves',\n    'rainStorm',\n    'fog',\n    'blizzard',\n    '',\n] as const;\nexport type WeatherEffectName = typeof allWeatherNames[number];\n\ninterface SceneWeatherSettings {\n    syncWeather: boolean;\n    syncWeatherPlaylist: boolean;\n}\n\nexport function getWeatherSettings(scene: Scene): SceneWeatherSettings {\n    const weather = scene.getFlag('pf2e-kingmaker-tools', 'weather') as SceneWeatherSettings | null;\n    return {\n        syncWeather: weather?.syncWeather ?? true,\n        syncWeatherPlaylist: weather?.syncWeatherPlaylist ?? true,\n    };\n}\n\nexport async function setWeatherSettings(scene: Scene, weather: SceneWeatherSettings): Promise<void> {\n    await scene.setFlag('pf2e-kingmaker-tools', 'weather', weather);\n}","import {parseCheckbox} from '../../utils';\nimport {getWeatherSettings, setWeatherSettings} from '../data';\n\n\nexport function sceneWeatherSettingsDialog(game: Game, scene: Scene): void {\n    const {syncWeather, syncWeatherPlaylist} = getWeatherSettings(scene);\n    new Dialog({\n        title: 'Scene Weather Settings',\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-sync-weather\">Sync Weather</label>\n                <input type=\"checkbox\" name=\"sync-weather\" id=\"km-sync-weather\" ${syncWeather ? 'checked' : ''}>\n            </div>\n            <div>\n                <label for=\"km-sync-weather-playlist\">Sync Weather Playlist</label>\n                <input type=\"checkbox\" name=\"sync-weather-playlist\" id=\"km-sync-weather-playlist\" ${syncWeatherPlaylist ? 'checked' : ''}>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const syncWeather = parseCheckbox($html, 'sync-weather');\n                    const syncWeatherPlaylist = parseCheckbox($html, 'sync-weather-playlist');\n                    await setWeatherSettings(scene, {\n                        syncWeather,\n                        syncWeatherPlaylist,\n                    });\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 250,\n    }).render(true);\n}","import {getStringSetting} from '../../settings';\nimport {deCamelCase, parseSelect} from '../../utils';\nimport {setWeather} from '../weather';\nimport {allWeatherNames, WeatherEffectName} from '../data';\n\nexport function setCurrentWeatherDialog(game: Game): void {\n    const weather = getStringSetting(game, 'currentWeatherFx') as WeatherEffectName;\n    const labels = allWeatherNames.map(name => {\n        return {label: deCamelCase(name), value: name};\n    });\n    new Dialog({\n        title: 'Set Weather',\n        content: `\n        <form class=\"simple-dialog-form\">\n            <div>\n                <label for=\"km-weather\">Weather</label>\n                <select name=\"weather\" id=\"km-weather\">\n                    ${labels.map((l) => {\n            return `<option value=\"${l.value}\" ${weather === l.value ? 'selected' : ''}>${l.label}</option>`;\n        }).join('')}                \n                </select>\n            </div>\n        </form>\n        `,\n        buttons: {\n            save: {\n                icon: '<i class=\"fa-solid fa-save\"></i>',\n                label: 'Save',\n                callback: async (html): Promise<void> => {\n                    const $html = html as HTMLElement;\n                    const weather = parseSelect($html, 'weather') as WeatherEffectName;\n                    await setWeather(game, weather);\n                },\n            },\n        },\n        default: 'save',\n    }, {\n        jQuery: false,\n        width: 250,\n    }).render(true);\n}","import {getNumberSetting, getRollMode, RollMode} from '../settings';\nimport {buildUuids, rollRollTable} from '../roll-tables';\nimport {setWeather} from './weather';\nimport {eventLevels, getSeason, GolarionMonth, golarionMonths} from '../camping/regions';\nimport {MonthNumbers} from 'luxon';\n\n\nasync function rollOnWeatherEventTable(\n    game: Game,\n    averagePartyLevel: number,\n    weatherHazardRange: number,\n    rollMode: RollMode,\n    rollTwice: boolean,\n): Promise<void> {\n    const uuids = await buildUuids(game);\n    const {table, draw} = await rollRollTable(game, uuids['Weather Events'], {rollMode, displayChat: false});\n    const {results} = draw;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    const tableResult = results[0] as any; // FIXME: remove cast once v10 TS types are available\n    const event = tableResult.text;\n    const eventLevel = Array.from(eventLevels.entries())\n        .filter(([name]) => event.startsWith(name))\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        .map(([_, level]) => level)[0] ?? 0;\n    if (eventLevel > (averagePartyLevel + weatherHazardRange)) {\n        console.info(`Re-rolling event, level ${event.level} is more than ${weatherHazardRange} levels higher than party level ${averagePartyLevel}`);\n        await rollOnWeatherEventTable(game, averagePartyLevel, weatherHazardRange, rollMode, rollTwice);\n    } else {\n        await table.toMessage(results, {roll: draw.roll, messageOptions: {rollMode}});\n        if (rollTwice) {\n            await postMessage('Choose a second weather event!', rollMode);\n        }\n    }\n}\n\nasync function rollWeatherEvent(\n    game: Game,\n    averagePartyLevel: number,\n    weatherHazardRange: number,\n    rollMode: RollMode,\n): Promise<void> {\n    const {isSuccess, total} = await rollCheck(17, 'Rolling for weather event with DC 17', rollMode);\n    if (total === 20) {\n        await rollOnWeatherEventTable(game, averagePartyLevel, weatherHazardRange, rollMode, true);\n    } else if (isSuccess) {\n        await rollOnWeatherEventTable(game, averagePartyLevel, weatherHazardRange, rollMode, false);\n    }\n}\n\n\nasync function rollCheck(dc: number, flavor: string, rollMode: RollMode): Promise<{\n    isSuccess: boolean,\n    total: number\n}> {\n    const roll = await new Roll('1d20').evaluate({async: true});\n    const isSuccess = roll.total >= dc;\n    await roll.toMessage({flavor}, {rollMode});\n    return {isSuccess, total: roll.total};\n}\n\nasync function postMessage(message: string, rollMode: RollMode): Promise<void> {\n    await ChatMessage.create({\n        content: message,\n        type: CONST.CHAT_MESSAGE_TYPES.ROLL,\n        rollMode,\n    });\n}\n\nexport async function rollKingmakerWeather(game: Game): Promise<void> {\n    const rollMode = getRollMode(game, 'weatherRollMode');\n    const levels = (game?.actors?.find(a => a.type === 'party') as PartyActor | undefined)\n        ?.members\n        ?.filter(a => a.type === 'character')\n        ?.map(a => a.level) ?? [];\n    const averagePartyLevel = Math.max(...levels, 1);\n    const weatherHazardRange = getNumberSetting(game, 'weatherHazardRange');\n    await rollWeather(game, averagePartyLevel, weatherHazardRange, rollMode);\n}\n\nasync function rollWeather(game: Game, averagePartyLevel: number, weatherHazardRange: number, rollMode: RollMode): Promise<void> {\n    const month = golarionMonths.get(game.pf2e.worldClock.worldTime.month as MonthNumbers);\n    const {precipitationDC, coldDC} = getSeason(month as GolarionMonth);\n\n    const hasPrecipitation = (await rollCheck(\n        precipitationDC,\n        `Checking for precipitation in ${month} on a DC of ${precipitationDC}`,\n        rollMode,\n    )).isSuccess;\n\n    let message;\n    if (coldDC !== undefined) {\n        const isCold = (await rollCheck(\n            coldDC,\n            `Checking for mild cold in ${month} on a DC of ${coldDC}`,\n            rollMode,\n        )).isSuccess;\n        if (isCold && hasPrecipitation) {\n            await setWeather(game, 'snow');\n            message = 'Weather: Cold & Snowing';\n        } else if (isCold) {\n            await setWeather(game, 'sunny');\n            message = 'Weather: Cold';\n        } else if (hasPrecipitation) {\n            await setWeather(game, 'rain');\n            message = 'Weather: Rainy';\n        } else {\n            await setWeather(game, 'sunny');\n            message = 'Weather: Sunny';\n        }\n    } else {\n        if (hasPrecipitation) {\n            await setWeather(game, 'rain');\n            message = 'Weather: Rainy';\n        } else {\n            await setWeather(game, 'sunny');\n            message = 'Weather: Sunny';\n        }\n    }\n    await rollWeatherEvent(game, averagePartyLevel, weatherHazardRange, rollMode);\n    await postMessage(message, rollMode);\n}\n","import {getBooleanSetting, getStringSetting} from '../settings';\nimport {allWeatherNames, getWeatherSettings, WeatherEffectName} from './data';\nimport {isFirstGm, isKingmakerInstalled} from '../utils';\n\nconst kingmakerModuleWeather = new Map<WeatherEffectName, { playlistSourceId: string, soundName: string }>();\nkingmakerModuleWeather.set('rain', {playlistSourceId: 'c6WJzHWMM72zP19H', soundName: 'Rain'});\nkingmakerModuleWeather.set('snow', {playlistSourceId: 'c6WJzHWMM72zP19H', soundName: 'Cold Wind'});\nkingmakerModuleWeather.set('blizzard', {playlistSourceId: 'c6WJzHWMM72zP19H', soundName: 'Colder Wind'});\nkingmakerModuleWeather.set('rainStorm', {playlistSourceId: 'c6WJzHWMM72zP19H', soundName: 'Thunderstorm'});\n\nfunction getWeatherSoundFX(game: Game, weather: WeatherEffectName): PlaylistSound | Playlist | undefined {\n    const overridenPlaylist = game.playlists?.getName(`weather.${weather}`);\n    const kingmakerModuleSound = kingmakerModuleWeather.get(weather);\n    if (isKingmakerInstalled(game)\n        && overridenPlaylist === undefined\n        && kingmakerModuleSound !== undefined\n    ) {\n        return game?.playlists\n            ?.filter(p => p._source._id === kingmakerModuleSound.playlistSourceId)\n            ?.map(p => p.sounds.getName(kingmakerModuleSound.soundName))\n            ?.[0];\n    } else {\n        return overridenPlaylist;\n    }\n}\n\nasync function stopWeatherEffects(game: Game, currentWeather: WeatherEffectName): Promise<void> {\n    const tracksToStop = allWeatherNames\n        .filter(e => e !== '' && e !== currentWeather)\n        .map(e => getWeatherSoundFX(game, e))\n        .filter(s => s !== undefined && s.playing);\n    for (const track of tracksToStop) {\n        if (track instanceof Playlist) {\n            await track.stopAll();\n        } else {\n            await track?.update({playing: false});\n        }\n    }\n}\n\nasync function playWeatherEffect(game: Game, weather: WeatherEffectName): Promise<void> {\n    if (weather !== '') {\n        const track = getWeatherSoundFX(game, weather);\n        if (track !== undefined && !track.playing) {\n            if (track instanceof Playlist) {\n                await track.playAll();\n            } else {\n                await track.update({playing: true});\n            }\n        }\n    }\n}\n\nasync function applyWeatherSound(game: Game, effectName: WeatherEffectName): Promise<void> {\n    await stopWeatherEffects(game, effectName);\n    await playWeatherEffect(game, effectName);\n}\n\nexport function dayHasChanged(game: Game, deltaInSeconds: number): boolean {\n    const now = game.pf2e.worldClock.worldTime;\n    const previous = now.minus({second: deltaInSeconds});\n    return now.day !== previous.day || now.month !== previous.month || now.year !== previous.year;\n}\n\nfunction getSceneWeather(game: Game, scene: Scene | null | undefined): WeatherEffectName | null {\n    if (scene && getWeatherSettings(scene).syncWeather) {\n        const effectName = getBooleanSetting(game, 'enableSheltered')\n            ? ''\n            : getStringSetting(game, 'currentWeatherFx') as WeatherEffectName;\n        if (effectName === 'sunny') {\n            return '';\n        } else if (allWeatherNames.includes(effectName)) {\n            return effectName;\n        }\n    }\n    return null;\n}\n\nfunction getWeatherPlaylist(game: Game, activeScene: Scene | undefined | null): WeatherEffectName {\n    if (activeScene && getWeatherSettings(activeScene).syncWeatherPlaylist) {\n        return activeScene.weather || (getBooleanSetting(game, 'enableSheltered') ? '' : 'sunny');\n    } else {\n        return '';\n    }\n}\n\nasync function syncSceneWeather(game: Game, scene: Scene | null | undefined): Promise<void> {\n    const effectName = await getSceneWeather(game, scene);\n    if (scene && effectName !== null) {\n        console.info(`Setting scene ${scene.name} weather to '${effectName}'`);\n        await scene?.update({'weather': effectName});\n    }\n}\n\nasync function syncScenePlaylist(game: Game, scene: Scene | null | undefined): Promise<void> {\n    const weatherEffect = getWeatherPlaylist(game, scene);\n    console.info(`Setting weather playlist to to ${weatherEffect}`);\n    if (getBooleanSetting(game, 'enableWeatherSoundFx')) {\n        await applyWeatherSound(game, weatherEffect);\n    }\n}\n\nasync function syncWeather(game: Game): Promise<void> {\n    if (isFirstGm(game) && getBooleanSetting(game, 'enableWeather')) {\n        const currentScene = game.scenes?.current;\n        const activeScene = game.scenes?.active;\n        if (activeScene && currentScene && activeScene.id === currentScene.id) {\n            await syncSceneWeather(game, activeScene);\n        } else {\n            await syncSceneWeather(game, currentScene);\n            await syncSceneWeather(game, activeScene);\n        }\n        await syncScenePlaylist(game, activeScene);\n    }\n}\n\nexport async function setWeather(game: Game, effectName: WeatherEffectName): Promise<void> {\n    await game.settings.set('pf2e-kingmaker-tools', 'currentWeatherFx', effectName);\n    await syncWeather(game);\n}\n\nexport async function toggleSheltered(game: Game): Promise<void> {\n    const isEnabled = !getBooleanSetting(game, 'enableSheltered');\n    await game.settings.set('pf2e-kingmaker-tools', 'enableSheltered', isEnabled);\n    await syncWeather(game);\n}\n\nexport async function toggleWeather(game: Game): Promise<void> {\n    const isEnabled = !getBooleanSetting(game, 'enableWeather');\n    await game.settings.set('pf2e-kingmaker-tools', 'enableWeather', isEnabled);\n    await syncWeather(game);\n}\n\nexport async function onPreUpdateScene(game: Game, scene: Scene, update: Partial<Scene>): Promise<void> {\n    if (isFirstGm(game) && getBooleanSetting(game, 'enableWeather') && update?.active) {\n        // make sure to set the weather effect when viewing a scene and then activating it\n        const weather = getSceneWeather(game, scene);\n        if (weather !== null) {\n            update.weather = weather;\n        }\n    }\n}\n\nexport async function onUpdateScene(game: Game, scene: Scene, update: Partial<Scene>): Promise<void> {\n    if (isFirstGm(game) && getBooleanSetting(game, 'enableWeather') && update?.active) {\n        // activating a scene plays its weather playlist\n        // setting the correct scene weather is done pre update or on render\n        await syncScenePlaylist(game, scene);\n    }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport async function onRenderScene(game: Game): Promise<void> {\n    // disabled because this produces foundry race conditions\n    // const current = game.scenes?.current;\n    // if (isFirstGm(game) && getBooleanSetting(game, 'enableWeather') && current) {\n    //     // when changing scenes, also ensure that the weather syncs without activating the scene\n    //     const current = game.scenes?.current;\n    //     await syncSceneWeather(game, current);\n    // }\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import {\n    dayHasChanged,\n    onPreUpdateScene,\n    onRenderScene,\n    onUpdateScene,\n    toggleSheltered,\n    toggleWeather,\n} from './weather/weather';\nimport {sceneWeatherSettingsDialog} from './weather/dialogs/scene-weather-settings';\nimport {setCurrentWeatherDialog} from './weather/dialogs/set-current-weather';\nimport {isFirstGm, rollModeChoices} from './utils';\nimport {toTimeOfDayMacro} from './time/app';\nimport {getBooleanSetting, getStringSetting, setSetting} from './settings';\nimport {rollKingmakerWeather} from './weather/roll-weather';\nimport {rollExplorationSkillCheck, rollSkillDialog} from './skill-checks';\nimport {rollKingdomEvent} from './kingdom-events';\nimport {showKingdom} from './kingdom/sheet';\nimport {showStructureEditDialog} from './kingdom/dialogs/edit-structure-rules';\nimport {getKingdom} from './kingdom/storage';\nimport {addOngoingEvent, changeDegree, parseUpgradeMeta, reRoll} from './kingdom/rolls';\nimport {kingdomChatButtons} from './kingdom/chat-buttons';\nimport {StringDegreeOfSuccess} from './degree-of-success';\nimport {editArmyStatistics} from './armies/sheet';\nimport {openCampingSheet} from './camping/sheet';\nimport {bindCampingChatEventListeners} from './camping/chat';\nimport {getDiffListeners} from './camping/effect-syncing';\nimport {getCamping, getCampingActor} from './camping/storage';\nimport {awardHeroPoints, resetHeroPoints, showAwardXPDialog} from './macros';\nimport {addDiscoverSpecialMealResult, addHuntAndGatherResult} from './camping/eating';\nimport {getActorByUuid} from './camping/actor';\nimport {checkBeginCombat, CombatUpdate, showSetSceneCombatPlaylistDialog, stopCombat} from './camping/combat-tracks';\nimport {migrate} from './migrations';\nimport {onCreateArmyItem, onPostUpdateArmy, onPreUpdateArmy, updateAmmunition} from './armies/hooks';\nimport {updateKingdomArmyConsumption} from './armies/utils';\nimport {openJournal} from './foundry-utils';\nimport {structureTokenMappingDialog} from './kingdom/dialogs/structure-token-mapping-dialog';\nimport {realmTileDialog} from './kingdom/dialogs/realm-tile-dialog';\n\n\nHooks.on('ready', async () => {\n    if (game instanceof Game) {\n        const gameInstance = game;\n        gameInstance.pf2eKingmakerTools = {\n            macros: {\n                toggleWeatherMacro: toggleWeather.bind(null, game),\n                realmTileDialogMacro: realmTileDialog.bind(null, game),\n                toggleShelteredMacro: toggleSheltered.bind(null, game),\n                setCurrentWeatherMacro: setCurrentWeatherDialog.bind(null, game),\n                structureTokenMappingMacro: structureTokenMappingDialog.bind(null, game),\n                sceneWeatherSettingsMacro: (): void => {\n                    const scene = gameInstance?.scenes?.current;\n                    if (scene) {\n                        sceneWeatherSettingsDialog(gameInstance, scene);\n                    }\n                },\n                toTimeOfDayMacro: toTimeOfDayMacro.bind(null, game),\n                toggleCombatTracksMacro: async (): Promise<void> => {\n                    const enabled = getBooleanSetting(gameInstance, 'enableCombatTracks');\n                    await stopCombat(gameInstance, gameInstance.combat);\n                    await setSetting(gameInstance, 'enableCombatTracks', !enabled);\n                },\n                setSceneCombatPlaylistDialogMacro: async (actor: Actor | undefined): Promise<void> => {\n                    const scene = gameInstance.scenes?.current;\n                    if (actor) {\n                        await showSetSceneCombatPlaylistDialog(gameInstance, actor);\n                    } else if (scene) {\n                        await showSetSceneCombatPlaylistDialog(gameInstance, scene);\n                    }\n                },\n                kingdomEventsMacro: rollKingdomEvent.bind(null, game),\n                rollKingmakerWeatherMacro: rollKingmakerWeather.bind(null, game),\n                viewKingdomMacro: showKingdom.bind(null, game),\n                awardXpMacro: showAwardXPDialog.bind(null, game),\n                resetHeroPointsMacro: resetHeroPoints.bind(null, game),\n                awardHeroPointsMacro: awardHeroPoints.bind(null, game),\n                editArmyStatisticsMacro: (actor: Actor): Promise<void> => editArmyStatistics(gameInstance, actor),\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                openCampingSheet: (): void => openCampingSheet(gameInstance),\n                rollExplorationSkillCheck: async (skill: string, effect: string): Promise<void> => {\n                    await rollExplorationSkillCheck(gameInstance, skill, effect);\n                },\n                rollSkillDialog: async (): Promise<void> => {\n                    const configuredActors = getStringSetting(gameInstance, 'skillCheckMacroCharacterNames')\n                        ?.split('||')\n                        ?.map(s => s.trim())\n                        ?.filter(s => s !== '') ?? [];\n                    if (configuredActors.length === 0) {\n                        ui?.notifications?.error('No actor names configured! Configure actor names first in settings');\n                    } else {\n                        const actorNames = new Set(configuredActors);\n                        const actors = gameInstance?.actors\n                            ?.filter(actor => (actor.type === 'character' || actor.type === 'familiar')\n                                && actor.name !== null\n                                && actorNames.has(actor.name)) ?? [];\n                        await rollSkillDialog(actors);\n                    }\n                },\n                editStructureMacro: async (actor: any): Promise<void> => {\n                    if (actor === undefined) {\n                        ui.notifications?.error('Please select an actor');\n                    } else {\n                        console.log(actor);\n                        await showStructureEditDialog(gameInstance, actor.token.baseActor);\n                    }\n                },\n            },\n        };\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'showManual', {\n            name: 'Show Manual',\n            scope: 'world',\n            config: false,\n            default: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'enableCombatTracks', {\n            name: 'Enable Combat Tracks',\n            hint: 'If enabled, starts a combat track depending on the current region, actor or scene. Region combat tracks have to be named after the region, e.g. \"Kingmaker.Rostland Hinterlands\"; \"Kingmaker.Default\" is played if no region playlist is found instead',\n            scope: 'world',\n            config: true,\n            default: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'enableWeather', {\n            name: 'Enable Weather',\n            default: true,\n            config: true,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'enableWeatherSoundFx', {\n            name: 'Enable Weather Sound Effects',\n            default: true,\n            config: true,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'enableSheltered', {\n            name: 'Enabled Sheltered',\n            default: false,\n            config: false,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'autoRollWeather', {\n            name: 'Automatically roll Weather',\n            hint: 'When a new day begins (00:00), automatically roll weather',\n            default: true,\n            config: true,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, string>('pf2e-kingmaker-tools', 'weatherRollMode', {\n            name: 'Weather Roll Mode',\n            scope: 'world',\n            config: true,\n            default: 'gmroll',\n            type: String,\n            choices: rollModeChoices,\n        });\n        gameInstance.settings.register<string, string, []>('pf2e-kingmaker-tools', 'forceEnabledCompanionLeadershipBenefits', {\n            name: 'Force Enabled Companion Leadership Benefits',\n            scope: 'world',\n            config: false,\n            default: [],\n            type: Array,\n        });\n        gameInstance.settings.register<string, string, number>('pf2e-kingmaker-tools', 'weatherHazardRange', {\n            name: 'Weather Hazard Range',\n            hint: 'Maximum Level of Weather Event that can occur. Added to Average Party Level.',\n            default: 4,\n            config: true,\n            type: Number,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, number>('pf2e-kingmaker-tools', 'rpToXpConversionRate', {\n            default: 1,\n            config: false,\n            type: Number,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, number>('pf2e-kingmaker-tools', 'rpToXpConversionLimit', {\n            default: 120,\n            config: false,\n            type: Number,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, number>('pf2e-kingmaker-tools', 'xpPerClaimedHex', {\n            default: 10,\n            config: false,\n            type: Number,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'cultOfTheBloomEvents', {\n            default: true,\n            config: false,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, boolean>('pf2e-kingmaker-tools', 'autoCalculateSettlementLevel', {\n            default: true,\n            config: false,\n            type: Boolean,\n            scope: 'world',\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'currentWeatherFx', {\n            name: 'Current Weather FX',\n            hint: 'Based on the current value of the roll table',\n            scope: 'world',\n            config: false,\n            default: 'sunny',\n            type: String,\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'proxyEncounterTable', {\n            name: 'Proxy Random Encounter Table',\n            hint: 'Name of the in world roll table that is rolled first to check what kind of encounter is rolled. Use the string \"Creature\" to roll on the region roll table in the proxy roll table or link another roll table of your choice. Leave blank to always roll on the region random encounter tables.',\n            scope: 'world',\n            config: false,\n            default: '',\n            type: String,\n        });\n        gameInstance.settings.register<string, string, string>('pf2e-kingmaker-tools', 'randomEncounterRollMode', {\n            name: 'Random Encounter Roll Mode',\n            scope: 'world',\n            config: false,\n            default: 'gmroll',\n            type: String,\n            choices: rollModeChoices,\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'skillCheckMacroCharacterNames', {\n            name: 'Skill Check Macro Character Names',\n            hint: 'A string of character names separated by ||, e.g. Jake||John||The Undertaker',\n            scope: 'world',\n            config: true,\n            default: '',\n            type: String,\n        });\n        gameInstance.settings.register<string, string, string>('pf2e-kingmaker-tools', 'kingdomEventRollMode', {\n            name: 'Kingdom Events Roll Mode',\n            scope: 'world',\n            config: false,\n            default: 'gmroll',\n            type: String,\n            choices: rollModeChoices,\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomEventsTable', {\n            name: 'Kingdom Events Table Name',\n            scope: 'world',\n            config: false,\n            default: 'Random Kingdom Events',\n            type: String,\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomCultTable', {\n            name: 'Kingdom Cult Events Table Name',\n            scope: 'world',\n            config: false,\n            default: 'Random Cult Events',\n            type: String,\n        });\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'vanceAndKerensharaXP', {\n            name: 'Enable Vance and Kerenshara XP rules',\n            hint: 'Adds additional Milestone Events, more XP for claiming hexes and RP',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'capitalInvestmentInCapital', {\n            name: 'Enable Capital Investment without Bank in Capital',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'reduceDCToBuildLumberStructures', {\n            name: 'Reduce DC to Build Lumber Structures',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'automateResources', {\n            name: 'Automatically sum worksites and farmlands',\n            scope: 'world',\n            config: false,\n            default: 'kingmaker',\n            requiresReload: true,\n            type: String,\n            choices: {\n                kingmaker: 'Kingmaker',\n                tileBased: 'Tile Based',\n                manual: 'Manual',\n            },\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomAlwaysAddHalfLevel', {\n            name: 'Always add half Level to Skill',\n            hint: 'If enabled, always adds half of the kingdom\\'s level to a skill, even if it is untrained',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomAlwaysAddLevel', {\n            name: 'Always add Level to Skill',\n            hint: 'If enabled, always adds the kingdom\\'s level to a skill, even if it is untrained. Overrides Always add half Level to Skill',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomSkillIncreaseEveryLevel', {\n            name: 'Double Skill Increases',\n            hint: 'If enabled, adds Skill Increases for all even levels from level 2 onwards',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomAllStructureItemBonusesStack', {\n            name: 'All Structure Item Bonuses Stack',\n            hint: 'If enabled, groups item bonuses from all structures, regardless of if they are same building type',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'kingdomIgnoreSkillRequirements', {\n            name: 'Ignore Skill Proficiency Requirements for Kingdom Activities',\n            scope: 'world',\n            config: false,\n            default: false,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register('pf2e-kingmaker-tools', 'autoCalculateArmyConsumption', {\n            name: 'Automatically Calculate Army Consumption',\n            hint: 'If enabled, gets all visible army tokens on all scenes and sums up their consumption',\n            scope: 'world',\n            config: false,\n            default: true,\n            requiresReload: true,\n            type: Boolean,\n        } as any);\n        gameInstance.settings.register<string, string, number>('pf2e-kingmaker-tools', 'schemaVersion', {\n            name: 'Schema Version',\n            default: 1,\n            config: false,\n            type: Number,\n            scope: 'world',\n        });\n        gameInstance.settings.register<string, string, string>('pf2e-kingmaker-tools', 'latestMigrationBackup', {\n            name: 'Schema Version',\n            default: '',\n            config: false,\n            type: String,\n            scope: 'world',\n        });\n\n        // migrations\n        await migrate(game, getKingdomSheetActor(game), getCampingActor(game));\n\n        // hooks\n        Hooks.on('updateWorldTime', async (_, delta) => {\n            if (getBooleanSetting(gameInstance, 'autoRollWeather')\n                && isFirstGm(gameInstance)\n                && dayHasChanged(gameInstance, delta)\n            ) {\n                await rollKingmakerWeather(gameInstance);\n            }\n        });\n        Hooks.on('canvasReady', async () => {\n            await onRenderScene(gameInstance);\n        });\n        Hooks.on('preUpdateScene', async (scene: StoredDocument<Scene>, update: Partial<Scene>) => {\n            await onPreUpdateScene(gameInstance, scene, update);\n        });\n        Hooks.on('updateScene', async (scene: StoredDocument<Scene>, update: Partial<Scene>) => {\n            await onUpdateScene(gameInstance, scene, update);\n        });\n        Hooks.on('preUpdateCombat', (combat: StoredDocument<Combat>, update: CombatUpdate) => checkBeginCombat(gameInstance, combat, update));\n        Hooks.on('deleteCombat', (combat: StoredDocument<Combat>) => stopCombat(gameInstance, combat));\n        // armies\n        Hooks.on('preUpdateActor', (actor: StoredDocument<Actor>, update: Partial<Actor>) => onPreUpdateArmy(gameInstance, actor, update));\n        Hooks.on('updateActor', (actor: StoredDocument<Actor>, update: Partial<Actor>) => onPostUpdateArmy(gameInstance, actor, update));\n        Hooks.on('createItem', (item: StoredDocument<Item>) => onCreateArmyItem(gameInstance, item));\n        Hooks.on('preUpdateCombat', (combat: StoredDocument<Combat>, update: CombatUpdate) => updateAmmunition(gameInstance, combat, update));\n        // army consumption\n        const updateConsumption = async (actor: Actor | null): Promise<void> => {\n            await updateKingdomArmyConsumption({\n                actor,\n                kingdomActor: getKingdomSheetActor(gameInstance),\n                game: gameInstance,\n            });\n        };\n        const forceUpdateConsumption = async (): Promise<void> => {\n            await updateKingdomArmyConsumption({\n                forceUpdate: true,\n                kingdomActor: getKingdomSheetActor(gameInstance),\n                game: gameInstance,\n            });\n        };\n        Hooks.on('createToken', (token: StoredDocument<Token>) => updateConsumption(token.actor));\n        Hooks.on('updateToken', (token: StoredDocument<Token>) => updateConsumption(token.actor));\n        Hooks.on('deleteToken', (token: StoredDocument<Token>) => updateConsumption(token.actor));\n        Hooks.on('updateActor', (actor: StoredDocument<Actor>) => updateConsumption(actor));\n        Hooks.on('updateItem', (item: StoredDocument<Item>) => updateConsumption(item.actor));\n        Hooks.on('createItem', (item: StoredDocument<Item>) => updateConsumption(item.actor));\n        Hooks.on('deleteItem', (item: StoredDocument<Item>) => updateConsumption(item.actor));\n        Hooks.on('deleteScene', () => forceUpdateConsumption());\n        checkKingdomErrors(gameInstance);\n        checkCampingErrors(gameInstance);\n\n        // listen for camping sheet open\n        const listeners = getDiffListeners(gameInstance);\n        gameInstance.socket!.on('module.pf2e-kingmaker-tools', async (data: { action: string, data: any }) => {\n            if (data.action === 'openCampingSheet') {\n                openCampingSheet(gameInstance);\n            } else if (data.action === 'openKingdomSheet') {\n                await showKingdom(gameInstance);\n            } else if (data.action === 'addDiscoverSpecialMealResult' && isFirstGm(gameInstance)) {\n                const recipe = data.data.recipe as string | null;\n                const criticalFailUuids = data.data.critFailUuids as string[];\n                const actor = await getActorByUuid(data.data.actorUuid);\n                const {specialIngredients, basicIngredients} = data.data;\n                if (actor) {\n                    const actorAndIngredients = {actor, specialIngredients, basicIngredients};\n                    await addDiscoverSpecialMealResult(gameInstance, actorAndIngredients, recipe, criticalFailUuids);\n                }\n            } else if (data.action === 'addHuntAndGatherResult' && isFirstGm(gameInstance)) {\n                const actor = await getActorByUuid(data.data.actorUuid);\n                const {specialIngredients, basicIngredients} = data.data;\n                if (actor) {\n                    await addHuntAndGatherResult(gameInstance, {\n                        actor,\n                        basicIngredients,\n                        specialIngredients,\n                    });\n                }\n            } else {\n                // players changed data and GM needs to sync effects\n                const sheetActor = getCampingActor(gameInstance);\n                if (sheetActor && isFirstGm(gameInstance)) {\n                    const camping = getCamping(sheetActor);\n                    for (const listener of listeners) {\n                        if (listener.canHandle(data.action)) {\n                            listener.onReceive(camping);\n                        }\n                    }\n                }\n            }\n        });\n\n        if (isFirstGm(gameInstance) && getBooleanSetting(gameInstance, 'showManual')) {\n            await setSetting(gameInstance, 'showManual', false);\n            await openJournal('Compendium.pf2e-kingmaker-tools.kingmaker-tools-journals.JournalEntry.iAQCUYEAq4Dy8uCY');\n        }\n    }\n});\n\nHooks.on('init', async () => {\n    await loadTemplates([\n        'modules/pf2e-kingmaker-tools/templates/common/skills.partial.hbs',\n        'modules/pf2e-kingmaker-tools/templates/camping/activity.partial.hbs',\n        'modules/pf2e-kingmaker-tools/templates/camping/eating.partial.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/sidebar.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/status.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/skills.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/turn.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/groups.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/feats.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/notes.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/settlements.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/settlement.hbs',\n        'modules/pf2e-kingmaker-tools/templates/kingdom/effects.hbs',\n    ]);\n    // load custom token mappings if kingmaker module isn't installed\n    if (game instanceof Game) {\n        if (!game.modules.get('pf2e-kingmaker')?.active) {\n            game.modules.get('pf2e-kingmaker-tools')\n                ?.updateSource({flags: {'pf2e-kingmaker-tools': {'pf2e-art': 'modules/pf2e-kingmaker-tools/token-map.json'}}});\n        }\n    }\n});\n\nHooks.on('renderChatLog', () => {\n    if (game instanceof Game) {\n        const gameInstance = game;\n        const actor = getKingdomSheetActor(gameInstance);\n        if (actor) {\n            const chatLog = $('#chat-log');\n            for (const button of kingdomChatButtons) {\n                chatLog.on('click', button.selector, (event: Event) => button.callback(gameInstance, actor, event));\n            }\n        }\n        bindCampingChatEventListeners(gameInstance);\n    }\n});\n\ntype LogEntry = {\n    name: string,\n    icon?: string,\n    condition?: (html: JQuery) => boolean,\n    callback: (html: JQuery) => void,\n};\n\nfunction getKingdomSheetActor(game: Game): Actor | undefined {\n    return game?.actors?.find(a => a.name === 'Kingdom Sheet');\n}\n\nfunction ifKingdomActorExists(game: Game, el: HTMLElement, callback: (actor: Actor) => void): void {\n    // TODO: replace this with a data-actor-id lookup in the el\n    const actor = getKingdomSheetActor(game);\n    if (actor) {\n        callback(actor);\n    } else {\n        ui.notifications?.error('Could not find actor with name Kingdom Sheet');\n    }\n}\n\nHooks.on('getChatLogEntryContext', (html: HTMLElement, items: LogEntry[]) => {\n    if (game instanceof Game) {\n        const gameInstance = game;\n        const hasActor = (): boolean => getKingdomSheetActor(gameInstance) !== undefined;\n        const hasContentLink = (el: JQuery): boolean => hasActor() && el[0].querySelector('.content-link') !== null;\n        const hasMeta = (el: JQuery): boolean => hasActor() && el[0].querySelector('.km-roll-meta') !== null;\n        const canChangeDegree = (chatMessage: HTMLElement, direction: 'upgrade' | 'downgrade'): boolean => {\n            const cantChangeDegreeUnless: StringDegreeOfSuccess = direction === 'upgrade' ? 'criticalSuccess' : 'criticalFailure';\n            const meta = chatMessage.querySelector('.km-upgrade-result');\n            return hasActor() && meta !== null && parseUpgradeMeta(chatMessage).degree !== cantChangeDegreeUnless;\n        };\n        const canReRollUsingFame = (el: JQuery): boolean => {\n            const actor = getKingdomSheetActor(gameInstance);\n            return actor ? getKingdom(actor).fame.now > 0 && hasMeta(el) : false;\n        };\n        const canReRollUsingCreativeSolution = (el: JQuery): boolean => {\n            const actor = getKingdomSheetActor(gameInstance);\n            return actor ? getKingdom(actor).creativeSolutions > 0 && hasMeta(el) : false;\n        };\n        const canReRollUsingSupernaturalSolution = (el: JQuery): boolean => {\n            const actor = getKingdomSheetActor(gameInstance);\n            return actor ? getKingdom(actor).supernaturalSolutions > 0 && hasMeta(el) : false;\n        };\n        items.push({\n            name: 'Re-Roll Using Fame/Infamy',\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            condition: canReRollUsingFame,\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 'fame')),\n        }, {\n            name: 'Re-Roll Using Creative Solution',\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            condition: canReRollUsingCreativeSolution,\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 'creative-solution')),\n        }, {\n            name: 'Re-Roll Using Supernatural Solution',\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            condition: canReRollUsingSupernaturalSolution,\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 'supernatural-solution')),\n        }, {\n            name: 'Re-Roll',\n            condition: hasMeta,\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 're-roll')),\n        }, {\n            name: 'Re-Roll Keep Higher',\n            condition: hasMeta,\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 'keep-higher')),\n        }, {\n            name: 'Re-Roll Keep Lower',\n            condition: hasMeta,\n            icon: '<i class=\"fa-solid fa-dice-d20\"></i>',\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => reRoll(actor, el[0], 'keep-lower')),\n        }, {\n            name: 'Upgrade Degree of Success',\n            condition: (el: JQuery) => canChangeDegree(el[0], 'upgrade'),\n            icon: '<i class=\"fa-solid fa-arrow-up\"></i>',\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => changeDegree(actor, el[0], 'upgrade')),\n        }, {\n            name: 'Downgrade Degree of Success',\n            condition: (el: JQuery) => canChangeDegree(el[0], 'downgrade'),\n            icon: '<i class=\"fa-solid fa-arrow-down\"></i>',\n            callback: el => ifKingdomActorExists(gameInstance, el[0], (actor) => changeDegree(actor, el[0], 'downgrade')),\n        }, {\n            name: 'Add to Ongoing Events',\n            icon: '<i class=\"fa-solid fa-plus\"></i>',\n            condition: hasContentLink,\n            callback: async (el) => {\n                ifKingdomActorExists(gameInstance, el[0], async (actor) => {\n                    const link = el[0].querySelector('.content-link') as HTMLElement | null;\n                    const uuid = link?.dataset?.uuid;\n                    const text = link?.innerText;\n                    if (uuid && text) {\n                        await addOngoingEvent(actor, uuid, text);\n                    }\n                });\n            },\n        });\n    }\n});\n\nfunction checkKingdomErrors(game: Game): void {\n    const actor = getKingdomSheetActor(game);\n    if (actor && !actor.getFlag('pf2e-kingmaker-tools', 'kingdom-sheet')) {\n        ui.notifications?.error('Found an Actor with name \"Kingdom Sheet\" that has not been imported using the \"View Kingdom\" Macro! Please delete the actor and re-import it.');\n    }\n}\n\nfunction checkCampingErrors(game: Game): void {\n    const actor = getCampingActor(game);\n    if (actor && !actor.getFlag('pf2e-kingmaker-tools', 'camping-sheet')) {\n        ui.notifications?.error('Found an Actor with name \"Camping Sheet\" that has not been imported using the \"Camping\" Macro! Please delete the actor and re-import it.');\n    }\n}"],"names":["t","self","e","r","s","n","a","i","o","l","c","u","f","m","h","d","p","g","y","b","v","Base","constructor","this","type","$_root","_definition","_reset","_ids","Ids","_preferences","_refs","Manager","_cache","_valids","_invalids","_flags","_rules","_singleRules","Map","$_terms","$_temp","ruleset","whens","describe","allow","verifyFlat","_values","alter","Array","isArray","_inRuleset","clone","alterations","push","target","adjuster","artifact","$_setFlag","cast","_default","description","empty","$_compile","override","error","Error","example","assertOptions","_inner","single","external","method","failover","forbidden","presence","id","test","invalid","label","meta","note","length","only","optional","prefs","context","externals","warnings","debug","checkPreferences","preferences","includes","raw","result","required","strict","convert","strip","tag","unit","valid","when","is","switch","then","otherwise","$_mutateRebuild","cache","provider","provision","Object","create","getPrototypeOf","_assign","concat","isSchema","keys","register","toSibling","merge","has","filter","keep","name","delete","rules","multi","set","assign","slice","_tracer","_combine","extend","base","extract","split","reach","fork","rule","modifiers","get","$","tailor","$_modify","each","ref","tracer","location","validate","entry","validateAsync","entryAsync","$_addRule","_resolve","args","argsByName","isResolvable","$_mutateRegister","normalize","assert","validateArg","_ruleRemove","priority","unshift","schema","$_createError","flags","messages","Report","$_getFlag","$_getRule","$_mapLabels","labels","$_match","abortEarly","_externals","snapshot","errors","restore","reset","source","path","key","family","rebuild","$_property","properties","$_reach","$_rootReferences","roots","default","$_parent","symbols","parent","call","$_validate","shallow","$_super","_super","bind","_bare","terms","init","literal","_generate","resolve","nest","localize","ancestors","schemas","break","join","mainstay","active","generate","remove","add","prototype","any","version","compile","root","isImmutable","deny","disallow","equal","exist","not","options","exports","max","supported","Set","Cache","isFinite","_max","_map","_list","List","size","value","first","_compact","pop","tail","head","next","prev","_remove","isoDate","defaults","allowUnknown","artifacts","dateFormat","escapeHtml","language","render","stack","wrap","array","nonEnumerables","noDefaults","skipFunctions","stripUnknown","Symbol","for","arraySingle","deepDefault","template","values","details","message","compare","isIsoDate","isNumber","isNaN","legacy","isValues","limit","Number","isSafeInteger","tryWithPath","append","appendPath","simple","custom","alternatives","try","RegExp","string","regex","Date","date","object","isRef","walk","condition","code","state","local","hasOwnProperty","_setTemplate","_template","toString","replace","trim","isTemplate","process","ValidationError","stackTraceLimit","super","_original","isError","isJoi","annotate","prepare","coerce","from","alias","map","overrides","manifest","build","types","boolean","function","link","number","symbol","aliases","alt","bool","func","_types","methods","x","expression","setup","attempt","extensions","extension","expandExtension","isExpression","in","decompile","compact","_byId","_byKey","_schemaChain","entries","_collect","shift","_get","scan","adjust","iterables","separator","prefix","ancestor","Ref","depth","updateDisplay","display","shadow","absolute","functions","fill","global","startsWith","toParent","refs","min","arrays","objects","or","nameRx","items","pattern","conditional","maxArity","to","minArity","setter","arity","mapped","desc","buffer","integer","special","entity","unknown","warn","State","Shadow","_snapshot","node","commit","opens","closes","toDateString","iso","toISOString","time","toTimeString","utc","toUTCString","Template","rendered","_settings","_functions","every","_parse","encode","indexOf","decode","_ref","wrapped","isDynamic","_part","formula","evaluate","stringify","Parser","reference","constants","arrayItems","JSON","true","false","null","second","minute","hour","day","if","msg","parseFloat","getTime","match","matches","some","reduce","mergeArrays","reports","_endedSwitch","unmatched","report","valids","examples","metas","notes","shared","tags","warning","sparse","ordered","_exclusions","_inclusions","_requireds","sort","patternLabel","errorsArray","pos","fastSplice","_","w","fillMissedErrors","fillOrderedErrors","fillDefault","operator","validateSingle","_arrayItems","order","by","unique","comparator","undefined","ignoreUndefined","done","dupePos","dupeValue","knownMisses","unknownMisses","isBool","sensitive","falsy","truthy","toLowerCase","isDate","parse","format","now","greater","less","timestamp","typeof","class","renameDefaults","multiple","dependencies","patterns","renames","rename","_hasPatternMatch","isPresent","rel","and","dependency","subject","instance","Keys","nand","oxor","fallthrough","with","without","xor","Sorter","after","group","nodes","peers","apply","defineProperty","writable","Dependency","present","presentWithLabels","keysToLabels","missing","missingWithLabels","paths","main","mainWithLabel","peersWithLabels","peer","peerWithLabel","exec","child","schemaChain","relative","links","perspective","numberRx","precisionRx","exponentialPartRegex","leadingSignAndZerosRegex","dotRegex","trailingZerosRegex","decimalPlaces","Math","parseInt","unsafe","extractSignificantDigits","String","normalizeDecimal","pow","round","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","trunc","baseDecimalPlace","pfactor","negative","sign","port","positive","precision","endsWith","tlds","base64Regex","dataUriRegex","hexRegex","withPrefix","withOptionalPrefix","withoutPrefix","ipRegex","cidr","isoDurationRegex","guidBrackets","guidVersions","uuidv1","uuidv2","uuidv3","uuidv4","uuidv5","uuidv6","uuidv7","uuidv8","guidSeparators","normalizationForms","insensitive","truncate","replacements","form","direction","toLocaleUpperCase","toLocaleLowerCase","enabled","replacement","byteAligned","arg","reason","alphanum","base64","urlSafe","paddingRequired","case","creditCard","charAt","dataUri","domain","addressOptions","address","isValid","email","invalids","guid","hex","hostname","minDomainSegments","ip","versions","isoDuration","encoding","lowercase","invert","errorCode","token","uppercase","uri","scheme","allowRelative","relativeOnly","maxDomainSegments","validateTlds","iterator","async","linked","original","log","Mainstay","_snapshots","cleanup","untrace","_register","trace","ignore","finalize","forEach","Values","_lowercase","lowercases","_override","applyToDefaultsWithShallow","nullOverride","reachCopy","needsProtoHack","weakSet","weakMap","cloneWithShallow","getInternalProto","getOwnPropertyDescriptor","enumerable","configurable","setPrototypeOf","mismatched","isDeepEqual","deepFunction","getSharedType","promise","isSame","SeenEntry","isDeepEqualObj","valueOf","hasOwnEnumerableProperty","propertyIsEnumerable","isSetSimpleEqual","getOwnPropertySymbols","part","skip","obj","captureStackTrace","charCodeAt","isSafe","escapeHtmlChar","namedHtml","padStart","safeCharCodes","isInteger","generic","Promise","WeakMap","WeakSet","typeMap","Reflect","ownKeys","getOwnPropertyNames","_items","before","seq","manual","_sort","mergeSort","nonAsciiRx","domainControlRx","tldSegmentRx","domainSegmentRx","URL","analyze","allowUnicode","punycode","allowFullyQualified","host","encoder","TextEncoder","ignoreLength","atextRx","binary","atomRx","fromCharCode","codes","EMPTY_STRING","FORBIDDEN_UNICODE","MULTIPLE_AT_CHAR","MISSING_AT_CHAR","EMPTY_LOCAL","ADDRESS_TOO_LONG","LOCAL_TOO_LONG","EMPTY_LOCAL_SEGMENT","INVALID_LOCAL_CHARS","DOMAIN_NON_EMPTY_STRING","DOMAIN_TOO_LONG","DOMAIN_INVALID_UNICODE_CHARS","DOMAIN_INVALID_CHARS","DOMAIN_INVALID_TLDS_CHARS","DOMAIN_SEGMENTS_COUNT","DOMAIN_SEGMENTS_COUNT_MAX","DOMAIN_FORBIDDEN_TLDS","DOMAIN_EMPTY_SEGMENT","DOMAIN_LONG_SEGMENT","v4Cidr","v6Cidr","ipv4address","ipv4Cidr","ipv6Cidr","ipv6address","ipvFuture","schemeRegex","j","k","R","S","A","O","E","D","hierPart","hierPartCapture","relativeRef","relativeRefCapture","query","queryWithSquareBrackets","fragment","rfc3986","ipv4","ipv6","ipvfuture","createRegex","allowQuerySquareBrackets","uriRegex","operators","operatorCharacters","operatorsOrder","operatorsPrefix","literals","tokenRx","settings","_parts","_subFormula","splice","calculate","exists","module","LuxonError","InvalidDateTimeError","toMessage","InvalidIntervalError","InvalidDurationError","ConflictingSpecificationError","InvalidUnitError","InvalidArgumentError","ZoneIsAbstractError","DATE_SHORT","year","month","DATE_MED","DATE_MED_WITH_WEEKDAY","weekday","DATE_FULL","DATE_HUGE","TIME_SIMPLE","TIME_WITH_SECONDS","TIME_WITH_SHORT_OFFSET","timeZoneName","TIME_WITH_LONG_OFFSET","TIME_24_SIMPLE","hourCycle","TIME_24_WITH_SECONDS","TIME_24_WITH_SHORT_OFFSET","TIME_24_WITH_LONG_OFFSET","DATETIME_SHORT","DATETIME_SHORT_WITH_SECONDS","DATETIME_MED","DATETIME_MED_WITH_SECONDS","DATETIME_MED_WITH_WEEKDAY","DATETIME_FULL","DATETIME_FULL_WITH_SECONDS","DATETIME_HUGE","DATETIME_HUGE_WITH_SECONDS","Zone","ianaName","isUniversal","offsetName","ts","opts","formatOffset","offset","equals","otherZone","singleton$1","SystemZone","Intl","DateTimeFormat","resolvedOptions","timeZone","locale","parseZoneInfo","getTimezoneOffset","dtfCache","typeToPos","era","ianaZoneCache","IANAZone","resetCache","isValidSpecifier","isValidZone","zone","zoneName","NaN","dtf","hour12","adOrBc","formatToParts","formatted","filled","isUndefined","partsOffset","parsed","fMonth","fDay","fYear","fadOrBc","fHour","fMinute","fSecond","hackyOffset","abs","asTS","over","objToLocalTS","millisecond","intlLFCache","intlDTCache","getCachedDTF","locString","intlNumCache","intlRelCache","sysLocaleCache","weekInfoCache","listStuff","loc","englishFn","intlFn","mode","listingMode","PolyNumberFormatter","intl","forceSimple","padTo","floor","otherOpts","intlOpts","useGrouping","minimumIntegerDigits","inf","NumberFormat","getCachedINF","fixed","roundTo","PolyDateFormatter","dt","z","originalZone","gmtOffset","offsetZ","setZone","plus","minutes","toJSDate","parts","PolyRelFormatter","isEnglish","style","hasRelative","rtf","cacheKeyOpts","RelativeTimeFormat","getCachedRTF","count","numeric","narrow","units","years","quarters","months","weeks","days","hours","seconds","lastable","isDay","isInPast","fmtValue","singular","lilUnits","fmtUnit","formatRelativeTime","fallbackWeekSettings","firstDay","minimalDays","weekend","Locale","fromOpts","numberingSystem","outputCalendar","weekSettings","defaultToEN","specifiedLocale","Settings","defaultLocale","localeR","numberingSystemR","defaultNumberingSystem","outputCalendarR","defaultOutputCalendar","weekSettingsR","validateWeekSettings","defaultWeekSettings","fromObject","numbering","parsedLocale","parsedNumberingSystem","parsedOutputCalendar","localeStr","xIndex","substring","uIndex","selectedStr","smaller","calendar","parseLocaleString","intlConfigString","weekdaysCache","standalone","monthsCache","meridiemCache","eraCache","fastNumbersCached","fastNumbers","isActuallyEn","hasNoWeirdness","alts","redefaultToEN","redefaultToSystem","formatStr","ms","DateTime","mapMonths","weekdays","mapWeekdays","meridiems","eras","field","matching","dtFormatter","find","numberFormatter","relFormatter","listFormatter","ListFormat","getCachedLF","getWeekSettings","hasLocaleWeekInfo","data","getWeekInfo","weekInfo","getCachedWeekInfo","getStartOfWeek","getMinDaysInFirstWeek","getWeekendDays","other","singleton","FixedOffsetZone","utcInstance","parseSpecifier","signedOffset","InvalidZone","normalizeZone","input","defaultZone","lowered","throwOnInvalid","twoDigitCutoffYear","cutoffYear","resetCaches","Invalid","explanation","nonLeapLadder","leapLadder","unitOutOfRange","dayOfWeek","UTC","setUTCFullYear","getUTCFullYear","js","getUTCDay","computeOrdinal","isLeapYear","uncomputeOrdinal","ordinal","table","month0","findIndex","isoWeekdayToLocal","isoWeekday","startOfWeek","gregorianToWeek","gregObj","minDaysInFirstWeek","weekYear","weekNumber","weeksInWeekYear","timeObject","weekToGregorian","weekData","weekdayOfJan4","yearInDays","daysInYear","gregorianToOrdinal","gregData","ordinalToGregorian","ordinalData","usesLocalWeekValues","localWeekday","localWeekNumber","localWeekYear","hasInvalidGregorianData","validYear","validMonth","integerBetween","validDay","daysInMonth","hasInvalidTimeData","validHour","validMinute","validSecond","validMillisecond","bestBy","arr","best","pair","prop","thing","bottom","top","padded","parseInteger","parseFloating","parseMillis","fraction","digits","towardZero","factor","modMonth","floorMod","firstWeekOffset","weekOffset","weekOffsetNext","untruncateYear","offsetFormat","modified","offHourStr","offMinuteStr","offHour","offMin","asNumber","numericValue","normalizeObject","normalizer","normalized","RangeError","pick","monthsLong","monthsShort","monthsNarrow","weekdaysLong","weekdaysShort","weekdaysNarrow","erasLong","erasShort","erasNarrow","stringifyTokens","splits","tokenToString","val","macroTokenToFormatOpts","DD","DDD","DDDD","tt","ttt","tttt","T","TT","TTT","TTTT","ff","fff","ffff","F","FF","FFF","FFFF","Formatter","parseFormat","fmt","current","currentFull","bracketed","formatOpts","systemLoc","formatWithSystemDefault","formatDateTime","formatDateTimeParts","formatInterval","interval","start","formatRange","end","num","formatDateTimeFromString","knownEnglish","useDateTimeFormatter","isOffsetFixed","allowZ","meridiem","meridiemForDateTime","monthForDateTime","weekdayForDateTime","maybeMacro","eraForDateTime","quarter","formatDurationFromString","dur","tokenToField","tokens","realTokens","found","lildur","shiftTo","ianaRegex","combineRegexes","regexes","full","combineExtractors","extractors","mergedVals","mergedZone","cursor","ex","extractor","simpleParse","ret","offsetRegex","isoTimeBaseRegex","isoTimeRegex","isoTimeExtensionRegex","extractISOWeekData","extractISOOrdinalData","sqlTimeRegex","sqlTimeExtensionRegex","int","fallback","extractISOTime","milliseconds","extractISOOffset","fullOffset","extractIANAZone","isoTimeOnly","extractISODuration","yearStr","monthStr","weekStr","dayStr","hourStr","minuteStr","secondStr","millisecondsStr","hasNegativePrefix","negativeSeconds","maybeNegate","force","obsOffsets","GMT","EDT","EST","CDT","CST","MDT","MST","PDT","PST","fromStrings","weekdayStr","rfc2822","extractRFC2822","obsOffset","milOffset","rfc1123","rfc850","ascii","extractRFC1123Or850","extractASCII","isoYmdWithTimeExtensionRegex","isoWeekWithTimeExtensionRegex","isoOrdinalWithTimeExtensionRegex","isoTimeCombinedRegex","extractISOYmdTimeAndOffset","extractISOWeekTimeAndOffset","extractISOOrdinalDateAndTime","extractISOTimeAndOffset","extractISOTimeOnly","sqlYmdWithTimeExtensionRegex","sqlTimeCombinedRegex","extractISOTimeOffsetAndIANAZone","INVALID$2","lowOrderMatrix","casualMatrix","daysInYearAccurate","daysInMonthAccurate","accurateMatrix","orderedUnits$1","reverseUnits","reverse","clone$1","clear","conf","conversionAccuracy","matrix","Duration","durationToMillis","vals","_vals$milliseconds","sum","normalizeValues","reduceRight","previous","previousVal","conv","rollUp","config","accurate","isLuxonDuration","fromMillis","normalizeUnit","fromDurationLike","durationLike","isDuration","fromISO","text","parseISODuration","fromISOTime","parseISOTimeOnly","week","toFormat","fmtOpts","toHuman","unitDisplay","listStyle","toObject","toISO","toISOTime","millis","toMillis","suppressMilliseconds","suppressSeconds","includePrefix","includeOffset","toJSON","invalidReason","duration","minus","negate","mapUnits","fn","reconfigure","as","rescale","newVals","removeZeroes","shiftToAll","built","accumulated","lastUnit","own","ak","negated","invalidExplanation","v1","v2","INVALID$1","Interval","isLuxonInterval","fromDateTimes","builtStart","friendlyDateTime","builtEnd","validateError","validateStartEnd","startIsValid","endIsValid","isInterval","toDuration","startOf","useLocaleWeeks","diff","hasSame","isEmpty","isAfter","dateTime","isBefore","contains","splitAt","dateTimes","sorted","results","added","splitBy","idx","divideEqually","numberOfParts","overlaps","abutsStart","abutsEnd","engulfs","intersection","union","intervals","final","sofar","item","currentCount","ends","difference","toLocaleString","toISODate","mapEndpoints","mapFn","Info","hasDST","proto","isValidIANAZone","locObj","getMinimumDaysInFirstWeek","getWeekendWeekdays","monthsFormat","weekdaysFormat","features","localeWeek","dayDiff","earlier","later","utcDayStart","toUTC","keepLocalTime","highWater","lowestOrder","differs","differ","highOrderDiffs","remainingMillis","lowerOrderUnits","numberingSystems","arab","arabext","bali","beng","deva","fullwide","gujr","hanidec","khmr","knda","laoo","limb","mlym","mong","mymr","orya","tamldec","telu","thai","tibt","latn","numberingSystemsUTF16","hanidecChars","digitRegex","MISSING_FTP","intUnit","post","deser","str","search","parseDigits","spaceOrNBSP","spaceOrNBSPRegExp","fixListRegex","stripInsensitivities","oneOf","strings","startIndex","groups","partTypeStyleToTokenVal","short","long","dayperiod","dayPeriod","hour24","dummyDateTimeCache","expandMacroTokens","formatOptsToTokens","maybeExpandMacroToken","explainFromTokens","one","two","three","four","six","oneOrTwo","oneToThree","oneToSix","oneToNine","twoToFour","fourToSix","unitate","unitForToken","disqualifyingUnit","regexString","handlers","buildRegex","rawMatches","all","matchIndex","specificOffset","Z","q","M","G","toField","dateTimeFromMatches","df","resolvedOpts","isSpace","actualType","tokenForPart","INVALID","MAX_DATE","unsupportedZone","possiblyCachedWeekData","possiblyCachedLocalWeekData","localWeekData","inst","old","fixOffset","localTS","tz","utcGuess","o2","o3","tsToObj","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","objToTS","adjustTime","oPre","millisToAdd","parseDataToDateTime","parsedZone","interpretationZone","toTechFormat","extended","longFormat","extendedZone","defaultUnitValues","defaultWeekUnitValues","defaultOrdinalUnitValues","orderedUnits","orderedWeekUnits","orderedOrdinalUnits","normalizeUnitWithLocalWeeks","weeknumber","weeksnumber","weeknumbers","weekyear","weekyears","quickDT","tsNow","offsetProvis","diffRelative","calendary","lastOpts","argList","ot","_zone","isLuxonDateTime","arguments","fromJSDate","zoneToUse","fromSeconds","containsOrdinal","containsGregorYear","containsGregorMD","containsGregor","definiteWeekDef","useWeekData","defaultValues","objNow","foundFirst","higherOrderInvalid","validWeek","validWeekday","hasInvalidWeekData","validOrdinal","hasInvalidOrdinalData","gregorian","tsFinal","offsetFinal","parseISODate","fromRFC2822","preprocessRFC2822","parseRFC2822Date","fromHTTP","parseHTTPDate","fromFormat","localeToUse","parseFromTokens","fromString","fromSQL","parseSQL","isDateTime","parseFormatForOpts","localeOpts","tokenList","expandFormat","ceil","isWeekend","monthShort","monthLong","weekdayShort","weekdayLong","offsetNameShort","offsetNameLong","isInDST","getPossibleOffsets","dayMs","minuteMs","oEarlier","oLater","o1","ts1","ts2","c1","c2","isInLeapYear","weeksInLocalWeekYear","resolvedLocaleOptions","toLocal","keepCalendarTime","newTS","offsetGuess","asObj","setLocale","settingWeekStuff","mixed","normalizedUnit","endOf","toLocaleParts","ext","toISOWeekDate","toRFC2822","toHTTP","toSQLDate","toSQLTime","includeZone","includeOffsetSpace","toSQL","toSeconds","toUnixInteger","toBSON","includeConfig","otherDateTime","durOpts","otherIsLater","diffed","diffNow","until","inputMs","adjustedToZone","toRelative","padding","toRelativeCalendar","fromFormatExplain","fromStringExplain","dateTimeish","VERSION","armyStatisticsByLevel","level","scouting","standardDC","ac","highSave","lowSave","attack","maximumTactics","army","Dialog","title","actor","content","buttons","no","icon","callback","yes","html","$html","parseSelect","weaponTypeMelee","parseCheckbox","uuids","onConfirm","jQuery","width","onYes","onUpdateArmyLevel","game","system","adjustments","getArmyAdjustment","isFirstGm","addArmyStats","addAttackModifiers","syncAttackModifiers","combat","update","actors","combatants","ammunition","itemTypes","equipment","ammunitionQuantity","calculateArmyAdjustments","ArmySheet","FormApplication","defaultOptions","submitOnChange","closeOnSubmit","classes","height","scrollY","apps","appId","getData","actorLevel","calculated","_updateObject","event","formData","expandObject","console","melee","maneuver","morale","ranged","recruitmentDC","saveArmyAdjustment","activateListeners","_getHeaderButtons","user","isGM","onclick","openJournal","disableArmyDialog","close","unsetFlag","editArmyStatistics","armySetupDialog","additionalUuids","uuid","fromUuid","createEmbeddedDocuments","getDefaultArmyAdjustment","initArmy","ui","notifications","sheetActor","getFlag","info","setFlag","syncedActorUpdates","isRanged","weaponType","increasedAmmunitionCount","action","calculateTotalArmyConsumption","consumption","scenes","tokenCollection","hidden","hasPlayerOwner","distinctBy","abilities","con","mod","calculatedUpdate","bonus","updates","attackModifier","updateEmbeddedDocuments","saves","reflex","will","fortitude","attributes","perception","foundry","utils","mergeObject","kingdomActor","forceUpdate","getBooleanSetting","isArmyActor","saveKingdom","armies","getHuntAndGatherQuantities","degreeOfSuccess","zoneDc","zoneLevel","DegreeOfSuccess","CRITICAL_SUCCESS","basicIngredients","specialIngredients","rations","SUCCESS","roll","FAILURE","addToInventory","quantity","isConsumableItem","uses","allCampingActivityNames","allCompanionNames","allCampingActivities","journalUuid","isLocked","isSecret","dc","skillRequirements","skill","proficiency","skills","criticalSuccess","modifyRandomEncounterDc","night","success","criticalFailure","failure","checkRandomEncounter","effectUuids","flatMap","ingredients","basicIngredientUuid","specialIngredientUuid","rationUuid","region","zoneDC","getRegionInfo","getItemsByName","names","getActorItemsByUuid","getItemNames","isEffectItem","getActorEffectsByUuid","proficiencyToRank","NotProficientError","satisfiesSkillProficiency","minimumProficiency","skillProp","getSkill","rank","loreSkill","getActorByUuid","document","Actor","getItemByUuid","Item","getItemsByUuid","requirements","requirement","capitalize","unslugify","actorUuid","existingEffects","deleteEmbeddedDocuments","removeActorEffectsByUuid","removeActorEffectsByName","getDC","dcType","getLevelBasedDC","migratedRecipes","actorUuids","campingActivities","cooking","chosenMeal","actorMeals","magicalSubsistenceAmount","subsistenceAmount","knownRecipes","homebrewMeals","cookingSkill","restRollMode","currentRegion","dailyPrepsAtTime","worldTime","homebrewCampingActivities","encounterModifier","gunsToClean","watchSecondsRemaining","actorUuidsNotKeepingWatch","increaseWatchActorNumber","lockedActivities","ignoreSkillRequirements","secret","isWatch","activity","rollData","extraRollOptions","slugify","skillToRoll","degree","postDegreeOfSuccessMessage","messageConfig","isPrivate","critSuccess","critFailure","degreeToProperty","checkRandomEncounterMessage","homebrewActivities","homebrewNames","combatEffects","getPartyActors","maintainArmorTarget","getMaintainArmorTarget","activityName","combatEffect","huntAndGatherTargetActorUuid","parseIngredientButton","element","dataset","addRecipe","actorAndIngredients","critFailUuids","recipe","addDiscoverSpecialMealResult","socket","emit","addIngredients","addHuntAndGatherResult","food","getIngredientList","ChatMessage","cost","CONST","CHAT_MESSAGE_TYPES","ROLL","rollMode","getCampingActor","chatLog","on","currentTarget","getCamping","getEncounterDC","rollRandomEncounter","checkForRandomEncounter","getEntityPlaylist","playlist","playlistNames","playlists","entityName","activePlaylist","save","track","isBlank","onSubmit","setSceneCombatPlaylistDialog","setEntityPlaylist","defaultKingmakerModuleSound","kingmakerModulePlaylists","getKingmakerCombatSound","_source","_id","sounds","getName","ifPlaylistExists","campingActor","getRegion","actorsPlaylist","sceneCombatPlaylist","regionPlaylist","defaultRegionPlaylist","kingmakerModulePlaylistSound","isKingmakerInstalled","getRegionPlaylist","defaultPlaylist","getDefaultPlaylist","music","stopAll","Playlist","playAll","playing","playlistSound","allowedActors","allOutcomes","AddCampingActivities","onSubmitCallback","originalName","deepClone","isHomebrew","outcomes","effects","getEffects","dcs","range","deCamelCase","effect","TextEditor","enrichHTML","createUUIDLink","journal","parseDC","outcome","listenClick","ev","editActivityDialog","selectedLores","allActorSkills","req","selectedSkills","skillDialog","atLeastOne","onSave","loresAndSkills","availableSkills","button","index","onOk","effectUuid","parseTextInput","effectTarget","getEffectByUuid","parseEffects","removeAfterRest","recipes","favoriteEffect","critSuccEffect","succEffect","failEffect","parseNumberInput","rarity","survivalDC","cookingLoreDC","favoriteMeal","actorsKeepingWatch","watchEnabled","proxyRandomEncounterTable","rollModeChoices","randomEncounterRollMode","setSetting","tpl","availableRecipes","availableFood","disabled","checkedIndex","checked","learningCost","toTemplateRecipe","learn","parseRadio","ManageCampingActivities","camping","activities","getCampingActivityData","localeCompare","saveCamping","addActivityDialog","formatCost","basic","learnedRecipes","learned","recipeName","cookingCost","price","enableRecipes","deleteRecipes","getConsumableFromUuid","removeItems","amount","remainingToRemove","getConsumablesByUuid","leftOverQuantity","removeFood","ration","charges","available","leftOver","leftOverCharges","removeRations","addFood","addIngredientsToActor","getCookingActorUuid","getRecipeData","allRecipes","rationSourceId","sourceId","specialIngredientsSourceId","basicIngredientsId","consumables","consumable","specialIngredient","basicIngredient","hasPreparedCampsite","actorIsCooking","canCook","actorConsumables","foodCost","availableBasicIngredients","availableSpecialIngredients","availableRations","availableMagicalSubsistence","availableSubsistence","actorsConsumingRations","actorsConsumingMeals","recipeSpecialIngredientCost","recipeBasicIngredientCost","requiredRationsTotal","availableRationsTotal","consumedRations","consumedSubsistence","magicalSubsistence","subsistence","getActorsByUuid","itemsToAdd","getHuntAndGatherActor","addOf","getKnownRecipes","recipeData","pf2e","actions","subsist","difficultyClass","syncActorMealEffects","getAllMealEffectUuids","removeActorsEffectsByUuid","actorUuidsEatingMeal","getMealEffectUuids","addActorRecipeEffect","actorUuidAndFavoriteMeal","getActivityOutcomeUuids","getCampingEffectUuids","getAllCampingEffectUuids","syncActorsCampingEffects","effectUuidsForActors","actorActivityDataByName","groupBySingle","effectsPerformedByActor","actorCampingActivities","effectsForActors","allActors","actorAndEffect","getEffectUuidsForActors","effectsForActor","getEffectsByUuid","allUuids","effectNames","existingEffectNames","effectsToAdd","effectsToRemove","syncActorCampingEffects","DiffListener","testFireChange","shouldFireChange","fireChange","getCurrent","onReceive","canHandle","CampingActivitiesListener","diffObject","ClearCampingActivitiesListener","campingEffectUuids","actorUuidAndMeal","recipeEffectUuids","getActivityModifier","campingActivityData","mods","forgoFlatCheck","creatureRollTable","toOfficialKingmakerRollTableName","regions","findRollTableUuidWithFallback","findCreatureRollTable","worldEncounterTable","getStringSetting","encounterTypeRollTable","findWorldTableUuid","rollOptions","flavor","total","dieRoll","Roll","determineDegreeOfSuccess","succeededEncounterFlatCheck","rollRollTable","tableResult","draw","currentRegionData","modifier","activityModifier","campingActivity","ca","isDayOrNight","getWorldTime","encounterDC","firstWorldMincePieEffects","strength","criticalSuccessUuid","successUuid","dexterity","constitution","wisdom","intelligence","charisma","getOutcomeEffects","includeAll","chooseRandomly","random","getExpiringOutcomeEffects","favoriteMealEffects","regionName","golarionMonths","weatherData","coldDC","precipitationDC","season","eventLevels","calculateDailyPreparationsSeconds","getActorsKeepingWatch","organizeWatchCritSuccess","additionalWatchers","blacklistedActorNumber","getWatchRandomEncounterData","watchDurationSeconds","dailyPrepsDuration","fullRestDurationInSeconds","advanceToSeconds","encounter","remainingSeconds","checks","encounterAtSeconds","partySize","restDurationSeconds","calculateRestSeconds","fishOnAStick","actorsFavoriteMeal","actorHasEffectByUuid","actorsCriticalFailure","actorsHavingNeither","getAverageRestDuration","watchSecondsDuration","dailyPrepsSeconds","fullDurationSeconds","currentSeconds","currentRestHours","formatHours","restHours","params","restingPlaylist","playRestingPlaylist","advance","actorKeepingWatchIndex","rollCampingCheck","startWatch","hasItemByUuid","currentHp","hp","maxHp","conMod","maxRestored","hpLost","hpRestored","healMoreHp","removeActorsEffectsByName","expiringUuids","getAllExpiringMealEffectUuids","removeExpiredMealEffects","restForTheNight","skipDialog","completeDailyPreparations","CampingSheet","diffListeners","dragDrop","dropSelector","dragSelector","submitOnClose","editable","getDiffListeners","read","sumElapsedSeconds","activityData","getActors","getWatchSecondsDuration","currentEncounterDCModifier","getActorConsumables","chosenMealData","getChosenMealData","isUser","viewActors","toViewActors","adventuringSince","toViewCampingActivities","watchDuration","knownFavoriteRecipes","degreesOfSuccesses","toViewDegrees","mealDegreeOfSuccess","formatWorldTime","timeMarkerPositionPx","getTimeOfDayPercent","hasCookingActor","consumedFood","calculateConsumedFood","toViewActorMeals","getCookingSkillData","chosenMealDc","getMealDc","showContinueRest","getRestHours","hasCookingLore","cookingActorHasCookingLore","cookingSkills","_canDragDrop","_canDragStart","cookingActor","reRender","Hooks","removeActor","combatEffectsToChat","advanceHours","manageRecipesDialog","deletedRecipes","addRecipeDialog","manageActivitiesDialog","consumeFood","resetAdventuringSince","eat","getCookingActorByUuid","rest","rollCheck","sheet","partyActors","campingSettingsDialog","openUuidSheet","discoverSpecialMeal","huntAndGather","rollStandardCheck","setActivityResult","askDcDialog","off","campingConfiguration","_onDragStart","dataTransfer","setData","_onDrop","parseDropData","classList","handleItemDrop","proficiencyRequirements","validateSkillProficiencies","setActivityActor","selectedSkill","dropData","parseNullableSelect","degreeKey","skillKey","parseActorMeals","consumed","getRecipesKnownInRegion","isCriticalSuccess","isSuccess","isCriticalFailure","CRITICAL_FAILURE","removeIngredients","recipeToAdd","postDiscoverSpecialMealResult","persistActivityDegreeOfSuccess","postHuntAndGatherResult","openCampingSheet","setupDialog","getDefaultConfiguration","toViewActor","image","img","chosenActivity","hasSkillCheck","cssClass","getCssClass","noActivityChosen","prepareCampActivity","prepareCampDegreeOfSuccess","canPerformActivities","isHidden","activityDataSkills","isSkillCheck","slug","askDc","toViewActivity","favoriteMealUuid","getCombatEffects","companionsAndLabels","SkillDialog","showLores","allProficiency","showAll","selected","lores","lore","proficiencies","allTrainedSkillRanks","slugifyable","canonicalId","loreToLoreSkill","adjustByDieNumber","dieNumber","allDegreesOfSuccesses","JournalEntryPage","pageId","rollEvent","tableName","rollTable","kingdomChatButtons","selector","preventDefault","costs","parsePayButton","payStructure","gainFame","getKingdom","updateResources","kingdom","getKingdomActivitiesById","modifierCopy","consumeId","crypto","randomUUID","allAbilities","score","allKingdomPhases","skillRanks","untrained","trained","expert","master","legendary","oncePerRound","leadership","commerce","upkeep","civic","companion","phase","unlockedCompanionActivities","groupedActivities","kingdomLevel","hints","maxTactics","hint","ranks","enableCapitalInvestment","fromEntries","activityRanks","noBuildingPreventsActivity","simpleRank","fortune","gainRP","gainUnrest","loseRP","allSkills","gainRolledRD","gainRuin","turns","loseRolledRD","createResourceButton","turn","gainCommodities","loseFame","gainSolution","loseCommodities","loseUnrest","phases","warfare","boating","magic","trade","loseRuin","hasFeat","dcAdjustment","turnLabel","getKingdomActivities","additionalActivities","homebrewIds","isCompanionName","allCompanions","getCompanionUnlock","role","leaderName","unlock","companionActivityUnlocks","roles","getCompanionUnlocks","leaders","alwaysEnableCompanionNames","overridenUnlocks","companionName","checkCompanionRoleInvested","leader","invested","actionSkills","counselor","emissary","general","magister","ruler","treasurer","viceroy","warden","curr","mergeObjects","setting","getStringArraySetting","generateForAllSkills","feat","allFeats","automationNotes","prerequisites","allFeatsByName","kingdomFeat","skillIncrease","abilityBoosts","settlementConstruction","ruinResistance","expansionExpert","hexes","experiencedLeadership","featuresByLevel","groupBy","uniqueFeatures","getSizeData","kingdomSize","kingdomSizeData","sizeFrom","sizeTo","getCultEventMilestones","xp","completed","homebrew","allHeartlands","allFameTypes","claimHexAttempts","claimHexCircumstanceBonus","investedLeadershipBonus","resourceDice","resourceDieSize","controlDCModifier","commodityCapacity","leaderVacant","sizeModifier","adjustedLevel","vacancyPenalty","turnsWithoutEvent","turnsWithoutCultEvent","atWar","charter","government","activeSettlement","public","gm","fame","supernaturalSolutions","creativeSolutions","xpThreshold","unrest","settlements","feats","bonusFeats","ongoingEvents","milestones","realmSceneId","workSites","farmlands","resources","quarries","lumberCamps","mines","luxurySources","commodities","ore","lumber","stone","luxuries","resourcePoints","heartland","vacant","agriculture","arts","defense","engineering","exploration","folklore","industry","intrigue","politics","scholarship","statecraft","wilderness","abilityScores","culture","economy","loyalty","stability","ruin","corruption","penalty","threshold","crime","decay","strife","activityBlacklist","isInvested","ability","relevantLeaders","abilityLeaders","allLeaders","leaderAbilities","levelData","getLevelData","allRuins","ruinAbilities","abilityRuins","skillAbilities","allSkillRanks","allBuildingTraits","magicalItemGroups","mundaneItemGroups","itemGroups","structuresByName","activityBonusRules","traits","affectsDowntime","upgradeFrom","construction","proficiencyRank","rp","availableItemsRules","maximumStacks","skillBonusRules","reducesUnrest","isBridge","lots","increaseLeadershipActivities","affectsEvents","storage","preventItemLevelPenalty","reducesRuin","consumptionReduction","leadershipActivityRules","unlockActivities","settlementEventRules","stacksWith","adjustment","existing","copy","ManageKingdomActivitiesDialog","buildActivities","blacklist","parseOutcome","AddKingdomActivities","edit","rankToProficiency","blankToUndefined","AddBonusFeatDialog","querySelector","addEventListener","selectedFeat","allModifierTypes","createLabels","allActivities","parseOptionalSelect","typeSlug","bonusOrPenalty","parseModifierType","negotiationDC","relations","createModifierList","CheckDialog","customModifiers","circumstance","status","untyped","modifierOverrides","consumeModifiers","onRoll","overrideSkills","afterRoll","automateResourceMode","getStolenLandsData","controlDC","getControlDC","getActivitySkills","activityDCType","companionSkillUnlocks","getCompanionSkillUnlocks","getOverrideUnlockCompanionNames","companionUnlockSkills","skillRankFilters","activitySkills","practicalMagic","activeSettlementStructureResult","getActiveSettlementStructureResult","getSettlement","applicableSkills","additionalModifiers","createActiveSettlementModifiers","settlement","getSettlementsWithoutLandBorders","convertedCustomModifiers","createCustomModifiers","skillModifiers","calculateModifiers","creativeSolutionModifier","supernaturalSolutionModifier","selectedSkillModifier","modifierBreakdown","encodeJson","creativeSolution","supernaturalSolution","selectableSkills","createSelectableSkills","createModifiers","createSkillModifiers","skillRank","untrainedProficiencyMode","getUntrainedProficiencyMode","skillItemBonus","merged","skillBonuses","homogenize","overrideModifiers","adjustDegreeOfSuccess","cooperativeLeadership","rollType","skillModifier","totalLabel","assurance","autoLevel","showLevelConfig","manualSettlementLevel","waterBorders","secondaryTerritory","sceneId","editTemplate","structureData","createElement","textarea","innerHTML","appendChild","outerHTML","json","KingdomSettings","companions","getCompanionBenefits","allStructuresItemBonusesStack","automaticallyCalculateArmyConsumption","doubleSkillIncreases","rpToXpConversionLimit","getNumberSetting","rpToXPConversionRate","untrainedSkillProficiency","getUntrainedProficiency","vkXpRules","xpPerClaimedHex","cultOfTheBloomEvents","autoCalculateSettlementLevel","kingdomEventsTable","kingdomCultTable","kingdomEventRollMode","capitalInvestmentInCapital","reduceDCToBuildLumberStructures","automateResources","amiri","ekunday","harrim","jaethal","jubilost","kalikke","kanerah","linzi","noknok","octavia","regongar","tristian","valerie","updateKingdomArmyConsumption","KingdomSizeDialog","Application","dice","drawings","canvas","controlled","tiles","SettlementSizeDialog","settlementTypeData","blocks","maximumLots","population","levelFrom","levelTo","maxItemBonus","influence","SettlementApp","settlementId","nav","capital","getCapitalSettlement","structureStackMode","getStructureStackMode","getStructureResult","builtStructures","getBuiltStructures","getStorage","settlementInfo","getSettlementInfo","skillItemBonuses","getSkillBonuses","hasEffects","hasStorage","hasBonuses","hasBuildings","scene","hasBridge","getActiveTabs","overcrowded","residentialLots","consumptionSurplus","capitalInvestmentPossible","allowCapitalInvestment","settlementEventBonus","leadershipActivityBonus","leadershipActivities","availableItems","getAvailableItems","itemLevelBonuses","sceneChange","querySelectorAll","el","tab","settlementLevel","qualityOfLifeBonus","bonuses","calculateAvailableItems","groupedBonuses","groupAvailableItems","itemBonusLabels","structures","sceneActorStructures","getSceneActorStructures","countedStructures","countStructureOccurrences","structure","occurrences","statusTab","bonusesTab","effectsTab","shoppingTab","buildingsTab","storageTab","actorId","importSheet","pack","packs","importFromCompendium","HelpApplication","rankToLabel","enrichIfDefined","pf2Dc","pf2eGame","checkModifier","CheckModifier","Check","checkProficiency","checkRpCost","checkLumberCost","checkOreCost","checkStoneCost","checkLuxuriesCost","StructureBrowserApp","structureActors","filters","resetFilters","getStructureActivities","getAllStructureActivities","getStructuresFromActors","housing","upgradeTo","infrastructure","ignoreProficiencyRequirements","ignoreStructureCost","filterStructures","viewStructures","toViewStructures","noStructures","stopPropagation","buildStructure","enabledFilters","hasUpgradeTo","checkBuildingCost","allActivityBonuses","enabledActivities","hasActivities","lacksProficiency","getStructureDC","disableBuild","insufficientStone","insufficientLumber","insufficientRp","insufficientLuxuries","insufficientOre","getPaymentChatData","upgradeFromStructures","isNonNullable","costMode","upgradeCosts","calculateCosts","structureToLink","structureLink","upgradeButtons","createPayButton","header","payButton","linkNote","activityBonuses","formatCosts","zeroedCosts","officialMappings","customMappings","migrateActors","migrateToMappings","mappingPerName","mapping","getCustomMappings","baseDirectory","importedStructures","isStructureActor","journalLink","migrate","folder","getAllMergedSettlements","capacity","calculateStorageCapacity","settlementConsumption","resourceMode","farmlandsCount","combinedConsumption","surplus","clamped","createPredicateName","removeUninterestingZeroModifiers","removePredicatedModifiers","predicates","activitySkillRank","keepModifier","predicate","removeLowestModifiers","groupedModifiers","highestEnabledValue","highest","createVacancyModifier","rulerVacant","enabledModifiers","option","settlementsWithoutLandBorders","isSecondaryTerritory","leadershipBonus","appliedLeaders","applyLeaderCompanionRules","calculateAbilityModifier","calculateUntrainedProficiency","calculateUnrestPenalty","itemPenalty","kingdomActivities","createActivityModifiers","skillBonus","createSkillModifier","calculateNewValue","currentValue","newValue","limitedValue","missingMessage","getCurrentValue","getLimit","getCapacity","evaluateValue","createUpdate","parseResourceButton","parsedValue","evaluatedValue","parseMeta","isNotBlank","atob","parseUpgradeMeta","hasCooperativeLeadership","previousDegree","btoa","modifierPills","parsedBreakdown","decodeJson","getModifiersByType","createModifierPills","upgradedDegreeOfSuccess","postComplexDegreeOfSuccess","postSimpleDegreeOfSuccess","postDegreeOfSuccess","buildChatButtons","resultKey","modifierToLabel","getResultKey","trimEnd","beforeHeader","reRollFormula","overrideRollType","kingdomActivity","newDegree","upgradeDegree","downgradeDegree","degreeEnum","StructureError","calculateLots","tokenWidth","tokenHeight","parseStructureData","refData","lookedUpStructure","ruleSchema","prototypeToken","isStructureActorActive","tokenIsStructure","shapeContainsOtherShape","marginOfErrorPx","xStart","xEnd","yStart","yEnd","getFilledBlocks","gridSize","grid","tokenPositions","getBlockTiles","drawingPosition","containsStructures","getSceneStructures","getScene","getAllSettlements","getSettlementStructureResult","evaluateStructures","includeCapital","parseWorksite","claimedHexes","commodity","camp","res","parseKingmaker","kingmaker","claimed","farmHexes","parseTileData","tile","parseDimensions","getWorksitesInTiles","worksiteType","tilesInPos","commodityType","lumberCamp","mine","quarry","luxuryWorksite","mergeWorksites","parseSceneTiles","claimedPositions","nonClaimedPositions","worksites","nonClaimed","parseSceneData","findStolenLandsScene","visible","shape","viewed","structureResult","leadershipActivityNumber","unlockedActivities","capitalSettlement","settlementAndScene","builtInRefs","refSchema","levels","KingdomApp","kingdomData","sizeData","unlockedSettlementActivities","totalConsumption","farmSurplus","getConsumption","useXpHomebrew","homebrewSkillIncreases","getCompanionUnlockActivities","hideActivities","getPerformableActivities","groupKingdomActivities","currentSceneId","getCurrentScene","canAddSettlement","canAddRealm","showAddRealmButton","showRealmData","heartlandLabel","unrestPenalty","anarchyAt","calculateAnarchy","resourceDiceNum","getResourceDiceNum","getRuin","getCommodities","getWorkSites","calculateSkills","getLeaders","getAbilities","fameTypes","fameLabel","getFameLabel","getFeats","tradeAgreementsSize","heartlands","actorTypes","isOvercrowded","lacksBridge","isCapital","groupRelationTypes","enableCompanionActivities","createActivityLabel","regionActivities","armyActivities","featureNames","canLevelUp","eventDC","calculateEventDC","cultEventDC","calculateCultEventDC","civicPlanning","fameType","skillsTab","turnTab","groupsTab","featsTab","notesTab","settlementsTab","unpackFormArray","milestone","reduceRuin","kingdomSizeDialog","settlementSizeDialog","upkeepGainFame","adjustUnrest","collectResources","reduceUnrest","payConsumption","checkForEvent","checkForCultEvent","rollKingdomEvent","rollCultEvent","claimedHexFeature","showStructureBrowser","viewSettlementScene","addOngoingEventDialog","deleteKingdomPropertyAtIndex","increaseXP","calculateEventXP","useHomeBrew","calculateHexXP","useVK","calculateRpXP","rpToXpConversionRate","addGroupDialog","manageKingdomActivitiesDialog","showHelpDialog","endTurn","help","newSettlement","showSettlement","addEffectDialog","showKingdomSettings","editSettlementDialog","savedData","consumeIds","overcrowdedSettlements","secondaryTerritories","rulerVacancyUnrest","newUnrest","ruinRoll","property","deleteIndex","deleteAt","rolledPoints","rollResourceDice","calculateCommoditiesThisTurn","featDice","sites","canReduce","commoditiesNextRound","storageCapacity","isCompanion","investedBonus","calculateInvestedBonus","levelFeats","takenFeatsByLevel","noFeat","featLevel","existingFeat","takenAt","featIds","currentFood","missingFood","pay","feature","unrestRoll","ctrlKey","activate","view","showKingdom","getDefaultKingdomData","abilityModifier","createAbilityModifier","proficiencyModifier","createProficiencyModifier","vacancyModifiers","createVacancyModifiers","investedModifier","createInvestedModifier","structureModifiers","createStructureModifiers","unrestModifier","createUnrestModifier","ruinModifier","createRuinModifier","processModifiers","skillLabel","abilityLabel","currentKingdom","makeRuinPenaltiesPositive","existingKingdom","existingMilestones","existingMap","newMap","existingVal","newVal","giveMilestoneXP","idFunction","groupStructures","structureOccurrences","calculateItemLevelGroupBonus","stackMode","structureValues","unionizeStructures","simplifiedRules","simplifyRules","getSettlementConfig","mergeBonuses","skillValue","mergePartialObjects","filteredActivities","groupByItemType","superCategory","categories","superCategoryBonus","category","itemLevelBonus","requiredKingdomLevel","settlementData","consumptionPerUniqueBuilding","existingReduction","newReduction","calculateConsumptionReduction","divine","alchemical","primal","occult","arcane","magical","luxuryOccult","luxuryArcane","luxuryDivine","luxuryMagical","luxuryPrimal","unionizedStructures","structureStorage","applyStorageIncreases","groupedStructures","allGroupedStructures","allSkillBonusRules","skillOnlyBonusRules","skillOnlyBonuses","existingValue","stackAllStructureBonuses","applyUnlockedActivities","applySettlementEventBonuses","applyLeadershipActivityBonuses","applySkillBonusRules","defaultPenalty","otherBonuses","alchemicalBonuses","luxuryBonuses","magicalBonuses","divineBonuses","primalBonuses","arcaneBonuses","occultBonuses","applyItemLevelRules","additionalMagicItemLevel","awardXPDialog","cancel","confirm","currentXP","currentLevel","addLevels","xpGain","speaker","getSpeaker","OTHER","awardXP","contents","points","point","heroPoints","awardPoints","resetPoints","migrations","Migration2","Migration3","Migration4","Migration5","Migration6","Migration7","Migration8","currentVersion","latestMigration","backup","createBackups","migrationsToRun","migration","migrateKingdom","migrateCamping","migrateOther","Migration","fameNext","migrateActivity","targetAll","isNullable","getWorldTables","tables","getWorldTableUuidMappings","findCompendiumTableUuid","compendiumName","buildUuids","compendium","documents","getDocuments","worldUuid","compendiumUuid","tableUuid","RollTable","namespace","settingsKey","rollSkillCheck","checkDc","check","getActiveExplorationEffects","use","skillInput","dcInput","previousTime","toTimeOfDay","body","timeInput","timeValue","currentTime","TimeOfDay","diffSeconds","localStorage","setItem","getItem","retract","TimeChangeMode","RETRACT","ADVANCE","isNegative","padZero","TimeUnit","TimeOfYear","static","targetTime","targetDayDifference","diffDays","elapsedSeconds","timeFormats","AR","yearOffset","Era","Months","pr","PluralRules","suffixes","calculateYear","Weekdays","select","formatOrdinals","getDegreePart","strikeThrough","word","toUpperCase","uncapitalize","replaceAll","createLabel","createTextNode","users","character","getDegreeHeader","obj1","obj2","conflictFunction","criterion","elem","modules","jsonString","publicroll","gmroll","blindroll","selfroll","allWeatherNames","weather","syncWeather","syncWeatherPlaylist","getWeatherSettings","setWeatherSettings","setWeather","rollOnWeatherEventTable","averagePartyLevel","weatherHazardRange","rollTwice","displayChat","messageOptions","postMessage","getRollMode","members","worldClock","getSeason","hasPrecipitation","isCold","rollWeatherEvent","rollWeather","kingmakerModuleWeather","getWeatherSoundFX","overridenPlaylist","kingmakerModuleSound","playlistSourceId","soundName","applyWeatherSound","effectName","currentWeather","tracksToStop","stopWeatherEffects","playWeatherEffect","getSceneWeather","syncSceneWeather","syncScenePlaylist","weatherEffect","activeScene","getWeatherPlaylist","currentScene","deltaInSeconds","isEnabled","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getKingdomSheetActor","ifKingdomActorExists","Game","gameInstance","pf2eKingmakerTools","macros","toggleWeatherMacro","toggleWeather","realmTileDialogMacro","realmTileDialog","toggleShelteredMacro","toggleSheltered","setCurrentWeatherMacro","setCurrentWeatherDialog","structureTokenMappingMacro","structureTokenMappingDialog","sceneWeatherSettingsMacro","sceneWeatherSettingsDialog","toTimeOfDayMacro","toggleCombatTracksMacro","stopCombat","setSceneCombatPlaylistDialogMacro","showSetSceneCombatPlaylistDialog","kingdomEventsMacro","rollKingmakerWeatherMacro","rollKingmakerWeather","viewKingdomMacro","awardXpMacro","showAwardXPDialog","resetHeroPointsMacro","resetHeroPoints","awardHeroPointsMacro","awardHeroPoints","editArmyStatisticsMacro","rollExplorationSkillCheck","rollSkillDialog","configuredActors","actorNames","editStructureMacro","showStructureEditDialog","baseActor","scope","Boolean","choices","requiresReload","tileBased","delta","dayHasChanged","onRenderScene","onPreUpdateScene","onUpdateScene","checkBeginCombat","onPreUpdateArmy","onPostUpdateArmy","onCreateArmyItem","updateAmmunition","updateConsumption","forceUpdateConsumption","checkKingdomErrors","checkCampingErrors","listeners","criticalFailUuids","listener","loadTemplates","updateSource","bindCampingChatEventListeners","hasActor","hasContentLink","hasMeta","canChangeDegree","chatMessage","cantChangeDegreeUnless","canReRollUsingFame","canReRollUsingCreativeSolution","canReRollUsingSupernaturalSolution","reRoll","changeDegree","innerText","addOngoingEvent"],"sourceRoot":""}