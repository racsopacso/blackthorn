/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={d:(r,o)=>{for(var i in o)t.o(o,i)&&!t.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:o[i]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _toPropertyKey(t){var r=function _toPrimitive(t,r){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===_typeof(r)?r:String(r)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,o)}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}t.d({},{xg:()=>$,h8:()=>H,Do:()=>N,Eh:()=>z});var r=function(){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}(HandlebarsApplication,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var t=_createSuper(HandlebarsApplication);function HandlebarsApplication(){return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,HandlebarsApplication),t.apply(this,arguments)}return function _createClass(t,r,o){return r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(HandlebarsApplication,[{key:"APP_ID",get:function get(){return this.constructor.APP_ID}}],[{key:"APP_ID",get:function get(){return this.name.split(/(?=[A-Z])/).join("-").toLowerCase()}},{key:"DEFAULT_OPTIONS",get:function get(){return{tag:"div",window:{frame:!0,positioned:!0,icon:"",controls:[],minimizable:!0,resizable:!1,contentTag:"section",contentClasses:[]},actions:{},form:{handler:void 0,submitOnChange:!1,closeOnSubmit:!1},position:{width:560,height:"auto"}}}}]),HandlebarsApplication}();function utils_confirm(t,r){return t=l(t),r=l(r),foundry.applications.api.DialogV2.confirm({window:{title:t},content:r})}function mergeClone(t,r){return t=foundry.utils.deepClone(t),r=foundry.utils.deepClone(r),foundry.utils.mergeObject(t,r)}function getProperty(t,r){return foundry.utils.getProperty(t,r)}function l(t){return game.i18n.localize(t)}function formBuilder_typeof(t){return formBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formBuilder_typeof(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,p=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){p=!0,c=t},f:function f(){try{u||null==o.return||o.return()}finally{if(p)throw c}}}}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=formBuilder_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},_get.apply(this,arguments)}function formBuilder_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&formBuilder_setPrototypeOf(t,r)}function formBuilder_setPrototypeOf(t,r){return formBuilder_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},formBuilder_setPrototypeOf(t,r)}function formBuilder_createSuper(t){var r=function formBuilder_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=formBuilder_getPrototypeOf(t);if(r){var a=formBuilder_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function formBuilder_possibleConstructorReturn(t,r){if(r&&("object"===formBuilder_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return formBuilder_assertThisInitialized(t)}(this,o)}}function formBuilder_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function formBuilder_getPrototypeOf(t){return formBuilder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},formBuilder_getPrototypeOf(t)}function formBuilder_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function formBuilder_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?formBuilder_ownKeys(Object(o),!0).forEach((function(r){formBuilder_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):formBuilder_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function formBuilder_defineProperty(t,r,o){return(r=formBuilder_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==formBuilder_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function _asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function formBuilder_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function formBuilder_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,formBuilder_toPropertyKey(i.key),i)}}function formBuilder_createClass(t,r,o){return r&&formBuilder_defineProperties(t.prototype,r),o&&formBuilder_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function formBuilder_toPropertyKey(t){var r=function formBuilder_toPrimitive(t,r){if("object"!==formBuilder_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==formBuilder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===formBuilder_typeof(r)?r:String(r)}function _classPrivateMethodInitSpec(t,r){_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,o){_checkPrivateRedeclaration(t,r),r.set(t,o)}function _checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function _classPrivateFieldSet(t,r,o){return function _classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,_classExtractFieldDescriptor(t,r,"set"),o),o}function _classPrivateFieldGet(t,r){return function _classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,_classExtractFieldDescriptor(t,r,"get"))}function _classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var o="6uy8g1tXqHlhlp65dhiL-genericFormHelper-"+N,i=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,p=new WeakMap,h=new WeakMap,d=new WeakMap,y=new WeakMap,v=new WeakSet,g=function(){function FormBuilder(){formBuilder_classCallCheck(this,FormBuilder),_classPrivateMethodInitSpec(this,v),_classPrivateFieldInitSpec(this,i,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,a,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,c,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,u,{writable:!0,value:{position:{width:560,height:"auto"},window:{}}}),_classPrivateFieldInitSpec(this,p,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,h,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,d,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,y,{writable:!0,value:null}),this.submitButton()}var t,r;return formBuilder_createClass(FormBuilder,[{key:"app",get:function get(){return _classPrivateFieldGet(this,y)}},{key:"render",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var t;return _regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return(t=this.form()).render(!0),r.abrupt("return",t.promise);case 3:case"end":return r.stop()}}),_callee,this)}))),function render(){return r.apply(this,arguments)})},{key:"form",value:function form(){if(_classPrivateFieldGet(this,y))return _classPrivateFieldGet(this,y);var t=new B({tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,c),options:_classPrivateFieldGet(this,u)});return _classPrivateFieldSet(this,y,t),t}},{key:"getHTML",value:function getHTML(){var t=this.form()._prepareContext();return B.registerPartial(),renderTemplate(o,t)}},{key:"getAsClass",value:function getAsClass(t){var r=formBuilder_objectSpread(formBuilder_objectSpread({},t),{},{tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,c),options:_classPrivateFieldGet(this,u)});return function(t){formBuilder_inherits(_class,t);var o=formBuilder_createSuper(_class);function _class(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return formBuilder_classCallCheck(this,_class),o.call(this,formBuilder_objectSpread(formBuilder_objectSpread({},r),t))}return formBuilder_createClass(_class)}(B)}},{key:"onRender",value:function onRender(t){return _classPrivateFieldGet(this,u).onRender=t,this}},{key:"registerAsMenu",value:function registerAsMenu(){var t,r,o,i,a,c,u,p,h,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},y=d.moduleId,v=d.key,g=d.name,m=d.label,_=d.icon,b=d.hint,w=d.scope,P=d.restricted,B=d.defaultValue,S=d.onChange,k=d.requiresReload;null!==(t=y)&&void 0!==t||(y=N),null!==(r=w)&&void 0!==r||(w="world"),null!==(o=P)&&void 0!==o||(P=!0),null!==(i=B)&&void 0!==i||(B={}),null!==(a=v)&&void 0!==a||(v="settings"),null!==(c=_)&&void 0!==c||(_="fas fa-cogs"),null!==(u=m)&&void 0!==u||(m="Configure"),null!==(p=g)&&void 0!==p||(g="Configuration Menu"),null!==(h=b)&&void 0!==h||(b="Configure the module settings");var x={settingsMenu:{requiresReload:k,onChange:S,moduleId:y,key:v}},O=this.getAsClass(x);return game.settings.registerMenu(y,v+"-menu",{name:g,label:m,hint:b,icon:_,scope:w,restricted:P,type:O}),game.settings.register(y,v,{scope:w,config:!1,default:B,type:Object,onChange:S,requiresReload:k}),{getSetting:function getSetting(){return game.settings.get(y,v)},setSetting:function setSetting(t){return game.settings.set(y,v,t)}}}},{key:"insertHTML",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(t,r){var o,i,a,c,u,p=arguments;return _regeneratorRuntime().wrap((function _callee2$(h){for(;;)switch(h.prev=h.next){case 0:return o=p.length>2&&void 0!==p[2]?p[2]:"afterend",h.next=3,this.getHTML();case 3:if(i=h.sent,(a=document.createElement("div")).innerHTML=i,c=a.children[0],u=r?t.querySelector(r):t){h.next=10;break}throw new Error("Element ".concat(r," not found"));case 10:return u.insertAdjacentElement(o,c),h.abrupt("return",c);case 12:case"end":return h.stop()}}),_callee2,this)}))),function insertHTML(r,o){return t.apply(this,arguments)})},{key:"title",value:function title(t){return _classPrivateFieldGet(this,u).window.title=t,this}},{key:"resizable",value:function resizable(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return _classPrivateFieldGet(this,u).window.resizable=t,this}},{key:"info",value:function info(t){return _classPrivateFieldGet(this,u).info=t,this}},{key:"object",value:function object(t){return _classPrivateFieldSet(this,d,t),this}},{key:"size",value:function size(t){var r=t.width,o=t.height;return _classPrivateFieldGet(this,u).position={width:null!=r?r:560,height:null!=o?o:"auto"},this}},{key:"submitButton",value:function submitButton(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enabled,o=void 0===r||r,i=t.label,a=void 0===i?"Confirm":i,u=t.icon,submitButton={type:"submit",action:"submit",icon:void 0===u?"fa-solid fa-check":u,label:a};return o?_classPrivateFieldGet(this,c).push(submitButton):_classPrivateFieldSet(this,c,_classPrivateFieldGet(this,c).filter((function(t){return"submit"!==t.action}))),this}},{key:"tab",value:function tab(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.id,a=r.group,c=r.icon,u=r.label,h=r.active,d=void 0!==h&&h;if(null!==(t=a)&&void 0!==t||(a="sheet"),!o&&_classPrivateFieldGet(this,p))return _classPrivateFieldSet(this,p,null),this;if(!o)throw new Error("You must provide an id for the tab");var tab={id:o,group:a,icon:c,label:u,active:d,fields:[]};return _classPrivateFieldGet(this,i).push(tab),_classPrivateFieldSet(this,p,tab),this}},{key:"fieldset",value:function fieldset(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).legend;if(!t&&_classPrivateFieldGet(this,h))return _classPrivateFieldSet(this,h,null),this;if(!t)throw new Error("You must provide a legend for the fieldset");var fieldset={legend:t,fieldset:!0,fields:[]};return _classPrivateMethodGet(this,v,_addField2).call(this,fieldset),_classPrivateFieldSet(this,h,fieldset),this}},{key:"html",value:function html(t){var r={html:t};return _classPrivateMethodGet(this,v,_addField2).call(this,r),this}},{key:"text",value:function text(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.StringField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"number",value:function number(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c=t.min,u=t.max,p=t.step,h={field:new foundry.data.fields.NumberField,name:r,label:o,hint:i,value:a,min:c,max:u,step:p};return _classPrivateMethodGet(this,v,_addField2).call(this,h),this}},{key:"checkbox",value:function checkbox(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.BooleanField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"color",value:function color(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.ColorField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"file",value:function file(t){var r,o=t.name,i=t.type,a=t.label,c=t.hint,u=t.value;null!==(r=i)&&void 0!==r||(i="imagevideo");var p=m[i],h=new foundry.data.fields.FilePathField({categories:p});h.categories=[i];var d={field:h,name:o,label:a,hint:c,type:i,value:u};return _classPrivateMethodGet(this,v,_addField2).call(this,d),this}},{key:"select",value:function select(t){var r,o=t.name,i=t.label,a=t.hint,c=t.value,u=t.options,p={field:inferSelectDataType(u)===Number?new foundry.data.fields.NumberField({choices:u,required:!0}):new foundry.data.fields.StringField({choices:u,required:!0,blank:!1}),name:o,label:i,hint:a,value:null!=c?c:null===(r=u[0])||void 0===r?void 0:r.key,options:u};return _classPrivateMethodGet(this,v,_addField2).call(this,p),this}},{key:"multiSelect",value:function multiSelect(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c=t.options,u=inferSelectDataType(c)===Number?new foundry.data.fields.NumberField({choices:c,nullable:!1}):new foundry.data.fields.StringField({choices:c,nullable:!1}),p={field:new foundry.data.fields.SetField(u),name:r,label:o,hint:i,value:a,options:c};return _classPrivateMethodGet(this,v,_addField2).call(this,p),this}},{key:"editor",value:function editor(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.HTMLField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"textArea",value:function textArea(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.JSONField,name:r,label:o,hint:i,value:a,stacked:!0};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"script",value:function script(t){var r=t.name,o=t.label,i=t.hint,a=t.value,c={field:new foundry.data.fields.JavaScriptField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,v,_addField2).call(this,c),this}},{key:"uuid",value:function uuid(t){var r,o=t.name,i=t.label,a=t.hint,c=t.value,u=t.type,p=t.multiple,h={field:new foundry.data.fields.DocumentUUIDField({},{type:u}),name:o,label:i,hint:a,value:c,type:u,multiple:p};return r=p?{field:new foundry.data.fields.SetField(h.field),name:o,label:i,hint:a,value:c,multiple:p}:h,_classPrivateMethodGet(this,v,_addField2).call(this,r),this}},{key:"button",value:function button(t){var r,o=t.label,i=t.action,a=t.icon,u=t.callback;null!==(r=i)&&void 0!==r||(i=foundry.utils.randomID());var button={action:i,type:"button",icon:a,label:o,callback:u};return _classPrivateFieldGet(this,c).push(button),this}}]),FormBuilder}();function _addField2(t){if(_classPrivateFieldGet(this,d)&&t.name){var r=foundry.utils.getProperty(_classPrivateFieldGet(this,d),t.name);void 0!==r&&(t.value=r)}return _classPrivateFieldGet(this,h)?_classPrivateFieldGet(this,h).fields.push(t):_classPrivateFieldGet(this,p)?_classPrivateFieldGet(this,p).fields.push(t):_classPrivateFieldGet(this,a).push(t)}var m={imagevideo:["IMAGE","VIDEO"],image:["IMAGE"],video:["VIDEO"],audio:["AUDIO"],font:["FONT"],graphics:["GRAPHICS"]};function inferSelectDataType(t){var r=Array.isArray(t)?t.map((function(t){return t.key})):Object.keys(t);try{if(r.every((function(t){return"number"==typeof JSON.parse(t)})))return Number}catch(t){return String}return String}var _=new WeakMap,b=new WeakMap,w=new WeakMap,P=new WeakSet,B=function(){formBuilder_inherits(FormHelper,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var t=formBuilder_createSuper(FormHelper);function FormHelper(r){var o;formBuilder_classCallCheck(this,FormHelper);var i={};return r.buttons.forEach((function(t){return i[t.action]=t.callback})),_classPrivateMethodInitSpec(formBuilder_assertThisInitialized(o=t.call(this,formBuilder_objectSpread({actions:i},r.options))),P),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),_,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),b,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),w,{writable:!0,value:void 0}),FormHelper.registerPartial(),o.menu=r.settingsMenu,o.resolve,o.reject,o.promise=new Promise((function(t,r){o.resolve=t,o.reject=r})),o.onRenderFunction=r.options.onRender,_classPrivateFieldSet(formBuilder_assertThisInitialized(o),w,r.options.info),o.processFormStructure(r),o}return formBuilder_createClass(FormHelper,[{key:"processFormStructure",value:function processFormStructure(t){var r,o,i,a=this.menu?game.settings.get(this.menu.moduleId,this.menu.key):{},c=!!this.menu;if(null!==(r=t.tabs)&&void 0!==r&&r.length){this.__tabs={},t.tabs.find((function(t){return t.active}))||(t.tabs[0].active=!0);var u,p=_createForOfIteratorHelper(t.tabs);try{for(p.s();!(u=p.n()).done;){var h,d,y=u.value;if(this.__tabs[y.id]={id:y.id,group:y.group,icon:y.icon,label:y.label,active:null!==(h=y.active)&&void 0!==h&&h,fields:null!==(d=y.fields)&&void 0!==d?d:[]},c){var v,g,m=_createForOfIteratorHelper(null!==(v=y.fields)&&void 0!==v?v:[]);try{for(m.s();!(g=m.n()).done;){var w=g.value,P=foundry.utils.getProperty(a,w.name);void 0!==P&&(w.value=P)}}catch(t){m.e(t)}finally{m.f()}}}}catch(t){p.e(t)}finally{p.f()}}if(c){var B,S,k=_createForOfIteratorHelper(null!==(B=t.fields)&&void 0!==B?B:[]);try{for(k.s();!(S=k.n()).done;){var x=S.value,O=foundry.utils.getProperty(a,x.name);void 0!==O&&(x.value=O)}}catch(t){k.e(t)}finally{k.f()}}_classPrivateFieldSet(this,_,null!==(o=t.fields)&&void 0!==o?o:[]),_classPrivateFieldSet(this,b,null!==(i=t.buttons)&&void 0!==i?i:[])}},{key:"_onClose",value:function _onClose(t){_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onClose",this).call(this,t),this.promise.resolved||this.resolve(!1)}},{key:"_prepareContext",value:function _prepareContext(t){return{tabs:_classPrivateMethodGet(this,P,_getTabs2).call(this),fields:_classPrivateFieldGet(this,_),info:_classPrivateFieldGet(this,w),buttons:[].concat(_toConsumableArray(_classPrivateFieldGet(this,b).filter((function(t){return"submit"!==t.type}))),_toConsumableArray(_classPrivateFieldGet(this,b).filter((function(t){return"submit"===t.type}))))}}},{key:"_onRender",value:function _onRender(t,r){_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onRender",this).call(this,t,r),this.__tabs||this.element.querySelector("nav").classList.add("hidden"),this.onRenderFunction&&this.onRenderFunction.bind(this)(t,r)}},{key:"changeTab",value:function changeTab(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(t=_get(formBuilder_getPrototypeOf(FormHelper.prototype),"changeTab",this)).call.apply(t,[this].concat(o))}},{key:"_onChangeForm",value:function _onChangeForm(t,r){_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onChangeForm",this).call(this,t,r);new FormDataExtended(this.element)}},{key:"getFormData",value:function getFormData(){var t=new FormDataExtended(this.element);return foundry.utils.expandObject(t.object)}}],[{key:"registerPartial",value:function registerPartial(){if(!Handlebars.partials[o]){var t=Handlebars.compile(k);Handlebars.registerPartial(o,t)}}}]),FormHelper}();function _getTabs2(){for(var t,r=null!==(t=this.__tabs)&&void 0!==t?t:{},o=0,i=Object.values(r);o<i.length;o++){var a=i[o];if(a.cssClass=a.active?"active":"",a.active)break}return r}function _onSubmit3(){return(_onSubmit3=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(t,r,o){var i;return _regeneratorRuntime().wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(i=foundry.utils.expandObject(o.object),this.resolve(i),!this.menu){t.next=6;break}return this.menu.requiresReload&&SettingsConfig.reloadConfirm(),this.menu.onChange&&this.menu.onChange(i),t.abrupt("return",game.settings.set(this.menu.moduleId,this.menu.key,i));case 6:case"end":return t.stop()}}),_callee3,this)})))).apply(this,arguments)}formBuilder_defineProperty(B,"DEFAULT_OPTIONS",{classes:["form-helper"],tag:"form",window:{contentClasses:["standard-form"]},position:{width:560,height:"auto"},form:{handler:function _classStaticPrivateMethodGet(t,r,o){return function _classCheckPrivateStaticAccess(t,r){if(t!==r)throw new TypeError("Private static access of wrong provenance")}(t,r),o}(B,B,(function _onSubmit(t,r,o){return _onSubmit3.apply(this,arguments)})),closeOnSubmit:!0},actions:{}}),formBuilder_defineProperty(B,"PARTS",{tabs:{template:"templates/generic/tab-navigation.hbs"},genericForm:{template:o,classes:["standard-form","scrollable"]},footer:{template:"templates/generic/form-footer.hbs"}});var S="\n    {{#if field.fieldset}}\n    <fieldset>\n        <legend>{{localize field.legend}}</legend>\n        {{#each field.fields as |f|}}\n        {{#if f.html}}{{{f.html}}}{{else}}\n        {{formField f.field stacked=f.stacked type=f.type label=f.label hint=f.hint name=f.name value=f.value min=f.min max=f.max step=f.step localize=true}}\n        {{/if}}\n        {{/each}}\n    </fieldset>\n    {{else}}\n    {{#if field.html}}{{{field.html}}}{{else}}\n    {{formField field.field stacked=field.stacked multiple=field.multiple type=field.type label=field.label hint=field.hint name=field.name value=field.value min=field.min max=field.max step=field.step localize=true}}\n    {{/if}}\n    {{/if}}\n        ",k='<div>\n    {{#if info}}{{{info}}}{{/if}}\n    {{#each tabs as |tab|}}\n\n    <section class="tab standard-form scrollable {{tab.cssClass}}" data-tab="{{tab.id}}" data-group="{{tab.group}}">\n        {{#each tab.fields as |field|}}\n        '.concat(S,"\n        {{/each}}\n    </section>\n\n    {{/each}}\n\n    {{#each fields as |field|}}\n    ").concat(S,"\n    {{/each}}\n</div>");function BarStyleConfiguration_typeof(t){return BarStyleConfiguration_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BarStyleConfiguration_typeof(t)}function BarStyleConfiguration_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function BarStyleConfiguration_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?BarStyleConfiguration_ownKeys(Object(o),!0).forEach((function(r){BarStyleConfiguration_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):BarStyleConfiguration_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function BarStyleConfiguration_defineProperty(t,r,o){return(r=BarStyleConfiguration_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function BarStyleConfiguration_regeneratorRuntime(){BarStyleConfiguration_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==BarStyleConfiguration_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function BarStyleConfiguration_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function BarStyleConfiguration_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){BarStyleConfiguration_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){BarStyleConfiguration_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function BarStyleConfiguration_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,BarStyleConfiguration_toPropertyKey(i.key),i)}}function BarStyleConfiguration_toPropertyKey(t){var r=function BarStyleConfiguration_toPrimitive(t,r){if("object"!==BarStyleConfiguration_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==BarStyleConfiguration_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===BarStyleConfiguration_typeof(r)?r:String(r)}function BarStyleConfiguration_get(){return BarStyleConfiguration_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function BarStyleConfiguration_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=BarStyleConfiguration_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},BarStyleConfiguration_get.apply(this,arguments)}function BarStyleConfiguration_setPrototypeOf(t,r){return BarStyleConfiguration_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},BarStyleConfiguration_setPrototypeOf(t,r)}function BarStyleConfiguration_createSuper(t){var r=function BarStyleConfiguration_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=BarStyleConfiguration_getPrototypeOf(t);if(r){var a=BarStyleConfiguration_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function BarStyleConfiguration_possibleConstructorReturn(t,r){if(r&&("object"===BarStyleConfiguration_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function BarStyleConfiguration_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,o)}}function BarStyleConfiguration_getPrototypeOf(t){return BarStyleConfiguration_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},BarStyleConfiguration_getPrototypeOf(t)}var x=function(t){!function BarStyleConfiguration_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&BarStyleConfiguration_setPrototypeOf(t,r)}(BarStyleConfiguration,t);var r,o,i,a,c=BarStyleConfiguration_createSuper(BarStyleConfiguration);function BarStyleConfiguration(){return function BarStyleConfiguration_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,BarStyleConfiguration),c.call(this)}return function BarStyleConfiguration_createClass(t,r,o){return r&&BarStyleConfiguration_defineProperties(t.prototype,r),o&&BarStyleConfiguration_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(BarStyleConfiguration,[{key:"_prepareContext",value:(a=BarStyleConfiguration_asyncToGenerator(BarStyleConfiguration_regeneratorRuntime().mark((function _callee(t){return BarStyleConfiguration_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{styles:getSetting("barStyles")});case 1:case"end":return t.stop()}}),_callee)}))),function _prepareContext(t){return a.apply(this,arguments)})},{key:"_onRender",value:function _onRender(t,r){var o=this;BarStyleConfiguration_get(BarStyleConfiguration_getPrototypeOf(BarStyleConfiguration.prototype),"_onRender",this).call(this,t,r);var i=this.element;i.querySelectorAll(".edit-style").forEach((function(t){t.addEventListener("click",(function(t){var r=t.currentTarget.dataset.styleId;o._onEdit(r)}))})),i.querySelectorAll(".delete-style").forEach((function(t){t.addEventListener("click",(function(t){var r=t.currentTarget.dataset.styleId;o._onDelete(r)}))})),i.querySelector(".add-style").addEventListener("click",(function(t){o._onAdd()}))}},{key:"_onEdit",value:(i=BarStyleConfiguration_asyncToGenerator(BarStyleConfiguration_regeneratorRuntime().mark((function _callee2(t){var r,o,i,a,c;return BarStyleConfiguration_regeneratorRuntime().wrap((function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:if(r=getSetting("barStyles").find((function(r){return r.id===t})),r){u.next=3;break}return u.abrupt("return");case 3:return o=mergeClone(A,r),u.next=6,(new g).title(l("".concat(N,".").concat(this.APP_ID,".edit"))+": ".concat(o.name)).object(o).text({name:"name",label:"Name"}).file({name:"background",label:"".concat(N,".").concat(this.APP_ID,".background")}).file({name:"bar",label:"".concat(N,".").concat(this.APP_ID,".bar")}).file({name:"foreground",label:"".concat(N,".").concat(this.APP_ID,".foreground")}).color({name:"tempBarColor",label:"".concat(N,".").concat(this.APP_ID,".tempBarColor")}).number({name:"tempBarAlpha",label:"".concat(N,".").concat(this.APP_ID,".tempBarAlpha"),min:0,max:1,step:.01}).number({name:"barHeight",label:"".concat(N,".").concat(this.APP_ID,".barHeight"),min:5,max:100,step:1}).select({name:"font",label:"".concat(N,".").concat(this.APP_ID,".font"),options:FontConfig.getAvailableFontChoices()}).number({name:"textSize",label:"".concat(N,".").concat(this.APP_ID,".textSize"),min:5,max:100,step:1}).select({name:"textAlign",label:"".concat(N,".").concat(this.APP_ID,".textAlign"),options:z}).select({name:"type",label:"".concat(N,".").concat(this.APP_ID,".type"),hint:"".concat(N,".").concat(this.APP_ID,".type-hint"),options:H}).render();case 6:if(i=u.sent){u.next=9;break}return u.abrupt("return");case 9:return a=getSetting("barStyles"),c=a.find((function(r){return r.id===t})),Object.keys(i).forEach((function(t){c[t]=i[t]})),u.next=14,setSetting("barStyles",a);case 14:this.render();case 15:case"end":return u.stop()}}),_callee2,this)}))),function _onEdit(t){return i.apply(this,arguments)})},{key:"_onDelete",value:(o=BarStyleConfiguration_asyncToGenerator(BarStyleConfiguration_regeneratorRuntime().mark((function _callee3(t){var r;return BarStyleConfiguration_regeneratorRuntime().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,utils_confirm("".concat(N,".").concat(this.APP_ID,".delete-title"),"".concat(N,".").concat(this.APP_ID,".delete-confirm"));case 2:if(o.sent){o.next=5;break}return o.abrupt("return");case 5:return r=getSetting("barStyles"),o.next=8,setSetting("barStyles",r.filter((function(r){return r.id!=t})));case 8:this.render();case 9:case"end":return o.stop()}}),_callee3,this)}))),function _onDelete(t){return o.apply(this,arguments)})},{key:"_onAdd",value:(r=BarStyleConfiguration_asyncToGenerator(BarStyleConfiguration_regeneratorRuntime().mark((function _callee4(){var t,r;return BarStyleConfiguration_regeneratorRuntime().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(new g).size({width:400}).title("".concat(N,".").concat(this.APP_ID,".add")).text({name:"name",label:"Name"}).render();case 2:if((t=o.sent)&&t.name){o.next=5;break}return o.abrupt("return");case 5:return(r=getSetting("barStyles")).push(mergeClone(A,BarStyleConfiguration_objectSpread({id:randomID()},t))),o.next=9,setSetting("barStyles",r);case 9:this.render();case 10:case"end":return o.stop()}}),_callee4,this)}))),function _onAdd(){return r.apply(this,arguments)})},{key:"_onClose",value:function _onClose(t){BarStyleConfiguration_get(BarStyleConfiguration_getPrototypeOf(BarStyleConfiguration.prototype),"_onClose",this).call(this,t)}}],[{key:"DEFAULT_OPTIONS",get:function get(){return mergeClone(BarStyleConfiguration_get(BarStyleConfiguration_getPrototypeOf(BarStyleConfiguration),"DEFAULT_OPTIONS",this),{classes:[this.APP_ID],id:this.APP_ID,window:{title:"".concat(N,".").concat(this.APP_ID,".title"),icon:"fas fa-paint-brush",resizable:!1},position:{width:560,height:"auto"}})}},{key:"PARTS",get:function get(){return{content:{template:"modules/".concat(N,"/templates/").concat(this.APP_ID,".hbs"),classes:["standard-form"],scrollable:[]}}}}]),BarStyleConfiguration}(r);function BossBar_typeof(t){return BossBar_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BossBar_typeof(t)}function BossBar_classPrivateFieldInitSpec(t,r,o){!function BossBar_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,r),r.set(t,o)}function BossBar_classPrivateFieldGet(t,r){return function BossBar_classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,BossBar_classExtractFieldDescriptor(t,r,"get"))}function BossBar_classPrivateFieldSet(t,r,o){return function BossBar_classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,BossBar_classExtractFieldDescriptor(t,r,"set"),o),o}function BossBar_classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}function BossBar_regeneratorRuntime(){BossBar_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==BossBar_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function BossBar_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function BossBar_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function BossBar_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,c=void 0,c=function BossBar_toPrimitive(t,r){if("object"!==BossBar_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==BossBar_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===BossBar_typeof(c)?c:String(c)),i)}var a,c}function BossBar_createClass(t,r,o){return r&&BossBar_defineProperties(t.prototype,r),o&&BossBar_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function BossBar_get(){return BossBar_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function BossBar_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=BossBar_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},BossBar_get.apply(this,arguments)}function BossBar_setPrototypeOf(t,r){return BossBar_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},BossBar_setPrototypeOf(t,r)}function BossBar_createSuper(t){var r=function BossBar_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=BossBar_getPrototypeOf(t);if(r){var a=BossBar_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function BossBar_possibleConstructorReturn(t,r){if(r&&("object"===BossBar_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return BossBar_assertThisInitialized(t)}(this,o)}}function BossBar_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BossBar_getPrototypeOf(t){return BossBar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},BossBar_getPrototypeOf(t)}var O=function(t){!function BossBar_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&BossBar_setPrototypeOf(t,r)}(BossBar,t);var r,o=BossBar_createSuper(BossBar);function BossBar(t){var r;return BossBar_classCallCheck(this,BossBar),r=o.call(this),ui.bossBar&&ui.bossBar.close(),ui.bossBar=BossBar_assertThisInitialized(r),r.scene=null!=t?t:game.scenes.viewed,r.savePosition=foundry.utils.debounce(r.savePosition.bind(BossBar_assertThisInitialized(r)),100),r}return BossBar_createClass(BossBar,[{key:"_prepareContext",value:(r=function BossBar_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){BossBar_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){BossBar_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(BossBar_regeneratorRuntime().mark((function _callee(t){var r,o,i;return BossBar_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return o=null!==(r=this.scene.getFlag(N,"actors"))&&void 0!==r?r:[],i=o.map((function(t){return new j(fromUuidSync(t.uuid),t.style,t.hideName)})),this.actors=new Set(o.map((function(t){return fromUuidSync(t.uuid)}))),this.bars=i,t.abrupt("return",{bars:i});case 5:case"end":return t.stop()}}),_callee,this)}))),function _prepareContext(t){return r.apply(this,arguments)})},{key:"_onActorUpdate",value:function _onActorUpdate(t){this.actors.has(t)&&this.updateBars()}},{key:"updateBars",value:function updateBars(){var t=this;this.bars.forEach((function(r){var o=t.element.querySelector('.bar-list-item[data-uuid="'.concat(r.actor.uuid,'"]'));o&&o.style.setProperty("--bar-percent","".concat(r.hpPercent,"%"))}))}},{key:"_onRender",value:function _onRender(t,r){BossBar_get(BossBar_getPrototypeOf(BossBar.prototype),"_onRender",this).call(this,t,r),foundry.applications.instances.delete(this.APP_ID),game.user.isGM&&this.element.querySelector(".window-header").addEventListener("contextmenu",(function(t){t.preventDefault(),(new D).render(!0)}))}},{key:"setPosition",value:function setPosition(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=(t=BossBar_get(BossBar_getPrototypeOf(BossBar.prototype),"setPosition",this)).call.apply(t,[this].concat(o)),c=this.element.querySelector(".boss-bar-container").offsetWidth;return this.element.style.setProperty("--bar-container-outer-width","".concat(c,"px")),this.savePosition(this.position),a}},{key:"savePosition",value:function savePosition(t){setSetting("barPosition",{width:t.width,left:t.left,top:t.top})}},{key:"_onClose",value:function _onClose(t){BossBar_get(BossBar_getPrototypeOf(BossBar.prototype),"_onClose",this).call(this,t)}}],[{key:"update",value:function update(){var t,r=ui.bossBar,o=game.scenes.viewed,i=null!==(t=o.getFlag(N,"actors"))&&void 0!==t?t:[];return!i.length&&r?r.close():i.length?new BossBar(o).render({position:getSetting("barPosition"),force:!0}):void 0}},{key:"resetPosition",value:function resetPosition(){setSetting("barPosition",{width:BossBar.defaultWidth,height:"auto",top:50,left:BossBar.defaultLeft}),setSetting("resetPosition",!1),BossBar.update()}},{key:"DEFAULT_OPTIONS",get:function get(){return mergeClone(BossBar_get(BossBar_getPrototypeOf(BossBar),"DEFAULT_OPTIONS",this),{classes:[this.APP_ID],id:this.APP_ID,window:{title:"".concat(N,".").concat(this.APP_ID,".title"),icon:"",resizable:!0},position:{width:this.defaultWidth,height:"auto",top:50,left:this.defaultLeft}})}},{key:"defaultSizeMulti",get:function get(){return.8}},{key:"defaultWidth",get:function get(){return document.querySelector("#ui-top").offsetWidth*this.defaultSizeMulti}},{key:"defaultLeft",get:function get(){return document.querySelector("#ui-top").getBoundingClientRect().left+document.querySelector("#ui-top").offsetWidth*(1-this.defaultSizeMulti)/2}},{key:"PARTS",get:function get(){return{content:{template:"modules/".concat(N,"/templates/").concat(this.APP_ID,".hbs"),classes:[],scrollable:[]}}}}]),BossBar}(r),C=new WeakMap,E=new WeakMap,j=function(){function Bar(t,r,o){var i,a;BossBar_classCallCheck(this,Bar),BossBar_classPrivateFieldInitSpec(this,C,{writable:!0,value:void 0}),BossBar_classPrivateFieldInitSpec(this,E,{writable:!0,value:void 0}),BossBar_classPrivateFieldSet(this,C,t),BossBar_classPrivateFieldSet(this,E,null!==(i=null!==(a=getSetting("barStyles").find((function(t){return t.id===r})))&&void 0!==a?a:getSetting("barStyles")[0])&&void 0!==i?i:A),this.hideName=o,this.useWounds=getSetting("woundsSystem")}return BossBar_createClass(Bar,[{key:"actor",get:function get(){return BossBar_classPrivateFieldGet(this,C)}},{key:"style",get:function get(){return BossBar_classPrivateFieldGet(this,E)}},{key:"currentHp",get:function get(){return getProperty(this.actor.system,getSetting("currentHpPath"))}},{key:"maxHp",get:function get(){return getProperty(this.actor.system,getSetting("maxHpPath"))}},{key:"hpPercent",get:function get(){return this.useWounds?Math.max(0,Math.round(100*(this.maxHp-this.currentHp)/this.maxHp)):Math.max(0,Math.round(100*this.currentHp/this.maxHp))}},{key:"name",get:function get(){return this.hideName?"":this.actor.name}},{key:"isClassic",get:function get(){return this.style.type==$.CLASSIC}},{key:"isMatchingImages",get:function get(){return this.style.type==$.MATCHING_IMAGES}},{key:"cssClass",get:function get(){return this.isClassic?"classic":this.isMatchingImages?"matching-images":"classic"}}]),Bar}();function settings_regeneratorRuntime(){settings_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==settings_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function settings_typeof(t){return settings_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},settings_typeof(t)}function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,c,u,p=[],h=!0,d=!1;try{if(c=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;h=!1}else for(;!(h=(i=c.call(o)).done)&&(p.push(i.value),p.length!==r);h=!0);}catch(t){d=!0,a=t}finally{try{if(!h&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(d)throw a}}return p}}(t,r)||function settings_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return settings_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return settings_arrayLikeToArray(t,r)}(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function settings_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function settings_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function settings_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function settings_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?settings_ownKeys(Object(o),!0).forEach((function(r){settings_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):settings_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function settings_defineProperty(t,r,o){return(r=function settings_toPropertyKey(t){var r=function settings_toPrimitive(t,r){if("object"!==settings_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==settings_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===settings_typeof(r)?r:String(r)}(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}var G={},I=!1,A={name:"Classic - Red",id:"default",background:"modules/bossbar/resources/Dark.webp",bar:"modules/bossbar/resources/Blood.webp",foreground:"",tempBarColor:"#7e7e7e",tempBarAlpha:.5,barHeight:20,textSize:20,textAlign:"left",type:0,font:"Times New Roman"},L=[settings_objectSpread(settings_objectSpread({},A),{},{name:"Classic - Ice",id:"default-ice",bar:"modules/bossbar/resources/Ice.webp"}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Classic - Grass",id:"default-grass",bar:"modules/bossbar/resources/Grass.webp"}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Classic - Oak",id:"default-oak",bar:"modules/bossbar/resources/Oak.webp"}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Evil",id:"evil",foreground:"modules/bossbar/resources/matching-images/evil/fg.png",bar:"modules/bossbar/resources/matching-images/evil/bar.png",background:"modules/bossbar/resources/matching-images/evil/bg.png",type:1}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Gears",id:"gears",foreground:"modules/bossbar/resources/matching-images/gears/fg.webp",bar:"modules/bossbar/resources/matching-images/gears/bar.webp",background:"modules/bossbar/resources/matching-images/gears/bg.webp",type:1}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Ooze",id:"ooze",foreground:"modules/bossbar/resources/matching-images/ooze/fg.webp",bar:"modules/bossbar/resources/matching-images/ooze/bar.webp",background:"modules/bossbar/resources/matching-images/ooze/bg.webp",type:1}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Royal",id:"royal",foreground:"modules/bossbar/resources/matching-images/royal/fg.png",bar:"modules/bossbar/resources/matching-images/royal/bar.png",background:"modules/bossbar/resources/matching-images/royal/bg.png",type:1}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Segmented",id:"segmented",foreground:"modules/bossbar/resources/matching-images/segmented/fg.png",bar:"modules/bossbar/resources/matching-images/segmented/bar.png",background:"modules/bossbar/resources/matching-images/segmented/bg.png",type:1}),settings_objectSpread(settings_objectSpread({},A),{},{name:"Steampunk",id:"steampunk",foreground:"modules/bossbar/resources/matching-images/steampunk/fg.png",bar:"modules/bossbar/resources/matching-images/steampunk/bar.png",background:"modules/bossbar/resources/matching-images/steampunk/bg.png",type:1})];function registerSettings(){!function registerSettingsArray(t){for(var r=function _loop(){var t=_slicedToArray(i[o],2),r=t[0],a=t[1];if(a.name||(a.name="".concat(N,".settings.").concat(r,".name")),a.hint||(a.hint="".concat(N,".settings.").concat(r,".hint")),void 0===a.useCache&&(a.useCache=I),a.useCache){var c=a.onChange;a.onChange&&(a.onChange=function(t){G[r]=t,c&&c(t)})}game.settings.register(N,r,a),a.useCache&&(G[r]=getSetting(r))},o=0,i=Object.entries(t);o<i.length;o++)r()}({barStyles:{scope:"world",config:!1,type:Array,default:[settings_objectSpread({},A)].concat(L),onChange:function onChange(){return O.update()}},barPosition:{scope:"client",type:Object,default:{}},resetPosition:{scope:"client",config:!0,type:Boolean,default:!1,onChange:function onChange(t){t&&O.resetPosition()}},currentHpPath:{scope:"world",config:!0,type:String,default:"attributes.hp.value"},maxHpPath:{scope:"world",config:!0,type:String,default:"attributes.hp.max"},woundsSystem:{scope:"world",config:!0,type:Boolean,default:!1}}),game.settings.registerMenu(N,"BarStyleConfiguration",{name:"bossbar.settings.BarStyleConfiguration.name",label:"bossbar.settings.BarStyleConfiguration.label",icon:"fas fa-paint-brush",type:x,restricted:!0})}function getSetting(t){var r;return null!==(r=G[t])&&void 0!==r?r:game.settings.get(N,t)}function setSetting(t,r){return _setSetting.apply(this,arguments)}function _setSetting(){return _setSetting=function settings_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){settings_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){settings_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(settings_regeneratorRuntime().mark((function _callee(t,r){return settings_regeneratorRuntime().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,game.settings.set(N,t,r);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),_callee)}))),_setSetting.apply(this,arguments)}function socket_typeof(t){return socket_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},socket_typeof(t)}function socket_createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function socket_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return socket_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return socket_arrayLikeToArray(t,r)}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,p=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){p=!0,c=t},f:function f(){try{u||null==o.return||o.return()}finally{if(p)throw c}}}}function socket_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function socket_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function socket_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?socket_ownKeys(Object(o),!0).forEach((function(r){socket_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):socket_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function socket_regeneratorRuntime(){socket_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==socket_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function socket_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function socket_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){socket_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){socket_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function socket_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function socket_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,socket_toPropertyKey(i.key),i)}}function socket_createClass(t,r,o){return r&&socket_defineProperties(t.prototype,r),o&&socket_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function socket_defineProperty(t,r,o){return(r=socket_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function socket_toPropertyKey(t){var r=function socket_toPrimitive(t,r){if("object"!==socket_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==socket_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===socket_typeof(r)?r:String(r)}var T=function(){function Socket(){socket_classCallCheck(this,Socket)}var t;return socket_createClass(Socket,null,[{key:"__$onMessage",value:(t=socket_asyncToGenerator(socket_regeneratorRuntime().mark((function _callee(t){var r,o,i,a,c,u,p;return socket_regeneratorRuntime().wrap((function _callee$(h){for(;;)switch(h.prev=h.next){case 0:if(!(r=t.__$socketOptions).__$storeName){h.next=12;break}if(!r.__$request){h.next=10;break}if((o=this.__$stores[r.__$storeName])._isLive){h.next=7;break}return h.abrupt("return");case 7:game.socket.emit("module.".concat(N),{__$socketOptions:{__$storeName:r.__$storeName,user:game.user.id},data:o.getData()}),h.next=11;break;case 10:this.__$stores[r.__$storeName].synchronize(t.data,game.users.get(r.user));case 11:return h.abrupt("return");case 12:if("__$response"!==r.__$eventName){h.next=16;break}return i=r.__$responseKey,this.__$promises[i]&&(this.__$promises[i].resolve({user:game.users.get(r.__$userId),response:t.result}),delete this.__$promises[i]),h.abrupt("return");case 16:if(r.users.includes(game.user.id)){h.next=18;break}return h.abrupt("return");case 18:return a=this.__$callbacks[r.__$eventName],delete t.__$socketOptions,h.next=22,a(t);case 22:c=h.sent,r.response&&(u="".concat(r.__$eventId,".").concat(game.user.id),p={__$socketOptions:{__$eventName:"__$response",__$responseKey:u,__$userId:game.user.id},result:c},this.__$socket.emit("module.".concat(N),p));case 24:case"end":return h.stop()}}),_callee,this)}))),function __$onMessage(r){return t.apply(this,arguments)})},{key:"__$parseUsers",value:function __$parseUsers(t){var r;if(Array.isArray(null===(r=t)||void 0===r?void 0:r.users))return t;"string"==typeof t&&(t={users:t}),Array.isArray(t)&&(t={users:t}),t.users=t.users||this.USERS.ALL;var o=game.users.filter((function(t){return t.active})),i=t.users;return i===this.USERS.ALL?t.users=o.map((function(t){return t.id})):i===this.USERS.GMS?t.users=o.filter((function(t){return t.isGM})).map((function(t){return t.id})):i===this.USERS.PLAYERS?t.users=o.filter((function(t){return!t.isGM})).map((function(t){return t.id})):i===this.USERS.OTHERS?t.users=o.filter((function(t){return t.id!==game.user.id})).map((function(t){return t.id})):i===this.USERS.FIRSTGM?t.users=[game.users.activeGM.id]:i===this.USERS.SELF&&(t.users=[game.user.id]),t}},{key:"register",value:function register(t,r){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.__$socket||(this.__$socket=game.socket,game.socket.on("module.".concat(N),this.__$onMessage.bind(this))),this.__$reserved.includes(t))throw new Error("Socket event name ".concat(t," is reserved"));this.__$callbacks[t]=r;var a=function(){var a=socket_asyncToGenerator(socket_regeneratorRuntime().mark((function _callee3(){var a,c,u,p,h,d,y,v,g,m,_,b,w,P,B=arguments;return socket_regeneratorRuntime().wrap((function _callee3$(S){for(;;)switch(S.prev=S.next){case 0:if(a=B.length>0&&void 0!==B[0]?B[0]:{},c=B.length>1&&void 0!==B[1]?B[1]:{},c=socket_objectSpread(socket_objectSpread({},i),c),c=o.__$parseUsers(c),u=foundry.utils.randomID(),c.__$eventId=u,c.__$eventName=t,p=[],h=c.users.includes(game.user.id),c.users=c.users.filter((function(t){return t!==game.user.id})),!c.response){S.next=28;break}d=socket_createForOfIteratorHelper(c.users),S.prev=12,v=socket_regeneratorRuntime().mark((function _loop(){var t;return socket_regeneratorRuntime().wrap((function _loop$(r){for(;;)switch(r.prev=r.next){case 0:t=y.value,p.push(new Promise((function(r,i){var a="".concat(u,".").concat(t);o.__$promises[a]={resolve:r,reject:i}})));case 2:case"end":return r.stop()}}),_loop)})),d.s();case 15:if((y=d.n()).done){S.next=19;break}return S.delegateYield(v(),"t0",17);case 17:S.next=15;break;case 19:S.next=24;break;case 21:S.prev=21,S.t1=S.catch(12),d.e(S.t1);case 24:return S.prev=24,d.f(),S.finish(24);case 27:setTimeout((function(){var t,r=socket_createForOfIteratorHelper(c.users);try{for(r.s();!(t=r.n()).done;){var i=t.value,a="".concat(u,".").concat(i);o.__$promises[a]&&(o.__$promises[a].reject({user:game.users.get(i),response:"timeout"}),delete o.__$promises[a])}}catch(t){r.e(t)}finally{r.f()}}),c.timeout||3e4);case 28:return a.__$socketOptions=c,o.__$socket.emit("module.".concat(N),a),g=[],h&&(m=function(){var t=socket_asyncToGenerator(socket_regeneratorRuntime().mark((function _callee2(){return socket_regeneratorRuntime().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=game.user,t.next=3,r(a);case 3:return t.t1=t.sent,t.abrupt("return",{user:t.t0,response:t.t1});case 5:case"end":return t.stop()}}),_callee2)})));return function localWrapper(){return t.apply(this,arguments)}}(),p.push(m())),S.next=34,Promise.all(p);case 34:_=S.sent,b=socket_createForOfIteratorHelper(_);try{for(b.s();!(w=b.n()).done;)P=w.value,g.push(P)}catch(t){b.e(t)}finally{b.f()}return S.abrupt("return",g);case 38:case"end":return S.stop()}}),_callee3,null,[[12,21,24,27]])})));return function wrappedCallback(){return a.apply(this,arguments)}}();this[t]=a.bind(this)}},{key:"registerStore",value:function registerStore(t){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.__$reserved.includes(t))throw new Error("Store name ".concat(t," is reserved"));if("object"!==socket_typeof(o))throw new Error("Initial value for store must be an object");return this.__$stores[t]=new R(t,o,i),Object.defineProperty(this,t,{get:function get(){return r.__$stores[t].getData()},set:function set(o){r.__$stores[t].setData(o)}}),this.__$stores[t]}}]),Socket}();socket_defineProperty(T,"__$callbacks",{}),socket_defineProperty(T,"__$stores",{}),socket_defineProperty(T,"__$promises",{}),socket_defineProperty(T,"USERS",{GMS:"gms",PLAYERS:"players",ALL:"all",OTHERS:"others",FIRSTGM:"firstGM",SELF:"self"}),socket_defineProperty(T,"__$reserved",["__$eventName","__$response","__$onMessage","__$parseUsers","register","USERS"]);var R=function(){function SynchronizedStore(t,r,o){socket_classCallCheck(this,SynchronizedStore),this._storeName=t,this._onChange=o,this._data=r,this._timestamp=Date.now(),this._isLive=!1,game.socket.emit("module.".concat(N),{__$socketOptions:{__$storeName:this._storeName,__$request:!0,user:game.user.id}})}return socket_createClass(SynchronizedStore,[{key:"synchronize",value:function synchronize(t){var r;this._data=t,this._timestamp=Date.now(),this._isLive=!0,null===(r=this._onChange)||void 0===r||r.call(this,this.data)}},{key:"getData",value:function getData(){return this._data}},{key:"setData",value:function setData(t){this.synchronize(t),game.socket.emit("module.".concat(N),{__$socketOptions:{__$storeName:this._storeName,user:game.user.id},data:t})}}]),SynchronizedStore}();function BossBarConfiguration_typeof(t){return BossBarConfiguration_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BossBarConfiguration_typeof(t)}function BossBarConfiguration_regeneratorRuntime(){BossBarConfiguration_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==BossBarConfiguration_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function BossBarConfiguration_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function BossBarConfiguration_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){BossBarConfiguration_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){BossBarConfiguration_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function BossBarConfiguration_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,c=void 0,c=function BossBarConfiguration_toPrimitive(t,r){if("object"!==BossBarConfiguration_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==BossBarConfiguration_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===BossBarConfiguration_typeof(c)?c:String(c)),i)}var a,c}function BossBarConfiguration_get(){return BossBarConfiguration_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function BossBarConfiguration_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=BossBarConfiguration_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},BossBarConfiguration_get.apply(this,arguments)}function BossBarConfiguration_setPrototypeOf(t,r){return BossBarConfiguration_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},BossBarConfiguration_setPrototypeOf(t,r)}function BossBarConfiguration_createSuper(t){var r=function BossBarConfiguration_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=BossBarConfiguration_getPrototypeOf(t);if(r){var a=BossBarConfiguration_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function BossBarConfiguration_possibleConstructorReturn(t,r){if(r&&("object"===BossBarConfiguration_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return BossBarConfiguration_assertThisInitialized(t)}(this,o)}}function BossBarConfiguration_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BossBarConfiguration_getPrototypeOf(t){return BossBarConfiguration_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},BossBarConfiguration_getPrototypeOf(t)}function BossBarConfiguration_classPrivateFieldInitSpec(t,r,o){!function BossBarConfiguration_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,r),r.set(t,o)}function BossBarConfiguration_classPrivateFieldGet(t,r){return function BossBarConfiguration_classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,BossBarConfiguration_classExtractFieldDescriptor(t,r,"get"))}function BossBarConfiguration_classPrivateFieldSet(t,r,o){return function BossBarConfiguration_classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,BossBarConfiguration_classExtractFieldDescriptor(t,r,"set"),o),o}function BossBarConfiguration_classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var M=new WeakMap,D=function(t){!function BossBarConfiguration_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&BossBarConfiguration_setPrototypeOf(t,r)}(BossBarConfiguration,t);var r,o,i=BossBarConfiguration_createSuper(BossBarConfiguration);function BossBarConfiguration(t){var r;return function BossBarConfiguration_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,BossBarConfiguration),BossBarConfiguration_classPrivateFieldInitSpec(BossBarConfiguration_assertThisInitialized(r=i.call(this)),M,{writable:!0,value:void 0}),BossBarConfiguration_classPrivateFieldSet(BossBarConfiguration_assertThisInitialized(r),M,null!=t?t:game.scenes.viewed),BossBarConfiguration_classPrivateFieldGet(BossBarConfiguration_assertThisInitialized(r),M)||ui.notifications.error("".concat(N,".").concat(r.APP_ID,".no-scene")),r.prepareActors(),r}return function BossBarConfiguration_createClass(t,r,o){return r&&BossBarConfiguration_defineProperties(t.prototype,r),o&&BossBarConfiguration_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(BossBarConfiguration,[{key:"prepareActors",value:function prepareActors(){var t,r=(null!==(t=this.scene.getFlag(N,"actors"))&&void 0!==t?t:[]).filter((function(t){return fromUuidSync(t.uuid)}));this.actors=JSON.parse(JSON.stringify(r)),this.actors.forEach((function(t){t.document=fromUuidSync(t.uuid)}))}},{key:"scene",get:function get(){return BossBarConfiguration_classPrivateFieldGet(this,M)}},{key:"title",get:function get(){return l("".concat(N,".").concat(this.APP_ID,".title"))+": ".concat(BossBarConfiguration_classPrivateFieldGet(this,M).name)}},{key:"_prepareContext",value:(o=BossBarConfiguration_asyncToGenerator(BossBarConfiguration_regeneratorRuntime().mark((function _callee(t){var r,o,i,a,c,u,p,h=this;return BossBarConfiguration_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(a=null!==(r=null===(o=canvas)||void 0===o||null===(o=o.tokens)||void 0===o||null===(o=o.controlled)||void 0===o?void 0:o.map((function(t){return t.actor})))&&void 0!==r?r:[],(c=(a.length?a:this.scene.tokens.map((function(t){return t.actor}))).filter((function(t){return!h.actors.find((function(r){return r.document===t}))}))).length||this.actors.length){t.next=4;break}return t.abrupt("return",ui.notifications.error("".concat(N,".").concat(this.APP_ID,".no-actors")));case 4:return u=getSetting("barStyles"),p=u.reduce((function(t,r){return t[r.id]=r.name,t}),{}),c=c.map((function(t){return{uuid:t.uuid,style:u[0].id,document:t}})),this.actors.length||1!==c.length||0!==(null!==(i=this.scene.getFlag(N,"actors"))&&void 0!==i?i:[]).length||(this.actors.push(c[0]),c=[]),t.abrupt("return",{actors:this.actors,actorOptions:c,barStyleOptions:p});case 9:case"end":return t.stop()}}),_callee,this)}))),function _prepareContext(t){return o.apply(this,arguments)})},{key:"_onRender",value:function _onRender(t,r){var o=this;BossBarConfiguration_get(BossBarConfiguration_getPrototypeOf(BossBarConfiguration.prototype),"_onRender",this).call(this,t,r);var i=this.element;i.querySelectorAll("#add").forEach((function(t){t.addEventListener("click",(function(t){var r=t.currentTarget.closest("li"),i=r.dataset.uuid,a=r.querySelector("select").value;o.actors.push({uuid:i,style:a,document:fromUuidSync(i)}),o.render()}))})),i.querySelectorAll("#delete").forEach((function(t){t.addEventListener("click",(function(t){var r=t.currentTarget.closest("li").dataset.uuid;o.actors=o.actors.filter((function(t){return t.uuid!==r})),o.render()}))})),i.querySelector("#save").addEventListener("click",(function(t){o.saveData(),o.close()})),i.querySelector("#save-pan").addEventListener("click",(function(t){var r,i;o.saveData(),o.close();var a=null===(r=o.actors.find((function(t){return t.document.getActiveTokens()[0]})))||void 0===r||null===(r=r.document)||void 0===r?void 0:r.getActiveTokens()[0];T.cameraPan({uuid:null==a||null===(i=a.document)||void 0===i?void 0:i.uuid,scale:1.8,duration:1e3})})),i.querySelector("#edit-themes").addEventListener("click",(function(t){o.close(),(new x).render(!0)}))}},{key:"saveData",value:function saveData(){var t=this,r=this.actors.map((function(r){return{uuid:r.document.uuid,style:t.element.querySelector('.selected-actors-list li[data-uuid="'.concat(r.document.uuid,'"] select')).value,hideName:t.element.querySelector('.selected-actors-list li[data-uuid="'.concat(r.document.uuid,'"] input[name="hideName"]')).checked}}));return this.scene.setFlag(N,"actors",r)}},{key:"_onClose",value:function _onClose(t){BossBarConfiguration_get(BossBarConfiguration_getPrototypeOf(BossBarConfiguration.prototype),"_onClose",this).call(this,t)}}],[{key:"DEFAULT_OPTIONS",get:function get(){return mergeClone(BossBarConfiguration_get(BossBarConfiguration_getPrototypeOf(BossBarConfiguration),"DEFAULT_OPTIONS",this),{classes:[this.APP_ID],id:this.APP_ID,window:{title:"".concat(N,".").concat(this.APP_ID,".title"),icon:"",resizable:!1},position:{width:560,height:"auto"}})}},{key:"PARTS",get:function get(){return{content:{template:"modules/".concat(N,"/templates/").concat(this.APP_ID,".hbs"),classes:["standard-form","scrollable"],scrollable:[""]}}}},{key:"cleanUpActors",value:(r=BossBarConfiguration_asyncToGenerator(BossBarConfiguration_regeneratorRuntime().mark((function _callee2(t){var r,o,i,a;return BossBarConfiguration_regeneratorRuntime().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(null!==(r=t)&&void 0!==r||(t=game.scenes.viewed),i=null!==(o=t.getFlag(N,"actors"))&&void 0!==o?o:[],(a=i.filter((function(t){return fromUuidSync(t.uuid)}))).length===i.length){c.next=5;break}return c.abrupt("return",t.setFlag(N,"actors",a));case 5:return c.abrupt("return",null);case 6:case"end":return c.stop()}}),_callee2)}))),function cleanUpActors(t){return r.apply(this,arguments)})}]),BossBarConfiguration}(r);function config_typeof(t){return config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},config_typeof(t)}function config_regeneratorRuntime(){config_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",p=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var c=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(c.prototype),p=new Context(a||[]);return i(u,"_invoke",{value:makeInvokeMethod(t,o,p)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,c,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,c)&&(d=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,c,u){var p=tryCatch(t[i],t,a);if("throw"!==p.type){var h=p.arg,d=h.value;return d&&"object"==config_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,c,u)}),(function(t){invoke("throw",t,c,u)})):r.resolve(d).then((function(t){h.value=t,c(h)}),(function(t){return invoke("throw",t,c,u)}))}u(p.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,c){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw c;return doneResult()}for(o.method=a,o.arg=c;;){var u=o.delegate;if(u){var p=maybeInvokeDelegate(u,o);if(p){if(p===h)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===h)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var c=a.arg;return c?c.done?(r[t.resultName]=c.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,h):c:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,p,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,p,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,u,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,c){void 0===c&&(c=Promise);var u=new AsyncIterator(wrap(r,o,i,a),c);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(g),define(g,p,"Generator"),define(g,c,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return c.type="throw",c.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),p=o.call(a,"finallyLoc");if(u&&p){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!p)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var c=a;break}}c&&("break"===t||"continue"===t)&&c.tryLoc<=r&&r<=c.finallyLoc&&(c=null);var u=c?c.completion:{};return u.type=t,u.arg=r,c?(this.method="next",this.next=c.finallyLoc,h):this.complete(u)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),h}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},t}function config_asyncGeneratorStep(t,r,o,i,a,c,u){try{var p=t[c](u),h=p.value}catch(t){return void o(t)}p.done?r(h):Promise.resolve(h).then(i,a)}function initConfig(){Hooks.on("getSceneControlButtons",(function(t){var r;console.log("Boss Bar | getSceneControlButtons",t),t.tokens.tools.bossBar={name:"bossBar",title:"bossbar.controls.bossUI.name",icon:"fas fa-pastafarianism",visible:game.user.isGM,button:!0,onClick:(r=function config_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var c=t.apply(r,o);function _next(t){config_asyncGeneratorStep(c,i,a,_next,_throw,"next",t)}function _throw(t){config_asyncGeneratorStep(c,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(config_regeneratorRuntime().mark((function _callee(){return config_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.cleanUpActors();case 2:(new D).render(!0);case 3:case"end":return t.stop()}}),_callee)}))),function onClick(){return r.apply(this,arguments)})}}))}function main_typeof(t){return main_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},main_typeof(t)}function main_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function main_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?main_ownKeys(Object(o),!0).forEach((function(r){main_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):main_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function main_defineProperty(t,r,o){return(r=function main_toPropertyKey(t){var r=function main_toPrimitive(t,r){if("object"!==main_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==main_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===main_typeof(r)?r:String(r)}(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}var N="bossbar",$={CLASSIC:0,MATCHING_IMAGES:1},H={0:"bossbar.settings.barStyle.classic",1:"bossbar.settings.barStyle.matchingImages"},z={left:"bossbar.settings.textAlign.left",center:"bossbar.settings.textAlign.center",right:"bossbar.settings.textAlign.right"};Hooks.on("init",(function(){initConfig(),registerSettings(),function setBossBarHooks(){Hooks.on("updateScene",(function(t,r){var o;null!==(o=r.flags)&&void 0!==o&&o.bossbar&&t===game.scenes.viewed&&O.update()})),Hooks.on("canvasReady",(function(){return O.update()})),Hooks.on("updateActor",(function(t,r){var o;null===(o=ui.bossBar)||void 0===o||o._onActorUpdate(t)}))}(),T.register("cameraPan",(function(t){var r,o=t.uuid,i=t.scale,a=t.duration,c=fromUuidSync(o);c.parent===(null===(r=canvas)||void 0===r?void 0:r.scene)&&canvas.animatePan(main_objectSpread(main_objectSpread({},c.object.center),{},{scale:i,duration:a}))}))}))})();
//# sourceMappingURL=index.js.map